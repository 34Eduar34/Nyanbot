Y29uc3QKCXsKICBXQUNvbm5lY3Rpb24sCiAgTWVzc2FnZVR5cGUsCiAgUHJlc2VuY2UsCiAgTWltZXR5cGUsCiAgR3JvdXBTZXR0aW5nQ2hhbmdlLAogIE1lc3NhZ2VPcHRpb25zLAogIFdBTG9jYXRpb25NZXNzYWdlLAogIFdBX01FU1NBR0VfU1RVQl9UWVBFUywKICBSZWNvbm5lY3RNb2RlLAogIFByb3h5QWdlbnQsCiAgd2FDaGF0S2V5LAogIG1lbnRpb25lZEppZCwKICBwcm9jZXNzVGltZSwKICBDaGF0TW9kaWZpY2F0aW9uLAp9ID0gcmVxdWlyZSgnQGFkaXdhanNoaW5nL2JhaWxleXMnKTsKCmNvbnN0IHFyY29kZSA9IHJlcXVpcmUoInFyY29kZS10ZXJtaW5hbCIpOwpjb25zdCBtb21lbnQgPSByZXF1aXJlKCJtb21lbnQtdGltZXpvbmUiKTsKY29uc3QgZnMgPSByZXF1aXJlKCJmcyIpOwpjb25zdCBicmFpbmx5ID0gcmVxdWlyZSgiYnJhaW5seS1zY3JhcGVyIik7CmNvbnN0IHsgY29sb3IsIGJnY29sb3IgfSA9IHJlcXVpcmUoJy4vbGliL2NvbG9yJyk7CmNvbnN0IHsgZmV0Y2hKc29uIH0gPSByZXF1aXJlKCcuL2xpYi9mZXRjaGVyJyk7CmNvbnN0IHsgcmVjb2duaXplIH0gPSByZXF1aXJlKCcuL2xpYi9vY3InKTsKY29uc3QKIHsgCiAgd2FpdCwKICBzaW1paCwKICBnZXRCdWZmZXIsCiAgaDJrLAogIGdlbmVyYXRlTWVzc2FnZUlELAogIGdldEdyb3VwQWRtaW5zLAogIGdldFJhbmRvbSwKICBiYW5uZXIsCiAgc3RhcnQsIAogIGluZm8sCiAgc3VjY2Vzcwp9ID0gcmVxdWlyZSgnLi9saWIvZnVuY3Rpb25zJyk7Cgpjb25zdCBheGlvcyA9IHJlcXVpcmUoImF4aW9zIik7CmNvbnN0IG9zID0gcmVxdWlyZSgnb3MnKTsKY29uc3QgQ3J5cHRvSlMgPSByZXF1aXJlKCJjcnlwdG8tanMiKTsKY29uc3QgcmVxdWVzdCA9IHJlcXVpcmUoJ3JlcXVlc3QnKTsKY29uc3QgdXRpbCA9IHJlcXVpcmUoJ3V0aWwnKTsKY29uc3QgZmZtcGVnID0gcmVxdWlyZSgnZmx1ZW50LWZmbXBlZycpOwpjb25zdCBpbWdiYiA9IHJlcXVpcmUoJ2ltZ2JiLXVwbG9hZGVyJyk7CmNvbnN0IGltYWdlVG9CYXNlNjQgPSByZXF1aXJlKCdpbWFnZS10by1iYXNlNjQnKTsKY29uc3QgeyBVdGlsc18xIH0gPSByZXF1aXJlKCcuL25vZGVfbW9kdWxlcy9AYWRpd2Fqc2hpbmcvYmFpbGV5cy9saWIvV0FDb25uZWN0aW9uL1V0aWxzJykKY29uc3QgeyByZW1vdmVCYWNrZ3JvdW5kRnJvbUltYWdlRmlsZSB9ID0gcmVxdWlyZSgncmVtb3ZlLmJnJyk7CmNvbnN0IHdlbGtvbSA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKCcuL3NyYy93ZWxrb20uanNvbicpKTsKY29uc3QgYW50aW1lZGlhID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL2FudGltZWRpYS5qc29uJykpOwpjb25zdCBiYWQgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYygnLi9zcmMvYmFkLmpzb24nKSk7CmNvbnN0IGJhZHdvcmQgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYygnLi9zcmMvYmFkd29yZC5qc29uJykpOwpjb25zdCBhdXRvc3RpY2sgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYygnLi9zcmMvYXV0b3N0aWNrLmpzb24nKSk7CmNvbnN0IG5zZncgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYygnLi9zcmMvbnNmdy5qc29uJykpOwpjb25zdCBhbnRpbGluayA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKCcuL3NyYy9hbnRpbGluay5qc29uJykpOwpjb25zdCBzZXRpa2VyID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL3N0aWsuanNvbicpKQpjb25zdCB2aWRlb255ZSA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKCcuL3NyYy92aWRlby5qc29uJykpCmNvbnN0IGF1ZGlvbnllID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL2F1ZGlvLmpzb24nKSkKY29uc3QgaW1hZ2VueWUgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYygnLi9zcmMvaW1hZ2UuanNvbicpKQpjb25zdCBzYW11ID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoJy4vc2V0dGluZy5qc29uJykpCmNvbnN0IHsgc3Bhd24sIGV4ZWMsIGV4ZWNTeW5jIH0gPSByZXF1aXJlKCJjaGlsZF9wcm9jZXNzIikKY29uc3Qgc3BlZWQgPSByZXF1aXJlKCdwZXJmb3JtYW5jZS1ub3cnKQpjb25zdCBjcnlwdG8gPSByZXF1aXJlKCdjcnlwdG8nKQpjb25zdCBzaW1pID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL3NpbWkuanNvbicpKQpjb25zdCBfcmVnaXN0ZXJlZCA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKCcuL3NyYy9yZWdpc3RlcmVkLmpzb24nKSkKY29uc3QgYmFuID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL2Jhbm5lZC5qc29uJykpCmNvbnN0IHByZW1pdW0gPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYygnLi9zcmMvcHJlbWl1bS5qc29uJykpCmNvbnN0IEV4aWYgPSByZXF1aXJlKCcuL2xpYi9leGlmJykKY29uc3QgZXhpZiA9IG5ldyBFeGlmKCkKCi8vU2V0dGluZ3MKcHVibGlrID0gdHJ1ZQpwcmVmaXggPSBzYW11LnByZWZpeApzYW15cGVycnkgPSBzYW11LnNhbXlwZXJyeQpib2R5TSA9IHNhbXUuc2FtdU0KdGFyZ2V0cHJpdmF0ZSA9ICcnCmJsb2NrZWQgPSBbXQoKLy9hcGlrZXkKYXBpID0gJ2VjMzUzNTNhOTkxYTI1OGIwNTg3Njg2MScKbG9sID0gc2FtdS5sb2wKemVrcyA9IHNhbXUuemVrcwppbWdiYl9rZXkgPSBzYW11LmltZ2JiX2tleQoKCmNvbnN0IGdldFJlZ2lzdGVyZWRSYW5kb21JZCA9ICgpID0+IHsKICByZXR1cm4gX3JlZ2lzdGVyZWRbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogX3JlZ2lzdGVyZWQubGVuZ3RoKV0uaWQKfQoKY29uc3QgYWRkUmVnaXN0ZXJlZFVzZXIgPSAodXNlcmlkLCBzZW5kZXIsIGFnZSwgdGltZSwgc2VyaWFscykgPT4gewogIGNvbnN0IG9iaiA9IHsKaWQ6IHVzZXJpZCwKbmFtZTogc2VuZGVyLAphZ2U6IGFnZSwKdGltZTogdGltZSwKc2VyaWFsOiBzZXJpYWxzCiAgfQogIF9yZWdpc3RlcmVkLnB1c2gob2JqKQogIGZzLndyaXRlRmlsZVN5bmMoJy4vc3JjL3JlZ2lzdGVyZWQuanNvbicsIEpTT04uc3RyaW5naWZ5KF9yZWdpc3RlcmVkKSkKfQoKY29uc3QgY3JlYXRlU2VyaWFsID0gKHNpemUpID0+IHsKICByZXR1cm4gY3J5cHRvLnJhbmRvbUJ5dGVzKHNpemUpLnRvU3RyaW5nKCdoZXgnKS5zbGljZSgwLCBzaXplKQp9Cgpjb25zdCBjaGVja1JlZ2lzdGVyZWRVc2VyID0gKHNlbmRlcikgPT4gewogIGxldCBzdGF0dXMgPSBmYWxzZQogIE9iamVjdC5rZXlzKF9yZWdpc3RlcmVkKS5mb3JFYWNoKChpKSA9PiB7CmlmIChfcmVnaXN0ZXJlZFtpXS5pZCA9PT0gc2VuZGVyKSB7CiAgc3RhdHVzID0gdHJ1ZQp9CiAgfSkKICByZXR1cm4gc3RhdHVzCn0KCgovL2Z1bmN0aW9uCmZ1bmN0aW9uIGt5dW4oc2Vjb25kcykgewoJZnVuY3Rpb24gcGFkKHMpIHsKCQlyZXR1cm4gKHMgPCAxMCA/ICcwJyA6ICcnKSArIHM7Cgl9Cgl2YXIgaG91cnMgPSBNYXRoLmZsb29yKHNlY29uZHMgLyAoNjAgKiA2MCkpOwoJdmFyIG1pbnV0ZXMgPSBNYXRoLmZsb29yKHNlY29uZHMgJSAoNjAgKiA2MCkgLyA2MCk7Cgl2YXIgc2Vjb25kcyA9IE1hdGguZmxvb3Ioc2Vjb25kcyAlIDYwKTsKCXJldHVybiBgJHtwYWQoaG91cnMpfToke3BhZChtaW51dGVzKX06JHtwYWQoc2Vjb25kcyl9YApsZXQgZCA9IG5ldyBEYXRlCgkJCQlsZXQgbG9jYWxlID0gJ2lkJwoJCQkJCWxldCBnbXQgPSBuZXcgRGF0ZSgwKS5nZXRUaW1lKCkgLSBuZXcgRGF0ZSgnMSBKYW51YXJpIDIwMjEnKS5nZXRUaW1lKCkKCQkJCQlsZXQgd2V0b24gPSBbJ1BhaGluZycsICdQb24nLCdXYWdlJywnS2xpd29uJywnTGVnaSddW01hdGguZmxvb3IoKChkICogMSkgKyBnbXQpIC8gODQ2MDAwMDApICUgNV0KCQkJCQlsZXQgd2VlayA9IGQudG9Mb2NhbGVEYXRlU3RyaW5nKGxvY2FsZSwgeyB3ZWVrZGF5OiAnbG9uZycgfSkKCQkJCQlsZXQgY2FsZW5kZXIgPSBkLnRvTG9jYWxlRGF0ZVN0cmluZyhsb2NhbGUsIHsKCQkJCWRheTogJ251bWVyaWMnLAoJCQkJbW9udGg6ICdsb25nJywKCQkJCXllYXI6ICdudW1lcmljJwoJCQkJfSkKCQkJbGV0IHYgPSBuZXcgRGF0ZQoJCQkJbGV0IGxvY2FsbGUgPSAnaWQnCgkJCQkJY29uc3QgaGFyaW55YSA9IGQudG9Mb2NhbGVEYXRlU3RyaW5nKGxvY2FsZSwgeyB3ZWVrZGF5OiAnbG9uZycgfSkKCQkJCQoJCQkJdmFyIHJhbWFkaGFuID0gTWF0aC5mbG9vcihwZW5naGl0dW5nUm1kIC0gbW9tZW50KCkuZm9ybWF0KCdERDpISDptbScpKSAKCQkJCWxldCBocmkgPSBuZXcgRGF0ZQoJCQkJbGV0IGxvY2FsZXYgPSAnaWQnCgkJCQkJdmFyIGhhcmk9IGhyaS50b0xvY2FsZURhdGVTdHJpbmcobG9jYWxldiwgeyB3ZWVrZGF5OiAnbG9uZycgfSkKfQoKYXN5bmMgZnVuY3Rpb24gc3RhcnRzKCkgewoJY29uc3Qgc2FtdTMzMCA9IG5ldyBXQUNvbm5lY3Rpb24oKQoJc2FtdTMzMC5sb2dnZXIubGV2ZWwgPSAnd2FybicKCXNhbXUzMzAub24oJ3FyJywgKCkgPT4gewoJCWNvbnNvbGUubG9nKGNvbG9yKCdbJywnd2hpdGUnKSwgY29sb3IoJyEnLCdyZWQnKSwgY29sb3IoJ10nLCd3aGl0ZScpLCBjb2xvcignIEVTQ0FORUEgRUwgQ09HSUdPIFdF7aC+7bWAJykpCgl9KQoKCWZzLmV4aXN0c1N5bmMoJy4vU2FtdS5qc29uJykgJiYgc2FtdTMzMC5sb2FkQXV0aEluZm8oJy4vU2FtdS5qc29uJykKCXNhbXUzMzAub24oJ2Nvbm5lY3RpbmcnLCAoKSA9PiB7CgkJc3RhcnQoJzInLCAnQ29ubmVjdGluZy4uLicpCgl9KQoJc2FtdTMzMC5vbignb3BlbicsICgpID0+IHsKCQlzdWNjZXNzKCcyJywgYENvbmVjdGFkb+2gve23vVxuXG49PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuKyBOeWFuQm90XG4rIFNhbXUzMzBcbj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG7ilIzilb7ilIMgUkVDSVZFUiDilIPilb5gKQoJfSkKCWF3YWl0IHNhbXUzMzAuY29ubmVjdCh7dGltZW91dE1zOiAzMCoxMDAwfSkKICAgICAgICBmcy53cml0ZUZpbGVTeW5jKCcuL1NhbXUuanNvbicsIEpTT04uc3RyaW5naWZ5KHNhbXUzMzAuYmFzZTY0RW5jb2RlZEF1dGhJbmZvKCksIG51bGwsICdcdCcpKQoJCQkJCnNhbXUzMzAub24oJ2dyb3VwLXBhcnRpY2lwYW50cy11cGRhdGUnLCBhc3luYyAoYW51KSA9PiB7CgkJaWYgKCF3ZWxrb20uaW5jbHVkZXMoYW51LmppZCkpIHJldHVybgoJCXRyeSB7CgkJCWNvbnN0IG1kYXRhID0gYXdhaXQgc2FtdTMzMC5ncm91cE1ldGFkYXRhKGFudS5qaWQpCgkJCWNvbnNvbGUubG9nKGFudSkKCQkJaWYgKGFudS5hY3Rpb24gPT0gJ2FkZCcpIHsKCQkJCW51bSA9IGFudS5wYXJ0aWNpcGFudHNbMF0KCQkJCWNvbnN0IG1vbWVudCA9IHJlcXVpcmUoJ21vbWVudC10aW1lem9uZScpCmNvbnN0IGptID0gbW9tZW50LnR6KCdBc2lhL0pha2FydGEnKS5mb3JtYXQoJ0hIOm1tOnNzJykKCQkJbGV0IGQgPSBuZXcgRGF0ZQoJCQkJbGV0IGxvY2FsZSA9ICdpZCcKCQkJCQlsZXQgZ210ID0gbmV3IERhdGUoMCkuZ2V0VGltZSgpIC0gbmV3IERhdGUoJzEgSmFudWFyaSAyMDIxJykuZ2V0VGltZSgpCgkJCQkJbGV0IHdldG9uID0gWydQYWhpbmcnLCAnUG9uJywnV2FnZScsJ0tsaXdvbicsJ0xlZ2knXVtNYXRoLmZsb29yKCgoZCAqIDEpICsgZ210KSAvIDg0NjAwMDAwKSAlIDVdCgkJCQkJbGV0IHdlZWsgPSBkLnRvTG9jYWxlRGF0ZVN0cmluZyhsb2NhbGUsIHsgd2Vla2RheTogJ2xvbmcnIH0pCgkJCQkJbGV0IGNhbGVuZGVyID0gZC50b0xvY2FsZURhdGVTdHJpbmcobG9jYWxlLCB7CgkJCQlkYXk6ICdudW1lcmljJywKCQkJCW1vbnRoOiAnbG9uZycsCgkJCQl5ZWFyOiAnbnVtZXJpYycKCQkJCX0pCgoJdHJ5IHsKCQlwdXNobmVtID0gc2FtLmtleS5mcm9tTWUgPyBzYW11MzMwLnVzZXIubmFtZSA6IGNvbnRzLm5vdGlmeSB8fCBjb250cy52bmFtZSB8fCBjb250cy5uYW1lIHx8ICctJwoKfSBjYXRjaCB7IAogcHVzaG5lbSA9IG51bS5zcGxpdCgnQCcpWzBdCn0KCQkJdHJ5IHsKCQkJCXBwaW1nID0gYXdhaXQgc2FtdTMzMC5nZXRQcm9maWxlUGljdHVyZShgJHthbnUucGFydGljaXBhbnRzWzBdLnNwbGl0KCdAJylbMF19QGMudXNgKQoJCQl9IGNhdGNoIHsKCQkJCXBwaW1nID0gJy4vc3JjL2ltYWdlL3BwLmpwZWcnCgkJCX0KCQkJCWV4ZWMoYG1hZ2ljayAnLi9zcmMvd2VsLmpwZycgLWdyYXZpdHkgd2VzdCAtZmlsbCAnIzAwRkZGRicgLWZvbnQgJy4vc3JjL2ZvbnQtZ3VlLnR0ZicgLXNpemUgMTI4MHg3MTAgLXBvaW50c2l6ZSA3NSAtaW50ZXJsaW5lLXNwYWNpbmcgNy41IC1hbm5vdGF0ZSArNDYwLTQ1ICcke3B1c2huZW19JyAtcG9pbnRzaXplIDM1IC1hbm5vdGF0ZSArNDYwKzgzICcke2ptfSAke2NhbGVuZGVyfScgLXBvaW50c2l6ZSA1MCAtYW5ub3RhdGUgKzQ2MCsyMDAgJ0JpZW52ZW5pZG8gYSAke21kYXRhLnN1YmplY3R9JyAnJHtwcGltZ30nIC1yZXNpemUgJVtmeDp0P3UudyowLjI6dS53XXglW2Z4Oj91LmgqMC4yOnUuaF0gLWdyYXZpdHkgY2VudGVyIC1nZW9tZXRyeSAtNDMwKzcwIC1jb21wb3NpdGUgJ2hhbXNpbC5qcGcnYCkKCQkJCS5vbignZXJyb3InLCAoKSA9PiByZXBseSgnZXJyb3InKSkKCQkJCS5vbignZXhpdCcsICgpID0+IHsKCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShtZGF0YS5pZCwgZnMucmVhZEZpbGVTeW5jKCdoYW1zaWwuanBnJyksIE1lc3NhZ2VUeXBlLmltYWdlLCB7Y2FwdGlvbjogYO2gve24mUhvbGEsIEAke251bS5zcGxpdCgnQCcpWzBdfSwgXypCaWVudmVuaWRvIGEgJHttZGF0YS5zdWJqZWN0fSwgZXNwZXJhbW9zIHF1ZSB0ZSBsYSBwYXNlcyBhIGd1c3RvIGVuIGVzdGUgZ3J1cG/inKgqX1xuXG5fUmVjdWVyZGEgc2llbXByZSBzZWd1aXIgbGFzIHJlZ2xhcyB5IG1hbnRlbmVyIHVuYSBmb3JtYWxpZGFkIHJlc3BldHVvc2Ff7aC97biJXG5cblNvbiBsYXMgKiR7am19KiBkZWwgKiR7Y2FsZW5kZXJ9KlxuXG4ke21kYXRhLmRlc2N9YCwgY29udGV4dEluZm86IHsgbWVudGlvbmVkSmlkOiBbbnVtXSB9fSkKCQkJfSkKCQkJLy9sZWF2ZQoJCX0gIGVsc2UgaWYgKGFudS5hY3Rpb24gPT0gJ3JlbW92ZScpIHsKCQkJCW51bSA9IGFudS5wYXJ0aWNpcGFudHNbMF0KCQkJCXRla3MgPSBgX1dlbm8gcHMuLi4uIGFtbe2gve24qi4uLiAgQCR7bnVtLnNwbGl0KCdAJylbMF19IHNlIG5vcyBmdWUsIG5pIGxsb3JhciBlcyBidWVubzopXwpfKk9qYWxhIHkgbGUgYmF5YSBiaWVuLCB5IG1hcyBkZXNwdWVzLi4uLi4gcXVlIGxvIGF0cm9wZWxsZSB1biB0cmVuISHtoL3tuontoL7ttKMqXwoqTm8gc2UgYXdpdGVuIGdlbnRlLCBlc3RlbiBzZWd1cm9zIHF1ZSBuYWRpZSBsbyBleHRyYcOxYXJhOkQqYAoJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShtZGF0YS5pZCwgdGVrcywgTWVzc2FnZVR5cGUudGV4dCx7IGNvbnRleHRJbmZvOiB7Im1lbnRpb25lZEppZCI6IFtudW1dfX0pCgkJCX0KCQl9IGNhdGNoIChlKSB7CgkJY29uc29sZS5sb2coZSkKCX0KCX0pCgpzYW11MzMwLm9uKCdDQjpCbG9ja2xpc3QnLCBqc29uID0+IHsKCWlmIChibG9ja2VkLmxlbmd0aCA+IDIpIHJldHVybgoJZm9yIChsZXQgaSBvZiBqc29uWzFdLmJsb2NrbGlzdCkgewoJCWJsb2NrZWQucHVzaChpLnJlcGxhY2UoJ2MudXMnLCAncy53aGF0c2FwcC5uZXQnKSkKCX0KfSkKCnNhbXUzMzAub24oJ0NCOmFjdGlvbiwsYmF0dGVyeScsIGpzb24gPT4gewoJCWdsb2JhbC5iYXR0ZXJ5TGV2ZWxTdHIgPSBqc29uWzJdWzBdWzFdLnZhbHVlCgkJZ2xvYmFsLmJhdHRlcnlsZXZlbCA9IHBhcnNlSW50KGJhdHRlcnlMZXZlbFN0cikKCQliYXRlcmFpID0gYmF0dGVyeWxldmVsCgkJaWYgKGpzb25bMl1bMF1bMV0ubGl2ZSA9PSAndHJ1ZScpIGNoYXJnaW5nID0gdHJ1ZQoJCWlmIChqc29uWzJdWzBdWzFdLmxpdmUgPT0gJ2ZhbHNlJykgY2hhcmdpbmcgPSBmYWxzZQoJfSkKCQoJLy9BTlRJREVMCnNhbXUzMzAub24oJ21lc3NhZ2UtdXBkYXRlJywgYXN5bmMgKGh1cnR6KSA9PiB7Cgl0cnkgewoJCWNvbnN0IGZyb20gPSBodXJ0ei5rZXkucmVtb3RlSmlkCgkJY29uc3QgbWVzc2FnZVN0dWJUeXBlID0gV0FfTUVTU0FHRV9TVFVCX1RZUEVTW2h1cnR6Lm1lc3NhZ2VTdHViVHlwZV0gfHwgJ01FU1NBR0UnCgkJY29uc3QgZGF0YVJldm9rZSA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKCcuL3NyYy9nYy1yZXZva2VkLmpzb24nKSkKCQljb25zdCBkYXRhQ3RSZXZva2UgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYygnLi9zcmMvY3QtcmV2b2tlZC5qc29uJykpCgkJY29uc3QgZGF0YUJhbkN0UmV2b2tlID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL2N0LXJldm9rZWQtYmFubGlzdC5qc29uJykpCgkJY29uc3Qgc2VuZGVyID0gaHVydHoua2V5LmZyb21NZSA/IHNhbXUzMzAudXNlci5qaWQgOiBodXJ0ei5rZXkucmVtb3RlSmlkLmVuZHNXaXRoKCdAZy51cycpID8gaHVydHoucGFydGljaXBhbnQgOiBodXJ0ei5rZXkucmVtb3RlSmlkCgkJY29uc3QgaXNSZXZva2UgPSBodXJ0ei5rZXkucmVtb3RlSmlkLmVuZHNXaXRoKCdAcy53aGF0c2FwcC5uZXQnKSA/IHRydWUgOiBodXJ0ei5rZXkucmVtb3RlSmlkLmVuZHNXaXRoKCdAZy51cycpID8gZGF0YVJldm9rZS5pbmNsdWRlcyhmcm9tKSA6IGZhbHNlCgkJY29uc3QgaXNDdFJldm9rZSA9IGh1cnR6LmtleS5yZW1vdGVKaWQuZW5kc1dpdGgoJ0BnLnVzJykgPyB0cnVlIDogZGF0YUN0UmV2b2tlLmRhdGEgPyB0cnVlIDogZmFsc2UKCQljb25zdCBpc0JhbkN0UmV2b2tlID0gaHVydHoua2V5LnJlbW90ZUppZC5lbmRzV2l0aCgnQGcudXMnKSA/IHRydWUgOiAhZGF0YUJhbkN0UmV2b2tlLmluY2x1ZGVzKHNlbmRlcikgPyB0cnVlIDogZmFsc2UKCQlpZiAobWVzc2FnZVN0dWJUeXBlID09ICdSRVZPS0UnKSB7CgkJCWNvbnNvbGUubG9nKGBFc3RhZG8gZGVsIGdydXBvIDogJHshaXNSZXZva2V9XG5Fc3RhZG8gZGUgdG9kb3MgbG9zIGNvbnRhY3RvcyA6ICR7IWlzQ3RSZXZva2V9XG5FbCBlc3RhZG8gZGVsIGNvbnRhY3RvIGVzdMOhIGV4Y2x1aWRvOiAkeyFpc0JhbkN0UmV2b2tlfWApCgkJCWlmICghaXNSZXZva2UpIHJldHVybgoJCQlpZiAoIWlzQ3RSZXZva2UpIHJldHVybgoJCQlpZiAoIWlzQmFuQ3RSZXZva2UpIHJldHVybgoJCQljb25zdCBmcm9tID0gaHVydHoua2V5LnJlbW90ZUppZAoJCQljb25zdCBpc0dyb3VwID0gaHVydHoua2V5LnJlbW90ZUppZC5lbmRzV2l0aCgnQGcudXMnKSA/IHRydWUgOiBmYWxzZQoJCQlsZXQgaW50CgkJCWxldCBpbmZvTVNHID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoJy4vc3JjLy5kYXQvbXNnLmRhdGEuanNvbicpKQoJCQljb25zdCBpZF9kZWxldGVkID0gaHVydHoua2V5LmlkCgkJCWNvbnN0IG9wdDR0YWcgPSB7CgkJCQljb250ZXh0SW5mbzogeyBtZW50aW9uZWRKaWQ6IFtzZW5kZXJdIH0KCQkJfQoJCQlmb3IgKGxldCBpID0gMDsgaSA8IGluZm9NU0cubGVuZ3RoOyBpKyspIHsKCQkJCWlmIChpbmZvTVNHW2ldLmtleS5pZCA9PSBpZF9kZWxldGVkKSB7CgkJCQkJY29uc3QgZGF0YUluZm8gPSBpbmZvTVNHW2ldCgkJCQkJY29uc3QgdHlwZSA9IE9iamVjdC5rZXlzKGluZm9NU0dbaV0ubWVzc2FnZSlbMF0KCQkJCQljb25zdCB0aW1lc3RhbXAgPSBpbmZvTVNHW2ldLm1lc3NhZ2VUaW1lc3RhbXAKCQkJCQlpbnQgPSB7CgkJCQkJCW5vOiBpLAoJCQkJCQl0eXBlOiB0eXBlLAoJCQkJCQl0aW1lc3RhbXA6IHRpbWVzdGFtcCwKCQkJCQkJZGF0YTogZGF0YUluZm8KCQkJCQl9CgkJCQl9CgkJCX0KCQkJY29uc3QgaW5kZXggPSBOdW1iZXIoaW50Lm5vKQoJCQljb25zdCBib2R5ID0gaW50LnR5cGUgPT0gJ2NvbnZlcnNhdGlvbicgPyBpbmZvTVNHW2luZGV4XS5tZXNzYWdlLmNvbnZlcnNhdGlvbiA6IGludC50eXBlID09ICdleHRlbmRlZFRleHRNZXNzYWdlJyA/IGluZm9NU0dbaW5kZXhdLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS50ZXh0IDogaW50LnR5cGUgPT0gJ2ltYWdlTWVzc2FnZScgPyBpbmZvTVNHW2luZGV4XS5tZXNzYWdlLmltYWdlTWVzc2FnZS5jYXB0aW9uIDogaW50LnR5cGUgPT0gJ3N0aWNrZXJNZXNzYWdlJyA/ICdTdGlja2VyJyA6IGludC50eXBlID09ICdhdWRpb01lc3NhZ2UnID8gJ0F1ZGlvJyA6IGludC50eXBlID09ICd2aWRlb01lc3NhZ2UnID8gaW5mb01TR1tpbmRleF0udmlkZW9NZXNzYWdlLmNhcHRpb24gOiBpbmZvTVNHW2luZGV4XQoJCQlidWR5ID0gKHR5cGUgPT09ICdjb252ZXJzYXRpb24nKSA/IGh1cnR6Lm1lc3NhZ2UuY29udmVyc2F0aW9uIDogKHR5cGUgPT09ICdleHRlbmRlZFRleHRNZXNzYWdlJykgPyBodXJ0ei5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UudGV4dCA6ICcnCgkJCWNvbnN0IG1lZGlhRGF0YSA9IGludC50eXBlID09PSAnZXh0ZW5kZWRUZXh0TWVzc2FnZScgPyBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGludC5kYXRhKS5yZXBsYWNlKCdxdW90ZWRNJywgJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvIDogaW50LmRhdGEKCQkJaWYgKGludC50eXBlID09ICdjb252ZXJzYXRpb24nIHx8IGludC50eXBlID09ICdleHRlbmRlZFRleHRNZXNzYWdlJykgewoJCQkJY29uc3Qgc3RyQ29udmVyc2F0aW9uID0gYAkJIOOAjCAqQU5USS1ERUxFVEUqIOOAjQoKKuKImCDtoL3tuY3toLztv7vigI3imYLvuI9Ob21icmUgOiogJHtwdXNobmFtZX0KKuKImCDtoL3ts7JOdW1lcm8gOiogd2EubWUvJHtzZW5kZXIuc3BsaXQoJ0AnKVswXX0KKuKImCDinI9UaXBvIDoqIFRleHQKKuKImCDtoL3ttZBIb3JhIDoqICR7bW9tZW50LnVuaXgoaW50LnRpbWVzdGFtcCkuZm9ybWF0KCdISDptbTpzcycpfQoq4oiYIO2gve2zhkZlY2hhIDoqICR7bW9tZW50LnVuaXgoaW50LnRpbWVzdGFtcCkuZm9ybWF0KCdERC9NTS9ZWVlZJyl9CiriiJgg7aC97bOhTWVuc2FqZSA6KiAke2JvZHkgPyBib2R5IDogJy0nfWAKCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgc3RyQ29udmVyc2F0aW9uLCBNZXNzYWdlVHlwZS50ZXh0KQoKCQkJfQoJCX0KfSBjYXRjaCAoZSkgewoJCWNvbnNvbGUubG9nKCdNZXNzYWdlIDogJXMnLCBjb2xvcihlLCAncmVkJykpCgkJLy8gY29uc29sZS5sb2coZSkKfQp9KQoKCnNhbXUzMzAub24oJ21lc3NhZ2UtbmV3JywgYXN5bmMgKHNhbSkgPT4gewoJdHJ5IHsKCQlpZiAoIXNhbS5tZXNzYWdlKSByZXR1cm4KCQlpZiAoc2FtLmtleSAmJiBzYW0ua2V5LnJlbW90ZUppZCA9PSAnc3RhdHVzQGJyb2FkY2FzdCcpIHJldHVybgoJCWxldCBpbmZvTVNHID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL21zZy5kYXRhLmpzb24nKSkKCQlpbmZvTVNHLnB1c2goSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzYW0pKSkKCQlmcy53cml0ZUZpbGVTeW5jKCcuL3NyYy8uZGF0L21zZy5kYXRhLmpzb24nLCBKU09OLnN0cmluZ2lmeShpbmZvTVNHLCBudWxsLCAyKSkKCQljb25zdCB1cnV0YW5fcGVzYW4gPSBpbmZvTVNHLmxlbmd0aAoJCWlmICh1cnV0YW5fcGVzYW4gPT09IDUwMDApIHsKCQkJaW5mb01TRy5zcGxpY2UoMCwgNDMwMCkKCQkJZnMud3JpdGVGaWxlU3luYygnLi9zcmMvbXNnLmRhdGEuanNvbicsIEpTT04uc3RyaW5naWZ5KGluZm9NU0csIG51bGwsIDIpKQoJCX0KCQkgaWYgKCFzYW0ubWVzc2FnZSkgcmV0dXJuCgkJaWYgKHNhbS5rZXkgJiYgc2FtLmtleS5yZW1vdGVKaWQgPT0gJ3N0YXR1c0Bicm9hZGNhc3QnKSByZXR1cm4KCQljb25zdCB0eXBlaSA9IE9iamVjdC5rZXlzKHNhbS5tZXNzYWdlKVswXQoJCWJ1ZG8gPSAodHlwZWkgPT09ICdjb252ZXJzYXRpb24nKSA/IHNhbS5tZXNzYWdlLmNvbnZlcnNhdGlvbiA6ICh0eXBlaSA9PT0gJ2V4dGVuZGVkVGV4dE1lc3NhZ2UnKSA/IHNhbS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UudGV4dCA6ICcnCgkJCWlmKHNhbS5rZXkuZnJvbU1lKXsKCQkJfQoKCQlpZiAoIXB1YmxpaykgewoJCQlpZiAoIXNhbS5rZXkuZnJvbU1lKSByZXR1cm4KCQl9CgkJZ2xvYmFsLnByZWZpeAoJCWdsb2JhbC5ibG9ja2VkCgkJc2FtLm1lc3NhZ2UgPSAoT2JqZWN0LmtleXMoc2FtLm1lc3NhZ2UpWzBdID09PSAnZXBoZW1lcmFsTWVzc2FnZScpID8gc2FtLm1lc3NhZ2UuZXBoZW1lcmFsTWVzc2FnZS5tZXNzYWdlIDogc2FtLm1lc3NhZ2UKCQlnbG9iYWwuYmF0cmVpID0gZ2xvYmFsLmJhdHJlaSA/IGdsb2JhbC5iYXRyZWkgOiBbXQoJCXNhbXUzMzAub24oJ0NCOmFjdGlvbiwsYmF0dGVyeScsIGpzb24gPT4gewoJCWNvbnN0IGJhdHRlcnlMZXZlbFN0ciA9IGpzb25bMl1bMF1bMV0udmFsdWUKCQljb25zdCBiYXR0ZXJ5bGV2ZWwgPSBwYXJzZUludChiYXR0ZXJ5TGV2ZWxTdHIpCgkJZ2xvYmFsLmJhdHJlaS5wdXNoKGJhdHRlcnlsZXZlbCkKCX0pCgkJY29uc3QgY29udGVudCA9IEpTT04uc3RyaW5naWZ5KHNhbS5tZXNzYWdlKQoJCWNvbnN0IGZyb20gPSBzYW0ua2V5LnJlbW90ZUppZAoJCWNvbnN0IHR5cGUgPSBPYmplY3Qua2V5cyhzYW0ubWVzc2FnZSlbMF0KCQl2YXIgdGlwZSA9ICdUZWtzJwoJCQlpZiAodHlwZSA9PSAnaW1hZ2VNZXNzYWdlJykgewoJCQkJdGlwZSA9ICdJbWFnZW4nCgkJCX0gZWxzZSBpZiAodHlwZSA9PSAnc3RpY2tlck1lc3NhZ2UnKSB7CgkJCQl0aXBlID0gJ1N0aWtlcicKCQkJfSBlbHNlIGlmICh0eXBlID09PSAnZXh0ZW5kZWRUZXh0TWVzc2FnZScgJiYgY29udGVudC5pbmNsdWRlcygnaW1hZ2VNZXNzYWdlJykpIHsKCQkJCXRpcGUgPSAnZXRpcXVldGEgSW1hZ2VuJwoJCQl9IGVsc2UgaWYgKHR5cGUgPT09ICdleHRlbmRlZFRleHRNZXNzYWdlJyAmJiBjb250ZW50LmluY2x1ZGVzKCdzdGlja2VyTWVzc2FnZScpKSB7CgkJCQl0aXBlID0gJ2V0aXF1ZXRhIFN0aWtlcicKCQkJfSBlbHNlIGlmICh0eXBlID09PSAnZXh0ZW5kZWRUZXh0TWVzc2FnZScgJiYgY29udGVudC5pbmNsdWRlcygnYXVkaW9NZXNzYWdlJykpIHsKCQkJCXRpcGUgPSAnZXRpcXVldGEgQXVkaW8nCgkJCX0gZWxzZSBpZiAodHlwZSA9PT0gJ2V4dGVuZGVkVGV4dE1lc3NhZ2UnICYmIGNvbnRlbnQuaW5jbHVkZXMoJ3ZpZGVvTWVzc2FnZScpKSB7CgkJCQl0aXBlID0gJ2V0aXF1ZXRhIFZpZGVvJwoJCQl9IGVsc2UgaWYgKHR5cGUgPT09ICdleHRlbmRlZFRleHRNZXNzYWdlJyAmJiBjb250ZW50LmluY2x1ZGVzKCdjb252ZXJzYXRpb24nKSkgewoJCQkJdGlwZSA9ICdldGlxdWV0YSBUZXh0bycKCQkJfSBlbHNlIGlmICh0eXBlID09PSAnZXh0ZW5kZWRUZXh0TWVzc2FnZScgJiYgY29udGVudC5pbmNsdWRlcygncHJvZHVjdE1lc3NhZ2UnKSkgewoJCQkJdGlwZSA9ICdldGlxdWV0YSBQcm9kdXZ0bycKCQkJfSBlbHNlIGlmICh0eXBlID09PSAnZXh0ZW5kZWRUZXh0TWVzc2FnZScgJiYgY29udGVudC5pbmNsdWRlcygnZG9jdW1lbnRNZXNzYWdlJykpIHsKCQkJCXRpcGUgPSAnZXRpcXVldGEgRG9jdW1lbnRvJwoJCQl9IGVsc2UgaWYgKHR5cGUgPT09ICdleHRlbmRlZFRleHRNZXNzYWdlJyAmJiBjb250ZW50LmluY2x1ZGVzKCdvcmRlck1lc3NhZ2UnKSkgewoJCQkJdGlwZSA9ICdldGlxdWV0YSBQZWRpZG8nCgkJCX0gZWxzZSBpZiAodHlwZSA9PT0gJ2V4dGVuZGVkVGV4dE1lc3NhZ2UnICYmIGNvbnRlbnQuaW5jbHVkZXMoJ2NvbnRhY3RNZXNzYWdlJykpIHsKCQkJCXRpcGUgPSAnZXRpcXVldGEgQ29udGFjdG8nCgkJCX0gZWxzZSBpZiAodHlwZSA9PT0gJ2V4dGVuZGVkVGV4dE1lc3NhZ2UnICYmIGNvbnRlbnQuaW5jbHVkZXMoJ2ltYWdlTWVzc2FnZScpKSB7CgkJCQl0aXBlID0gJ2V0aXF1ZXRhIExvY2FzaW9uJwoJCQl9IGVsc2UgaWYgKHR5cGUgPT09ICdleHRlbmRlZFRleHRNZXNzYWdlJyAmJiBjb250ZW50LmluY2x1ZGVzKCdtZW50aW9uZWRKaWQnKSkgewoJCQkJdGlwZSA9ICdNZW5jaW9uYXIgcGVyc29uYXMnCgkJCX0gZWxzZSBpZiAodHlwZSA9PT0gJ2V4dGVuZGVkVGV4dE1lc3NhZ2UnICYmIGNvbnRlbnQuaW5jbHVkZXMoJ21hdGNoZWRUZXh0JykpIHsKCQkJCXRpcGUgPSAnTGluaycKCQkJfSBlbHNlIGlmICh0eXBlID09ICd2aWRlb01lc3NhZ2UnKSB7CgkJCQl0aXBlID0gJ1ZpZGVvJwoJCQl9IGVsc2UgaWYgKHR5cGUgPT0gJ2NvbnZlcnNhdGlvbicpIHsKCQkJCXRpcGUgPSAnVGV4dG8nCgkJCX0gZWxzZSB7CgkJCQl0aXBlID0gJ0HDum4gbm8gY29ub2NpZG8nCgkJCX0KCQljb25zdCB7IHRleHQsIGV4dGVuZGVkVGV4dCwgY29udGFjdCwgbG9jYXRpb24sIGxpdmVMb2NhdGlvbiwgaW1hZ2UsIHZpZGVvLCBzdGlja2VyLCBkb2N1bWVudCwgYXVkaW8sIHByb2R1Y3QgfSA9IE1lc3NhZ2VUeXBlCgkJY29uc3QgdGltZSA9IG1vbWVudC50eignQXNpYS9KYWthcnRhJykuZm9ybWF0KCdERC9NTSBISDptbTpzcycpCgkJYm9keSA9ICh0eXBlID09PSAnY29udmVyc2F0aW9uJyAmJiBzYW0ubWVzc2FnZS5jb252ZXJzYXRpb24uc3RhcnRzV2l0aChwcmVmaXgpKSA/IHNhbS5tZXNzYWdlLmNvbnZlcnNhdGlvbiA6ICh0eXBlID09ICdpbWFnZU1lc3NhZ2UnKSAmJiBzYW0ubWVzc2FnZS5pbWFnZU1lc3NhZ2UuY2FwdGlvbi5zdGFydHNXaXRoKHByZWZpeCkgPyBzYW0ubWVzc2FnZS5pbWFnZU1lc3NhZ2UuY2FwdGlvbiA6ICh0eXBlID09ICd2aWRlb01lc3NhZ2UnKSAmJiBzYW0ubWVzc2FnZS52aWRlb01lc3NhZ2UuY2FwdGlvbi5zdGFydHNXaXRoKHByZWZpeCkgPyBzYW0ubWVzc2FnZS52aWRlb01lc3NhZ2UuY2FwdGlvbiA6ICh0eXBlID09ICdleHRlbmRlZFRleHRNZXNzYWdlJykgJiYgc2FtLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS50ZXh0LnN0YXJ0c1dpdGgocHJlZml4KSA/IHNhbS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UudGV4dCA6ICcnCgkJYnVkeSA9ICh0eXBlID09PSAnY29udmVyc2F0aW9uJykgPyBzYW0ubWVzc2FnZS5jb252ZXJzYXRpb24gOiAodHlwZSA9PT0gJ2V4dGVuZGVkVGV4dE1lc3NhZ2UnKSA/IHNhbS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UudGV4dCA6ICcnCgkJY29uc3QgY29tbWFuZCA9IGJvZHkucmVwbGFjZShwcmVmaXgsICcnKS50cmltKCkuc3BsaXQoLyArLykuc2hpZnQoKS50b0xvd2VyQ2FzZSgpCgkJdmFyIHBlcyA9ICh0eXBlID09PSAnY29udmVyc2F0aW9uJyAmJiBzYW0ubWVzc2FnZS5jb252ZXJzYXRpb24pID8gc2FtLm1lc3NhZ2UuY29udmVyc2F0aW9uIDogKHR5cGUgPT0gJ2ltYWdlTWVzc2FnZScpICYmIHNhbS5tZXNzYWdlLmltYWdlTWVzc2FnZS5jYXB0aW9uID8gc2FtLm1lc3NhZ2UuaW1hZ2VNZXNzYWdlLmNhcHRpb24gOiAodHlwZSA9PSAndmlkZW9NZXNzYWdlJykgJiYgc2FtLm1lc3NhZ2UudmlkZW9NZXNzYWdlLmNhcHRpb24gPyBzYW0ubWVzc2FnZS52aWRlb01lc3NhZ2UuY2FwdGlvbiA6ICh0eXBlID09ICdleHRlbmRlZFRleHRNZXNzYWdlJykgJiYgc2FtLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS50ZXh0ID8gc2FtLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS50ZXh0IDogJycKCQljb25zdCBtZXNzYWdlc0MgPSBwZXMuc2xpY2UoMCkudHJpbSgpLnNwbGl0KC8gKy8pLnNoaWZ0KCkudG9Mb3dlckNhc2UoKQoJCWNvbnN0IGlzID0gYnVkeS5zbGljZSgwKS50cmltKCkuc3BsaXQoLyArLykuc2hpZnQoKS50b0xvd2VyQ2FzZSgpCgoJCWNvbnN0IGFyZ3MgPSBib2R5LnRyaW0oKS5zcGxpdCgvICsvKS5zbGljZSgxKQoJCWNvbnN0IGlzQ21kID0gYm9keS5zdGFydHNXaXRoKHByZWZpeCkKCQkKCgkJbWVzcyA9IHsKCQkJd2FpdDogJ+KMmyDtoLXtsITtoLXtsI0g7aC17bCP7aC17bCR7aC17bCO7aC17bCC7aC17bCE7aC17bCS7aC17bCOIOKMmycsCgkJCXN1Y2Nlc3M6ICfinJTvuI8g7aC17bmO7aC17bmQ7aC17bmO7aC17bmO7aC17bmA7aC17bmOIOKclO+4jycsCgkJCW5zZnc6ICftoLXtt5/toLXtt7wg7aC17biA7aC17be27aC17bey7aC17be77aC17biB7aC17be8IO2gte23ve2gte23su2gte23v+2gte23vCDtoLXtt7vtoLXtt7wg7aC17be97aC17biC7aC17bey7aC17bex7aC17be8IO2gte23su2gte23t+2gte23su2gte23sO2gte24gu2gte24ge2gte23ru2gte23vyDtoLXtt7LtoLXtuIDtoLXtt7Ig7aC17bew7aC17be87aC17be67aC17beu7aC17be77aC17bex7aC17be8LCDtoLXtt7LtoLXtuIDtoLXtuIHtoLXtt7Ig7aC17be07aC17be/7aC17biC7aC17be97aC17be8IO2gte23u+2gte23vCDtoLXtt73toLXtt7LtoLXtt7/toLXtt7rtoLXtt7btoLXtuIHtoLXtt7Ig7aC17bew7aC17be87aC17be77aC17biB7aC17bey7aC17be77aC17be27aC17bex7aC17be8ICvtoLXtv63toLXtv7RcbipQQVJBIEFDVElWQVIgTE9TIENPTUFORE9TICsxOCwgVVNBOiogLisxOCAxJywgCgkJCWZlcnI6ICdJbnRlbnRhbG8gZGUgbnVldm8gbWFzIHRhcmRlJywKCQkJYmFuOiAn4pqgICpVU1RFRCBFUyBVTiBVU1VBUklPIEJBTkVBRE8sIEVTTyBRVUlFUkUgREVDSVIgUVVFIE5PIFBVRURFIFVTQVIgRUwgQk9UKiDimqAnLAoJCQlwcmVtOiAn7aC+7bS07aC87b+7IF8qTE8gU0lFTlRPLCBFU1RFIENPTUFORE8gU09MTyBQVUVERSBTRVIgVVRJTElaQURPIFBPUiBVU1VBUklPUypfIGBgYFBSRU1JVU1gYGAg7aC97bCx4oCN7aC97bK7JywKCQkJZXJyb3I6IHsKCQkJCXN0aWNrOiAnW+Kdl10g7aC17bmA7aC17bmN7aC17bmN7aC17bmK7aC17bmNIGludGVudGFsbyBkZSBudWV2bywgZGEgZXJyb3IgYSBsYSBwcmltZXJhOkQgIOKdjCcsCgkJCQlJdjogJ+KdjCBMaW5rIGludmFsaWRvIOKdjCcKCQkJfSwKCQkJb25seTogewogICAgZ3JvdXA6ICdb4p2XXSDCoUVzdGUgY29tYW5kbyBzb2xvIHNlIHB1ZWRlIHVzYXIgZW4gZ3J1cG9zISDinYwnLAogICAgb3duZXJHOiAnW+Kdl10gwqFFc3RlIGNvbWFuZG8gc29sbyBwdWVkZSBzZXIgdXRpbGl6YWRvIHBvciBlbCBjcmVhZG9yIGRlbCBncnVwbyEg4p2MJywKICAgIG93bmVyQjogJ1vinZddIMKhRXN0ZSBjb21hbmRvIHNvbG8gcHVlZGUgc2VyIHV0aWxpemFkbyBwb3IgZWwgY3JlYWRvciBkZWwgYm90ISDinYxcbk9zZWEsIFNhbXU6IHdhLm1lLys1Mjk5ODQ5MDc3OTQsIEhhYmxhIGNvbiBlbCBwYXJhIHF1ZSBwdWVkYSBjYW1iaWFyIGVsIG51bWVybyBkZWwgb3duZXIgZW4gZXN0ZSBib3QnLAogICAgYWRtaW46ICdb4p2XXSDCoUVzdGUgY29tYW5kbyBzb2xvIHB1ZWRlIHNlciB1dGlsaXphZG8gcG9yIGFkbWluaXN0cmFkb3JlcyBkZWwgZ3J1cG8hIOKdjCcsCiAgICBCYWRtaW46ICdb4p2XXSDCoUVzdGUgY29tYW5kbyBzb2xvIHNlIHB1ZWRlIHVzYXIgY3VhbmRvIGVsIGJvdCBlcyBhZG1pbmlzdHJhZG9yISDinYwnLAogICAgZGFmdGFyQjogYEhvbGEsIHVzYSAqJHtwcmVmaXh9cmVnKiBwYXJhIHBvZGVyIHVzYXIgZWwgYm90YAogIH0KCQl9CgoJCWNvbnN0IGJvdE51bWJlciA9IHNhbXUzMzAudXNlci5qaWQKCQljb25zdCBzYW11ID0gJ2BgYCcKCQljb25zdCBqaWQgPSBzYW0ua2V5LnJlbW90ZUppZAoJCWNvbnN0IGlzR3JvdXAgPSBmcm9tLmVuZHNXaXRoKCdAZy51cycpCgkJY29uc3Qgc2VuZGVyID0gaXNHcm91cCA/IHNhbS5wYXJ0aWNpcGFudCA6IHNhbS5rZXkucmVtb3RlSmlkIAoJCWNvbnN0IGNvbnRzID0gc2FtLmtleS5mcm9tTWUgPyBzYW11MzMwLnVzZXIuamlkIDogc2FtdTMzMC5jb250YWN0c1tzZW5kZXJdIHx8IHsgbm90aWZ5OiBqaWQucmVwbGFjZSgvQC4rLywgJycpIH0KCQljb25zdCBwdXNobmFtZSA9IHNhbS5rZXkuZnJvbU1lID8gc2FtdTMzMC51c2VyLm5hbWUgOiBjb250cy5ub3RpZnkgfHwgY29udHMudm5hbWUgfHwgY29udHMubmFtZSB8fCAnLScgICAgICAgICAgICAgCgkJY29uc3Qgb3duZXJOdW1iZXIgPSBbYCR7c2FteXBlcnJ5fUBzLndoYXRzYXBwLm5ldGBdCgkvLwljb25zdCBpc0dyb3VwID0gZnJvbS5lbmRzV2l0aCgnQGcudXMnKQoJLy8JY29uc3Qgc2VuZGVyID0gaXNHcm91cCA/IHNhbS5wYXJ0aWNpcGFudCA6IHNhbS5rZXkucmVtb3RlSmlkCgkJY29uc3QgdG90YWxjaGF0ID0gYXdhaXQgc2FtdTMzMC5jaGF0cy5hbGwoKQoJCWNvbnN0IGdyb3VwTWV0YWRhdGEgPSBpc0dyb3VwID8gYXdhaXQgc2FtdTMzMC5ncm91cE1ldGFkYXRhKGZyb20pIDogJycKCQljb25zdCBncm91cE5hbWUgPSBpc0dyb3VwID8gZ3JvdXBNZXRhZGF0YS5zdWJqZWN0IDogJycKCQljb25zdCBncm91cElkID0gaXNHcm91cCA/IGdyb3VwTWV0YWRhdGEuamlkIDogJycKCQljb25zdCBncm91cE1lbWJlcnMgPSBpc0dyb3VwID8gZ3JvdXBNZXRhZGF0YS5wYXJ0aWNpcGFudHMgOiAnJwoJCWNvbnN0IGdyb3VwRGVzYyA9IGlzR3JvdXAgPyBncm91cE1ldGFkYXRhLmRlc2MgOiAnJwoJCWNvbnN0IGdyb3VwT3duZXIgPSBpc0dyb3VwID8gZ3JvdXBNZXRhZGF0YS5vd25lciA6ICcnCgkJY29uc3QgZ3JvdXBBZG1pbnMgPSBpc0dyb3VwID8gZ2V0R3JvdXBBZG1pbnMoZ3JvdXBNZW1iZXJzKSA6ICcnCgkJY29uc3QgaXNCb3RHcm91cEFkbWlucyA9IGdyb3VwQWRtaW5zLmluY2x1ZGVzKGJvdE51bWJlcikgfHwgZmFsc2UKCQljb25zdCBpc0JhZFdvcmQgPSBpc0dyb3VwID8gYmFkd29yZC5pbmNsdWRlcyhmcm9tKSA6IGZhbHNlCgkJY29uc3QgaXNBbnRpTWVkaWEgPSBpc0dyb3VwID8gYW50aW1lZGlhLmluY2x1ZGVzKGZyb20pIDogZmFsc2UKCQljb25zdCBpc0F1dG9TdCA9IGlzR3JvdXAgPyBhdXRvc3RpY2suaW5jbHVkZXMoZnJvbSkgOiBmYWxzZQoJCWNvbnN0IGlzU2ltaSA9IGlzR3JvdXAgPyBzaW1pLmluY2x1ZGVzKGZyb20pIDogZmFsc2UKCQljb25zdCBpc05zZncgPSBpc0dyb3VwID8gbnNmdy5pbmNsdWRlcyhmcm9tKSA6IGZhbHNlCgkJY29uc3QgaXNBbnRpTGluayA9IGlzR3JvdXAgPyBhbnRpbGluay5pbmNsdWRlcyhmcm9tKSA6IGZhbHNlCgkJY29uc3QgaXNHcm91cEFkbWlucyA9IGdyb3VwQWRtaW5zLmluY2x1ZGVzKHNlbmRlcikgfHwgZmFsc2UKCQljb25zdCBpc1dlbGtvbSA9IGlzR3JvdXAgPyB3ZWxrb20uaW5jbHVkZXMoZnJvbSkgOiBmYWxzZQoJCWNvbnN0IGlzT3duZXIgPSBvd25lck51bWJlci5pbmNsdWRlcyhzZW5kZXIpCgkJY29uc3QgaXNSZWdpc3RlciA9IGNoZWNrUmVnaXN0ZXJlZFVzZXIoc2VuZGVyKQoJCWNvbnN0IGlzQmFubmVkID0gYmFuLmluY2x1ZGVzKHNlbmRlcikKCQljb25zdCBpc1ByZW0gPSBwcmVtaXVtLmluY2x1ZGVzKHNlbmRlcikKCQljb25zdCBpc1VybCA9ICh1cmwpID0+IHsKCQkJcmV0dXJuIChuZXcgUmVnRXhwKC9odHRwcz86XC9cLyh3d3dcLik/Wy1hLXpBLVowLTlAOiUuK34jPV17MSwyNTZ9XC5bYS16QS1aMC05KCldezEsNn1cYihbLWEtekEtWjAtOSgpQDolKy5+Iz8mLz1dKikvLCAnZ2knKSkKCQl9CgkJY29uc3QgcmVwbHkgPSAodGVrcykgPT4gewoJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIHRla3MsIHRleHQsIHsgcXVvdGVkOiBzYW0sIHRpbWVzdGFtcDogMCwgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZSwgY2FwdGlvbjogJ19fJywgdGh1bWJuYWlsSnBnOiAnLi9zcmMvaGVscC5qcGcnfX0pCgkJfQoJCWNvbnN0IG1hdGggPSAodGVrcykgPT4gewoJCQkJcmV0dXJuIE1hdGguZmxvb3IodGVrcykKCQkJfQpjb25zdCBmaWxldXJsID0gYXN5bmMobGluaywgdHlwZSkgPT4gewogd295ID0gYXdhaXQgZ2V0QnVmZmVyKGxpbmspCiBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIHdveSwgdHlwZSwge3F1b3RlZDpmdG9rb30pCn0KCS8vRkFLRSBTVEFUVVMKCWNvbnN0IGZpbWcgPSB7Cgkga2V5OgoJIHsgZnJvbU1lOiBmYWxzZSwKCSBwYXJ0aWNpcGFudDogYDBAcy53aGF0c2FwcC5uZXRgLCAuLi4oZnJvbSA/IAoJIHsgcmVtb3RlSmlkOiAic3RhdHVzQGJyb2FkY2FzdCIgfSA6IHt9KSB9LAoJIG1lc3NhZ2U6IHsgImltYWdlTWVzc2FnZSI6IHsgIm1pbWV0eXBlIjogImltYWdlL2pwZWciLCJjYXB0aW9uIjogJ+2gve2yk+2gte2xhu2gte2wtO2gte2xgCDtoLXtsYwg7aC17bGD7aC17bC47aC17bGF7aC17bGF7aC17bGM7aC97bSlXO2gve2wrE55YW5Cb3QnLCAnanBlZ1RodW1ibmFpbCc6IGZzLnJlYWRGaWxlU3luYygnLi9OeWFuQm90LmpwZycpfX0KCX0KCQljb250ZXh0SW5mbzogewogIG1lbnRpb25lZEppZDogW3NlbmRlcl19Cgljb25zdCBmZG9jID0gewoJIGtleToKCSB7IGZyb21NZTogZmFsc2UsCgkgcGFydGljaXBhbnQ6IGA1MjE5OTg0OTA3Nzk0QHMud2hhdHNhcHAubmV0YCwgLi4uKGZyb20gPyAKCSB7IHJlbW90ZUppZDogInN0YXR1c0Bicm9hZGNhc3QiIH0gOiB7fSkgfSwKCSBtZXNzYWdlOiB7ICJkb2N1bWVudE1lc3NhZ2UiOiB7ICJ0aXRsZSI6IuKdo++4j+2gte2zou2gte2zqu2gte2ztiDtoLXttIIg7aC17bOf7aC17bOu7aC17bO77aC17bO77aC17bSCLO2gve20pSIsICJjYXB0aW9uIjogICJOeWFuQm90LO2gve2wrCIgLCAnanBlZ1RodW1ibmFpbCc6IGZzLnJlYWRGaWxlU3luYygnLi9OeWFuQm90LmpwZycpfX0KCX0KCWNvbnN0IGZsb2MgPSB7Cgkga2V5OgoJIHsgZnJvbU1lOiBmYWxzZSwKCSBwYXJ0aWNpcGFudDogYDBAcy53aGF0c2FwcC5uZXRgLCAuLi4oZnJvbSA/IAoJIHsgcmVtb3RlSmlkOiAic3RhdHVzQGJyb2FkY2FzdCIgfSA6IHt9KSB9LAoJIG1lc3NhZ2U6IHsgImxvY2F0aW9uTWVzc2FnZSI6IHsgInRpdGxlIjoi7aC97bSQU2FtdTMzMOKaoSIsICJjYXB0aW9uIjogIkFkaW9z7aC97bi0IiAsICdqcGVnVGh1bWJuYWlsJzogZnMucmVhZEZpbGVTeW5jKCcuL3NyYy9zYW15cGVycnkucG5nJyl9fQoJfQoJCWNvbnRleHRJbmZvOiB7CiAgbWVudGlvbmVkSmlkOiBbc2VuZGVyXX0KCWNvbnN0IGZsaXZlTG9jID0gewoJIGtleToKCSB7IGZyb21NZTogZmFsc2UsCgkgcGFydGljaXBhbnQ6IGAwQHMud2hhdHNhcHAubmV0YCwgLi4uKGZyb20gPyAKCSB7IHJlbW90ZUppZDogInN0YXR1c0Bicm9hZGNhc3QiIH0gOiB7fSkgfSwKCSBtZXNzYWdlOiB7ICJsaXZlTG9jYXRpb25NZXNzYWdlIjogeyAidGl0bGUiOiJOeWFuQm90IiwiY2FwdGlvbiI6ICftoL3ttKXinaPvuI9T4aWybSDhg6cgUOGlsXJy4YOnIHwgTuGDp+GlsuGlkkJvdO2gve2wrCcsICdqcGVnVGh1bWJuYWlsJzogZnMucmVhZEZpbGVTeW5jKCcuL055YW5Cb3QuanBnJyl9fQoJfQoJCWNvbnRleHRJbmZvOiB7CiAgbWVudGlvbmVkSmlkOiBbc2VuZGVyXX0KCWNvbnN0IGZ2aWQgPSB7Cgkga2V5OgoJIHsgZnJvbU1lOiBmYWxzZSwKCSBwYXJ0aWNpcGFudDogYDBAcy53aGF0c2FwcC5uZXRgLCAuLi4oZnJvbSA/IAoJIHsgcmVtb3RlSmlkOiAic3RhdHVzQGJyb2FkY2FzdCIgfSA6IHt9KSB9LAoJIG1lc3NhZ2U6IHsgInZpZGVvTWVzc2FnZSI6IHsgInRpdGxlIjogIk55YW5Cb3QiLCJjYXB0aW9uIjogJ+Kaoe2gve20pe2gte2yru2gte2ytu2gte2zgiDtoLXts44g7aC17bKr7aC17bGS7aC17bOH7aC17bOH7aC17bOOIHwg7aC17bKp7aC17bOO7aC17bK27aC17bOD4oSs7aC17bGc7aC17bOJ7aC97bKTJywgJ2pwZWdUaHVtYm5haWwnOiBmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL2Zha2UuanBnJyl9fQoJfQoJCWNvbnRleHRJbmZvOiB7CiAgbWVudGlvbmVkSmlkOiBbc2VuZGVyXX0KICAgCWNvbnN0IGZ0b2tvID0gewoJCWtleTogewoJCQlmcm9tTWU6IGZhbHNlLAoJCQlwYXJ0aWNpcGFudDogYDBAcy53aGF0c2FwcC5uZXRgLCAuLi4oZnJvbSA/IHsgcmVtb3RlSmlkOiAic3RhdHVzQGJyb2FkY2FzdCIgfSA6IHt9KQoJCX0sCgkJbWVzc2FnZTogewoJCQkicHJvZHVjdE1lc3NhZ2UiOiB7CgkJCQkicHJvZHVjdCI6IHsKCQkJCQkicHJvZHVjdEltYWdlIjp7CgkJCQkJCSJtaW1ldHlwZSI6ICJpbWFnZS9qcGVnIiwKCQkJCQkJImpwZWdUaHVtYm5haWwiOiBmcy5yZWFkRmlsZVN5bmMoYC4vc3JjL2Zha2UuanBnYCkKCQkJCQl9LAoJCQkJCSJ0aXRsZSI6ICLinqvtoLXtt6btoLXtt67toLXtt7og7aC17biGIO2gte23o+2gte23su2gte23v+2gte23v+2gte24hu2gve20peKdo++4jyIgLAoJCQkJCSJkZXNjcmlwdGlvbiI6ICIiLAoJCQkJCSJjdXJyZW5jeUNvZGUiOiAiU1lQIiwKCQkJCQkicHJpY2VBbW91bnQxMDAwIjogIi05OSIsCgkJCQkJInJldGFpbGVySWQiOiAiTnlhbkJvdCIsCgkJCQkJInByb2R1Y3RJbWFnZUNvdW50IjogOTk5CgkJCQl9LAoJCQkJImJ1c2luZXNzT3duZXJKaWQiOiBgMEBzLndoYXRzYXBwLm5ldGAKCQl9Cgl9Cgl9CgkJY29udGV4dEluZm86IHsKICBtZW50aW9uZWRKaWQ6IFtzZW5kZXJdfQoJY29uc3QgZmdjID0gewogICAgICAgICAgICAgICAgICAgIGtleTogewogICAgICAgICAgICAgICAgICAgICAgICBmcm9tTWU6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICBwYXJ0aWNpcGFudDogYDBAcy53aGF0c2FwcC5uZXRgLCAuLi4oZnJvbSA/IHsgcmVtb3RlSmlkOiAiNTIxNDQ0NzAwMDM3Ny0xNjIwMDQ5OTY1QGcudXMiIH0gOiB7fSkKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHsKICAgICAgICAgICAgICAgICAgICAgICAgImltYWdlTWVzc2FnZSI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ1cmwiOiAiaHR0cHM6Ly9tbWcud2hhdHNhcHAubmV0L2QvZi9BdDB4N1pkSXZ1aWNmamxmOW9XUzZBM0FSOVhQaDBQLWhaSVZQTHNJNzBuTS5lbmMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIm1pbWV0eXBlIjogImltYWdlL2pwZWciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImNhcHRpb24iOiBg7aC97bSl7aC17bKu7aC17bK27aC17bOCIO2gte2zjiDtoLXtsqvtoLXtsZLtoLXts4ftoLXts4ftoLXts45cbiR7YXJncy5qb2luKCcgJyl9YCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJmaWxlU2hhMjU2IjogIitJYStEd2liNzBZMUNXUk1BUDlRTEpLaklKdDU0Zkt5Y09mQjJPRVpiVFU9IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJmaWxlTGVuZ3RoIjogIjI4Nzc3IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAxMDgwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogMTA3OSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtZWRpYUtleSI6ICJ2WG1SUjdaVWVEV2pYeTVpUWsxN1Ryb3dCenV3UnlhMGVyckFGblh4YkdjPSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZmlsZUVuY1NoYTI1NiI6ICJzUjlEMlJTNUpTaWZ3NDlIZUJBRGd1STIzZldEejFhWnU0ZmFXRy9DeVJZPSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZGlyZWN0UGF0aCI6ICIvdi90NjIuNzExOC0yNC8yMTQyNzY0Ml84NDA5NTI2ODY0NzQ1ODFfNTcyNzg4MDc2MzMyNzYxNDMwX24uZW5jP29oPTNmNTdjMWJhMmZjYWI5NWYyYzBiYjQ3NWQ3MjcyMGJhJm9lPTYwMkYzRDY5IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtZWRpYUtleVRpbWVzdGFtcCI6ICIxNjEwOTkzNDg2IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJqcGVnVGh1bWJuYWlsIjogZnMucmVhZEZpbGVTeW5jKCcuL3NyYy9zYW15cGVycnkucG5nJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2NhbnNTaWRlY2FyIjogIjFXMFhoZmFBY0R3Yzd4aDFSOGxjYTZRZy8xYkI0bmFGQ1NuZ00yTEtPMk5vUDVSSTdLK3pMdz09IgogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQoJfQoJCWNvbnRleHRJbmZvOiB7CiAgbWVudGlvbmVkSmlkOiBbc2VuZGVyXX0KICAgICAgICAgICAgICAgIAoKCQljb25zdCBzZW5kTWVzcyA9IChoZWhlLCB0ZWtzKSA9PiB7CgkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoaGVoZSwgdGVrcywgdGV4dCwge2NvbnRleHRJbmZvOiB7ImZvcndhcmRpbmdTY29yZSI6IDk5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9fSwge3F1b3RlZDogZnRva28KfSkKfQoJCWNvbnN0IG1lbnRpb25zID0gKHRla3MsIG1lbWJlcnIsIGlkKSA9PiB7CgkJCShpZCA9PSBudWxsIHx8IGlkID09IHVuZGVmaW5lZCB8fCBpZCA9PSBmYWxzZSkgPyBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIHRla3MudHJpbSgpLCBleHRlbmRlZFRleHQsIHsgY29udGV4dEluZm86IHsgIm1lbnRpb25lZEppZCI6IG1lbWJlcnIgfSB9KSA6IHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgdGVrcy50cmltKCksIGV4dGVuZGVkVGV4dCwgeyBxdW90ZWQ6IGZ0b2tvLCBjb250ZXh0SW5mbzogeyAibWVudGlvbmVkSmlkIjogbWVtYmVyciB9IH0pCgkJfQoKCQljb25zdCBzZW5kS29udGFrID0gKGZyb20sIG5vbW9yLCBuYW1hKSA9PiB7Cgljb25zdCB2Y2FyZCA9ICdCRUdJTjpWQ0FSRFxuJworICdWRVJTSU9OOjMuMFxuJworIGBGTjoke25hbWF9XG5gCisgJ09SRzrtoL3tsKxOeWFuQm90O1xuJworIGBURUw7dHlwZT1DRUxMO3R5cGU9Vk9JQ0U7d2FpZD0ke25vbW9yfTorJHtub21vcn1cbmAKKyAnRU5EOlZDQVJEJyAKCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwge2Rpc3BsYXluYW1lOiBuYW1hLCB2Y2FyZDogdmNhcmR9LAoJCU1lc3NhZ2VUeXBlLmNvbnRhY3QpCgkJfQoJCgkJY29sb3JzID0gWydyZWQnLCAnd2hpdGUnLCAnYmxhY2snLCAnYmx1ZScsICd5ZWxsb3cnLCAnZ3JlZW4nXQoJCWNvbnN0IGlzTWVkaWEgPSAodHlwZSA9PT0gJ2ltYWdlTWVzc2FnZScgfHwgdHlwZSA9PT0gJ3ZpZGVvTWVzc2FnZScpCgkJY29uc3QgaXNRdW90ZWRJbWFnZSA9IHR5cGUgPT09ICdleHRlbmRlZFRleHRNZXNzYWdlJyAmJiBjb250ZW50LmluY2x1ZGVzKCdpbWFnZU1lc3NhZ2UnKQoJCWNvbnN0IGlzUXVvdGVkVmlkZW8gPSB0eXBlID09PSAnZXh0ZW5kZWRUZXh0TWVzc2FnZScgJiYgY29udGVudC5pbmNsdWRlcygndmlkZW9NZXNzYWdlJykKCQljb25zdCBpc1F1b3RlZEF1ZGlvID0gdHlwZSA9PT0gJ2V4dGVuZGVkVGV4dE1lc3NhZ2UnICYmIGNvbnRlbnQuaW5jbHVkZXMoJ2F1ZGlvTWVzc2FnZScpCgkJY29uc3QgaXNRdW90ZWRTdGlja2VyID0gdHlwZSA9PT0gJ2V4dGVuZGVkVGV4dE1lc3NhZ2UnICYmIGNvbnRlbnQuaW5jbHVkZXMoJ3N0aWNrZXJNZXNzYWdlJykKCQkKCQkKCQkvL2F1dG9TdGlrZXIgQnkgU2FtdTMzMAppZiAoaXNHcm91cCAmJiBpc0F1dG9TdCAmJiAhYm90TnVtYmVyKSB7CmlmIChpc01lZGlhICYmICFzYW0ubWVzc2FnZS52aWRlb01lc3NhZ2UgfHwgaXNRdW90ZWRJbWFnZSkgeyAgICAgICAgICAgCglpZiAoIWJvdE51bWJlcikgewoJY29uc3QgZW5jbWVkaWEgPSBpc1F1b3RlZEltYWdlID8gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzYW0pLnJlcGxhY2UoJ3F1b3RlZE0nLCdtJykpLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mbyA6IHNhbSAgICAgICAKCWNvbnN0IG1lZGlhID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZEFuZFNhdmVNZWRpYU1lc3NhZ2UoZW5jbWVkaWEpIAoJcmFuID0gZ2V0UmFuZG9tKCcud2VicCcpICAgICAgICAgICAKCWF3YWl0IGZmbXBlZyhgLi8ke21lZGlhfWApICAgICAgCgkJLmlucHV0KG1lZGlhKSAgICAgICAKCQkub24oJ3N0YXJ0JywgZnVuY3Rpb24gKGNtZCkgeyAgICAgIAoJCQljb25zb2xlLmxvZyhgU3RhcnRlZCA6ICR7Y21kfWApICAgICAKCQl9KSAgICAgICAgICAgICAgICAgICAgCgkJLm9uKCdlcnJvcicsIGZ1bmN0aW9uIChlcnIpIHsgICAgICAgICAgIAoJCQljb25zb2xlLmxvZyhgRXJyb3IgOiAke2Vycn1gKSAgICAgICAgCgkJCWZzLnVubGlua1N5bmMobWVkaWEpICAgICAgICAgICAgICAgICAKCQkJcmVwbHkobWVzcy5lcnJvci5zdGljaykgICAgICAgICAgICAgICAgIAoJCX0pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAoJCS5vbignZW5kJywgZnVuY3Rpb24gKCkgeyAgICAgICAgICAgICAgICAgIAoJCQljb25zb2xlLmxvZygnRmluaXNoJykgICAgICAgICAgICAgICAKCQkJZXhlYyhgd2VicG11eCAtc2V0IGV4aWYgJHthZGRNZXRhZGF0YSgnQXV0by1TdC1CeS1TYW11MzMwLVNhbS15LVBlcnJ5Jyl9ICR7cmFufSAtbyAke3Jhbn1gLCBhc3luYyAoZXJyb3IpID0+IHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAoJCQkJaWYgKGVycm9yKSByZXR1cm4gcmVwbHkobWVzcy5lcnJvci5zdGljaykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBmcy5yZWFkRmlsZVN5bmMocmFuKSwgc3RpY2tlciwge3F1b3RlZDogZmRvYywgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZX19KSAgICAKCQkJCQkJCQkJcmVwbHkobWVzcy5zdWNjZXNzKSAgICAgICAKCQkJCQkJCQkJZnMudW5saW5rU3luYyhtZWRpYSkgICAgICAgCgkJCQkJCQkJCWZzLnVubGlua1N5bmMocmFuKSAgICAgICAgICAKCQkJCQkJCQkJfSkgICAgICAgICAgICAgICAgICAgICAgIAoJCQkJCQkJfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYWRkT3V0cHV0T3B0aW9ucyhbYC12Y29kZWNgLGBsaWJ3ZWJwYCxgLXZmYCxgc2NhbGU9J21pbigzMjAsaXcpJzptaW4nKDMyMCxpaCknOmZvcmNlX29yaWdpbmFsX2FzcGVjdF9yYXRpbz1kZWNyZWFzZSxmcHM9MTUsIHBhZD0zMjA6MzIwOi0xOi0xOmNvbG9yPXdoaXRlQDAuMCwgc3BsaXQgW2FdW2JdOyBbYV0gcGFsZXR0ZWdlbj1yZXNlcnZlX3RyYW5zcGFyZW50PW9uOnRyYW5zcGFyZW5jeV9jb2xvcj1mZmZmZmYgW3BdOyBbYl1bcF0gcGFsZXR0ZXVzZWBdKQoJCQkJCQkJLnRvRm9ybWF0KCd3ZWJwJykKCQkJCQkJICAJLnNhdmUocmFuKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQp9Cn0KCgoKCgoKCgoKCgkJCWlmIChpc0dyb3VwICYmIGlzQm90R3JvdXBBZG1pbnMgJiYgaXNCYWRXb3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiYWQuaW5jbHVkZXMobWVzc2FnZXNDKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNHcm91cEFkbWlucykgeyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQoJCQkJCXZhciBraWMgPSBgJHtzZW5kZXIuc3BsaXQoIkAiKVswXX1Acy53aGF0c2FwcC5uZXRgCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcGx5KGBMbyBzaWVudG8gJHtzZW5kZXIuc3BsaXQoIkAiKVswXX0sIHBlcm8gYXF1aSBubyBzZSBwZXJtaXRlbiBsYXMgbWFsYXMgcGFsYWJyYXMsIHNlcsOhcyBleHB1bHNhZG8gZW4gNSBzZWd1bmRvc2ApCiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYW11MzMwLmdyb3VwUmVtb3ZlKGZyb20sIFtraWNdKS5jYXRjaCgoZSk9PntyZXBseShgKkVSUjoqICR7ZX1gKX0pCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDUwMDApCiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBseSgiMSBzZWd1bmRvIikKICAgICAgICAgICAgICAgICAgICAgICAgfSwgNDAwMCkKICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCggKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGx5KCIyIHNlZ3VuZG9zIikKICAgICAgICAgICAgICAgICAgICAgICAgfSwgMzAwMCkKICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCggKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGx5KCIzIHNlZ3VuZG9zIikKICAgICAgICAgICAgICAgICAgICAgICAgfSwgMjAwMCkKICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCggKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGx5KCI0IHNlZ3VuZG9zIikKICAgICAgICAgICAgICAgICAgICAgICAgfSwgMTAwMCkKICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCggKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGx5KCI1IHNlZ3VuZG9zIikKICAgICAgICAgICAgICAgICAgICAgICAgfSwgMCkKCQkJCX0KCQkJfQoJCX0KCQkJaWYgKGlzR3JvdXAgJiYgaXNCb3RHcm91cEFkbWlucyAmJiBpc0FudGlNZWRpYSAmJiAhYm90TnVtYmVyKSB7ICAgICAgICAgCgkJCQlpZiAoaXNNZWRpYSAmJiAhc2FtLm1lc3NhZ2UudmlkZW9NZXNzYWdlIHx8IGlzUXVvdGVkSW1hZ2UpIHsKCQkJCQlpZiAoIWlzR3JvdXBBZG1pbnMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQoJCQkJCQl2YXIga2ljID0gYCR7c2VuZGVyLnNwbGl0KCJAIilbMF19QHMud2hhdHNhcHAubmV0YCAgICAgCgkJCXJlcGx5KGBMbyBzaWVudG8gJHtzZW5kZXIuc3BsaXQoIkAiKVswXX0sIHBlcm8gYXF1aSBubyBzZSBwZXJtaXRlbiBsYXMgZm90b3MgbmkgdmlkZW9zLCAqc2Vyw6FzIGV4cHVsc2FkbyBwb3Igc2VndXJpZGFkOkQqYCkKCQkJCXNhbXUzMzAuZ3JvdXBSZW1vdmUoZnJvbSwgW2tpY10pLmNhdGNoKChlKT0+e3JlcGx5KGAqRVJSOiogJHtlfWApfSkgICAgICAgCgkJCQkJfSAgICAgICAgCgkJCQl9ICAgICAgCgkJCX0KCQkJaWYgKGlzR3JvdXAgJiYgaXNCb3RHcm91cEFkbWlucyAmJiBpc0FudGlNZWRpYSAmJiAhYm90TnVtYmVyKSB7CgkJCQlpZiAoaXNNZWRpYSAmJiBzYW0ubWVzc2FnZS52aWRlb01lc3NhZ2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNHcm91cEFkbWlucykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBraWMgPSBgJHtzZW5kZXIuc3BsaXQoIkAiKVswXX1Acy53aGF0c2FwcC5uZXRgICAgICAKCQkJCQkJcmVwbHkoYExvIHNpZW50byAke3NlbmRlci5zcGxpdCgiQCIpWzBdfSwgcGVybyBhcXVpIG5vIHNlIHBlcm1pdGVuIGxhcyBmb3RvcyBuaSB2aWRlb3MsICpzZXLDoXMgZXhwdWxzYWRvIHBvciBzZWd1cmlkYWQ6RCpgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhbXUzMzAuZ3JvdXBSZW1vdmUoZnJvbSwgW2tpY10pLmNhdGNoKChlKT0+e3JlcGx5KGAqRVJSOiogJHtlfWApfSkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAoJCQkJCX0KCQkJCX0KCQkJfQoJCQkJCgkJCgkJCSBpZiAobWVzc2FnZXNDLmluY2x1ZGVzKCJodHRwczovLyIpKXsKCQkgICAgICAgIGlmICghaXNHcm91cCkgcmV0dXJuCgkJICAgICAgICBpZiAoIWlzQW50aUxpbmspIHJldHVybgoJCSAgICAgICAgaWYgKGlzR3JvdXBBZG1pbnMpIHJldHVybiByZXBseSgnVGllbmVzIHN1ZXJ0ZSwgZXJlcyBhZG1pbiB5IG5vIHRlIHNhY2Fyw6knKQoJCSAgICAgICAgc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCgkJICAgICAgICBpZiAobWVzc2FnZXNDLmluY2x1ZGVzKCIjaXppbmFkbWluIikpIHJldHVybiByZXBseSgiI2l6aW5hZG1pbiByZWNlYmlkbyIpCgkJICAgICAgICB2YXIga2ljID0gYCR7c2VuZGVyLnNwbGl0KCJAIilbMF19QHMud2hhdHNhcHAubmV0YAoJCSAgICAgICAgcmVwbHkoYExpbmsgZGV0ZWN0YWRvICR7c2VuZGVyLnNwbGl0KCJAIilbMF19IHNlcsOhcyBleHB1bHNhZG8gZW4gNSBzZWd1bmRvc2ApCgkJICAgICAgICBzZXRUaW1lb3V0KCAoKSA9PiB7CgkJCSAgICAgICAgc2FtdTMzMC5ncm91cFJlbW92ZShmcm9tLCBba2ljXSkuY2F0Y2goKGUpPT57cmVwbHkoYCpFUlI6KiAke2V9YCl9KQoJCSAgICAgICAgfSwgNTAwMCkKCQkgICAgICAgIHNldFRpbWVvdXQoICgpID0+IHsKCQkJICAgICAgICBzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKCQkJICAgICAgICByZXBseSgiMSBzZWd1bmRvIikKCQkgICAgICAgIH0sIDQwMDApCgkJICAgICAgICBzZXRUaW1lb3V0KCAoKSA9PiB7CgkJCSAgICAgICAgc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCgkJICAgICAgICAgICAgICAgIHJlcGx5KCIyIHNlZ3VuZG9zIikKCQkgICAgICAgIH0sIDMwMDApCgkJICAgICAgICBzZXRUaW1lb3V0KCAoKSA9PiB7CgkJCSAgICAgICAgc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCgkJCSAgICAgICAgcmVwbHkoIjMgc2VndW5kb3MiKQoJCSAgICAgICAgfSwgMjAwMCkKCQkgICAgICAgIHNldFRpbWVvdXQoICgpID0+IHsKCQkJICAgICAgICBzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKCQkJICAgICAgICByZXBseSgiNCBzZWd1bmRvcyIpCgkJICAgICAgICB9LCAxMDAwKQoJCSAgICAgICAgc2V0VGltZW91dCggKCkgPT4gewoJCQkgICAgICAgIHNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQoJCQkgICAgICAgIHJlcGx5KCI1IHNlZ3VuZG9zIikKCQkJfSwgMTAwMCkKCQkJc2V0VGltZW91dCggKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGx5KCJBZGlvczpEIikKCQkgICAgICAgIH0sIDApCgkgICAgICAgIH0KCQoJCgkgICAgICAgICAgICBpZiAobWVzc2FnZXNDLmluY2x1ZGVzKCJ3d3cuIikpewoJCSAgICAgICAgaWYgKCFpc0dyb3VwKSByZXR1cm4KCQkgICAgICAgIGlmICghaXNBbnRpTGluaykgcmV0dXJuCgkJICAgICAgICBpZiAoaXNHcm91cEFkbWlucykgcmV0dXJuIHJlcGx5KCdUaWVuZXMgc3VlcnRlLCBlcmVzIGFkbWluIHkgbm8gdGUgc2FjYXLDqScpCgkJICAgICAgICBzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKCQkgICAgICAgIGlmIChtZXNzYWdlc0MuaW5jbHVkZXMoIiNpemluYWRtaW4iKSkgcmV0dXJuIHJlcGx5KCIjaXppbmFkbWluIHJlY2ViaWRvIikKCQkgICAgICAgIHZhciBraWMgPSBgJHtzZW5kZXIuc3BsaXQoIkAiKVswXX1Acy53aGF0c2FwcC5uZXRgCgkJICAgICAgICByZXBseShgTGluayBkZXRlY3RhZG8gJHtzZW5kZXIuc3BsaXQoIkAiKVswXX0gc2Vyw6FzIGV4cHVsc2FkbyBlbiA1IHNlZ3VuZG9zYCkKCQkgICAgICAgIHNldFRpbWVvdXQoICgpID0+IHsKCQkJICAgICAgICBzYW11MzMwLmdyb3VwUmVtb3ZlKGZyb20sIFtraWNdKS5jYXRjaCgoZSk9PntyZXBseShgKkVSUjoqICR7ZX1gKX0pCgkJICAgICAgICB9LCA1MDAwKQoJCSAgICAgICAgc2V0VGltZW91dCggKCkgPT4gewoJCQkgICAgICAgIHNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQoJCQkgICAgICAgIHJlcGx5KCIxIHNlZ3VuZG8iKQoJCSAgICAgICAgfSwgNDAwMCkKCQkgICAgICAgIHNldFRpbWVvdXQoICgpID0+IHsKCQkJICAgICAgICBzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKCQkgICAgICAgICAgICAgICAgcmVwbHkoIjIgc2VndW5kb3MiKQoJCSAgICAgICAgfSwgMzAwMCkKCQkgICAgICAgIHNldFRpbWVvdXQoICgpID0+IHsKCQkJICAgICAgICBzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKCQkJICAgICAgICByZXBseSgiMyBzZWd1bmRvcyIpCgkJICAgICAgICB9LCAyMDAwKQoJCSAgICAgICAgc2V0VGltZW91dCggKCkgPT4gewoJCQkgICAgICAgIHNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQoJCQkgICAgICAgIHJlcGx5KCI0IHNlZ3VuZG9zIikKCQkgICAgICAgIH0sIDEwMDApCgkJICAgICAgICBzZXRUaW1lb3V0KCAoKSA9PiB7CgkJCSAgICAgICAgc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCgkJCSAgICAgICAgcmVwbHkoIjUgc2VndW5kb3MiKQoJCSAgICAgICAgfSwgMCkKCSAgICAgICAgfQoJCQoJCQoJCQoJCWNvbG9ycyA9IFsncmVkJywnd2hpdGUnLCdibGFjaycsJ2JsdWUnLCd5ZWxsb3cnLCdncmVlbiddCgovLyoqKioqKioqKkNvbnNvbGUgbG9nIGNoYXRzCgkJCWlmICghaXNHcm91cCAmJiBpc0NtZCkgY29uc29sZS5sb2coICd8JywgY29sb3IoY29tbWFuZCksICdceDFiWzE7MzJtPicsIHRpbWUsIGNvbG9yKGNvbW1hbmQpLCAnZnJvbScsIGNvbG9yKHB1c2huYW1lKSwgJ2FyZ3MgOicsIChhcmdzLmxlbmd0aCkpCgkJCQovLyoqKioqKioqKkNvbnNvbGUgbG9nIGdydXBvcwoJCQlpZiAoaXNDbWQgJiYgaXNHcm91cCkgY29uc29sZS5sb2coJ3wnLCBjb2xvcihjb21tYW5kKSwnXHgxYlsxOzMybT4nLCB0aW1lLCBjb2xvcihjb21tYW5kKSwgJ2Zyb20nLCAoZ3JvdXBOYW1lKSwgJ2FyZ3MgOicsIGNvbG9yKGFyZ3MubGVuZ3RoKSkKCgkJCgoJCQlmdW5jdGlvbiBhZGRNZXRhZGF0YShwYWNrbmFtZSkgewkKCQkJCWlmICghcGFja25hbWUpIHBhY2tuYW1lID0gJ1dBQm90JzsJCgkJCQlsZXQgbmFtZSA9IGAke3BhY2tuYW1lfWAKCQkJCWlmIChmcy5leGlzdHNTeW5jKGAuL3NyYy9zdGlja2Vycy8ke25hbWV9LmV4aWZgKSkgcmV0dXJuIGAuL3NyYy9zdGlja2Vycy8ke25hbWV9LmV4aWZgCgkJCQljb25zdCBqc29uID0gewkKCQkJCQkic3RpY2tlci1wYWNrLW5hbWUiOiBwYWNrbmFtZSwKCQkJCX0KCQkJCWNvbnN0IGxpdHRsZUVuZGlhbiA9IEJ1ZmZlci5mcm9tKFsweDQ5LCAweDQ5LCAweDJBLCAweDAwLCAweDA4LCAweDAwLCAweDAwLCAweDAwLCAweDAxLCAweDAwLCAweDQxLCAweDU3LCAweDA3LCAweDAwXSkJCgkJCQljb25zdCBieXRlcyA9IFsweDAwLCAweDAwLCAweDE2LCAweDAwLCAweDAwLCAweDAwXQkKCgkJCQlsZXQgbGVuID0gSlNPTi5zdHJpbmdpZnkoanNvbikubGVuZ3RoCQoJCQkJbGV0IGxhc3QJCgoJCQkJaWYgKGxlbiA+IDI1NikgewkKCQkJCQlsZW4gPSBsZW4gLSAyNTYJCgkJCQkJYnl0ZXMudW5zaGlmdCgweDAxKQkKCQkJCX0gZWxzZSB7CQoJCQkJCWJ5dGVzLnVuc2hpZnQoMHgwMCkJCgkJCQl9CQoKCQkJCWlmIChsZW4gPCAxNikgewkKCQkJCQlsYXN0ID0gbGVuLnRvU3RyaW5nKDE2KQkKCQkJCQlsYXN0ID0gIjAiICsgbGVuCQoJCQkJfSBlbHNlIHsJCgkJCQkJbGFzdCA9IGxlbi50b1N0cmluZygxNikJCgkJCQl9CQoKCQkJCWNvbnN0IGJ1ZjIgPSBCdWZmZXIuZnJvbShsYXN0LCAiaGV4IikJCgkJCQljb25zdCBidWYzID0gQnVmZmVyLmZyb20oYnl0ZXMpCQoJCQkJY29uc3QgYnVmNCA9IEJ1ZmZlci5mcm9tKEpTT04uc3RyaW5naWZ5KGpzb24pKQkKCgkJCQljb25zdCBidWZmZXIgPSBCdWZmZXIuY29uY2F0KFtsaXR0bGVFbmRpYW4sIGJ1ZjIsIGJ1ZjMsIGJ1ZjRdKQkKCgkJCQlmcy53cml0ZUZpbGUoYC4vc3JjL3N0aWNrZXJzLyR7bmFtZX0uZXhpZmAsIGJ1ZmZlciwgKGVycikgPT4gewkKCQkJCQlyZXR1cm4gYC4vc3JjL3N0aWNrZXJzLyR7bmFtZX0uZXhpZmAJCgkJCQl9KQkKCgkJCX0KCQkJCgkJCgppZihidWR5Lm1hdGNoKCdib3QnKSAmJiAhYm90TnVtYmVyKXsKcm0gPSBbCnJlc3VsdCA9IGZzLnJlYWRGaWxlU3luYyhgLi90ZW1wL1NhbXUud2VicGApCl0KbmsgPSBybVtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBybS5sZW5ndGgpXQogIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgbmssIHN0aWNrZXIsIHsKcXVvdGVkOiBmaW1nLCAiZm9yd2FyZGluZ1Njb3JlIjogOTk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZQogIH0pCn0KCQkKCQkKCQkKc3dpdGNoKGlzKSB7CiAgY2FzZSAnYnVlbm9zJzoKYnVmID0gZnMucmVhZEZpbGVTeW5jKGAuL3RlbXAvYXVkaW8vd2VuYXMubXAzYCkKc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBidWYsIGF1ZGlvLCB7CiAgbWltZXR5cGU6ICdhdWRpby9tcDQnLCBxdW90ZWQ6IGZsaXZlTG9jLCBkdXJhdGlvbiA6LTk5OTk5OTk5OTk5OTk5OSwgcHR0OiB0cnVlCn0pCn0KCnN3aXRjaChpcykgewogIGNhc2UgJ3Rlc3QnOgpidWYgPSBmcy5yZWFkRmlsZVN5bmMoYC4vdGVtcC9hdWRpby9vbmkubXAzYCkKc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCnJlcGx5KGBIb2xhICoke3B1c2huYW1lfSosIGFxdWkgYW5kYW1vcywgbWkgdmVsb2NpZGFkIGRlIHJlc3B1ZXRhIGVzIGRlOiBfJHtwcm9jZXNzLnVwdGltZSgpfV8gbWlsaXNlZ3VuZG9zYCkKc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBidWYsIGF1ZGlvLCB7CiAgbWltZXR5cGU6ICdhdWRpby9tcDQnLCBxdW90ZWQ6IGZsaXZlTG9jLCBkdXJhdGlvbiA6OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OSwgcHR0OiB0cnVlCn0pIApicmVhawp9CQkKCQkJCgkJc3dpdGNoIChjb21tYW5kKSB7CgkJCQkKCQkJCQoJCQkJCmNhc2UgJ2hlbHAnOgpjYXNlICdtZW51JzoKCmNvbnN0IG1vbWVudCA9IHJlcXVpcmUoJ21vbWVudC10aW1lem9uZScpCgpjb25zdCBqbW4gPSBtb21lbnQudHooJ0FzaWEvSmFrYXJ0YScpLmZvcm1hdCgnSEg6bW06c3MnKQoKbGV0IGQgPSBuZXcgRGF0ZQoJCQkJbGV0IGxvY2FsZSA9ICdpZCcKCQkJCQlsZXQgZ210ID0gbmV3IERhdGUoMCkuZ2V0VGltZSgpIC0gbmV3IERhdGUoJzEgSmFudWFyaSAyMDIxJykuZ2V0VGltZSgpCgkJCQkJbGV0IHdldG9uID0gWydQYWhpbmcnLCAnUG9uJywnV2FnZScsJ0tsaXdvbicsJ0xlZ2knXVtNYXRoLmZsb29yKCgoZCAqIDEpICsgZ210KSAvIDg0NjAwMDAwKSAlIDVdCgkJCQkJbGV0IHdlZWsgPSBkLnRvTG9jYWxlRGF0ZVN0cmluZyhsb2NhbGUsIHsgd2Vla2RheTogJ2xvbmcnIH0pCgkJCQkJbGV0IGNhbGVuZGVyID0gZC50b0xvY2FsZURhdGVTdHJpbmcobG9jYWxlLCB7CgkJCQlkYXk6ICdudW1lcmljJywKCQkJCW1vbnRoOiAnbG9uZycsCgkJCQl5ZWFyOiAnbnVtZXJpYycKCQkJCX0pCgkJCQkKCQkJCXZhciBudW0gPSBzYW0ucGFydGljaXBhbnQKCQkJCWZvdG8gPSBmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL2hlbHAuanBnJykKCQkJCWZha2VlID0gZnMucmVhZEZpbGVTeW5jKCcuL3NyYy9mYWtlLmpwZycpCgkJCQkKICBzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLnJlY29yZGluZykKICBpZiAoIWlzUmVnaXN0ZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkuZGFmdGFyQikKICB1cHRpbWUgPSBwcm9jZXNzLnVwdGltZSgpCgkJCQoJCQkJbWVudSA9IGDinqvhgLztoLXtupzht6TtoLXtuorNo+2gte26ls2r7aC17bqe7aC07bmE7aCb7b6U7aCb7b6U7aCb7b2Z7aC97biILmxpIE/ihLHhu4tjzrnJkWwubGkK7aC97bSQSG9sYSAqJHtwdXNobmFtZX0qIApIb3JhOiAke2ptbn0KRmVjaGE6ICR7Y2FsZW5kZXJ9CtmM2J4ke3NhbXV9IFsgJHtwcmVmaXh9IF0gIFByZWZpam86JHtzYW11feKcj++4jwrZjNieJHtzYW11fSBUaWVtcG8gZGUgYWN0aXZpZGFkOiR7c2FtdX0gKiR7a3l1bih1cHRpbWUpfSrtoL3ttZAK2YzYniR7c2FtdX0gTW9kbzoke3NhbXV9ICpPTirinIUK2YzYniR7c2FtdX0gR3J1cG86JHtzYW11fSAqJHtncm91cE5hbWV9Ku2gve2xpQrZjNieJHtzYW11fSBOw7ptZXJvIGRlIGdydXBvczoke3NhbXV9ICoke19yZWdpc3RlcmVkLmxlbmd0aH0q4pqhCtmM2J4ke3NhbXV9IE7Dum1lcm8gZGUgY2hhdHM6JHtzYW11fSAqJHt0b3RhbGNoYXQubGVuZ3RofSrtoL3ttKUK2YzYniR7c2FtdX0gTnVtZXJvIGRlbCBEdWXDsW8gd2EubWUvKzUyOTk4NDkwNzc5NCR7c2FtdX3toLztv4YKCu2gte23oO2gte23rCDtoLXtt5btoLXtt5TtoLXtt6HtoLXtt5TtoLXtt58g7aC17beX7aC17beYIO2gte23rO2gte23ou2gte23qO2gte23p+2gte23qC7toLXtt5XtoLXtt5g6IGh0dHBzOi8veW91dHUuYmUvY2hNYzU3Z2pta0kKCuKNoyAqQk9UIElORk8qIOKNowoKJHtzYW11feKXpiDtoLztvJBOYXZlZ2Fkb3IgOiR7c2FtdX0gKiR7c2FtdTMzMC5icm93c2VyRGVzY3JpcHRpb25bMV19Kgoke3NhbXV94pemIO2gve2zoXNlcnZpZG9yIDoke3NhbXV9ICoke3NhbXUzMzAuYnJvd3NlckRlc2NyaXB0aW9uWzBdfSoKJHtzYW11feKXpiDinIV2ZXJzaW9uIDoke3NhbXV9ICoke3NhbXUzMzAuYnJvd3NlckRlc2NyaXB0aW9uWzJdfSoKJHtzYW11feKXpiDtoL3tuoRWZWxvY2lkYWQgOiR7c2FtdX0gKiR7cHJvY2Vzcy51cHRpbWUoKX0qCiR7c2FtdX3il6Yg7aC97bOyU2lzdGVtYSBvcGVyYXRpdm8gOiR7c2FtdX0gKiR7c2FtdTMzMC51c2VyLnBob25lLmRldmljZV9tYW51ZmFjdHVyZXJ9Kgoke3NhbXV94pemIO2gvu26gHZlcnNpb24gZGUke3NhbXV9ICpXaGF0c0FwcCogOiAqJHtzYW11MzMwLnVzZXIucGhvbmUud2FfdmVyc2lvbn0qCl9MaXN0YSBkZSBNRU5Vc18KJHtib2R5TX0gJHtwcmVmaXh9bWVudTEgKihNZW51IGRlIE1lZGlhKgoke2JvZHlNfSAke3ByZWZpeH1tZW51MiAqKE1lbnUgZGUgU3RpY2tlcikqCiR7Ym9keU19ICR7cHJlZml4fW1lbnUzICooTWVudSBkZSBHcnVwb3MpKgoke2JvZHlNfSAke3ByZWZpeH1tZW51NCAqKE1lbnUgZGUgZGVzY2FyZ2FzKSoKJHtib2R5TX0gJHtwcmVmaXh9bWVudTUgKihPdHJvcyBjb21hbmRvcykqCiR7Ym9keU19ICR7cHJlZml4fW1lbnU2ICooQ29tYW5kb3MgKzE4KSogCiR7Ym9keU19ICR7cHJlZml4fW1lbnU3ICooQ29tYW5kb3MgZGUgbG9nb3MpKiAK4bS44bWDIOG1kOG1g8q44bWSyrPhtqbMgeG1gyDhtYjhtYkgy6HhtZLLoiDhtpzhtZLhtZDhtYPigb/htYjhtZLLoiDhtqDhtZjigb/htpzhtqbhtZLigb/htYPigb8g4bWDy6EgwrnigbDigbAK4bSxy6LhtpzKs+G2puG1h+G1iSDLoeG1ksuiIOG2nOG1kuG1kOG1g+KBv+G1iOG1ksuiIOG1ieKBvyDLouG1mCDhtqDhtZLKs+G1kOG1g+G1l+G1kiDhtpzhtZLKs8qz4bWJ4bac4bWX4bWSIOG1luG1g8qz4bWDIOGRq+G1mOG1iSDigb/htZIg4bWI4bWJIOG1icqzyrPhtZLKs+G1icuiCsui4bamIOG1l+G2puG1ieKBv+G1icuiIOG1g8uh4bWN4bWYzIHigb8g4bWWyrPhtZLhtYfLoeG1ieG1kOG1gyDhtZIg4bWDy6HhtY3htZjigb/htYMg4bag4bWY4oG/4bac4bam4bWSzIHigb8g4bWI4bWJy6Eg4bWH4bWS4bWXIOG1iOG1icqy4bWSIOG1iOG1iSDhtqDhtZjigb/htpzhtqbhtZLigb/htYPKsyDKsOG1g8yB4ba74bWQ4bWJy6HhtZIgy6LhtYPhtYfhtYnKsyDhtYMg4bWQ4bamzKMu4bWCyrDhtYPhtZfLouG0rOG1luG1li5saQogICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCjo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6OjogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKwqY6CsKmOiAgICAgICAgIC4gOiDtoL3tsKztoLXtsI3toLXtsLLtoLXtsJrtoLXtsKftoLXtsIHtoLXtsKjtoLXtsK3toL3tsKwgOiAuCsKmOiAgICAg7aC97bSl4p2j77iP7aC17bem7aC17beu7aC17be6IO2gte24hiDtoLXtt6PtoLXtt7LtoLXtt7/toLXtt7/toLXtuIbinaPvuI/toL3ttKUKOjo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6OgoqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzCgkJICAgICDtoLztvLggU2Ft4buLUGVycnkubGkg7aC87by4CgkgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKYApzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGZvdG8sIGltYWdlLCB7IHF1b3RlZDogZnRva28sIGNhcHRpb246IG1lbnUsIHRodW1ibmFpbDogZmFrZWUsIGNvbnRleHRJbmZvOiB7ImZvcndhcmRpbmdTY29yZSI6IDk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZX19KQpicmVhawoJCmNhc2UgJ21lbnUxJzoKCXNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UucmVjb3JkaW5nKQogIGlmICghaXNSZWdpc3RlcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5kYWZ0YXJCKQogIHVwdGltZSA9IHByb2Nlc3MudXB0aW1lKCkKY29uc3QgTWVudW0gPSB7CnRleHQ6IGDinqvhgLztoLXtupzht6TtoLXtuorNo+2gte26ls2r7aC17bqe7aC07bmE7aCb7b6U7aCb7b6U7aCb7b2ZLmxpIE/ihLHhu4tjzrnJkWwubGkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCu2gve20kEhvbGEgKiR7cHVzaG5hbWV9KiAK4o2jICpCT1QgSU5GTyog4o2jCipVU0E6ICR7cHJlZml4fXBpbmcqIG8gKnRlc3QqClBhcmEgc2FiZXIgeSB2ZXJpZmljYXIgc2kgZWwgYm90IGVzdGEgYWN0aXZvLgoqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzCgkgICAgICDtoLztvLggU2Ft4buLUGVycnkubGkg7aC87by4CiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgoke2JvZHlNfSAke3ByZWZpeH1pbWFnZW4gKihCdXNjYSBpbWFnZW5lcyBkZSBwaW50ZXJlc3QpKgoke2JvZHlNfSAke3ByZWZpeH1hbmltZQoke2JvZHlNfSAke3ByZWZpeH1nb29nbGUKJHtib2R5TX0gJHtwcmVmaXh9ZG9uYWxkdHJ1bXAKJHtib2R5TX0gJHtwcmVmaXh9cXVlYW5pbWUKJHtib2R5TX0gJHtwcmVmaXh9dXJsMmltZwoke2JvZHlNfSAke3ByZWZpeH10b3VybCAqKEV0aXF1ZXRhIHVuYSBpbWFnZW4pKgoke2JvZHlNfSAke3ByZWZpeH1nZXRwaWMgQHBhcnRpY2lwYW50ZQoke2JvZHlNfSAke3ByZWZpeH1zcyBfKExpbmspXyAqKENhcHR1cmEgZGUgcGFudGFsbGEgZGUgdW4gbGluaykqCiR7Ym9keU19ICR7cHJlZml4fXdwCiR7Ym9keU19ICR7cHJlZml4fXdwc2VhcmNoIF8oQnVzY2EgZm9uZG9zIGRlIHBhbnRhbGxhKV8KJHtib2R5TX0gJHtwcmVmaXh9bG9saQoke2JvZHlNfSAke3ByZWZpeH1uZWtvCiR7Ym9keU19ICR7cHJlZml4fWRvcmtpbmcKJHtib2R5TX0gJHtwcmVmaXh9dHdpdAoke2JvZHlNfSAke3ByZWZpeH1jeWJlcnB1bmsKJHtib2R5TX0gJHtwcmVmaXh9bGV0cmEgKihMZXRyYSBkZSB1bmEgY2FuY2lvbikqCiR7Ym9keU19ICR7cHJlZml4fWFjb3JkZXMgKihBY29yZGVzIGRlIHVuYSBjYW5jaW9uKSoKYCwKCWNvbnRleHRJbmZvOiB7CiAgbWVudGlvbmVkSmlkOiBbc2VuZGVyXSwgImZvcndhcmRpbmdTY29yZSI6IDk5OTksICJpc0ZvcndhcmRlZCI6IHRydWUKfQogIH0KICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIE1lbnVtLCB0ZXh0LCB7CgkgIHF1b3RlZDogZnRva299KSAgICAgICAgICAgICAgCiAgYnJlYWsKCmNhc2UgJ21lbnUyJzoKICAgc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCiAgaWYgKCFpc1JlZ2lzdGVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmRhZnRhckIpCiAgdXB0aW1lID0gcHJvY2Vzcy51cHRpbWUoKQpjb25zdCBNZW51cyA9IHsKdGV4dDogYOKeq+GAvO2gte26nOG3pO2gte26is2j7aC17bqWzavtoLXtup7toLTtuYTtoJvtvpTtoJvtvpTtoJvtvZkubGkgT+KEseG7i2POucmRbC5saSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK7aC97bSQSG9sYSAqJHtwdXNobmFtZX0qCirMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMKCSAgICAg7aC87by4IFNhbeG7i1BlcnJ5LmxpIO2gvO28uAogKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKJHtib2R5TX0gJHtwcmVmaXh9c3RpY2tlciAqKEltYWdlbiwgdmlkZW8gbyBnaWYpKgoke2JvZHlNfSAke3ByZWZpeH1zdGlja2VyIG5vYmcgKihFdGlxdWV0YSB1bmEgZm90byBwYXJhIGNyZWFyIHVuIHN0aWNrZXIgc2luIGZvbmRvKSoKJHtib2R5TX0gJHtwcmVmaXh9YXV0b3N0aWNrCiR7Ym9keU19ICR7cHJlZml4fWNpcmNsZQoke2JvZHlNfSAke3ByZWZpeH10b2ltZwoke2JvZHlNfSAke3ByZWZpeH1hdHRwCiR7Ym9keU19ICR7cHJlZml4fXR0cCAKJHtib2R5TX0gJHtwcmVmaXh9ZW1vamkKJHtib2R5TX0gJHtwcmVmaXh9dGFrZXN0aWNrCmAsCgljb250ZXh0SW5mbzogewogIG1lbnRpb25lZEppZDogW3NlbmRlcl0sICJmb3J3YXJkaW5nU2NvcmUiOiA5OTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlCn0KICB9CiAgc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBNZW51cywgdGV4dCwgewpxdW90ZWQ6IGZ2aWR9KSAgICAgICAgICAgICAgCiAgYnJlYWsKY2FzZSAnbWVudTMnOgogICBzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKICBpZiAoIWlzUmVnaXN0ZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkuZGFmdGFyQikKICB1cHRpbWUgPSBwcm9jZXNzLnVwdGltZSgpCmNvbnN0IE1lbnVnID0gewp0ZXh0OiBg4p6r4YC87aC17bqc4bek7aC17bqKzaPtoLXtupbNq+2gte26nu2gtO25hO2gm+2+lO2gm+2+lO2gm+29mS5saSBP4oSx4buLY865yZFsLmxpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIArtoL3ttJBIb2xhICoke3B1c2huYW1lfSoK4o2jICpCT1QgSU5GTyog4o2jCiR7c2FtdX3il6Yg7aC87byQTmF2ZWdhZG9yIDoke3NhbXV9ICoke3NhbXUzMzAuYnJvd3NlckRlc2NyaXB0aW9uWzFdfSoKJHtzYW11feKXpiDtoL3ts6FzZXJ2aWRvciA6JHtzYW11fSAqJHtzYW11MzMwLmJyb3dzZXJEZXNjcmlwdGlvblswXX0qCiR7c2FtdX3il6Yg4pyFdmVyc2lvbiA6JHtzYW11fSAqJHtzYW11MzMwLmJyb3dzZXJEZXNjcmlwdGlvblsyXX0qCiR7c2FtdX3il6Yg7aC97bqEVmVsb2NpZGFkIDoke3NhbXV9ICoke3Byb2Nlc3MudXB0aW1lKCl9Kgoke3NhbXV94pemIO2gve2zslNpc3RlbWEgb3BlcmF0aXZvIDoke3NhbXV9ICoke3NhbXUzMzAudXNlci5waG9uZS5kZXZpY2VfbWFudWZhY3R1cmVyfSoKJHtzYW11feKXpiDtoL7tuoB2ZXJzaW9uIGRlJHtzYW11fSAqV2hhdHNBcHAqIDogKiR7c2FtdTMzMC51c2VyLnBob25lLndhX3ZlcnNpb259Kgoke2JvZHlNfSAke3NhbXV9JHtwcmVmaXh9YW50aWxpbmske3NhbXV9CiR7Ym9keU19ICR7c2FtdX0ke3ByZWZpeH1hbnRpbWVkaWEke3NhbXV9CiR7Ym9keU19ICR7c2FtdX0ke3ByZWZpeH1hbnRpYmFkJHtzYW11fQoke2JvZHlNfSAke3NhbXV9JHtwcmVmaXh9YXV0b3N0JHtzYW11fQoke2JvZHlNfSAke3NhbXV9JHtwcmVmaXh9YW50aWRlbGV0ZSR7c2FtdX0KJHtib2R5TX0gJHtwcmVmaXh9KzE4IDEvMAoKKlBhcmEgcXVlIGVsIGJvdCBlbnRyZSBhIHR1IGdydXBvLCB1c2EgZWwgc2lndWllbnRlIGNvbWFuZG86KgoJJHtwcmVmaXh9ZW50cmFib3QgKihMaW5rIGRlbCBncnVwbykqCgoke2JvZHlNfSAke3ByZWZpeH1hYnJpcgoke2JvZHlNfSAke3ByZWZpeH1jZXJyYXIKJHtib2R5TX0gJHtwcmVmaXh9bGVhdmUKJHtib2R5TX0gJHtwcmVmaXh9dGFnc3RpY2sKJHtib2R5TX0gJHtwcmVmaXh9aGlkZXRhZwoke2JvZHlNfSAke3ByZWZpeH1hbGwKJHtib2R5TX0gJHtwcmVmaXh9c2V0ZGVzYwoke2JvZHlNfSAke3ByZWZpeH1zZXRuYW1lCiR7Ym9keU19ICR7cHJlZml4fWFkbWlubGlzdAoke2JvZHlNfSAke3ByZWZpeH1zZXRwaWMKJHtib2R5TX0gJHtwcmVmaXh9ZW5saW5lYQoke2JvZHlNfSAke3ByZWZpeH1wcm9tb3RlCiR7Ym9keU19ICR7cHJlZml4fWRlbW90ZQoke2JvZHlNfSAke3ByZWZpeH1lbGltaW5hcgoke2JvZHlNfSAke3ByZWZpeH1hw7FhZGlyICooTnVtZXJvIHNpbiBlbCArKSoKJHtib2R5TX0gJHtwcmVmaXh9bm90aWYKJHtib2R5TX0gJHtwcmVmaXh9cmVwbHkgQG1pZW1icm98ZnJhc2V8ZnJhc2UKJHtib2R5TX0gJHtwcmVmaXh9bGluawpgLAoJY29udGV4dEluZm86IHsKICBtZW50aW9uZWRKaWQ6IFtzZW5kZXJdLCAiZm9yd2FyZGluZ1Njb3JlIjogOTk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZQp9CiAgfQogIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgTWVudWcsIHRleHQsIHsKcXVvdGVkOiB7IGtleTogeyBmcm9tTWU6IGZhbHNlLCBwYXJ0aWNpcGFudDogYDBAcy53aGF0c2FwcC5uZXRgLCAuLi4oZnJvbSA/IHsgcmVtb3RlSmlkOiAic3RhdHVzQGJyb2FkY2FzdCIgfSA6IHt9KSB9LCBtZXNzYWdlOiB7ICJpbWFnZU1lc3NhZ2UiOiB7ICJtaW1ldHlwZSI6ICJpbWFnZS9qcGVnIiwgImNhcHRpb24iOiAi4p6r7aC17bG07aC17bKG7aC17bKP7aC17bKWIO2gte2xq+2gte2yhiDtoLXtsa7toLXtspPtoLXtspbtoLXtspHtoLXtspDtoLXtspRcbuKdo++4j+KDnu2gve20pe2gte25juqvre2gte25ls2g7aC17bmi6q+tIO2gte25lCDqr63toLXtuYvqr63toLXtuZrtoLXtuaftoLXtuafqr63toLXtua7toL3ttKXinaPvuI8iICwianBlZ1RodW1ibmFpbCI6IGZzLnJlYWRGaWxlU3luYyhgLi9OeWFuQm90LmpwZ2ApfX19fSkgICAgICAgICAgICAgIAogIGJyZWFrCmNhc2UgJ21lbnU0JzoKICAgc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCiAgaWYgKCFpc1JlZ2lzdGVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmRhZnRhckIpCiAgdXB0aW1lID0gcHJvY2Vzcy51cHRpbWUoKQpjb25zdCBNZW51ZCA9IHsKdGV4dDogYOKeq+GAvO2gte26nOG3pO2gte26is2j7aC17bqWzavtoLXtup7toLTtuYTtoJvtvpTtoJvtvpTtoJvtvZkubGkgT+KEseG7i2POucmRbC5saSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK7aC97bSQSG9sYSAqJHtwdXNobmFtZX0qCuKNoyAqQk9UIElORk8qIOKNowoke3NhbXV94pemIO2gvO28kE5hdmVnYWRvciA6JHtzYW11fSAqJHtzYW11MzMwLmJyb3dzZXJEZXNjcmlwdGlvblsxXX0qCiR7c2FtdX3il6Yg7aC97bOhc2Vydmlkb3IgOiR7c2FtdX0gKiR7c2FtdTMzMC5icm93c2VyRGVzY3JpcHRpb25bMF19Kgoke3NhbXV94pemIOKchXZlcnNpb24gOiR7c2FtdX0gKiR7c2FtdTMzMC5icm93c2VyRGVzY3JpcHRpb25bMl19Kgoke3NhbXV94pemIO2gve26hFZlbG9jaWRhZCA6JHtzYW11fSAqJHtwcm9jZXNzLnVwdGltZSgpfSoKJHtzYW11feKXpiDtoL3ts7JTaXN0ZW1hIG9wZXJhdGl2byA6JHtzYW11fSAqJHtzYW11MzMwLnVzZXIucGhvbmUuZGV2aWNlX21hbnVmYWN0dXJlcn0qCiR7c2FtdX3il6Yg7aC+7bqAdmVyc2lvbiBkZSR7c2FtdX0gKldoYXRzQXBwKiA6ICoke3NhbXUzMzAudXNlci5waG9uZS53YV92ZXJzaW9ufSoKJHtib2R5TX0gJHtwcmVmaXh9cGxheSAqKERlc2NhcmdhIGRlIGF1ZGlvcyBlbiBub3RhIGRlIHZveikqCiR7Ym9keU19ICR7cHJlZml4fXBsYXkyICooRGVzY2FyZ2EgZGUgYXVkaW9zIGVuIG1wMykqCiR7Ym9keU19ICR7cHJlZml4fXBsYXl2aWQgKihEZXNjYXJnYSBkZSB2aWRlb3MgcG9yIG5vbWJyZSkqCiR7Ym9keU19ICR7cHJlZml4fWlnICooRm90b3MgeSB2aWRlb3MgZGUgSW5zdGFncmFtKSoKJHtib2R5TX0gJHtwcmVmaXh9eXRtcDMKJHtib2R5TX0gJHtwcmVmaXh9eXRtcDQKJHtib2R5TX0gJHtwcmVmaXh9bWZpcmUgKihMaW5rIGRlIG1lZGlhZmlyZSkqCiR7Ym9keU19ICR7cHJlZml4fXRvbXAzICooVmlkZW9zIGEgYXVkaW8pKgpgLAoJY29udGV4dEluZm86IHsKICBtZW50aW9uZWRKaWQ6IFtzZW5kZXJdLCAiZm9yd2FyZGluZ1Njb3JlIjogOTk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZQp9CiAgfQogIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgTWVudWQsIHRleHQsIHsKcXVvdGVkOiAgZnZpZH0pICAgICAgICAgICAgICAKICBicmVhawpjYXNlICdtZW51NSc6CiAgIHNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQogIGlmICghaXNSZWdpc3RlcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5kYWZ0YXJCKQogIHVwdGltZSA9IHByb2Nlc3MudXB0aW1lKCkKY29uc3QgTWVudW8gPSB7CnRleHQ6IGDinqvhgLztoLXtupzht6TtoLXtuorNo+2gte26ls2r7aC17bqe7aC07bmE7aCb7b6U7aCb7b6U7aCb7b2ZLmxpIE/ihLHhu4tjzrnJkWwubGkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCu2gve20kEhvbGEgKiR7cHVzaG5hbWV9KiAKKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMswoJICAgICAg7aC87by4IFNhbeG7i1BlcnJ5LmxpIO2gvO28uAogKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKJHtib2R5TX0gJHtwcmVmaXh9dm96ICooQ29kaWdvIGRlIGlkaW9tYSkqICooVGV4dG8pKiBfUGFyYSB2ZXIgaWRpb21hcyBjb21wYXRpYmxlcywgdXNhIGVsIGNvbWFuZG9fICppZGlvbWFzKgoke2JvZHlNfSAke3ByZWZpeH1ibG9jawoke2JvZHlNfSAke3ByZWZpeH10cmFuc2xhdGUgKihpZGlvbWEgYSB0cmFkdWNpciA9IGVzLCBlbiwgaWQuLi4pKgoke2JvZHlNfSAke3ByZWZpeH1zZXRpbWcKJHtib2R5TX0gJHtwcmVmaXh9c2V0aW1nbWVudQoke2JvZHlNfSAke3ByZWZpeH10aWt0b2tzdGFsayBAdXN1YXJpbwoke2JvZHlNfSAke3ByZWZpeH1oaWRldGFnICooVGV4dG8pKgoke2JvZHlNfSAke3ByZWZpeH1jYyAqKFRhcmpldGFzIGRlIGNyw6lkaXRvKSoKJHtib2R5TX0gJHtwcmVmaXh9PiAqKEVqZWN1dGEgY29tYW5kb3MgZW4gbGEgdGVybWluYWwpKgoke2JvZHlNfSAke3ByZWZpeH0kICooRWplY3V0YSBjb21hbmRvcyBlbiBsYSB0ZXJtaW5hbCkqIAoke2JvZHlNfSAke3ByZWZpeH1jYW1iaWFyICooQ2FtYmlhIGVsIGN1ZXJwbyBkZWwgbWVuw7opKgoke2JvZHlNfSAke3ByZWZpeH10cmlnZ2VyICooRXRpcXVldGEgdW4gYXVkaW8pKgoke2JvZHlNfSAke3ByZWZpeH1zbG93ICooRXRpcXVldGEgdW4gYXVkaW8pKgoke2JvZHlNfSAke3ByZWZpeH1pbXV0ICooRXRpcXVldGEgdW4gYXVkaW8pKgoke2JvZHlNfSAke3ByZWZpeH1ob2RlICooRXRpcXVldGEgdW4gYXVkaW8pKgoke2JvZHlNfSAke3ByZWZpeH1iYXNzICooRXRpcXVldGEgdW4gYXVkaW8pKgoke2JvZHlNfSAke3ByZWZpeH1hcmRpbGxhICooRXRpcXVldGEgdW4gYXVkaW8pKgoke2JvZHlNfSAke3ByZWZpeH1ncmF2ZSAqKEV0aXF1ZXRhIHVuIGF1ZGlvKSoKJHtib2R5TX0gJHtwcmVmaXh9YXJ0aQoke2JvZHlNfSAke3ByZWZpeH1zaG9ydGxpbmsgXyhBY29ydGFkb3IgZGUgbGlua3MpCiR7Ym9keU19ICR7cHJlZml4fXF1b3RlCiR7Ym9keU19ICR7cHJlZml4fXBhc3RlYmluICooZ2VuZXJhIGxpbmsgaGFjaWEgZWwgdGV4dG8gbyBsaW5rIHF1ZSBlc2NyaWJhcykqCiR7Ym9keU19ICR7cHJlZml4fWFiaW5hcmlvICoodGV4dG8gYSBjb2RpZ28gYmluYXJpbykqIDAxMDAxMAoke2JvZHlNfSAke3ByZWZpeH1iaW5hdGV4dCAqKGNvZGlnbyBiaW5hcmlvIGEgdGV4dG8pKgoke2JvZHlNfSAke3ByZWZpeH1hb2N0YWwgKih0ZXh0byBhIGNvZGlnbyBvY3RhbCkqCiR7Ym9keU19ICR7cHJlZml4fW9jdGFsYXRleHQgKihjb2RpZ28gb2N0YWwgYSB0ZXh0bykqCiR7Ym9keU19ICR7cHJlZml4fWFoZXggKih0ZXh0byBhIGNvZGlnbyBoZXgpKgoke2JvZHlNfSAke3ByZWZpeH1oZXhhdGV4dCAqKGNvZGlnbyBoZXggYSB0ZXh0bykqCiR7Ym9keU19ICR7cHJlZml4fXJhdGUgX2ZyYXNlIEBtaWVtYnJvXwoke2JvZHlNfSAke3ByZWZpeH13YS5tZQoke2JvZHlNfSAke3ByZWZpeH1pZGlvaW1hcwoke2JvZHlNfSAke3ByZWZpeH1wYWlzZXMKJHtib2R5TX0gJHtwcmVmaXh9cmV2ZXJzYQoke2JvZHlNfSAke3ByZWZpeH12ZXJkYWQKJHtib2R5TX0gJHtwcmVmaXh9bWVtZQoke2JvZHlNfSAke3ByZWZpeH1yZWFkbW9yZSBfZnJhc2UvZnJhc2VfCiR7Ym9keU19ICR7cHJlZml4fW1hcGEKJHtib2R5TX0gJHtwcmVmaXh9c295eW8KJHtib2R5TX0gJHtwcmVmaXh9YmxvY2tsaXN0CiR7Ym9keU19ICR7cHJlZml4fWxlZXJpbWFnZW4KYCwKCWNvbnRleHRJbmZvOiB7CiAgbWVudGlvbmVkSmlkOiBbc2VuZGVyXSwgImZvcndhcmRpbmdTY29yZSI6IDk5OTksICJpc0ZvcndhcmRlZCI6IHRydWUKfQogIH0KICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIE1lbnVvLCB0ZXh0LCB7CgkgIHF1b3RlZDogZmxvY30pICAgICAgICAgICAgICAKICBicmVhawogY2FzZSAnbWVudTYnOgogICBzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKICBpZiAoIWlzUmVnaXN0ZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkuZGFmdGFyQikKICBpZiAoIWlzR3JvdXApIHJldHVybiByZXBseShtZXNzLm9ubHkuZ3JvdXApCiAgaWYgKCFpc05zZncpIHJldHVybiByZXBseShtZXNzLm5zZncpCiAgdXB0aW1lID0gcHJvY2Vzcy51cHRpbWUoKQpjb25zdCBNZW51MTggPSB7CnRleHQ6IGDinqvhgLztoLXtupzht6TtoLXtuorNo+2gte26ls2r7aC17bqe7aC07bmE7aCb7b6U7aCb7b6U7aCb7b2ZLmxpIE/ihLHhu4tjzrnJkWwubGkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCu2gve20kEhvbGEgKiR7cHVzaG5hbWV9KgoqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzCgkgICAgIO2gvO28uCBTYW3hu4tQZXJyeS5saSDtoLztvLgKICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiR7Ym9keU19ICR7cHJlZml4fXBvcm5vCiR7Ym9keU19ICR7cHJlZml4fWxlc2JpYW4gCiR7Ym9keU19ICR7cHJlZml4fXRldGFzCiR7Ym9keU19ICR7cHJlZml4fWFzcwoke2JvZHlNfSAke3ByZWZpeH1wdXNzeQoke2JvZHlNfSAke3ByZWZpeH14bnh4CiR7Ym9keU19ICR7cHJlZml4fXhueHhzZWFyY2gKYCwKCWNvbnRleHRJbmZvOiB7CiAgbWVudGlvbmVkSmlkOiBbc2VuZGVyXSwgImZvcndhcmRpbmdTY29yZSI6IDk5OTksICJpc0ZvcndhcmRlZCI6IHRydWUKfQogIH0KICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIE1lbnUxOCwgdGV4dCwgewpxdW90ZWQ6IGZ2aWR9KSAgICAgICAgICAgICAgCiAgYnJlYWsKCQkJCQpjYXNlICdtZW51Nyc6CiAgIHNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQogIGlmICghaXNSZWdpc3RlcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5kYWZ0YXJCKQogIHVwdGltZSA9IHByb2Nlc3MudXB0aW1lKCkKY29uc3QgTWVudTcgPSB7CnRleHQ6IGDinqvhgLztoLXtupzht6TtoLXtuorNo+2gte26ls2r7aC17bqe7aC07bmE7aCb7b6U7aCb7b6U7aCb7b2ZLmxpIE/ihLHhu4tjzrnJkWwubGkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCu2gve20kEhvbGEgKiR7cHVzaG5hbWV9KgoqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzCgkgICAgIO2gvO28uCBTYW3hu4tQZXJyeS5saSDtoLztvLgKICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgoke2JvZHlNfSAke3ByZWZpeH1ibGFja3BpbmsgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fW5lb24gKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWdyZWVubmVvbiAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9YWR2YW5jZWdsb3cgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWZ1dHVyZW5lb24gKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fXNhbmR3cml0aW5nICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1zYW5kc3VtbWVyICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1zYW5kZW5ncmF2ZWQgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fW1ldGFsZGFyayAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9bmVvbmxpZ2h0ICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1ob2xvZ3JhcGhpYyAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9dGV4dDE5MTcgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fW1pbmlvbiAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9ZGVsdXhlc2lsdmVyICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1uZXd5ZWFyY2FyZCAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9Ymxvb2Rmcm9zdGVkICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1oYWxsb3dlZW4gKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWpva2VybG9nbyAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9ZmlyZXdvcmtzcGFya2xlICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1uYXR1cmVsZWF2ZXMgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWJva2VoICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH10b3hpYyAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9c3RyYXdiZXJyeSAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9Ym94M2QgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fXJvYWR3YXJuaW5nICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1icmVha3dhbGwgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWljZWNvbGQgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWx1eHVyeSAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9Y2xvdWQgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fXN1bW1lcnNhbmQgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWhvcnJvcmJsb29kICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH10aHVuZGVyICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1wb3JuaHViICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1nbGl0Y2ggKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWF2ZW5nZXIgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fXNwYWNlICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1uaW5qYWxvZ28gKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fW1hcnZlbHN0dWRpbyAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9bGlvbmxvZ28gKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fXdvbGZsb2dvICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1zdGVlbDNkICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH13YWxsZ3Jhdml0eSAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9c29tYnJhICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1jdXAgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWN1cDEgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fXJvbWFuY2UgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fXNtb2tlICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1idXJucGFwZXIgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWxvdmVtZXNzYWdlICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH11bmRlcmdyYXNzICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1sb3ZlICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1jYWZlICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH13b29kaGVhcnQgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fXdvb2RlbmJvYXJkICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1zdW1tZXIzZCAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9d29sZm1ldGFsICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1uYXR1cmUzZCAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9dW5kZXJ3YXRlciAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9Z29sZGVycm9zZSAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9c3VtbWVybmF0dXJlICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1sZXR0ZXJsZWF2ZXMgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWdsb3dpbmduZW9uICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1mYWxsbGVhdmVzICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1mbGFtbWluZyAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9aHAgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWNhcnZlZHdvb2QgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fXRpa3RvayAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9YXJjYWRlOGJpdCAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9YmF0dGxlZmllbGQ0ICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1wdWJnICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH13ZXRnbGFzcyAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9bXVsdGljb2xvcjNkICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH13YXRlcmNvbG9yICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1sdXh1cnlnb2xkICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1nYWxheHl3YWxscGFwZXIgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWxpZ2h0dGV4dCAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9YmVhdXRpZnVsZmxvd2VyICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1wdXBweWN1dGUgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fXJveWFsdGV4dCAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9aGVhcnRzaGFwZWQgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWJpcnRoZGF5Y2FrZSAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9Z2FsYXh5c3R5bGUgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWhvbG9ncmFtM2QgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWdyZWVubmVvbiAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9Z2xvc3N5Y2hyb21lICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1ncmVlbmJ1c2ggKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fW1ldGFsbG9nbyAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9bm9lbHRleHQgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWdsaXR0ZXJnb2xkICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH10ZXh0Y2FrZSAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9c3RhcnNuaWdodCAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9d29vZGVuM2QgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fXRleHRieW5hbWUgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fXdyaXRlZ2FsYWN5ICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1nYWxheHliYXQgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fXNub3czZCAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9YmlydGhkYXlkYXkgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWdvbGRwbGF5YnV0dG9uICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1zaWx2ZXJwbGF5YnV0dG9uICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1mcmVlZmlyZSAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoqCiR7Ym9keU19ICR7cHJlZml4fWd0YXYgKihFdGlxdWV0YSB1bmEgaW1hZ2VuKSoKJHtib2R5TX0gJHtwcmVmaXh9d2FudGVkICooRXRpcXVldGEgdW5hIGltYWdlbikqCiR7Ym9keU19ICR7cHJlZml4fXdhc3RlZCAqKEV0aXF1ZXRhIHVuYSBpbWFnZW4pKgoke2JvZHlNfSAke3ByZWZpeH1vY2VhbiAqKEV0aXF1ZXRhIHVuYSBpbWFnZW4pKgoke2JvZHlNfSAke3ByZWZpeH1nZXIgKihFdGlxdWV0YSB1bmEgaW1hZ2VuKSoKJHtib2R5TX0gJHtwcmVmaXh9ZHJhd2luZyAqKEV0aXF1ZXRhIHVuYSBpbWFnZW4pKgoke2JvZHlNfSAke3ByZWZpeH1jZyAqKEV0aXF1ZXRhIHVuYSBpbWFnZW4pKgoKYCwKCWNvbnRleHRJbmZvOiB7CiAgbWVudGlvbmVkSmlkOiBbc2VuZGVyXSwgImZvcndhcmRpbmdTY29yZSI6IDk5OTksICJpc0ZvcndhcmRlZCI6IHRydWUKfQogIH0KICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIE1lbnU3LCB0ZXh0LCB7CnF1b3RlZDogZnZpZH0pICAgICAgICAgICAgICAKICBicmVhawoJCQkJCgkJCQkKLy9lbmNvZGUgeSBkZWNvZGUgYnkgU2FtdQpjYXNlICdjb2RlJzoKdGV4dG8gPSBhcmdzLmpvaW4oJyAnKQp2YXIgcmF3U3RyID0gYCR7dGV4dG99YAp2YXIgd29yZEFycmF5ID0gQ3J5cHRvSlMuZW5jLlV0ZjgucGFyc2UocmF3U3RyKTsKdmFyIGJhc2U2NCA9IENyeXB0b0pTLmVuYy5CYXNlNjQuc3RyaW5naWZ5KHdvcmRBcnJheSk7CnJlcGx5KGAke2Jhc2U2NH1gKQpicmVhawoKY2FzZSAnZGVjb2RlJzoKdGV4dG8gPSBhcmdzLmpvaW4oJyAnKQp2YXIgcGFyc2VXb3JkQXJyYXkgPSBDcnlwdG9KUy5lbmMuQmFzZTY0LnBhcnNlKGAke3RleHRvfWApOwp2YXIgcGFyc2VkU3RyID0gcGFyc2VXb3JkQXJyYXkudG9TdHJpbmcoQ3J5cHRvSlMuZW5jLlV0ZjgpOwoJcmVwbHkoYCR7cGFyc2VkU3RyfWApCgkJYnJlYWsKCgoKCmNhc2UgJ2xvbGknOgppZiAoIWlzUmVnaXN0ZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkuZGFmdGFyQikKCnNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQp1ayA9IFsiYW5pbWUgbG9saSJdCm5rID0gdWtbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdWsubGVuZ3RoKV0KdHJ5IHsKZGF0YSA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkuZmRjaS5zZS9zb3NtZWQvcmVwLnBocD9nYW1iYXI9JHtua31gLCB7CiAgbWV0aG9kOiAnZ2V0Jwp9KQpyZXBseShtZXNzLndhaXQpCm4gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGRhdGEpKTsKbmltZWsgPSBuW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIG4ubGVuZ3RoKV07CnBvayA9IGF3YWl0IGdldEJ1ZmZlcihuaW1laykKc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBwb2ssIGltYWdlLCB7CiAgcXVvdGVkOiBzYW0sIGNhcHRpb246IGDimJVgLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfQp9KQoKfSBjYXRjaCB7CiAgcmVwbHkobWVzcy5mZXJyKQp9CmJyZWFrCQoJCmNhc2UgJ21lbWUnOgogIHNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQogIGlmICghaXNSZWdpc3RlcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5kYWZ0YXJCKQoKdHJ5IHsKICBiZWggPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vbWVtZS1hcGkuaGVyb2t1YXBwLmNvbS9naW1tZS9tZW1lc21leGljb2ApCiAgcGludCA9IGF3YWl0IGdldEJ1ZmZlcihgJHtiZWgudXJsfWApCiAgcmVwbHkobWVzcy53YWl0KQogIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgcGludCwgaW1hZ2UsIHsKCSAgcXVvdGVkOiBmZG9jLCBjYXB0aW9uOiBgJHtiZWgudGl0bGV9YCwgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZX0KICB9KQogIAp9IGNhdGNoIHsKICByZXBseShtZXNzLmZlcnIpCn0KICBicmVhawoJCQkJCgkJCQkKY2FzZSAnbWFwYSc6CiAgaWYgKCFpc1JlZ2lzdGVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmRhZnRhckIpCiAgCiAgaWYgKGFyZ3MubGVuZ3RoIDwgMSkgcmV0dXJuIHJlcGx5KCdJbmdyZXNhIGVsIG5vbWJyZSBkZWwgw6FyZWEnKQogIGRhZXJhaCA9IGJvZHkuc2xpY2UoNSkKICB0cnkgewogIGRhdGEgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vbW5henJpYS5oZXJva3VhcHAuY29tL2FwaS9tYXBzP3NlYXJjaD0ke2RhZXJhaH1gKQogIHJlcGx5KG1lc3Mud2FpdCkKICBoYXNpbCA9IGF3YWl0IGdldEJ1ZmZlcihkYXRhLmdhbWJhcikKICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGhhc2lsLCBpbWFnZSwgewpxdW90ZWQ6IHNhbSwgY2FwdGlvbjogYFJlc3VsdGFkbyAqJHtkYWVyYWh9aSpgLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfQogIH0pCiAgCiAgfSBjYXRjaCB7CiAgICByZXBseShtZXNzLmZlcnIpCiAgfQogIGJyZWFrCgkJCQoJCQkKY2FzZSAnd2EubWUnOgpjYXNlICd3YW1lJzoKICBzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKICBvcHRpb25zID0gewp0ZXh0OiBgTGluayBXaGF0c0FwcDogKndhLm1lLyR7c2VuZGVyLnNwbGl0KCJAcy53aGF0c2FwcC5uZXQiKVswXX0qXG4qT3IgKCAvICkqXG4qYXBpLndoYXRzYXBwLmNvbS9zZW5kP3Bob25lPSR7c2VuZGVyLnNwbGl0KCJAIilbMF19KmAsCmNvbnRleHRJbmZvOiB7CiAgbWVudGlvbmVkSmlkOiBbc2VuZGVyXSwgImZvcndhcmRpbmdTY29yZSI6IDk5OTksICJpc0ZvcndhcmRlZCI6IHRydWUKfQogIH0KICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIG9wdGlvbnMsIHRleHQsIHsKcXVvdGVkOiBzYW0KICB9KQogIGJyZWFrCgkJCQkKY2FzZSAndmVyZGFkJzoKY29uc3QgdHRydGggPSB0cnV0W01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRydXQubGVuZ3RoKV0Kc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBg4oCjICpWZXJkYWQqXG4ke3R0cnRofWAsIHRleHQsIHsKICBxdW90ZWQ6IHNhbQp9KQpicmVhawoKCi8vKioqKioqKioqCiAgY2FzZSAnbm90aWYnOgoKaWYgKCFpc0dyb3VwQWRtaW5zKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmFkbWluKQpzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKaWYgKCFpc1JlZ2lzdGVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmRhZnRhckIpCmlmICghaXNHcm91cCkgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5ncm91cCkKdGVrcyA9IGBOb3RpZmljYWNpw7NuIGRhZGEgcG9yIEAke3NlbmRlci5zcGxpdCgiQCIpWzBdfVxuKk1lbnNhamUgOiAke2JvZHkuc2xpY2UoNyl9KmAKZ3JvdXAgPSBhd2FpdCBzYW11MzMwLmdyb3VwTWV0YWRhdGEoZnJvbSk7Cm1lbWJlciA9IGdyb3VwWydwYXJ0aWNpcGFudHMnXQpqaWRzID0gW107Cm1lbWJlci5tYXAoYXN5bmMgYWRtID0+IHsKICBqaWRzLnB1c2goYWRtLmlkLnJlcGxhY2UoJ2MudXMnLCAncy53aGF0c2FwcC5uZXQnKSk7Cn0pCm9wdGlvbnMgPSB7CiAgdGV4dDogdGVrcywKICBjb250ZXh0SW5mbzogewptZW50aW9uZWRKaWQ6IGppZHMsICJmb3J3YXJkaW5nU2NvcmUiOiA5OTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlCiAgfSwKICBxdW90ZWQ6IHNhbQp9CmF3YWl0IHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgb3B0aW9ucywgdGV4dCkKYnJlYWsKCQkKY2FzZSAncmVhZG1vcmUnOgpzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKaWYgKCFpc1JlZ2lzdGVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmRhZnRhckIpCgppZiAoYXJncy5sZW5ndGggPCAxKSByZXR1cm4gcmVwbHkoYEVzY3JpYmUgZWwgdGV4dG9cbkVqZW1wbG8gOiAke3ByZWZpeH1yZWFkbW9yZSB0ZSBhbW8vcmRpZG8gdW4gcGVycm8/YCkKdGVscyA9IGJvZHkuc2xpY2UoOSkKdmFyIHRla3MxID0gdGVscy5zcGxpdCgiLyIpWzBdOwp2YXIgdGVrczIgPSB0ZWxzLnNwbGl0KCIvIilbMV07Cmhhc2lsID0gYCR7dGVrczF9zY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PJHt0ZWtzMn1gCnNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgaGFzaWwsIHRleHQsIHsKICBxdW90ZWQ6IHNhbQp9KQpicmVhawoJCQkJCmNhc2UgJ3NldHBpYyc6CgppZiAoIWlzR3JvdXApIHJldHVybiByZXBseShtZXNzLm9ubHkuZ3JvdXApCmlmICghaXNSZWdpc3RlcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5kYWZ0YXJCKQppZiAoIWlzR3JvdXBBZG1pbnMpIHJldHVybiByZXBseShtZXNzLm9ubHkuYWRtaW4pCmlmICghaXNCb3RHcm91cEFkbWlucykgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5CYWRtaW4pCmNvbnN0IGVuY21lZGlhID0gaXNRdW90ZWRJbWFnZSA/IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywgJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvOiBzYW0KcmVwbHkobWVzcy53YWl0KQpjb25zdCBtZWRpYSA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRBbmRTYXZlTWVkaWFNZXNzYWdlKGVuY21lZGlhKQphd2FpdCBzYW11MzMwLnVwZGF0ZVByb2ZpbGVQaWN0dXJlIChmcm9tLCBtZWRpYSkKcmVwbHkoJ1NlIGNhbWJpbyBsYSBmb3RvIGRlbCBncnVwbycpCmJyZWFrCgkKCQkJCmNhc2UgJ3JlZyc6CmlmIChpc1JlZ2lzdGVyKSByZXR1cm4gcmVwbHkoJ1R1IGN1ZW50YSB5YSBlc3RhYmEgdmVyaWZpY2FkYScpCmNvbnN0IG5hbWFVc2VyID0gYCR7cHVzaG5hbWV9YApjb25zdCB1bXVyVXNlciA9IGAke3NlbmRlcn1gCmNvbnN0IHNlcmlhbFVzZXIgPSBjcmVhdGVTZXJpYWwoMjApCnZlcmkgPSBzZW5kZXIKaWYgKGlzR3JvdXApIHsKICBhZGRSZWdpc3RlcmVkVXNlcihzZW5kZXIsIG5hbWFVc2VyLCB1bXVyVXNlciwgdGltZSwgc2VyaWFsVXNlcikKICBoYXNpbCA9IGDjgJggICpWZXJpY2FjacOzbiog44CZCkPDs2RpZ28gOiAqJHtzZXJpYWxVc2VyfSoK4pemICpOb21icmUqIDogKiR7bmFtYVVzZXJ9Kgril6YgKk7Dum1lcm8qIDogKiR7c2VuZGVyLnNwbGl0KCJAIilbMF19KgpgCnJlcGx5KGhhc2lsKQogIGNvbnNvbGUubG9nKGNvbG9yKCdbUkVHSVNURVJdJyksIGNvbG9yKHRpbWUsICd5ZWxsb3cnKSwgJ05hbWU6JywgY29sb3IobmFtYVVzZXIsICdjeWFuJyksICdBZ2U6JywgY29sb3IodW11clVzZXIsICdjeWFuJyksICdTZXJpYWw6JywgY29sb3Ioc2VyaWFsVXNlciwgJ2N5YW4nKSwgJ2luJywgY29sb3Ioc2VuZGVyIHx8IGdyb3VwTmFtZSkpCn0gZWxzZSB7CiAgYWRkUmVnaXN0ZXJlZFVzZXIoc2VuZGVyLCBuYW1hVXNlciwgdW11clVzZXIsIHRpbWUsIHNlcmlhbFVzZXIpCiAgaGFzaWwgPSBg44CYICAqVmVyaWZpY2FjacOzbiog44CZCkPDs2RpZ28gOiAqJHtzZXJpYWxVc2VyfSoK4pemICpOb21icmUqIDogKiR7bmFtYVVzZXJ9Kgril6YgKk7Dum1lcm8qIDogKiR7c2VuZGVyLnNwbGl0KCJAIilbMF19KgpgCnJlcGx5KGhhc2lsKQogIGNvbnNvbGUubG9nKGNvbG9yKCdbUkVHSVNURVJdJyksIGNvbG9yKHRpbWUsICd5ZWxsb3cnKSwgJ05hbWU6JywgY29sb3IobmFtYVVzZXIsICdjeWFuJyksICdBZ2U6JywgY29sb3IodW11clVzZXIsICdjeWFuJyksICdTZXJpYWw6JywgY29sb3Ioc2VyaWFsVXNlciwgJ2N5YW4nKSkKfQp0bSA9IGB2ZXJpZmljYWNpw7NuIGNvbXBsZXRhIHVzYSAke3ByZWZpeH1NZW51IHBhcmEgdmVyIGxvcyBjb21hbmRvc2AKcmVwbHkodG0pCmJyZWFrCgkJCgkJCQkKY2FzZSAndG91cmwnOgogaWYgKCFpc1JlZ2lzdGVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LnVzZXJCKQogICAgICAgICAgICB2YXIgaW1nYmIgPSByZXF1aXJlKCdpbWdiYi11cGxvYWRlcicpCiAgICAgICAgICAgaWYgKChpc01lZGlhICYmICFzYW0ubWVzc2FnZS52aWRlb01lc3NhZ2UgfHwgaXNRdW90ZWRJbWFnZSkgJiYgYXJncy5sZW5ndGggPT0gMCkgewogICAgICAgICAgIGdlciA9IGlzUXVvdGVkSW1hZ2UgPyBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkucmVwbGFjZSgncXVvdGVkTScsJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvIDogc2FtCiAgICAgICAgICAgcmVwbHkobWVzcy53YWl0KQogICAgICAgICBvd2dpID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZEFuZFNhdmVNZWRpYU1lc3NhZ2UoZ2VyKQogICAgICAgICAgIGFudSA9IGF3YWl0IGltZ2JiKCcyMGExNDg2MWU0Zjc1OTFmM2RjNTI2NDljYjA3YWUwMicsIG93Z2kpCiAgICAgICAgdGVrcyA9IGAke2FudS5kaXNwbGF5X3VybH1gCnJlcGx5KHRla3MpCn0KYnJlYWsKCQkJCQoJCQkJCgkJCQljYXNlICdwb3Jubyc6CmlmICghaXNHcm91cCkgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5ncm91cCkgICAgICAgICAgCmlmICghaXNOc2Z3KSByZXR1cm4gcmVwbHkobWVzcy5uc2Z3KQpwb3JuID0gYXdhaXQgZmV0Y2hKc29uKCdodHRwczovL21lbWUtYXBpLmhlcm9rdWFwcC5jb20vZ2ltbWUvcG9ybicsIHsKbWV0aG9kOiAnZ2V0JwoJfSkgCnJlcGx5KG1lc3Mud2FpdCkKYnVmZmVyID0gYXdhaXQgZ2V0QnVmZmVyKGAke3Bvcm4udXJsfWApCglzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGJ1ZmZlciwgaW1hZ2UsIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAoJCXF1b3RlZDogZmltZyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKCX0pCiAgYnJlYWsKCQpjYXNlICduZWtvJzoKaWYgKCFpc1JlZ2lzdGVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmRhZnRhckIpCgpzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKdWsgPSBbImFuaW1lIG5la28iXQpuayA9IHVrW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHVrLmxlbmd0aCldCnRyeSB7CmRhdGEgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vYXBpLmZkY2kuc2Uvc29zbWVkL3JlcC5waHA/Z2FtYmFyPSR7bmt9YCwgewogIG1ldGhvZDogJ2dldCcKfSkKcmVwbHkobWVzcy53YWl0KQpuID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkYXRhKSk7Cm5pbWVrID0gbltNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBuLmxlbmd0aCldOwpwb2sgPSBhd2FpdCBnZXRCdWZmZXIobmltZWspCnNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgcG9rLCBpbWFnZSwgewogIHF1b3RlZDogc2FtLCBjYXB0aW9uOiBg4piVYCwgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZX0KfSkKCn0gY2F0Y2ggewogIHJlcGx5KG1lc3MuZmVycikKfQpicmVhawoJCQkJCmNhc2UgJ2xlc2JpYW4nOgppZiAoIWlzR3JvdXApIHJldHVybiByZXBseShtZXNzLm9ubHkuZ3JvdXApICAgICAgICAgICAgICAgCmlmICghaXNOc2Z3KSByZXR1cm4gcmVwbHkobWVzcy5uc2Z3KQpwb3JuID0gYXdhaXQgZmV0Y2hKc29uKCdodHRwczovL21lbWUtYXBpLmhlcm9rdWFwcC5jb20vZ2ltbWUvbGVzYmlhbnMnLCB7Cm1ldGhvZDogJ2dldCcKICAgICAgICB9KSAgICAgICAgICAgICAgICAgICAgCnJlcGx5KG1lc3Mud2FpdCkKYnVmZmVyID0gYXdhaXQgZ2V0QnVmZmVyKGAke3Bvcm4udXJsfWApICAgICAgICAKc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBidWZmZXIsIGltYWdlLCB7CmZpbWd9KQogIGJyZWFrCgkJCQkKY2FzZSAndGV0YXMnOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKaWYgKCFpc0dyb3VwKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5Lmdyb3VwKSAgICAgICAgICAgICAgCmlmICghaXNOc2Z3KSByZXR1cm4gcmVwbHkobWVzcy5uc2Z3KQpwdyA9IFsiaHR0cHM6Ly9tZW1lLWFwaS5oZXJva3VhcHAuY29tL2dpbW1lL3RpdHMiLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiJodHRwczovL21lbWUtYXBpLmhlcm9rdWFwcC5jb20vZ2ltbWUvQmVzdFRpdHMiLAoJImh0dHBzOi8vbWVtZS1hcGkuaGVyb2t1YXBwLmNvbS9naW1tZS9ib29icyIsCgkiaHR0cHM6Ly9tZW1lLWFwaS5oZXJva3VhcHAuY29tL2dpbW1lL2FtYXppbmd0aXRzIiwgICAgICAgICAgICAgICAgICAgIAoJImh0dHBzOi8vbWVtZS1hcGkuaGVyb2t1YXBwLmNvbS9naW1tZS9UaW55VGl0cyJdICAgICAgICAgCm5rID0gcHdbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcHcubGVuZ3RoKV0KcG9ybiA9IGF3YWl0IGZldGNoSnNvbihgJHtua31gLCB7ICAgICAgICAKCW1ldGhvZDogJ2dldCcgICAgICAgICAgICAgICAgICAgCn0pCnJlcGx5KG1lc3Mud2FpdCkKYnVmZmVyID0gYXdhaXQgZ2V0QnVmZmVyKGAke3Bvcm4udXJsfWApICAgICAgICAgICAgICAgIApzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGJ1ZmZlciwgaW1hZ2UsIHsgICAgICAgICAgICAgICAgICAgCglxdW90ZWQ6IGZpbWcgICAgICAgICAgICAgICAKfSkKICBicmVhawoJCmNhc2UgJ2Fzcyc6CmlmICghaXNHcm91cCkgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5ncm91cCkgICAgICAgICAgICAgICAgICAgICAgICAgCmlmICghaXNOc2Z3KSByZXR1cm4gcmVwbHkobWVzcy5uc2Z3KQpwdyA9IFsiaHR0cHM6Ly9tZW1lLWFwaS5oZXJva3VhcHAuY29tL2dpbW1lL0N1dGVMaXR0bGVCdXR0cyIsCiJodHRwczovL21lbWUtYXBpLmhlcm9rdWFwcC5jb20vZ2ltbWUvYXNzIiwgICAgICAgICAgICAgICAgCiJodHRwczovL21lbWUtYXBpLmhlcm9rdWFwcC5jb20vZ2ltbWUvYm9vYnMiLAoiaHR0cHM6Ly9tZW1lLWFwaS5oZXJva3VhcHAuY29tL2dpbW1lL2FzcyJdCm5rID0gcHdbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcHcubGVuZ3RoKV0KcG9ybiA9IGF3YWl0IGZldGNoSnNvbihgJHtua31gLCB7CiAgICAgICAgbWV0aG9kOiAnZ2V0Jwp9KQpyZXBseShtZXNzLndhaXQpCmJ1ZmZlciA9IGF3YWl0IGdldEJ1ZmZlcihgJHtwb3JuLnVybH1gKQpzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGJ1ZmZlciwgaW1hZ2UsIHsKICAgICAgICBxdW90ZWQ6IGZpbWcgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCn0pCiAgYnJlYWsKCQkJCQpjYXNlICdwdXNzeSc6CmlmICghaXNHcm91cCkgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5ncm91cCkgICAgICAgICAgICAgICAgICAgICAKaWYgKCFpc05zZncpIHJldHVybiByZXBseShtZXNzLm5zZncpCnB3ID0gWyJodHRwczovL21lbWUtYXBpLmhlcm9rdWFwcC5jb20vZ2ltbWUvcHVzc3kiLAoiaHR0cHM6Ly9tZW1lLWFwaS5oZXJva3VhcHAuY29tL2dpbW1lL0xlZ2FsVGVlbnMiICAgICAgICAgICAKXQpuayA9IHB3W01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHB3Lmxlbmd0aCldICAgICAgIApwb3JuID0gYXdhaXQgZmV0Y2hKc29uKGAke25rfWAsIHsKICAgICAgICBtZXRob2Q6ICdnZXQnICAgICAgICAgICAgICAgICAgIAp9KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCnJlcGx5KG1lc3Mud2FpdCkKYnVmZmVyID0gYXdhaXQgZ2V0QnVmZmVyKGAke3Bvcm4udXJsfWApCnNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYnVmZmVyLCBpbWFnZSwgewogICAgICAgIHF1b3RlZDogZmltZyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKfSkKICBicmVhawoJCQkJCgkJCQkKCQkJCWNhc2UgJ2NjJzoKCQkJCQl0cnkgewoJCQkJCQlhbnUgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vdmlkZWZpa3JpLmNvbS9hcGkvY2NnZW5lcmF0b3IvYCwgewoJCQkJCQltZXRob2Q6ICdnZXQnCiAJCQkJCQl9KQogIAkJCQkJCXJlcGx5KGAqJHthbnUucmVzdWx0LmNhcmQubmV0d29ya30qXG7toL3tsrMgX051bWVybyBkZSB0YXJqZXRhXyA6ICR7YW51LnJlc3VsdC5jYXJkLm51bWJlcn1cbiMgX0NWVl8gOiAke2FudS5yZXN1bHQuY2FyZC5jdnZ9XG7toL3ts5EgX3Bpbl8gOiAke2FudS5yZXN1bHQuY2FyZC5waW59XG7toL3tsrAgX01vbnRvXyA6ICR7YW51LnJlc3VsdC5jYXJkLmJhbGFuY2V9XG5fTWVzIGRlIHZlbmNpbWllbnRvXyA6ICR7YW51LnJlc3VsdC5jYXJkLmV4cGlyYXRpb25fbW9udGh9XG5fQcOxbyBkZSB2ZW5jaW1pZW50b18gOiAke2FudS5yZXN1bHQuY2FyZC5leHBpcmF0aW9uX3llYXJ9XG5cbipJbmZvcm1hY2lvbiBkZSBsYSB0YXJqZXRhKu2gvu23vlxuXO2gve2xqO2gvO2/u+KAje2gvu22sSBfUHJvcGlldGFyaW9fIDogJHthbnUucmVzdWx0LmN1c3RvbWVyLm5hbWV9XG5f7aC87byNRGlyZWNjaW9uXyA6ICR7YW51LnJlc3VsdC5jdXN0b21lci5hZGRyZXNzfVxuX+2gvO28hkNpdWRhZF8gOiAke2FudS5yZXN1bHQuY3VzdG9tZXIuY291bnRyeX1gKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIHsKICAgIAkJCQkJCXJlcGx5KG1lc3MuZmVycikgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCgkJCQkJCQkJCQkJCQkgICAgfQogIAkJCQkJCWJyZWFrCgkJCQkKCQkJCQoJCQkJY2FzZSAnbnVldm9ncnVwbyc6CgkJCQlub21icmUgPSBhcmdzLmpvaW4oJyAnKQoJCQkJY29uc3QgZ3JvdXAgPSBhd2FpdCBzYW11MzMwLmdyb3VwQ3JlYXRlKGAke25vbWJyZX1gLCBbIjUyMTk5ODQ5MDc3OTRAcy53aGF0c2FwcC5uZXQiXSkKCQkJCXJlcGx5KGAqRUwgR1JVUE8gRlVFIENSRUFETyBDT1JSRUNUQU1FTlRFKlxuaWQgZGVsIGdydXBvOiAke2dyb3VwLmdpZH1gKQoJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShncm91cC5naWQsICJoZWxsbyBldmVyeW9uZSIsIHRleHQsIHtxdW90ZWQ6IGZsaXZlTG9jfSkKCQkJCWJyZWFrCgkJCQkKCQkJCQoJCQkJCgkJCQoKCgkJCQkKCQkJCWNhc2UgJ3N0aWNrZXInOgoJCQljYXNlICdzdGlrZXInOgoJCQljYXNlICdzJzoKCQkJCWlmIChpc01lZGlhICYmICFzYW0ubWVzc2FnZS52aWRlb01lc3NhZ2UgfHwgaXNRdW90ZWRJbWFnZSkgewoJCQkJCWNvbnN0IGVuY21lZGlhID0gaXNRdW90ZWRJbWFnZSA/IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywgJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvIDogc2FtCgkJCQkJY29uc3QgbWVkaWEgPSBhd2FpdCBzYW11MzMwLmRvd25sb2FkQW5kU2F2ZU1lZGlhTWVzc2FnZShlbmNtZWRpYSwgYC4vc3RpY2tlci8ke3NlbmRlcn1gKQoJCQkJCWF3YWl0IGZmbXBlZyhgJHttZWRpYX1gKQoJCQkJCQkJLmlucHV0KG1lZGlhKQoJCQkJCQkJLm9uKCdzdGFydCcsIGZ1bmN0aW9uIChjbWQpIHsKCQkJCQkJCQljb25zb2xlLmxvZyhgU3RhcnRlZCA6ICR7Y21kfWApCgkJCQkJCQl9KQoJCQkJCQkJLm9uKCdlcnJvcicsIGZ1bmN0aW9uIChlcnIpIHsKCQkJCQkJCQljb25zb2xlLmxvZyhgRXJyb3IgOiAke2Vycn1gKQoJCQkJCQkJCWZzLnVubGlua1N5bmMobWVkaWEpCgkJCQkJCQkJcmVwbHkoJ2Vycm9yJykKCQkJCQkJCX0pCgkJCQkJCQkub24oJ2VuZCcsIGZ1bmN0aW9uICgpIHsKCQkJCQkJCQljb25zb2xlLmxvZygnRmluaXNoJykKCQkJCQkJCQlleGVjKGB3ZWJwbXV4IC1zZXQgZXhpZiAuL3N0aWNrZXIvZGF0YS5leGlmIC4vc3RpY2tlci8ke3NlbmRlcn0ud2VicCAtbyAuL3N0aWNrZXIvJHtzZW5kZXJ9LndlYnBgLCBhc3luYyAoZXJyb3IpID0+IHsKCQkJCQkJCQkJaWYgKGVycm9yKSByZXR1cm4gYXF1bC5yZXBseShmcm9tLCBtZXNzLmVycm9yLmFwaSwgcXVsKQoJCQkJCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlZnJvbSwgZnMucmVhZEZpbGVTeW5jKGAuL3N0aWNrZXIvJHtzZW5kZXJ9LndlYnBgLHN0aWNrZXIsIHtxdW90ZWQ6IGZkb2MsIGNvbnRleHRJbmZvOiB7ImZvcndhcmRpbmdTY29yZSI6IDk5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9fSkKCQkJCQkJCQkJZnMudW5saW5rU3luYyhtZWRpYSkJCgkJCQkJCQkJCWZzLnVubGlua1N5bmMoYC4vc3RpY2tlci8ke3NlbmRlcn0ud2VicGApCQoJCQkJCQkJCX0pCgkJCQkJCQl9KQoJCQkJCQkJLmFkZE91dHB1dE9wdGlvbnMoW2AtdmNvZGVjYCxgbGlid2VicGAsYC12ZmAsYHNjYWxlPSdtaW4oMzIwLGl3KSc6bWluJygzMjAsaWgpJzpmb3JjZV9vcmlnaW5hbF9hc3BlY3RfcmF0aW89ZGVjcmVhc2UsZnBzPTE1LCBwYWQ9MzIwOjMyMDotMTotMTpjb2xvcj13aGl0ZUAwLjAsIHNwbGl0IFthXVtiXTsgW2FdIHBhbGV0dGVnZW49cmVzZXJ2ZV90cmFuc3BhcmVudD1vbjp0cmFuc3BhcmVuY3lfY29sb3I9ZmZmZmZmIFtwXTsgW2JdW3BdIHBhbGV0dGV1c2VgXSkKCQkJCQkJCS50b0Zvcm1hdCgnd2VicCcpCgkJCQkJCQkuc2F2ZShgLi9zdGlja2VyLyR7c2VuZGVyfS53ZWJwYCkKCQkJCX0gZWxzZSBpZiAoKGlzTWVkaWEgJiYgc2FtLm1lc3NhZ2UudmlkZW9NZXNzYWdlLmZpbGVMZW5ndGggPCAxMDAwMDAwMCB8fCBpc1F1b3RlZFZpZGVvICYmIHNhbS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8ucXVvdGVkTWVzc2FnZS52aWRlb01lc3NhZ2UuZmlsZUxlbmd0aCA8IDEwMDAwMDAwKSkgewoJCQkJCWNvbnN0IGVuY21lZGlhID0gaXNRdW90ZWRWaWRlbyA/IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywgJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvIDogc2FtCgkJCQkJY29uc3QgbWVkaWEgPSBhd2FpdCBzYW11MzMwLmRvd25sb2FkQW5kU2F2ZU1lZGlhTWVzc2FnZShlbmNtZWRpYSwgYC4vc3RpY2tlci8ke3NlbmRlcn1gKQoJCQkJCXJlcGx5KG1lc3Mud2FpdCkKCQkJCQkJYXdhaXQgZmZtcGVnKGAke21lZGlhfWApCgkJCQkJCQkuaW5wdXRGb3JtYXQobWVkaWEuc3BsaXQoJy4nKVs0XSkKCQkJCQkJCS5vbignc3RhcnQnLCBmdW5jdGlvbiAoY21kKSB7CgkJCQkJCQkJY29uc29sZS5sb2coYFN0YXJ0ZWQgOiAke2NtZH1gKQoJCQkJCQkJfSkKCQkJCQkJCS5vbignZXJyb3InLCBmdW5jdGlvbiAoZXJyKSB7CgkJCQkJCQkJY29uc29sZS5sb2coYEVycm9yIDogJHtlcnJ9YCkKCQkJCQkJCQlmcy51bmxpbmtTeW5jKG1lZGlhKQoJCQkJCQkJCXRpcGUgPSBtZWRpYS5lbmRzV2l0aCgnLm1wNCcpID8gJ3ZpZGVvJyA6ICdnaWYnCgkJCQkJCQkJcmVwbHkoJ2Vycm9yJykKCQkJCQkJCX0pCgkJCQkJCQkub24oJ2VuZCcsIGZ1bmN0aW9uICgpIHsKCQkJCQkJCQljb25zb2xlLmxvZygnRmluaXNoJykKCQkJCQkJCQlleGVjKGB3ZWJwbXV4IC1zZXQgZXhpZiAuL3N0aWNrZXIvZGF0YS5leGlmIC4vc3RpY2tlci8ke3NlbmRlcn0ud2VicCAtbyAuL3N0aWNrZXIvJHtzZW5kZXJ9LndlYnBgLCBhc3luYyAoZXJyb3IpID0+IHsKCQkJCQkJCQkJaWYgKGVycm9yKSByZXR1cm4gcmVwbHkoJ2Vycm9yJykKCQkJCQkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBmcy5yZWFkRmlsZVN5bmMoYC4vc3RpY2tlci8ke3NlbmRlcn0ud2VicGApLCBzdGlja2VyLCB7cXVvdGVkOiBmZG9jLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfX0pCgkJCQkJCQkJCWZzLnVubGlua1N5bmMobWVkaWEpCgkJCQkJCQkJCWZzLnVubGlua1N5bmMoYC4vc3RpY2tlci8ke3NlbmRlcn0ud2VicGApCgkJCQkJCQkJfSkKCQkJCQkJCX0pCgkJCQkJCQkuYWRkT3V0cHV0T3B0aW9ucyhbYC12Y29kZWNgLGBsaWJ3ZWJwYCxgLXZmYCxgc2NhbGU9J21pbigzMjAsaXcpJzptaW4nKDMyMCxpaCknOmZvcmNlX29yaWdpbmFsX2FzcGVjdF9yYXRpbz1kZWNyZWFzZSxmcHM9MTUsIHBhZD0zMjA6MzIwOi0xOi0xOmNvbG9yPXdoaXRlQDAuMCwgc3BsaXQgW2FdW2JdOyBbYV0gcGFsZXR0ZWdlbj1yZXNlcnZlX3RyYW5zcGFyZW50PW9uOnRyYW5zcGFyZW5jeV9jb2xvcj1mZmZmZmYgW3BdOyBbYl1bcF0gcGFsZXR0ZXVzZWBdKQoJCQkJCQkJLnRvRm9ybWF0KCd3ZWJwJykKCQkJCQkJCS5zYXZlKGAuL3N0aWNrZXIvJHtzZW5kZXJ9LndlYnBgKQoJCQkJfSBlbHNlIHsKCQkJCQlyZXBseShgS2lyaW0gZ2FtYmFyL3ZpZGVvIGRlbmdhbiBjYXB0aW9uICR7cHJlZml4fXN0aWNrZXIgYXRhdSB0YWcgZ2FtYmFyL3ZpZGVvIHlhbmcgc3VkYWggZGlraXJpbVxuTm90ZSA6IER1cmFzaSB2aWRlbyBtYXhpbWFsIDEwIGRldGlrYCkKCQkJCX0KCQkJCWJyZWFrCgkJCQkKCQkJCQoJCQkJCgkJCQkKCQkJCQoJCQkJCgkJCQkKCQkJCQoJCQkJCgkJCQljYXNlICdzaW1pJzoKc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCnRleHRvID0gYm9keS5zbGljZSg1KSAgICAgICAgICAgICAgICAgICAgCnNpbSA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkuc2ltc2ltaS5uZXQvdjEvP3RleHQ9JHt0ZXh0b30mbGFuZz1lc2ApCnNtdXUgPSAoYCR7c2ltLnN1Y2Nlc3N9YCkgICAgICAgICAgICAgICAgICAgCnNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgc211dSwgdGV4dCwge3F1b3RlZDogeyBrZXk6IHsgICAgICAgICAgICAgCglmcm9tTWU6IGZhbHNlLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAoJcGFydGljaXBhbnQ6IGAwQHMud2hhdHNhcHAubmV0YCwgLi4uKGZyb20gPyB7IHJlbW90ZUppZDogInN0YXR1c0Bicm9hZGNhc3QiIH0gOiB7fSkgICAgICAgICAKfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiB7ICAgICAgICAgICAKCQkJCQkJCQkicHJvZHVjdE1lc3NhZ2UiOiB7ICAgICAgICAgIAoJCQkJCQkJCQkicHJvZHVjdCI6IHsgICAgICAgICAgICAKCQkJCQkJCQkJCSJwcm9kdWN0SW1hZ2UiOnsgICAgICAgCgkJCQkJCQkJCQkJIm1pbWV0eXBlIjogImltYWdlL2pwZWciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImpwZWdUaHVtYm5haWwiOiBmcy5yZWFkRmlsZVN5bmMoYC4vc3JjL3NpbWkuanBnYCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0aXRsZSI6IGDinqvtoLXtsJLtoLXtsKLtoLXtsKbtoLXtsKztoLXtsKLtoLXtsKbtoLXtsKIgfCDtoLXtsJLtoLXtsJrtoLXtsKYg7aC17bCyIO2gte2wj+2gte2wnu2gte2wq+2gte2wq+2gte2wsu2gve20peKdo++4j3wgJHtwdXNobmFtZX0gYCwgICAgICAgICAgICAgICAgCgkJCQkJCQkJCQkiZGVzY3JpcHRpb24iOiBgJHt0ZXh0b31gLCAgICAKCQkJCQkJCQkJCSJjdXJyZW5jeUNvZGUiOiAnJywKCQkJCQkJCQkJCSJwcmljZUFtb3VudDEwMDAiOiAiOTk5IiwKCQkJCQkJCQkJCSJyZXRhaWxlcklkIjogJ1RPTScsICAKCQkJCQkJCQkJCSJwcm9kdWN0SW1hZ2VDb3VudCI6IDk5OQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiYnVzaW5lc3NPd25lckppZCI6IGA1MjE5OTg0OTA3Nzk0QHMud2hhdHNhcHAubmV0YAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKCQkJCQkgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAoJCQkJICAgICAgfSkKCQkJCWJyZWFrCgkJCQkKCQkJCQoJCQkJCgkJCWNhc2UgJ2hpZGV0YWcxJzoKCQkJY2FzZSAnaGlkZXRhZyc6CgkJCQlpZiAoIWlzR3JvdXApIHJldHVybiByZXBseShtZXNzLm9ubHkuZ3JvdXApCgkJCQkJbWVtYmVyc19pZCA9IFtdCgkJCQkJdGVrcyA9IChhcmdzLmxlbmd0aCA+IDEpID8gYXJncy5qb2luKCcgJykudHJpbSgpIDogYCR7YXJncy5qb2luKCcgJyl9YAoJCQkJCWZvciAobGV0IG1lbSBvZiBncm91cE1lbWJlcnMpIHsKCQkJCQkJbWVtYmVyc19pZC5wdXNoKG1lbS5qaWQpCgkJCQkJfQoJCQkJCW1lbnRpb25zKHRla3MsIG1lbWJlcnNfaWQsIHRydWUsIE1lc3NhZ2VUeXBlLnRleHQpCgkJCQlicmVhawoJCQkKCQkJY2FzZSAnc2V0bmFtZSc6CgkJCQlhd2FpdCBzYW11MzMwLmdyb3VwVXBkYXRlU3ViamVjdChmcm9tLCBgJHthcmdzLmpvaW4oJyAnKX1gKQoJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBgKuOAjCBOT01CUkUgREVMIEdSVVBPIENBTUJJQURPIEE644CNXG4ke2FyZ3Muam9pbignICcpfSpgLCBNZXNzYWdlVHlwZS50ZXh0KQoJCQkJYnJlYWsKCQkJY2FzZSAnc2V0ZGVzYyc6CgkJCQlhd2FpdCBzYW11MzMwLmdyb3VwVXBkYXRlRGVzY3JpcHRpb24oZnJvbSwgYCR7YXJncy5qb2luKCcgJyl9YCkKCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYCrjgIwgREVTQ1JJUENJT04gREVMIEdSVVBPIENBTUJJQURBIEE644CNXG4ke2FyZ3Muam9pbignICcpfSpgLCBNZXNzYWdlVHlwZS50ZXh0KQoJCQkJYnJlYWsKCQkJY2FzZSAndXB0aW1lJzoKCQkJCXJ1bnRpbWUgPSBwcm9jZXNzLnVwdGltZSgpCgkJCQl0ZWtzID0gYCR7a3l1bihydW50aW1lKX1gCgkJCQkKCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYCR7dGVrc31gLCBNZXNzYWdlVHlwZS50ZXh0KQoJCQkJYnJlYWsKCQkJCgkJCWNhc2UgJ2ltYWdlbic6CmlmICghaXNSZWdpc3RlcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5kYWZ0YXJCKQoKaWYgKGFyZ3MubGVuZ3RoIDwgMSkgcmV0dXJuIHJlcGx5KCdJbmdyZXNhIGFsZ28gcGFyYSBidXNjYXIgZW4gaW3DoWdlbmVz7aC97bSQJykKdGVscyA9IGJvZHkuc2xpY2UoOCkKZmFrZWUgPSBmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL2ltZy5qcGcnKQpzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKcmVwbHkobWVzcy53YWl0KQp0cnkgewpkYXRhID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS5mZGNpLnNlL3Nvc21lZC9yZXAucGhwP2dhbWJhcj0ke3RlbHN9YCwgewogIG1ldGhvZDogJ2dldCcKfSkKbiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZGF0YSkpOwpuaW1layA9IG5bTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogbi5sZW5ndGgpXTsKcG9rID0gYXdhaXQgZ2V0QnVmZmVyKG5pbWVrKQpzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIHBvaywgaW1hZ2UsIHsKICBxdW90ZWQ6IGZ0b2tvLCBjYXB0aW9uOiBgRXNwZXJvIHkgdGUgZ3VzdGUgZXN0YSBpbWFnZW4gZGUgKiR7dGVsc30qYCwgdGh1bWJuYWlsOiBmYWtlZSwgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZX0KfSkKCn0gY2F0Y2ggewogIHJlcGx5KG1lc3MuZmVycikKfQpicmVhawoJCQkKY2FzZSAnYW50aWRlbGV0ZSc6CgkJCQljb25zdCBkYXRhUmV2b2tlID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL2djLXJldm9rZWQuanNvbicpKQoJCQkJY29uc3QgZGF0YUN0UmV2b2tlID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL2N0LXJldm9rZWQuanNvbicpKQoJCQkJY29uc3QgZGF0YUJhbkN0UmV2b2tlID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL2N0LXJldm9rZWQtYmFubGlzdC5qc29uJykpCgkJCQljb25zdCBpc1Jldm9rZSA9IGRhdGFSZXZva2UuaW5jbHVkZXMoZnJvbSkKCQkJCWNvbnN0IGlzQ3RSZXZva2UgPSBkYXRhQ3RSZXZva2UuZGF0YQoJCQkJY29uc3QgaXNCYW5DdFJldm9rZSA9IGRhdGFCYW5DdFJldm9rZS5pbmNsdWRlcyhzZW5kZXIpID8gdHJ1ZSA6IGZhbHNlCgkJCQljb25zdCBhcmd6ID0gYm9keS5zcGxpdCgnICcpCgkJCQlpZiAoYXJnei5sZW5ndGggPT09IDEpIHJldHVybiBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGBVc28gZGUgbGEgZnVuY2nDs24gYW50aWRlbGV0ZSA6XG5cbioke3ByZWZpeH1hbnRpZGVsZXRlIFthY3RpdmFyL2Rlc2FjdGl2YXJdKiAoUGFyYSBncnVwb3MpXG4qJHtwcmVmaXh9YW50aWRlbGV0ZSBbMS8wXSogKFBhcmEgUFJJVilcbioke3ByZWZpeH1hbnRpZGVsZXRlIGJhbmN0IDUyMTk5ODR4eHh4eHh4KiAoUGFyYSB1biBudW1lcm8gZW4gZXNwZWNpZmljbylgLCBNZXNzYWdlVHlwZS50ZXh0KQoJCQkJaWYgKGFyZ3pbMV0gPT0gJ2FjdGl2YXInKSB7CgkJCQkJaWYgKGlzR3JvdXApIHsKCQkJCQkJaWYgKGlzUmV2b2tlKSByZXR1cm4gc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBgQW50aWRlbGV0ZSBlc3RhYmEgaGFiaWxpdGFkbyBlbiBlc3RlIGdydXBvIGFudGVzIWAsIE1lc3NhZ2VUeXBlLnRleHQpCgkJCQkJCWRhdGFSZXZva2UucHVzaChmcm9tKQoJCQkJCQlmcy53cml0ZUZpbGVTeW5jKCcuL3NyYy9nYy1yZXZva2VkLmpzb24nLCBKU09OLnN0cmluZ2lmeShkYXRhUmV2b2tlLCBudWxsLCAyKSkKCQkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBgKlN1Y2NlcyBFbmFibGUgQW50aWRlbGV0ZSBHcnVwISpgLCBNZXNzYWdlVHlwZS50ZXh0KQoJCQkJCX0gZWxzZSBpZiAoIWlzR3JvdXApIHsKCQkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBgUGFyYSB1dGlsaXphciBlbiBQUklWOiAqJHtwcmVmaXh9YW50aWRlbGV0ZSAxKmAsIE1lc3NhZ2VUeXBlLnRleHQpCgkJCQkJfQoJCQkJfSBlbHNlIGlmIChhcmd6WzFdID09ICcxJykgewoJCQkJCWlmICghaXNHcm91cCkgewoJCQkJCQlpZiAoaXNDdFJldm9rZSkgcmV0dXJuIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYEFudGlkZWxldGUgc2UgaGEgaGFiaWxpdGFkbyBlbiB0b2RvcyBsb3MgY29udGFjdG9zIWAsIE1lc3NhZ2VUeXBlLnRleHQpCgkJCQkJCWRhdGFDdFJldm9rZS5kYXRhID0gdHJ1ZQoJCQkJCQlmcy53cml0ZUZpbGVTeW5jKCcuL3NyYy9jdC1yZXZva2VkLmpzb24nLCBKU09OLnN0cmluZ2lmeShkYXRhQ3RSZXZva2UsIG51bGwsIDIpKQoJCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGBBbnRpZGVsZXRlIHlhIGVzdGEgYWN0aXZhZG8gZW4gdG9kb3MgbG9zIGNvbnRhY3RvcyFgLCBNZXNzYWdlVHlwZS50ZXh0KQoJCQkJCX0gZWxzZSBpZiAoaXNHcm91cCkgewoJCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGBQYXJhIHVzb2VuIGdydXBvczogKiR7cHJlZml4fWFudGlkZWxldGUgYWN0aXZhcipgLCBNZXNzYWdlVHlwZS50ZXh0KQoJCQkJCX0KCQkJCX0gZWxzZSBpZiAoYXJnelsxXSA9PSAnYmFuY3QnKSB7CgkJCQkJaWYgKGlzQmFuQ3RSZXZva2UpIHJldHVybiBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGBFc3RlIGNvbnRhY3RvIHlhIGVzdMOhIGVuIGxhIGJhc2UgZGUgZGF0b3MgZGUgbGEgbGlzdGEgZGUgcHJvaGliaWNpw7NuLiFgLCBNZXNzYWdlVHlwZS50ZXh0KQoJCQkJCWlmIChhcmd6Lmxlbmd0aCA9PT0gMiB8fCBhcmd6WzJdLnN0YXJ0c1dpdGgoJzAnKSkgcmV0dXJuIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYEluZ3Jlc2UgZWwgbsO6bWVybyBxdWUgY29taWVuemUgc2luIGVsICsuXG5FamVtcGxvIDUyOTk4NHh4eHh4YCwgTWVzc2FnZVR5cGUudGV4dCkKCQkJCQlkYXRhQmFuQ3RSZXZva2UucHVzaChhcmd6WzJdICsgJ0BzLndoYXRzYXBwLm5ldCcpCgkJCQkJZnMud3JpdGVGaWxlU3luYygnLi9zcmMvY3QtcmV2b2tlZC1iYW5saXN0Lmpzb24nLCBKU09OLnN0cmluZ2lmeShkYXRhQmFuQ3RSZXZva2UsIG51bGwsIDIpKQoJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYEtvbnRhayAke2FyZ3pbMl19IHRlbGFoIGRpbWFzdWthbiBrZSBiYW5saXN0IGFudGlkZWxldGUgc2VjYXJhIHBlcm1hbmVuIWAsIE1lc3NhZ2VUeXBlLnRleHQpCgkJCQl9IGVsc2UgaWYgKGFyZ3pbMV0gPT0gJ2Rlc2FjdGl2YXInKSB7CgkJCQkJaWYgKGlzR3JvdXApIHsKCQkJCQkJY29uc3QgaW5kZXggPSBkYXRhUmV2b2tlLmluZGV4T2YoZnJvbSkKCQkJCQkJZGF0YVJldm9rZS5zcGxpY2UoaW5kZXgsIDEpCgkJCQkJCWZzLndyaXRlRmlsZVN5bmMoJy4vc3JjL2djLXJldm9rZWQuanNvbicsIEpTT04uc3RyaW5naWZ5KGRhdGFSZXZva2UsIG51bGwsIDIpKQoJCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGAqU3VjY2VzIGRpc2FibGUgQW50aWRlbGV0ZSBHcnVwISpgLCBNZXNzYWdlVHlwZS50ZXh0KQoJCQkJCX0gZWxzZSBpZiAoIWlzR3JvdXApIHsKCQkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBgUGFyYSB1dGlsaXphciBlbiBQcml2OiAqJHtwcmVmaXh9YW50aWRlbGV0ZSAwKmAsIE1lc3NhZ2VUeXBlLnRleHQpCgkJCQkJfQoJCQkJfSBlbHNlIGlmIChhcmd6WzFdID09ICcwJykgewoJCQkJCWlmICghaXNHcm91cCkgewoJCQkJCQlkYXRhQ3RSZXZva2UuZGF0YSA9IGZhbHNlCgkJCQkJCWZzLndyaXRlRmlsZVN5bmMoJy4vc3JjL2N0LXJldm9rZWQuanNvbicsIEpTT04uc3RyaW5naWZ5KGRhdGFDdFJldm9rZSwgbnVsbCwgMikpCgkJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYEFudGlkZWxldGUgZXN0w6EgZGVzaGFiaWxpdGFkbyBlbiB0b2RvcyBsb3MgY29udGFjdG9zIWAsIE1lc3NhZ2VUeXBlLnRleHQpCgkJCQkJfSBlbHNlIGlmIChpc0dyb3VwKSB7CgkJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYFBhcmEgdXNvIGVuIGdydXBvczogKiR7cHJlZml4fWFudGlkZWxldGUgZGVzYWN0aXZhcipgLCBNZXNzYWdlVHlwZS50ZXh0KQoJCQkJCX0KCQkJCX0KCQkJCWJyZWFrCgkJCWNhc2UgJ2xpbmsnOgoJCQkJaWYgKCFpc0dyb3VwKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5Lmdyb3VwKQoJCQkJY29uc3QgbGlua2djID0gYXdhaXQgc2FtdTMzMC5ncm91cEludml0ZUNvZGUoZnJvbSkKCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYGh0dHBzOi8vY2hhdC53aGF0c2FwcC5jb20vJHtsaW5rZ2N9YCwgdGV4dCwge3F1b3RlZDpmZG9jfSkKCQkJCWJyZWFrCgkJCQkKCQkJCQoJCQkJCgkJY2FzZSAnc2hvcnRsaW5rJzoKCQkgICAgaWYgKCFpc1JlZ2lzdGVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmRhZnRhckIpCgkJICAgIGlmICghaXNVcmwpIHJldHVybiByZXBseSgnUG9yZmF2b3IgZW52aWEgZXNwZWNpZmljYW1lbnRlIHVuIGxpbmsnKQogICAgICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA8MCkgcmV0dXJuIHJlcGx5KGBFamVtcGxvOiAke3ByZWZpeH1zaG9ydGxpbmsgaHR0cHM6Ly9ib25nby5jYXRgKQogICAgICAgICAgICAgICAgICAgIGluaV9saW5rID0gYXJncy5qb2luKCcgJykKICAgICAgICAgICAgICAgICAgICBpbmlfYnVmZmVyID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS5sb2xodW1hbi54eXovYXBpL3Nob3J0bGluaz9hcGlrZXk9JHthcGl9JnVybD0ke2luaV9saW5rfWApCiAgICAgICAgICAgICAgICAgICAgcmVwbHkoaW5pX2J1ZmZlci5yZXN1bHQpCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKCQkJCQoJCQkKCQljYXNlICdzdGFsa2lnJzoKICAgICAgICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPT0gMCkgcmV0dXJuIHJlcGx5KGBFamVtcGxvOiAke3ByZWZpeCArIGNvbW1hbmR9IHNhbXUuMzMwYCkKICAgICAgICAgICAgICAgICAgICB1c2VybmFtZSA9IGFyZ3Muam9pbignICcpCiAgICAgICAgICAgICAgICAgICAgaW5pX3Jlc3VsdCA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkubG9saHVtYW4ueHl6L2FwaS9zdGFsa2lnLyR7dXNlcm5hbWV9P2FwaWtleT0ke2FwaX1gKQogICAgICAgICAgICAgICAgICAgIGluaV9yZXN1bHQgPSBpbmlfcmVzdWx0LnJlc3VsdAogICAgICAgICAgICAgICAgICAgIGluaV9idWZmZXIgPSBhd2FpdCBnZXRCdWZmZXIoaW5pX3Jlc3VsdC5waG90b19wcm9maWxlKQogICAgICAgICAgICAgICAgICAgIGluaV90eHQgPSBgVXNlcm5hbWUgOiAke2luaV9yZXN1bHQudXNlcm5hbWV9XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBgRnVsbCBOYW1lIDogJHtpbmlfcmVzdWx0LmZ1bGxuYW1lfVxuYAogICAgICAgICAgICAgICAgICAgIGluaV90eHQgKz0gYFBvc3RzIDogJHtpbmlfcmVzdWx0LnBvc3RzfVxuYAogICAgICAgICAgICAgICAgICAgIGluaV90eHQgKz0gYEZvbGxvd2VycyA6ICR7aW5pX3Jlc3VsdC5mb2xsb3dlcnN9XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBgRm9sbG93aW5nIDogJHtpbmlfcmVzdWx0LmZvbGxvd2luZ31cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGBCaW8gOiAke2luaV9yZXN1bHQuYmlvfWAKICAgICAgICAgICAgICAgICAgICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGluaV9idWZmZXIsIGltYWdlLCB7IGNhcHRpb246IGluaV90eHQgfSkKICAgICAgICAgICAgICAgICAgICBicmVhawoJCQkJCgkJY2FzZSAnZG9uYWxkdHJ1bXAnOgogICAgICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA9PSAwKSByZXR1cm4gcmVwbHkoYEVqZW1wbG86ICR7cHJlZml4ICsgY29tbWFuZH0gU2FtdTMzMCB5IFBlcnJ5YCkKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ID0gYXJncy5qb2luKCcgJykKICAgICAgICAgICAgICAgICAgICBpbmlfYnVmZmVyID0gYXdhaXQgZ2V0QnVmZmVyKGBodHRwczovL2FwaS5sb2xodW1hbi54eXovYXBpL3R3ZWV0dHJ1bXA/YXBpa2V5PSR7YXBpfSZ0ZXh0PSR7aW5pX3R4dH1gKQogICAgICAgICAgICAgICAgICAgIGF3YWl0IHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgaW5pX2J1ZmZlciwgaW1hZ2UsIHsgcXVvdGVkOiBmdG9rbyB9KQogICAgICAgICAgICAgICAgICAgIGJyZWFrCgkJCQkKCQljYXNlICdlbW9qaSc6CiAgICAgICAgICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID09IDApIHJldHVybiByZXBseShgRWplbXBsbzogJHtwcmVmaXggKyBjb21tYW5kfSDtoL3tuK1gKQogICAgICAgICAgICAgICAgICAgIGVtb2ppID0gYXJnc1swXQogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGVtb2ppID0gZW5jb2RlVVJJQ29tcG9uZW50KGVtb2ppWzBdKQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgICAgICAgICBlbW9qaSA9IGVuY29kZVVSSUNvbXBvbmVudChlbW9qaSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaW5pX2J1ZmZlciA9IGF3YWl0IGdldEJ1ZmZlcihgaHR0cHM6Ly9hcGkubG9saHVtYW4ueHl6L2FwaS9zbW9qaS8ke2Vtb2ppfT9hcGlrZXk9JHthcGl9YCkKICAgICAgICAgICAgICAgICAgICBhd2FpdCBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGluaV9idWZmZXIsIHN0aWNrZXIsIHsgcXVvdGVkOiBmdG9rbyB9KQogICAgICAgICAgICAgICAgICAgIGJyZWFrCgkJCQkKCQljYXNlICd0YWtlc3RpY2snOgogICAgICAgICAgICAgICAgICAgIGlmICgoaXNNZWRpYSAmJiAhc2FtLm1lc3NhZ2UudmlkZW9NZXNzYWdlIHx8IGlzUXVvdGVkU3RpY2tlcikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID09IDApIHJldHVybiByZXBseShgRXhhbXBsZTogJHtwcmVmaXggKyBjb21tYW5kfSBTYW11MzMwfFNhbSB5IFBlcnJ5YCkKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZW5jbWVkaWEgPSBpc1F1b3RlZFN0aWNrZXIgPyBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkucmVwbGFjZSgncXVvdGVkTScsICdtJykpLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mbyA6IHNhbQogICAgICAgICAgICAgICAgICAgICAgICBmaWxlUGF0aCA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRBbmRTYXZlTWVkaWFNZXNzYWdlKGVuY21lZGlhLCBmaWxlbmFtZSA9IGdldFJhbmRvbSgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgZmlsZV9uYW1lID0gZ2V0UmFuZG9tKCIud2VicCIpCiAgICAgICAgICAgICAgICAgICAgICAgIGluaV90eHQgPSBhcmdzLmpvaW4oIiAiKS5zcGxpdCgifCIpCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3QoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBgaHR0cHM6Ly9hcGkubG9saHVtYW4ueHl6L2FwaS9jb252ZXJ0L3Rvd2VicGF1dGhvcj9hcGlrZXk9JHthcGl9YCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybURhdGE6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaW1nIjogZnMuY3JlYXRlUmVhZFN0cmVhbShmaWxlUGF0aCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInBhY2thZ2UiOiBpbmlfdHh0WzBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJhdXRob3IiOiBpbmlfdHh0WzFdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5jb2Rpbmc6ICJiaW5hcnkiCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSwgYm9keSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZnMudW5saW5rU3luYyhmaWxlUGF0aCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZzLndyaXRlRmlsZVN5bmMoZmlsZV9uYW1lLCBib2R5LCAiYmluYXJ5IikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluaV9idWZmID0gZnMucmVhZEZpbGVTeW5jKGZpbGVfbmFtZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgaW5pX2J1ZmYsIHN0aWNrZXIsIHsgcXVvdGVkOiBzYW0gfSkudGhlbigoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnMudW5saW5rU3luYyhmaWxlX25hbWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICByZXBseShgRXRpcXVldGEgdW4gc3Rpa2VyIGNvbiBlbCBjb21hbmRvYCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWsKCQkJCQoJCWNhc2UgJ2JsYWNrcGluayc6CiAgICAgICAgICAgICAgICBjYXNlICduZW9uJzoKICAgICAgICAgICAgICAgIGNhc2UgJ2dyZWVubmVvbic6CiAgICAgICAgICAgICAgICBjYXNlICdhZHZhbmNlZ2xvdyc6CiAgICAgICAgICAgICAgICBjYXNlICdmdXR1cmVuZW9uJzoKICAgICAgICAgICAgICAgIGNhc2UgJ3NhbmR3cml0aW5nJzoKICAgICAgICAgICAgICAgIGNhc2UgJ3NhbmRzdW1tZXInOgogICAgICAgICAgICAgICAgY2FzZSAnc2FuZGVuZ3JhdmVkJzoKICAgICAgICAgICAgICAgIGNhc2UgJ21ldGFsZGFyayc6CiAgICAgICAgICAgICAgICBjYXNlICduZW9ubGlnaHQnOgogICAgICAgICAgICAgICAgY2FzZSAnaG9sb2dyYXBoaWMnOgogICAgICAgICAgICAgICAgY2FzZSAndGV4dDE5MTcnOgogICAgICAgICAgICAgICAgY2FzZSAnbWluaW9uJzoKICAgICAgICAgICAgICAgIGNhc2UgJ2RlbHV4ZXNpbHZlcic6CiAgICAgICAgICAgICAgICBjYXNlICduZXd5ZWFyY2FyZCc6CiAgICAgICAgICAgICAgICBjYXNlICdibG9vZGZyb3N0ZWQnOgogICAgICAgICAgICAgICAgY2FzZSAnaGFsbG93ZWVuJzoKICAgICAgICAgICAgICAgIGNhc2UgJ2pva2VybG9nbyc6CiAgICAgICAgICAgICAgICBjYXNlICdmaXJld29ya3NwYXJrbGUnOgogICAgICAgICAgICAgICAgY2FzZSAnbmF0dXJlbGVhdmVzJzoKICAgICAgICAgICAgICAgIGNhc2UgJ2Jva2VoJzoKICAgICAgICAgICAgICAgIGNhc2UgJ3RveGljJzoKICAgICAgICAgICAgICAgIGNhc2UgJ3N0cmF3YmVycnknOgogICAgICAgICAgICAgICAgY2FzZSAnYm94M2QnOgogICAgICAgICAgICAgICAgY2FzZSAncm9hZHdhcm5pbmcnOgogICAgICAgICAgICAgICAgY2FzZSAnYnJlYWt3YWxsJzoKICAgICAgICAgICAgICAgIGNhc2UgJ2ljZWNvbGQnOgogICAgICAgICAgICAgICAgY2FzZSAnbHV4dXJ5JzoKICAgICAgICAgICAgICAgIGNhc2UgJ2Nsb3VkJzoKICAgICAgICAgICAgICAgIGNhc2UgJ3N1bW1lcnNhbmQnOgogICAgICAgICAgICAgICAgY2FzZSAnaG9ycm9yYmxvb2QnOgogICAgICAgICAgICAgICAgY2FzZSAndGh1bmRlcic6CiAgICAgICAgICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID09IDApIHJldHVybiByZXBseShgRXhhbXBsZTogJHtwcmVmaXggKyBjb21tYW5kfSBTYW11MzMwYCkKCQkgICAgcmVwbHkobWVzcy53YWl0KQogICAgICAgICAgICAgICAgICAgIGluaV90eHQgPSBhcmdzLmpvaW4oIiAiKQogICAgICAgICAgICAgICAgICAgIGdldEJ1ZmZlcihgaHR0cHM6Ly9hcGkubG9saHVtYW4ueHl6L2FwaS90ZXh0cHJvbWUvJHtjb21tYW5kfT9hcGlrZXk9JHthcGl9JnRleHQ9JHtpbmlfdHh0fWApLnRoZW4oKGdhbWJhcikgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGdhbWJhciwgaW1hZ2UsIHsgcXVvdGVkOiBmZ2MgfSkKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBjYXNlICdwb3JuaHViJzoKICAgICAgICAgICAgICAgIGNhc2UgJ2dsaXRjaCc6CiAgICAgICAgICAgICAgICBjYXNlICdhdmVuZ2VyJzoKICAgICAgICAgICAgICAgIGNhc2UgJ3NwYWNlJzoKICAgICAgICAgICAgICAgIGNhc2UgJ25pbmphbG9nbyc6CiAgICAgICAgICAgICAgICBjYXNlICdtYXJ2ZWxzdHVkaW8nOgogICAgICAgICAgICAgICAgY2FzZSAnbGlvbmxvZ28nOgogICAgICAgICAgICAgICAgY2FzZSAnd29sZmxvZ28nOgogICAgICAgICAgICAgICAgY2FzZSAnc3RlZWwzZCc6CiAgICAgICAgICAgICAgICBjYXNlICd3YWxsZ3Jhdml0eSc6CiAgICAgICAgICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID09IDApIHJldHVybiByZXBseShgRXhhbXBsZTogJHtwcmVmaXggKyBjb21tYW5kfSBTYW11MzMwfFNhbSB5IFBlcnJ5YCkKCQkJCXJlcGx5KG1lc3Mud2FpdCkKICAgICAgICAgICAgICAgICAgICBhID0gYXJncy5qb2luKCcgJykKICAgICAgICAgICAgICAgICAgICB0eHQxID0gYS5zcGxpdCgifCIpWzBdOwogICAgICAgICAgICAgICAgICAgIHR4dDIgPSBhLnNwbGl0KCJ8IilbMV07CiAgICAgICAgICAgICAgICAgICAgZ2V0QnVmZmVyKGBodHRwczovL2FwaS5sb2xodW1hbi54eXovYXBpL3RleHRwcm9tZTIvJHtjb21tYW5kfT9hcGlrZXk9JHthcGl9JnRleHQxPSR7dHh0MX0mdGV4dDI9JHt0eHQyfWApLnRoZW4oKGdhbWJhcikgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGdhbWJhciwgaW1hZ2UsIHsgcXVvdGVkOiBsb2wgfSkKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICAgICAgICAgIC8vIFBob3RvIE94eSAvLwogICAgICAgICAgICAgICAgY2FzZSAnc29tYnJhJzoKICAgICAgICAgICAgICAgIGNhc2UgJ2N1cCc6CiAgICAgICAgICAgICAgICBjYXNlICdjdXAxJzoKICAgICAgICAgICAgICAgIGNhc2UgJ3JvbWFuY2UnOgogICAgICAgICAgICAgICAgY2FzZSAnc21va2UnOgogICAgICAgICAgICAgICAgY2FzZSAnYnVybnBhcGVyJzoKICAgICAgICAgICAgICAgIGNhc2UgJ2xvdmVtZXNzYWdlJzoKICAgICAgICAgICAgICAgIGNhc2UgJ3VuZGVyZ3Jhc3MnOgogICAgICAgICAgICAgICAgY2FzZSAnbG92ZSc6CiAgICAgICAgICAgICAgICBjYXNlICdjYWZlJzoKICAgICAgICAgICAgICAgIGNhc2UgJ3dvb2RoZWFydCc6CiAgICAgICAgICAgICAgICBjYXNlICd3b29kZW5ib2FyZCc6CiAgICAgICAgICAgICAgICBjYXNlICdzdW1tZXIzZCc6CiAgICAgICAgICAgICAgICBjYXNlICd3b2xmbWV0YWwnOgogICAgICAgICAgICAgICAgY2FzZSAnbmF0dXJlM2QnOgogICAgICAgICAgICAgICAgY2FzZSAndW5kZXJ3YXRlcic6CiAgICAgICAgICAgICAgICBjYXNlICdnb2xkZXJyb3NlJzoKICAgICAgICAgICAgICAgIGNhc2UgJ3N1bW1lcm5hdHVyZSc6CiAgICAgICAgICAgICAgICBjYXNlICdsZXR0ZXJsZWF2ZXMnOgogICAgICAgICAgICAgICAgY2FzZSAnZ2xvd2luZ25lb24nOgogICAgICAgICAgICAgICAgY2FzZSAnZmFsbGxlYXZlcyc6CiAgICAgICAgICAgICAgICBjYXNlICdmbGFtbWluZyc6CiAgICAgICAgICAgICAgICBjYXNlICdocCc6CiAgICAgICAgICAgICAgICBjYXNlICdjYXJ2ZWR3b29kJzoKICAgICAgICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPT0gMCkgcmV0dXJuIHJlcGx5KGBFeGFtcGxlOiAke3ByZWZpeCArIGNvbW1hbmR9IFNhbXUzMzBgKQoJCQkJcmVwbHkobWVzcy53YWl0KQogICAgICAgICAgICAgICAgICAgIGluaV90eHQgPSBhcmdzLmpvaW4oJyAnKQogICAgICAgICAgICAgICAgICAgIGdldEJ1ZmZlcihgaHR0cHM6Ly9hcGkubG9saHVtYW4ueHl6L2FwaS9waG90b294eTEvJHtjb21tYW5kfT9hcGlrZXk9JHthcGl9JnRleHQ9JHtpbmlfdHh0fWApLnRoZW4oKGdhbWJhcikgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGdhbWJhciwgaW1hZ2UsIHsgcXVvdGVkOiBmZ2MgfSkKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBjYXNlICd0aWt0b2snOgogICAgICAgICAgICAgICAgY2FzZSAnYXJjYWRlOGJpdCc6CiAgICAgICAgICAgICAgICBjYXNlICdiYXR0bGVmaWVsZDQnOgogICAgICAgICAgICAgICAgY2FzZSAncHViZyc6CQkJCQogICAgICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA9PSAwKSByZXR1cm4gcmVwbHkoYEV4YW1wbGU6ICR7cHJlZml4ICsgY29tbWFuZH0gU2FtdTMzMHxTYW0geSBQZXJyeWApCgkJICAgIHJlcGx5KG1lc3Mud2FpKQoJCSAgICBhID0gYXJncy5qb2luKCcgJykKICAgICAgICAgICAgICAgICAgICB0eHQxID0gYS5zcGxpdCgifCIpWzBdOwogICAgICAgICAgICAgICAgICAgIHR4dDIgPSBhLnNwbGl0KCJ8IilbMV07CiAgICAgICAgICAgICAgICAgICAgZ2V0QnVmZmVyKGBodHRwczovL2FwaS5sb2xodW1hbi54eXovYXBpL3Bob3Rvb3h5Mi8ke2NvbW1hbmR9P2FwaWtleT0ke2FwaX0mdGV4dDE9JHt0eHQxfSZ0ZXh0Mj0ke3R4dDJ9YCkudGhlbigoZ2FtYmFyKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgZ2FtYmFyLCBpbWFnZSwgeyBxdW90ZWQ6IGZnYyB9KQogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKCiAgICAgICAgICAgICAgICAgICAgLy8gRXBob3RvIDM2MCAvLwogICAgICAgICAgICAgICAgY2FzZSAnd2V0Z2xhc3MnOgogICAgICAgICAgICAgICAgY2FzZSAnbXVsdGljb2xvcjNkJzoKICAgICAgICAgICAgICAgIGNhc2UgJ3dhdGVyY29sb3InOgogICAgICAgICAgICAgICAgY2FzZSAnbHV4dXJ5Z29sZCc6CiAgICAgICAgICAgICAgICBjYXNlICdnYWxheHl3YWxscGFwZXInOgogICAgICAgICAgICAgICAgY2FzZSAnbGlnaHR0ZXh0JzoKICAgICAgICAgICAgICAgIGNhc2UgJ2JlYXV0aWZ1bGZsb3dlcic6CiAgICAgICAgICAgICAgICBjYXNlICdwdXBweWN1dGUnOgogICAgICAgICAgICAgICAgY2FzZSAncm95YWx0ZXh0JzoKICAgICAgICAgICAgICAgIGNhc2UgJ2hlYXJ0c2hhcGVkJzoKICAgICAgICAgICAgICAgIGNhc2UgJ2JpcnRoZGF5Y2FrZSc6CiAgICAgICAgICAgICAgICBjYXNlICdnYWxheHlzdHlsZSc6CiAgICAgICAgICAgICAgICBjYXNlICdob2xvZ3JhbTNkJzoKICAgICAgICAgICAgICAgIGNhc2UgJ2dyZWVubmVvbic6CiAgICAgICAgICAgICAgICBjYXNlICdnbG9zc3ljaHJvbWUnOgogICAgICAgICAgICAgICAgY2FzZSAnZ3JlZW5idXNoJzoKICAgICAgICAgICAgICAgIGNhc2UgJ21ldGFsbG9nbyc6CiAgICAgICAgICAgICAgICBjYXNlICdub2VsdGV4dCc6CiAgICAgICAgICAgICAgICBjYXNlICdnbGl0dGVyZ29sZCc6CiAgICAgICAgICAgICAgICBjYXNlICd0ZXh0Y2FrZSc6CiAgICAgICAgICAgICAgICBjYXNlICdzdGFyc25pZ2h0JzoKICAgICAgICAgICAgICAgIGNhc2UgJ3dvb2RlbjNkJzoKICAgICAgICAgICAgICAgIGNhc2UgJ3RleHRieW5hbWUnOgogICAgICAgICAgICAgICAgY2FzZSAnd3JpdGVnYWxhY3knOgogICAgICAgICAgICAgICAgY2FzZSAnZ2FsYXh5YmF0JzoKICAgICAgICAgICAgICAgIGNhc2UgJ3Nub3czZCc6CiAgICAgICAgICAgICAgICBjYXNlICdiaXJ0aGRheWRheSc6CiAgICAgICAgICAgICAgICBjYXNlICdnb2xkcGxheWJ1dHRvbic6CiAgICAgICAgICAgICAgICBjYXNlICdzaWx2ZXJwbGF5YnV0dG9uJzoKICAgICAgICAgICAgICAgIGNhc2UgJ2ZyZWVmaXJlJzoKICAgICAgICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPT0gMCkgcmV0dXJuIHJlcGx5KGBFeGFtcGxlOiAke3ByZWZpeCArIGNvbW1hbmR9IFNhbSB5IFBlcnJ5YCkKCQkJCXJlcGx5KG1lc3Mud2FpdCkKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ID0gYXJncy5qb2luKCcgJykKICAgICAgICAgICAgICAgICAgICBnZXRCdWZmZXIoYGh0dHBzOi8vYXBpLmxvbGh1bWFuLnh5ei9hcGkvZXBob3RvMS8ke2NvbW1hbmR9P2FwaWtleT0ke2FwaX0mdGV4dD0ke2luaV90eHR9YCkudGhlbigoZ2FtYmFyKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgZ2FtYmFyLCBpbWFnZSwgeyBxdW90ZWQ6IGZnYyB9KQogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKCQkJCQoJCWNhc2UgJ2dvb2dsZSc6CiAgICAgICAgICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID09IDApIHJldHVybiByZXBseShgRXhhbXBsZTogJHtwcmVmaXggKyBjb21tYW5kfSBHYXRpdG9zYCkKICAgICAgICAgICAgICAgICAgICBxdWVyeSA9IGFyZ3Muam9pbignICcpCiAgICAgICAgICAgICAgICAgICAgZ2V0X3Jlc3VsdCA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkubG9saHVtYW4ueHl6L2FwaS9nc2VhcmNoP2FwaWtleT0ke2FwaX0mcXVlcnk9JHtxdWVyeX1gKQogICAgICAgICAgICAgICAgICAgIGdldF9yZXN1bHQgPSBnZXRfcmVzdWx0LnJlc3VsdAogICAgICAgICAgICAgICAgICAgIGluaV90eHQgPSAnR29vZ2xlIFNlYXJjaCA6IFxuJwogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHggb2YgZ2V0X3Jlc3VsdCkgewogICAgICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDtoL7ttYBUaXRsZSA6ICR7eC50aXRsZX1cbmAKICAgICAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBg7aC97bGB77iP4oCN7aC97beo77iPTGluayA6ICR7eC5saW5rfVxuYAogICAgICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDtoL3tsqxEZXNjIDogJHt4LmRlc2N9XG5cbmAKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmVwbHkoaW5pX3R4dCkKICAgICAgICAgICAgICAgICAgICBicmVhawoJCQkJCgkJY2FzZSAnd3BzZWFyY2gnOgogICAgICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA9PSAwKSByZXR1cm4gcmVwbHkoYEV4YW1wbGU6ICR7cHJlZml4ICsgY29tbWFuZH0gZ2F0b3NgKQogICAgICAgICAgICAgICAgICAgIHF1ZXJ5ID0gYXJncy5qb2luKCcgJykKICAgICAgICAgICAgICAgICAgICBnZXRfcmVzdWx0ID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS5sb2xodW1hbi54eXovYXBpL3dhbGxwYXBlcj9hcGlrZXk9JHthcGl9JnF1ZXJ5PSR7cXVlcnl9YCkKICAgICAgICAgICAgICAgICAgICBpbmlfYnVmZmVyID0gYXdhaXQgZ2V0QnVmZmVyKGdldF9yZXN1bHQucmVzdWx0KQogICAgICAgICAgICAgICAgICAgIGF3YWl0IHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgaW5pX2J1ZmZlciwgaW1hZ2UsIHsgcXVvdGVkOiBmdG9rbyB9KQogICAgICAgICAgICAgICAgICAgIGJyZWFrCgkJCQkKCQljYXNlICd0cmFuc2xhdGUnOgogICAgICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA9PSAwKSByZXR1cm4gcmVwbHkoYEV4YW1wbGU6ICR7cHJlZml4ICsgY29tbWFuZH0gZXMgSGkgYnJvYCkKICAgICAgICAgICAgICAgICAgICBpZGlvbWEgPSBhcmdzWzBdCiAgICAgICAgICAgICAgICAgICAgYXJncy5zaGlmdCgpCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCA9IGFyZ3Muam9pbignICcpCiAgICAgICAgICAgICAgICAgICAgZ2V0X3Jlc3VsdCA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkubG9saHVtYW4ueHl6L2FwaS90cmFuc2xhdGUvYXV0by8ke2lkaW9tYX0/YXBpa2V5PSR7YXBpfSZ0ZXh0PSR7aW5pX3R4dH1gKQogICAgICAgICAgICAgICAgICAgIGdldF9yZXN1bHQgPSBnZXRfcmVzdWx0LnJlc3VsdAogICAgICAgICAgICAgICAgICAgIGluaXRfdHh0ID0gYFRyYWR1Y2Npb24gZGUgOiAke2dldF9yZXN1bHQuZnJvbX1cbmAKICAgICAgICAgICAgICAgICAgICBpbml0X3R4dCArPSBgYSA6ICR7Z2V0X3Jlc3VsdC50b31cbmAKICAgICAgICAgICAgICAgICAgICBpbml0X3R4dCArPSBgT3JpZ2luYWwgOiAke2dldF9yZXN1bHQub3JpZ2luYWx9XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pdF90eHQgKz0gYFRyYWR1Y2lkbyA6ICR7Z2V0X3Jlc3VsdC50cmFuc2xhdGVkfVxuYAogICAgICAgICAgICAgICAgICAgIGluaXRfdHh0ICs9IGBQcm9udW5jaWFjaW9uIDogJHtnZXRfcmVzdWx0LnByb251bmNpYXRpb259XG5gCiAgICAgICAgICAgICAgICAgICAgcmVwbHkoaW5pdF90eHQpCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKCQkJCgkJY2FzZSAnYWNvcmRlcyc6CiAgICAgICAgICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID09IDApIHJldHVybiByZXBseShgRXhhbXBsZTogJHtwcmVmaXggKyBjb21tYW5kfSBDaXJjdWxvIGRlIGFtb3JgKQogICAgICAgICAgICAgICAgICAgIHF1ZXJ5ID0gYXJncy5qb2luKCcgJykKICAgICAgICAgICAgICAgICAgICBnZXRfcmVzdWx0ID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS5sb2xodW1hbi54eXovYXBpL2Nob3JkP2FwaWtleT0ke2FwaX0mcXVlcnk9JHtxdWVyeX1gKQogICAgICAgICAgICAgICAgICAgIGdldF9yZXN1bHQgPSBnZXRfcmVzdWx0LnJlc3VsdAogICAgICAgICAgICAgICAgICAgIGluaV90eHQgPSBgVGl0bGUgOiAke2dldF9yZXN1bHQudGl0bGV9XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBgQ2hvcmQgOiBcbiR7Z2V0X3Jlc3VsdC5jaG9yZH1gCiAgICAgICAgICAgICAgICAgICAgcmVwbHkoaW5pX3R4dCkKICAgICAgICAgICAgICAgICAgICBicmVhawoJCQkJCgkJY2FzZSAneG54eCc6CgkJCQkgIGlmICghaXNOc2Z3KSByZXR1cm4gcmVwbHkobWVzcy5uc2Z3KQogICAgICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA9PSAwKSByZXR1cm4gcmVwbHkoYEV4YW1wbGU6ICR7cHJlZml4ICsgY29tbWFuZH0gaHR0cHM6Ly93d3cueG54eC5jb20vdmlkZW8tdXk1YTczYi9tb21faXNfaG9ybnlfLV9icm9va2x5bmApCiAgICAgICAgICAgICAgICAgICAgcXVlcnkgPSBhcmdzLmpvaW4oJyAnKQogICAgICAgICAgICAgICAgICAgIGdldF9yZXN1bHQgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vYXBpLmxvbGh1bWFuLnh5ei9hcGkveG54eD9hcGlrZXk9JHthcGl9JnVybD0ke3F1ZXJ5fWApCiAgICAgICAgICAgICAgICAgICAgZ2V0X3Jlc3VsdCA9IGdldF9yZXN1bHQucmVzdWx0CiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCA9IGBUaXRsZSA6ICR7Z2V0X3Jlc3VsdC50aXRsZX1cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGBEdXJhdGlvbiA6ICR7Z2V0X3Jlc3VsdC5kdXJhdGlvbn1cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGBWaWV3IDogJHtnZXRfcmVzdWx0LnZpZXd9XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBgUmF0aW5nIDogJHtnZXRfcmVzdWx0LnJhdGluZ31cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGBMaWtlIDogJHtnZXRfcmVzdWx0Lmxpa2V9XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBgRGlzbGlrZSA6ICR7Z2V0X3Jlc3VsdC5kaXNsaWtlfVxuYAogICAgICAgICAgICAgICAgICAgIGluaV90eHQgKz0gYENvbW1lbnQgOiAke2dldF9yZXN1bHQuY29tbWVudH1cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGBUYWcgOiAke2dldF9yZXN1bHQudGFnLmpvaW4oIiwgIil9XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBgRGVzY3JpcHRpb24gOiAke2dldF9yZXN1bHQuZGVzY3JpcHRpb259XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSAiTGluayA6IFxuIgogICAgICAgICAgICAgICAgICAgIGluaV9saW5rID0gZ2V0X3Jlc3VsdC5saW5rCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgeCBvZiBpbmlfbGluaykgewogICAgICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGAke3gudHlwZX0gLSAke3gubGlua31cblxuYAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWwgPSBhd2FpdCBnZXRCdWZmZXIoZ2V0X3Jlc3VsdC50aHVtYm5haWwpCiAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCB0aHVtYm5haWwsIGltYWdlLCB7IHF1b3RlZDogZnRva28sIGNhcHRpb246IGluaV90eHQgfSkKICAgICAgICAgICAgICAgICAgICBicmVhawkKCQkJCgkJIGNhc2UgJ3hueHhzZWFyY2gnOgogICAgICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA9PSAwKSByZXR1cm4gcmVwbHkoYEV4YW1wbGU6ICR7cHJlZml4ICsgY29tbWFuZH0gSmFwYW5lc2VgKQogICAgICAgICAgICAgICAgICAgIHF1ZXJ5ID0gYXJncy5qb2luKCcgJykKICAgICAgICAgICAgICAgICAgICBnZXRfcmVzdWx0ID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS5sb2xodW1hbi54eXovYXBpL3hueHhzZWFyY2g/YXBpa2V5PSR7YXBpfSZxdWVyeT0ke3F1ZXJ5fWApCiAgICAgICAgICAgICAgICAgICAgZ2V0X3Jlc3VsdCA9IGdldF9yZXN1bHQucmVzdWx0CiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCA9ICIiCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgeCBvZiBnZXRfcmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGluaV90eHQgKz0gYFRpdGxlIDogJHt4LnRpdGxlfVxuYAogICAgICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGBWaWV3cyA6ICR7eC52aWV3c31cbmAKICAgICAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBgRHVyYXRpb24gOiAke3guZHVyYXRpb259XG5gCiAgICAgICAgICAgICAgICAgICAgICAgIGluaV90eHQgKz0gYFVwbG9hZGVyIDogJHt4LnVwbG9hZGVyfVxuYAogICAgICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGBMaW5rIDogJHt4Lmxpbmt9XG5gCiAgICAgICAgICAgICAgICAgICAgICAgIGluaV90eHQgKz0gYFRodW1ibmFpbCA6ICR7eC50aHVtYm5haWx9XG5cbmAKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmVwbHkoaW5pX3R4dCkKICAgICAgICAgICAgICAgICAgICBicmVhawoJCQkJCgkJY2FzZSAndGFnc3RpY2snOgogICAgICAgICAgICAgICAgICAgIGlmICgoaXNNZWRpYSAmJiAhc2FtLm1lc3NhZ2UudmlkZW9NZXNzYWdlIHx8IGlzUXVvdGVkU3RpY2tlcikgJiYgYXJncy5sZW5ndGggPT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmNtZWRpYSA9IGlzUXVvdGVkU3RpY2tlciA/IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywgJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvIDogc2FtCiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVQYXRoID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZEFuZFNhdmVNZWRpYU1lc3NhZ2UoZW5jbWVkaWEsIGZpbGVuYW1lID0gZ2V0UmFuZG9tKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGFyZ3Muam9pbignICcpCiAgICAgICAgICAgICAgICAJZ3JvdXAgPSBhd2FpdCBzYW11MzMwLmdyb3VwTWV0YWRhdGEoZnJvbSkKICAgICAgICAgICAgICAgICAgICAgICAgbWVtYmVyID0gZ3JvdXBbJ3BhcnRpY2lwYW50cyddCiAgICAgICAgICAgICAgICAgICAgICAgIG1lbSA9IFtdCiAgICAgICAgICAgICAgICAgICAgICAgIG1lbWJlci5tYXAoYXN5bmMgYWRtID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lbS5wdXNoKGFkbS5pZC5yZXBsYWNlKCdjLnVzJywgJ3Mud2hhdHNhcHAubmV0JykpCiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dEluZm86IHsgbWVudGlvbmVkSmlkOiBtZW0gfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RlZDogc2FtCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaW5pX2J1ZmZlciA9IGZzLnJlYWRGaWxlU3luYyhmaWxlUGF0aCkKICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBpbmlfYnVmZmVyLCBzdGlja2VyLCBvcHRpb25zKQogICAgICAgICAgICAgICAgICAgICAgICBmcy51bmxpbmtTeW5jKGZpbGVQYXRoKQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlcGx5KGBFdGlxdWV0YSB1biBzdGlja2VyIGNvbiBlbCBjb21hbmRvYCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWsKCQkJCQoJCQkJCgkJCQkKCQkJCQoJY2FzZSAnZW50cmFib3QnOgpzYW11MzMwLnF1ZXJ5KHsKanNvbjpbImFjdGlvbiIsICJpbnZpdGUiLCBgJHthcmdzWzBdLnJlcGxhY2UoJ2h0dHBzOi8vY2hhdC53aGF0c2FwcC5jb20vJywnJyl9YF0KfSkKcmVwbHkoJ1lhIGVudHJlIGFsIGdydXBv7aC97biJJykKYnJlYWsKCQkJCQpjYXNlICdwbGF5JzoKICBpZiAoIWlzUmVnaXN0ZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkuZGFmdGFyQikKICBpZiAoYXJncy5sZW5ndGggPT0gMCkgcmV0dXJuIHJlcGx5KGBFamVtcGxvOiAke3ByZWZpeCArIGNvbW1hbmR9IE1lIG9sdmlkZSBkZSB2aXZpcmApCiAgICAgICAgICAgICAgICAgICAgcXVlcnkgPSBhcmdzLmpvaW4oJyAnKQoJCSAgICBmYWtlZSA9IGZzLnJlYWRGaWxlU3luYygnLi9zcmMvaW1nLmpwZycpCiAgICAgICAgICAgICAgICAgICAgZ2V0X3Jlc3VsdCA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkubG9saHVtYW4ueHl6L2FwaS95dHBsYXk/YXBpa2V5PSR7YXBpfSZxdWVyeT0ke3F1ZXJ5fWApCiAgICAgICAgICAgICAgICAgICAgZ2V0X3Jlc3VsdCA9IGdldF9yZXN1bHQucmVzdWx0CiAgICAgICAgICAgICAgICAgICAgZ2V0X2luZm8gPSBnZXRfcmVzdWx0LmluZm8KICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ID0gYCpUaXR1bG8qIDogJHtnZXRfaW5mby50aXRsZX1cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDtoL3ttbXtoLztv7vigI3imYDvuI/vuI9QdWJsaWNhZG9yIDogJHtnZXRfaW5mby51cGxvYWRlcn1cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDtoL3ttZBEdXJhY2lvbiA6ICR7Z2V0X2luZm8uZHVyYXRpb259XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBg7aC97bGAVmlzdGFzIDogJHtnZXRfaW5mby52aWV3fVxuYAogICAgICAgICAgICAgICAgICAgIGluaV90eHQgKz0gYO2gve2xje2gvO2/u0xpa2UgOiAke2dldF9pbmZvLmxpa2V9XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBg7aC97bGO7aC87b+7RGlzbGlrZSA6ICR7Z2V0X2luZm8uZGlzbGlrZX1cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDtoL3ts4tEZXNjcmlwY2lvbiA6XG4gJHtnZXRfaW5mby5kZXNjcmlwdGlvbn1cblxuYAoJCSAgICBpbmlfdHh0ICs9IGBTaSBlbCBhdWRpbyBubyBsbGVnYSwgcHVlZGUgZGVzY2FyZ2FyIHBvciBhcXVpOiA6XG4gJHtnZXRfcmVzdWx0LmF1ZGlvWzNdLmxpbmt9XG5cbmAKCQkgICAgaW5pX3R4dCArPSBgUHVlZGUgZGVzY2FyZ2FyIHRhbWJpZW4gZWwgdmlkZW8gYXF1aTogOlxuICR7Z2V0X3Jlc3VsdC52aWRlb1swXS5saW5rfVxuYAogICAgICAgICAgICAgICAgICAgIGluaV9idWZmZXIgPSBhd2FpdCBnZXRCdWZmZXIoZ2V0X2luZm8udGh1bWJuYWlsKQogICAgICAgICAgICAgICAgICAgIGF3YWl0IHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgaW5pX2J1ZmZlciwgaW1hZ2UsIHsgcXVvdGVkOiBmdmlkLCBjYXB0aW9uOiBpbmlfdHh0LCB0aHVtYm5haWw6IGZha2VlLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfSB9KQogICAgICAgICAgICAgICAgICAgIGdldF9hdWRpbyA9IGF3YWl0IGdldEJ1ZmZlcihnZXRfcmVzdWx0LmF1ZGlvWzRdLmxpbmspCiAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBnZXRfYXVkaW8sIGF1ZGlvLCB7IG1pbWV0eXBlOiAnYXVkaW8vbXA0JywgZHVyYXRpb24gOi05OTk5OTk5OTk5OTk5OTksIGZpbGVuYW1lOiBgJHtnZXRfaW5mby50aXRsZX0ubXAzYCwgcXVvdGVkOiBmdmlkIH0pCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKCQoJCQkJCmNhc2UgJ3BsYXkyJzoKICAgIGlmICghaXNSZWdpc3RlcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5kYWZ0YXJCKQogIGlmIChhcmdzLmxlbmd0aCA9PSAwKSByZXR1cm4gcmVwbHkoYEVqZW1wbG86ICR7cHJlZml4ICsgY29tbWFuZH0gTWUgb2x2aWRlIGRlIHZpdmlyYCkKICAgICAgICAgICAgICAgICAgICBxdWVyeSA9IGFyZ3Muam9pbignICcpCgkJICAgIGZha2VlID0gZnMucmVhZEZpbGVTeW5jKCcuL3NyYy9pbWcuanBnJykKICAgICAgICAgICAgICAgICAgICBnZXRfcmVzdWx0ID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS5sb2xodW1hbi54eXovYXBpL3l0cGxheT9hcGlrZXk9JHthcGl9JnF1ZXJ5PSR7cXVlcnl9YCkKICAgICAgICAgICAgICAgICAgICBnZXRfcmVzdWx0ID0gZ2V0X3Jlc3VsdC5yZXN1bHQKICAgICAgICAgICAgICAgICAgICBnZXRfaW5mbyA9IGdldF9yZXN1bHQuaW5mbwogICAgICAgICAgICAgICAgICAgIGluaV90eHQgPSBg7aC+7beKVGl0dWxvIDogJHtnZXRfaW5mby50aXRsZX1cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDtoL3ttbXtoLztv7vigI3imYDvuI/vuI9QdWJsaWNhZG9yIDogJHtnZXRfaW5mby51cGxvYWRlcn1cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDtoL3ttZBEdXJhY2lvbiA6ICR7Z2V0X2luZm8uZHVyYXRpb259XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBg7aC97bGAVmlzdGFzIDogJHtnZXRfaW5mby52aWV3fVxuYAogICAgICAgICAgICAgICAgICAgIGluaV90eHQgKz0gYO2gve2xje2gvO2/u0xpa2UgOiAke2dldF9pbmZvLmxpa2V9XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBg7aC97bGO7aC87b+7RGlzbGlrZSA6ICR7Z2V0X2luZm8uZGlzbGlrZX1cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDtoL3ts4tEZXNjcmlwY2lvbiA6XG4gJHtnZXRfaW5mby5kZXNjcmlwdGlvbn1cblxuYAoJCSAgICBpbmlfdHh0ICs9IGBTaSBlbCBhdWRpbyBubyBsbGVnYSwgcHVlZGUgZGVzY2FyZ2FyIHBvciBhcXVpOiA6XG4gJHtnZXRfcmVzdWx0LmF1ZGlvWzNdLmxpbmt9XG5cbmAKCQkgICAgaW5pX3R4dCArPSBgUHVlZGUgZGVzY2FyZ2FyIHRhbWJpZW4gZWwgdmlkZW8gYXF1aTogOlxuICR7Z2V0X3Jlc3VsdC52aWRlb1swXS5saW5rfVxuYAogICAgICAgICAgICAgICAgICAgIGluaV9idWZmZXIgPSBhd2FpdCBnZXRCdWZmZXIoZ2V0X2luZm8udGh1bWJuYWlsKQogICAgICAgICAgICAgICAgICAgIGF3YWl0IHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgaW5pX2J1ZmZlciwgaW1hZ2UsIHsgcXVvdGVkOiBmdmlkLCBjYXB0aW9uOiBpbmlfdHh0LCB0aHVtYm5haWw6IGZha2VlLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfSB9KQogICAgICAgICAgICAgICAgICAgIGdldF9hdWRpbyA9IGF3YWl0IGdldEJ1ZmZlcihnZXRfcmVzdWx0LmF1ZGlvWzRdLmxpbmspCiAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBnZXRfYXVkaW8sIGF1ZGlvLCB7IG1pbWV0eXBlOiAnYXVkaW8vbXA0JywgcHR0IDogdHJ1ZSwgZHVyYXRpb24gOi05OTk5OTk5OTk5OTk5OTksIGZpbGVuYW1lOiBgJHtnZXRfaW5mby50aXRsZX0ubXAzYCwgcXVvdGVkOiBmdmlkIH0pCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKCQkJCQoJCQkJCmNhc2UgJ3BsYXl2aWQnOgogIGlmICghaXNSZWdpc3RlcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5kYWZ0YXJCKQogIGlmIChhcmdzLmxlbmd0aCA9PSAwKSByZXR1cm4gcmVwbHkoYEVqZW1wbG86ICR7cHJlZml4ICsgY29tbWFuZH0gTWUgb2x2aWRlIGRlIHZpdmlyYCkKICAgICAgICAgICAgICAgICAgICBxdWVyeSA9IGFyZ3Muam9pbignICcpCgkJICAgIGZha2VlID0gZnMucmVhZEZpbGVTeW5jKCcuL3NyYy9pbWcuanBnJykKICAgICAgICAgICAgICAgICAgICBnZXRfcmVzdWx0ID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS5sb2xodW1hbi54eXovYXBpL3l0cGxheT9hcGlrZXk9JHthcGl9JnF1ZXJ5PSR7cXVlcnl9YCkKICAgICAgICAgICAgICAgICAgICBnZXRfcmVzdWx0ID0gZ2V0X3Jlc3VsdC5yZXN1bHQKICAgICAgICAgICAgICAgICAgICBnZXRfaW5mbyA9IGdldF9yZXN1bHQuaW5mbwogICAgICAgICAgICAgICAgICAgIGluaV90eHQgPSBg7aC+7beKVGl0dWxvIDogJHtnZXRfaW5mby50aXRsZX1cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDtoL3ttbXtoLztv7vigI3imYDvuI/vuI9QdWJsaWNhZG9yIDogJHtnZXRfaW5mby51cGxvYWRlcn1cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDtoL3ttZBEdXJhY2lvbiA6ICR7Z2V0X2luZm8uZHVyYXRpb259XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBg7aC97bGAVmlzdGFzIDogJHtnZXRfaW5mby52aWV3fVxuYAogICAgICAgICAgICAgICAgICAgIGluaV90eHQgKz0gYO2gve2xje2gvO2/u0xpa2UgOiAke2dldF9pbmZvLmxpa2V9XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBg7aC97bGO7aC87b+7RGlzbGlrZSA6ICR7Z2V0X2luZm8uZGlzbGlrZX1cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDtoL3ts4tEZXNjcmlwY2lvbiA6XG4gJHtnZXRfaW5mby5kZXNjcmlwdGlvbn1cblxuYAoJCSAgICBpbmlfdHh0ICs9IGBfU2kgZWwgdmlkZW8gbm8gbGxlZ2EsIHB1ZWRlIGRlc2NhcmdhciBwb3IgYXF1aV8gOlxuICR7Z2V0X3Jlc3VsdC52aWRlb1swXS5saW5rfVxuXG5gCgkJICAgIGluaV90eHQgKz0gYFB1ZWRlIGRlc2NhcmdhciB0YW1iaWVuIGVsIGF1ZGlvIGFxdWk6IDpcbiAke2dldF9yZXN1bHQuYXVkaW9bM10ubGlua31cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfYnVmZmVyID0gYXdhaXQgZ2V0QnVmZmVyKGdldF9pbmZvLnRodW1ibmFpbCkKICAgICAgICAgICAgICAgICAgICBhd2FpdCBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGluaV9idWZmZXIsIGltYWdlLCB7IHF1b3RlZDogZnZpZCwgY2FwdGlvbjogaW5pX3R4dCwgdGh1bWJuYWlsOiBmYWtlZSwgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZX0gfSkKICAgICAgICAgICAgICAgICAgICBnZXRfdmlkZW8gPSBhd2FpdCBnZXRCdWZmZXIoZ2V0X3Jlc3VsdC52aWRlb1swXS5saW5rKQogICAgICAgICAgICAgICAgICAgIGF3YWl0IHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgZ2V0X3ZpZGVvLCB2aWRlbywgeyBtaW1ldHlwZTogJ3ZpZGVvL21wNCcsIGZpbGVuYW1lOiBgJHtnZXRfaW5mby50aXRsZX0ubXA0YCwgcXVvdGVkOiBmdmlkIH0pCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKCQkJCQoJCQkJCgkJY2FzZSAneXRzZWFyY2gnOgogICAgICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA9PSAwKSByZXR1cm4gcmVwbHkoYEVqZW1wbG86ICR7cHJlZml4ICsgY29tbWFuZH0gTWUgb2x2aWRlIGRlIHZpdmlyYCkKICAgICAgICAgICAgICAgICAgICBxdWVyeSA9IGFyZ3Muam9pbignICcpCiAgICAgICAgICAgICAgICAgICAgZ2V0X3Jlc3VsdCA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkubG9saHVtYW4ueHl6L2FwaS95dHNlYXJjaD9hcGlrZXk9JHthcGl9JnF1ZXJ5PSR7cXVlcnl9YCkKICAgICAgICAgICAgICAgICAgICBnZXRfcmVzdWx0ID0gZ2V0X3Jlc3VsdC5yZXN1bHQKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ID0gIiIKICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4IG9mIGdldF9yZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBgKuKXplRpdHVsbyogOiAke3gudGl0bGV9XG5gCiAgICAgICAgICAgICAgICAgICAgICAgIGluaV90eHQgKz0gYCril6ZWaXN0YXMqIDogJHt4LnZpZXdzfVxuYAogICAgICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDil6ZQdWJsaWNhZG8gZWwgJHt4LnB1Ymxpc2hlZH1cbmAKICAgICAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBg7aC97bO4VGh1bWJuYWlsIDogJHt4LnRodW1ibmFpbH1cbmAKICAgICAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBg7aC97bOyTGluayA6IGh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3dhdGNoP3Y9JHt4LnZpZGVvSWR9XG5cbmAKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmVwbHkoaW5pX3R4dCkKICAgICAgICAgICAgICAgICAgICBicmVhawoJCQkJCgkJCQkKCQkJY2FzZSAnYXBpJzoKCQkJCQlpZiAoYXJncy5sZW5ndGggPCAxKSByZXR1cm4KCQkJCQlpZiAoIWlzT3duZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkub3duZXJCKQoJCQkJICAgCW5ld2FwaSA9IGFyZ3Muam9pbignICcpCgkJCQkJYXBpbmV3ID0gbmV3YXBpCgkJCQkJZnMud3JpdGVGaWxlU3luYyhgJHthcGl9YCkKCQkJCQlyZXBseShgQXBpIGNhbWJpYWRhIDogJHtuZXdhcGl9YCkKCQkJCQlicmVhawoKY2FzZSAndGlrdG9rMic6CiByZXBseSgnd2FpdCcpCiBwZSA9IGFyZ3Muam9pbignICcpCiAgYW51ID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwOi8vZG9jcy1qb2pvLmhlcm9rdWFwcC5jb20vYXBpL3Rpa3Rva19ub3dtP3VybD0ke3BlfWApCnRla3MgPSBgTmloIEJvc3MgVmlkZW9ueWEuLi5gCgkJCQkJYnVmZmVyID0gYXdhaXQgZ2V0QnVmZmVyKGAke2FudS5yZXN1bHR9YCkKCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGJ1ZmZlciwgdmlkZW8sIHttaW1ldHlwZTogJ3ZpZGVvL21wNCcsIHF1b3RlZDogZnRva28sIGNhcHRpb246IHRla3N9KQoJCQkJCWJyZWFrCmNhc2UgJ2lnJzoKIHBlID0gYXJncy5qb2luKCcgJykKIGFudSA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly92aWRlZmlrcmkuY29tL2FwaS9pZ2RsLz91cmw9JHtwZX1gKQogYnVmID0gYXdhaXQgZ2V0QnVmZmVyKGAke2FudS5yZXN1bHQudmlkZW99YCkKIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYnVmLCB2aWRlbywge3F1b3RlZDpmdG9rbywgY2FwdGlvbjogYE5paCBCb3NzYCB9KQogYnJlYWsKCQkJCQogY2FzZSAnaWd0dic6CiBwZSA9IGFyZ3Muam9pbignICcpCiBhbnUgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vdmlkZWZpa3JpLmNvbS9hcGkvaWd0di8/dXJsPSR7cGV9YCkKIGJ1ZiA9IGF3YWl0IGdldEJ1ZmZlcihgJHthbnUucmVzdWx0LnZpZGVvX3VybH1gKQogc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBidWYsIHZpZGVvLCB7cXVvdGVkOmZ0b2tvLCBjYXB0aW9uOiBgTmloIEJvc3NgIH0pCiBicmVhawoJCQkJCiBjYXNlICdsaXJpayc6CmNhc2UgJ2xldHJhJzoKY2FzZSAnbGV0cmFzJzoKICBpZiAoYXJncy5sZW5ndGggPCAxKSByZXR1cm4gcmVwbHkoJ0VzY3JpYmUgZWwgbm9tYnJlIGRlIGxhIGNhbmNpb24nKQogIGlmICghaXNSZWdpc3RlcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5kYWZ0YXJCKQogIAogIHNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQogIHRlbHMgPSBhcmdzLmpvaW4oJyAnKQogIHRyeSB7CiAgYW51ID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL3ZpZGVmaWtyaS5jb20vYXBpL2xpcmlrbGFndS8/cXVlcnk9JHt0ZWxzfWAsIHsKbWV0aG9kOiAnZ2V0JwogIH0pCiAgcmVwbHkoYO2gvu21sFJlc3VsdGFkbyBkZSAke3RlbHN9OlxuXG5fX19fX19fX19fX19fX19fX19fX1xuKu2gve2xpUFydGlzdGEqICR7YW51LnJlc3VsdC5hcnRpc3R9XG4ke2FudS5yZXN1bHQubGlyaWt9YCkKICAKICB9IGNhdGNoIHsKICAgIHJlcGx5KG1lc3MuZmVycikKICB9CiAgYnJlYWsKCQkJCQogLy9BcnJlZ2xhZG8gcG9yIFNhbXUzMzAKY2FzZSAneXRtcDMnOgogIGlmICghaXNSZWdpc3RlcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5kYWZ0YXJCKQogIAogIHJlcGx5KG1lc3Mud2FpdCkKICBwbGF5ID0gYm9keS5zbGljZSg3KQogIGlmKCFpc1VybChhcmdzWzBdKSAmJiAhYXJnc1swXS5pbmNsdWRlcygneW91dHUnKSkgcmV0dXJuIHJlcGx5KCdGb3JtYXRvIGRlIGxpbmsgaW5jb3JyZWN0bycpCiAgdHJ5IHsKICBzYW0gPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vYXBpLnpla3MueHl6L2FwaS95dG1wMy8yP3VybD0ke3BsYXl9JmFwaWtleT1hcGl2aW56YCkKICBpbmZvbXAzID0gYCpBdWRpbyEhISpcbuKAoyBOb21icmUgOiAke3NhbS5yZXN1bHQudGl0bGV9XG7igKMgRnVlbnRlOiAke3NhbS5yZXN1bHQuc291cmNlfVxu4oCjIFRhbWHDsW86ICR7c2FtLnJlc3VsdC5zaXplfVxu4oCjICpDYWxpZGFkKiA6ICR7YW51LnJlc3VsdC5xdWFsaXR5fVxuXG5fRWwgYXVkaW8gc2UgZXN0YSBtYW5kYW5kbyBlc3BlcmUsIHNpIG5vIGxsZWdhIGRlc2Nhcmd1ZSBwb3IgZWwgbGlua19cbuKAoyAqbGluayogOiAke3NhbS5yZXN1bHQubGlua31gCiAgZmFrZWUgPSBmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL2ltZy5qcGcnKQogIGJ1ZmZlciA9IGF3YWl0IGdldEJ1ZmZlcihzYW0ucmVzdWx0LnRodW1iKQogIGxhZ3UgPSBhd2FpdCBnZXRCdWZmZXIoc2FtLnJlc3VsdC5saW5rKQogIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYnVmZmVyLCBpbWFnZSwgewpxdW90ZWQ6IGZ2aWQsIGNhcHRpb246IGluZm9tcDMsIHRodW1ibmFpbDogZmFrZWUsIGNvbnRleHRJbmZvOiB7ImZvcndhcmRpbmdTY29yZSI6IDk5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9CiAgfSkKICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGxhZ3UsIGF1ZGlvLCB7Cm1pbWV0eXBlOiAnYXVkaW8vbXA0JywgZHVyYXRpb24gOi05OTk5OTk5OTk5OTk5OTksIGZpbGVuYW1lOiBgJHtzYW0ucmVzdWx0LnRpdGxlfS5tcDNgLCBxdW90ZWQ6IGZsaXZlTG9jLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfQogIH0pCiAgCiAgfSBjYXRjaCB7CiAgICByZXBseShtZXNzLmZlcnIpCiAgfQogIGJyZWFrCgpjYXNlICd5dG1wNCc6CiAgaWYgKCFpc1JlZ2lzdGVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmRhZnRhckIpCiAgCiAgcmVwbHkobWVzcy53YWl0KQogIHBsYXkgPSBib2R5LnNsaWNlKDcpCiAgdHJ5IHsKICBhbnUgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vYXBpLnpla3MueHl6L2FwaS95dG1wND91cmw9JHtwbGF5fSZhcGlrZXk9YXBpdmluemApCiAgaWYoIWlzVXJsKGFyZ3NbMF0pICYmICFhcmdzWzBdLmluY2x1ZGVzKCd5b3V0dScpKSByZXR1cm4gcmVwbHkoJ0VsIGZvcm1hdG8gZGVsIGxpbmsgZXMgaW5jb3JyZWN0bycpCiAgaWYgKGFudS5lcnJvcikgcmV0dXJuIHJlcGx5KGFudS5lcnJvcikKICBpbmZvbXAzID0gYCpWaWRlbypcbuKAoyAqTm9tYnJlKiA6ICR7YW51LnJlc3VsdC50aXRsZX1cbuKAoyAqRnVlbnRlKiA6ICR7YW51LnJlc3VsdC5zb3VyY2V9XG7igKMgKlRhbWHDsW8qIDogJHthbnUucmVzdWx0LnNpemV9XG5cbl9TZSBlc3RhIG1hbmRhbmRvIGVsIHZpZGVvLCBzaSBubyBsbGVnYSBkZXNjYXJndWUgcG9yIGVsIGxpbmtfXG7igKMgKmxpbmsqIDogJHthbnUucmVzdWx0LnVybF92aWRlb31gCiAgZmFrZWUgPSBmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL2ltZy5qcGcnKQogIGJ1ZmZlciA9IGF3YWl0IGdldEJ1ZmZlcihhbnUucmVzdWx0LnRodW1ibmFpbCkKICBsYWd1ID0gYXdhaXQgZ2V0QnVmZmVyKGFudS5yZXN1bHQudXJsX3ZpZGVvKQogIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYnVmZmVyLCBpbWFnZSwgewpxdW90ZWQ6IGZ2aWQsIGNhcHRpb246IGluZm9tcDMsIHRodW1ibmFpbDogZmFrZWUKICB9KQogIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgbGFndSwgdmlkZW8sIHsKbWltZXR5cGU6ICd2aWRlby9tcDQnLCBkdXJhdGlvbiA6LTk5OTk5OTk5OTk5OTk5OSwgZmlsZW5hbWU6IGAke2FudS5yZXN1bHQudGl0bGV9Lm1wNGAsIHF1b3RlZDogZnZpZAogIH0pCiAgCiAgfSBjYXRjaCB7CiAgICByZXBseShtZXNzLmZlcnIpCiAgfQogIGJyZWFrCiBjYXNlICd0aWt0b2thdWRpbyc6CiBwZSA9IGFyZ3Muam9pbignICcpCiBhbnUgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHA6Ly9kb2NzLWpvam8uaGVyb2t1YXBwLmNvbS9hcGkvdGlrdG9rX2F1ZGlvP3VybD0ke3BlfWApCiBidWYgPSBhd2FpdCBnZXRCdWZmZXIoYCR7YW51LnJlc3VsdH1gKQogc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBidWYsIGF1ZGlvLCB7bWltZXR5cGU6ICdhdWRpby9tcDQnLCBxdW90ZWQ6IGZ0b2tvLCBwdHQ6dHJ1ZX0pCiBicmVhawpjYXNlICdzcyc6CiBwZSA9IGFyZ3Muam9pbignICcpCiBhbnUgPSBhd2FpdCBnZXRCdWZmZXIoYGh0dHBzOi8vYXBpLXJ1bGwuaGVyb2t1YXBwLmNvbS9hcGkvc3N3ZWI/dXJsPSR7cGV9YCkKIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYW51LCBpbWFnZSwge3F1b3RlZDogZmltZ30pCiBicmVhawogCgkJCQljYXNlICdpbXV0JzoKCQkJCQllbmNtZWRpYSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8KCQkJCQltZWRpYSA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRBbmRTYXZlTWVkaWFNZXNzYWdlKGVuY21lZGlhKQoJCQkJCXJhbiA9IGdldFJhbmRvbSgnLm1wMycpCgkJCQkJZXhlYyhgZmZtcGVnIC1pICR7bWVkaWF9IC1hZiBhdGVtcG89My80LGFzZXRyYXRlPTQ0NTAwKjQvMyAke3Jhbn1gLCAoZXJyLCBzdGRlcnIsIHN0ZG91dCkgPT4gewoJCQkJCQlmcy51bmxpbmtTeW5jKG1lZGlhKQoJCQkJCQlpZiAoZXJyKSByZXR1cm4gcmVwbHkoJ0Vycm9yIScpCgkJCQkJCWhhaCA9IGZzLnJlYWRGaWxlU3luYyhyYW4pCgkJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgaGFoLCBhdWRpbywge21pbWV0eXBlOiAnYXVkaW8vbXA0JywgcHR0OiB0cnVlLCBxdW90ZWQ6IGZkb2N9KQoJCQkJCQlmcy51bmxpbmtTeW5jKHJhbikKCQkJCQl9KQoJCQkJYnJlYWsKCQkJCWNhc2UgJ2hvZGUnOgoJCQkJCWVuY21lZGlhID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzYW0pLnJlcGxhY2UoJ3F1b3RlZE0nLCdtJykpLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mbwoJCQkJCW1lZGlhID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZEFuZFNhdmVNZWRpYU1lc3NhZ2UoZW5jbWVkaWEpCgkJCQkJcmFuID0gZ2V0UmFuZG9tKCcubXAzJykKCQkJCQlleGVjKGBmZm1wZWcgLWkgJHttZWRpYX0gLWFmIGF0ZW1wbz00LzMsYXNldHJhdGU9NDQ1MDAqMy80ICR7cmFufWAsIChlcnIsIHN0ZGVyciwgc3Rkb3V0KSA9PiB7CgkJCQkJCWZzLnVubGlua1N5bmMobWVkaWEpCgkJCQkJCWlmIChlcnIpIHJldHVybiByZXBseSgnRXJyb3IhJykKCQkJCQkJaGFoID0gZnMucmVhZEZpbGVTeW5jKHJhbikKCQkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBoYWgsIGF1ZGlvLCB7bWltZXR5cGU6ICdhdWRpby9tcDQnLCBwdHQ6IHRydWUsIHF1b3RlZDogZmRvY30pCgkJCQkJCWZzLnVubGlua1N5bmMocmFuKQoJCQkJCX0pCgkJCQlicmVhawoJCQkJCgkJCQljYXNlICd0cmlnZ2VyJzoKCQkJCQkgICByZXBseShtZXNzLndhaXQpCgkJCQkJICAgdHJpID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzYW0pLnJlcGxhY2UoJ3F1b3RlZE0nLCdtJykpLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mbwoJCQkJCSAgIGdlciA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRBbmRTYXZlTWVkaWFNZXNzYWdlKHRyaSkKCQkJCQkgICByYW4gPSBnZXRSYW5kb20oJy5tcDMnKQoJCQkJCSAgIGV4ZWMoYGZmbXBlZyAtaSAke2dlcn0gLWZpbHRlcl9jb21wbGV4ICJhY3J1c2hlcj1sZXZlbF9pbj04OmxldmVsX291dD0xODpiaXRzPTg6bW9kZT1sb2c6YWE9MSIgJHtyYW59YCwgKGVyciwgc3RkZXJyLCBzdGRvdXQpID0+IHsKCQkJCQkJZnMudW5saW5rU3luYyhnZXIpCgkJCQkJCWlmIChlcnIpIHJldHVybiByZXBseSgnRXJyb3IhJykKCQkJCQkJaGFoID0gZnMucmVhZEZpbGVTeW5jKHJhbikKCQkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBoYWgsIGF1ZGlvLCB7bWltZXR5cGU6ICdhdWRpby9tcDQnLCBwdHQ6dHJ1ZSwgcXVvdGVkOiBmZG9jfSkKCQkJCQkJZnMudW5saW5rU3luYyhyYW4pCgkJCQkJfSkKCQkJCWJyZWFrCgkKCQkJCQljYXNlICdzbG93JzoKCQkJCQlyZXBseShtZXNzLndhaXQpCgkJCQkJbG93ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzYW0pLnJlcGxhY2UoJ3F1b3RlZE0nLCdtJykpLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mbwoJCQkJCXNsbyA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRBbmRTYXZlTWVkaWFNZXNzYWdlKGxvdykKCQkJCQlyYW4gPSBnZXRSYW5kb20oJy5tcDMnKQoJCQkJCWV4ZWMoYGZmbXBlZyAtaSAke3Nsb30gLWZpbHRlcjphICJhdGVtcG89MC43LGFzZXRyYXRlPTQ0MTAwIiAke3Jhbn1gLCAoZXJyLCBzdGRlcnIsIHN0ZG91dCkgPT4gewoJCQkJCQlmcy51bmxpbmtTeW5jKHNsbykKCQkJCQkJaWYgKGVycikgcmV0dXJuIHJlcGx5KCdFcnJvciEnKQoJCQkJCQloYWggPSBmcy5yZWFkRmlsZVN5bmMocmFuKQoJCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGhhaCwgYXVkaW8sIHttaW1ldHlwZTogJ2F1ZGlvL21wNCcsIGR1cmF0aW9uIDotOTk5OTk5OTk5OTk5OTk5LCBwdHQ6dHJ1ZSwgcXVvdGVkOiBmZG9jfSkKCQkJCQkJZnMudW5saW5rU3luYyhyYW4pCgkJCQkJfSkKCQkJCWJyZWFrCgkJCQljYXNlICdhcmRpbGxhJzoKCQkJCQlyZXBseShtZXNzLndhaXQpCgkJCQkJcGFpID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzYW0pLnJlcGxhY2UoJ3F1b3RlZE0nLCdtJykpLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mbwoKCQkJCQl0dXAgPSBhd2FpdCBzYW11MzMwLmRvd25sb2FkQW5kU2F2ZU1lZGlhTWVzc2FnZShwYWkpCgkJCQkJcmFuID0gZ2V0UmFuZG9tKCcubXAzJykKCQkJCQlleGVjKGBmZm1wZWcgLWkgJHt0dXB9IC1maWx0ZXI6YSAiYXRlbXBvPTAuNSxhc2V0cmF0ZT02NTEwMCIgJHtyYW59YCwgKGVyciwgc3RkZXJyLCBzdGRvdXQpID0+IHsKCQkJCQkJZnMudW5saW5rU3luYyh0dXApCgkJCQkJCWlmIChlcnIpIHJldHVybiByZXBseSgnRXJyb3IhJykKCQkJCQkJaGFoID0gZnMucmVhZEZpbGVTeW5jKHJhbikKCQkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBoYWgsIGF1ZGlvLCB7bWltZXR5cGU6ICdhdWRpby9tcDQnLCBkdXJhdGlvbiA6LTk5OTk5OTk5OTk5OTk5OSwgcHR0OnRydWUsIHF1b3RlZDogZmRvY30pCgkJCQkJCWZzLnVubGlua1N5bmMocmFuKQoJCQkJCX0pCgkJCQlicmVhawoJCQkJY2FzZSAnZ3JhdmUnOgoJCQkJCXJlcGx5KG1lc3Mud2FpdCkKCQkJCQltdWsgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkucmVwbGFjZSgncXVvdGVkTScsJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvCgoJCQkJCWdlbSA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRBbmRTYXZlTWVkaWFNZXNzYWdlKG11aykKCQkJCQlyYW4gPSBnZXRSYW5kb20oJy5tcDMnKQoJCQkJCWV4ZWMoYGZmbXBlZyAtaSAke2dlbX0gLWZpbHRlcjphICJhdGVtcG89MS42LGFzZXRyYXRlPTIyMTAwIiAke3Jhbn1gLCAoZXJyLCBzdGRlcnIsIHN0ZG91dCkgPT4gewoJCQkJCQlmcy51bmxpbmtTeW5jKGdlbSkKCQkJCQkJaWYgKGVycikgcmV0dXJuIHJlcGx5KCdFcnJvciEnKQoJCQkJCQloYWggPSBmcy5yZWFkRmlsZVN5bmMocmFuKQoJCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGhhaCwgYXVkaW8sIHttaW1ldHlwZTogJ2F1ZGlvL21wNCcsIGR1cmF0aW9uIDotOTk5OTk5OTk5OTk5OTk5LCBwdHQ6dHJ1ZSwgcXVvdGVkOiBmZG9jfSkKCQkJCQkJZnMudW5saW5rU3luYyhyYW4pCgkJCQkJfSkKCQkJCWJyZWFrCgkJCQljYXNlICdiYXNzJzogICAgICAgICAgICAgICAgIAoJCQkJCWFzcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8KCgkJCQkJYmFzID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZEFuZFNhdmVNZWRpYU1lc3NhZ2UoYXNzKQoJCQkJCXJhbiA9IGdldFJhbmRvbSgnLm1wMycpCgkJCQkJZXhlYyhgZmZtcGVnIC1pICR7YmFzfSAtYWYgZXF1YWxpemVyPWY9OTQ6d2lkdGhfdHlwZT1vOndpZHRoPTI6Zz0zMCAke3Jhbn1gLCAoZXJyLCBzdGRlcnIsIHN0ZG91dCkgPT4gewoJCQkJCQlmcy51bmxpbmtTeW5jKGJhcykKCQkJCQkJaWYgKGVycikgcmV0dXJuIHJlcGx5KCdFcnJvciEnKQoJCQkJCQloYWggPSBmcy5yZWFkRmlsZVN5bmMocmFuKQoJCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGhhaCwgYXVkaW8sIHttaW1ldHlwZTogJ2F1ZGlvL21wNCcsIGR1cmF0aW9uIDotOTk5OTk5OTk5OTk5OTk5LCBwdHQ6dHJ1ZSwgdGVzY3VrLCBxdW90ZWQ6IGZkb2N9KQoJCQkJCQlmcy51bmxpbmtTeW5jKHJhbikKCQkJCQl9KQoJCQkJCWJyZWFrCgkJCQkKCQkJY2FzZSAndG9tcDMnOgoJCQkJc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCgkJCQlpZiAoIWlzUXVvdGVkVmlkZW8pIHJldHVybiByZXBseSgnWSBlbCB2aWRlbz8nKQoJCQkJcmVwbHkobWVzcy53YWl0KQoJCQkJZW5jbWVkaWEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkucmVwbGFjZSgncXVvdGVkTScsICdtJykpLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mbwoJCQkJbWVkaWEgPSBhd2FpdCBzYW11MzMwLmRvd25sb2FkQW5kU2F2ZU1lZGlhTWVzc2FnZShlbmNtZWRpYSkKCQkJCXJhbiA9IGdldFJhbmRvbSgnLm1wMycpCgkJCQlleGVjKGBmZm1wZWcgLWkgJHttZWRpYX0gJHtyYW59YCwgKGVycikgPT4gewoJCQkJCWZzLnVubGlua1N5bmMobWVkaWEpCgkJCQkJaWYgKGVycikgcmV0dXJuIHJlcGx5KG1lc3MuZmVycikKCQkJCQlidWZmZXIgPSBmcy5yZWFkRmlsZVN5bmMocmFuKQoJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYnVmZmVyLCBhdWRpbywgeyBtaW1ldHlwZTogJ2F1ZGlvL21wNCcsIHF1b3RlZDogZnRva299KQoJCQkJCQlmcy51bmxpbmtTeW5jKHJhbikKCQkJCQkgICB9KQoJCQkJYnJlYWsKCQkJY2FzZSAnZ2V0c3RpY2tlcic6CgkJCWNhc2UgJ2dldHMnOgoJCQkJdmFyIGl0c21lID0gYCR7bnVtYmVybnllfUBzLndoYXRzYXBwLm5ldGAKCQkJCW5hbWFzdGMgPSBhcmdzLmpvaW4oJyAnKQoJCQkJcmVzdWx0ID0gZnMucmVhZEZpbGVTeW5jKGAuL21lZGlhL3N0aWNrZXIvJHtuYW1hc3RjfS53ZWJwYCkKCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgcmVzdWx0LCBzdGlja2VyLCB7IHF1b3RlZDogeyBrZXk6IHsgZnJvbU1lOiBmYWxzZSwgcGFydGljaXBhbnQ6IGAwQHMud2hhdHNhcHAubmV0YCwgLi4uKGZyb20gPyB7IHJlbW90ZUppZDogInN0YXR1c0Bicm9hZGNhc3QiIH0gOiB7fSkgfSwgbWVzc2FnZTogeyAiaW1hZ2VNZXNzYWdlIjogeyAibWltZXR5cGUiOiAiaW1hZ2UvanBlZyIsICJjYXB0aW9uIjogIiR7c2V0dGluZy5uYW1lfSIsICdqcGVnVGh1bWJuYWlsJzogZnMucmVhZEZpbGVTeW5jKCcuL3NyYy9JdmFuLmpwZycpfX19fSkKCQkJCWJyZWFrCgkJCWNhc2UgJ3N0aWNrZXJsaXN0JzoKCQkJY2FzZSAnbGlzdHN0aWNrZXInOgoJCQkJdGVrcyA9ICcqU3RpY2tlciBMaXN0IDoqXG5cbicKCQkJCWZvciAobGV0IGF3b2t3a3drIG9mIHNldGlrZXIpIHsKCQkJCQl0ZWtzICs9IGAtICR7YXdva3drd2t9XG5gCgkJCQl9CgkJCQl0ZWtzICs9IGBcbipUb3RhbCA6ICR7c2V0aWtlci5sZW5ndGh9KmAKCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgdGVrcy50cmltKCksIGV4dGVuZGVkVGV4dCwgeyBxdW90ZWQ6IGZ0b2tvLCBjb250ZXh0SW5mbzogeyAibWVudGlvbmVkSmlkIjogc2V0aWtlciB9IH0pCgkJCQlicmVhawoJCQljYXNlICdhZGRzdGlja2VyJzoKCQkJCWlmICghaXNRdW90ZWRTdGlja2VyKSByZXR1cm4gcmVwbHkoJ1JlcGx5IHN0aWtlciBueWEnKQoJCQkJc3ZzdCA9IGFyZ3Muam9pbignICcpCgkJCQlpZiAoIXN2c3QpIHJldHVybiByZXBseSgnTmFtYSBzdGlja2VyIG55YSBhcGE/JykKCQkJCWJvaWogPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkucmVwbGFjZSgncXVvdGVkTScsICdtJykpLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mbwoJCQkJZGVsYiA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRNZWRpYU1lc3NhZ2UoYm9paikKCQkJCXNldGlrZXIucHVzaChgJHtzdnN0fWApCgkJCQlmcy53cml0ZUZpbGVTeW5jKGAuL21lZGlhL3N0aWNrZXIvJHtzdnN0fS53ZWJwYCwgZGVsYikKCQkJCWZzLndyaXRlRmlsZVN5bmMoJy4vbWVkaWEvc3RpY2suanNvbicsIEpTT04uc3RyaW5naWZ5KHNldGlrZXIpKQoJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBgU3Vrc2VzIE1lbmFtYmFoa2FuIFN0aWNrZXJcbkNlayBkZW5nYW4gY2FyYSAke3ByZWZpeH1saXN0c3RpY2tlcmAsIE1lc3NhZ2VUeXBlLnRleHQsIHsgcXVvdGVkOiBmdG9rbyB9KQoJCQkJYnJlYWsKCQkJY2FzZSAnYWRkdm4nOgoJCQkJaWYgKCFpc1F1b3RlZEF1ZGlvKSByZXR1cm4gcmVwbHkoJ1JlcGx5IHZubnlhIGJsb2trIScpCgkJCQlzdnN0ID0gYXJncy5qb2luKCcgJykKCQkJCWlmICghc3ZzdCkgcmV0dXJuIHJlcGx5KCdOYW1hIGF1ZGlvbnlhIGFwYSBzdT8nKQoJCQkJYm9paiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywgJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvCgkJCQlkZWxiID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZE1lZGlhTWVzc2FnZShib2lqKQoJCQkJYXVkaW9ueWUucHVzaChgJHtzdnN0fWApCgkJCQlmcy53cml0ZUZpbGVTeW5jKGAuL3NyYy9hdWRpby8ke3N2c3R9Lm1wM2AsIGRlbGIpCgkJCQlmcy53cml0ZUZpbGVTeW5jKCcuL3NyYy9hdWRpby5qc29uJywgSlNPTi5zdHJpbmdpZnkoYXVkaW9ueWUpKQoJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBgU3Vrc2VzIE1lbmFtYmFoa2FuICBWblxuQ2VrIGRlbmdhbiBjYXJhICR7cHJlZml4fWxpc3R2bmAsIE1lc3NhZ2VUeXBlLnRleHQsIHsgcXVvdGVkOiBmdG9rbyB9KQoJCQkJYnJlYWsKCQkJY2FzZSAnbGlzdHZuJzoKCQkJY2FzZSAndm5saXN0JzoKCQkJCXRla3MgPSAnKkxpc3QgVm46KlxuXG4nCgkJCQlmb3IgKGxldCBhd29rd2t3ayBvZiBhdWRpb255ZSkgewoJCQkJCXRla3MgKz0gYC0gJHthd29rd2t3a31cbmAKCQkJCX0KCQkJCXRla3MgKz0gYFxuKlRvdGFsIDogJHthdWRpb255ZS5sZW5ndGh9KmAKCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgdGVrcy50cmltKCksIGV4dGVuZGVkVGV4dCwgeyBxdW90ZWQ6IGZ0b2tvLCBjb250ZXh0SW5mbzogeyAibWVudGlvbmVkSmlkIjogYXVkaW9ueWUgfSB9KQoJCQkJYnJlYWsKCQkJY2FzZSAnYWRkaW1hZ2UnOgoJCQkJaWYgKCFpc1F1b3RlZEltYWdlKSByZXR1cm4gcmVwbHkoJ1JlcGx5IGltYWdlbnlhIGJsb2trIScpCgkJCQlzdnN0ID0gYXJncy5qb2luKCcgJykKCQkJCWlmICghc3ZzdCkgcmV0dXJuIHJlcGx5KCdOYW1hIGltYWdlbnlhIGFwYSBzdT8nKQoJCQkJYm9paiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywgJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvCgkJCQlkZWxiID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZE1lZGlhTWVzc2FnZShib2lqKQoJCQkJaW1hZ2VueWUucHVzaChgJHtzdnN0fWApCgkJCQlmcy53cml0ZUZpbGVTeW5jKGAuL3NyYy9pbWFnZS8ke3N2c3R9LmpwZWdgLCBkZWxiKQoJCQkJZnMud3JpdGVGaWxlU3luYygnLi9zcmMvaW1hZ2UuanNvbicsIEpTT04uc3RyaW5naWZ5KGltYWdlbnllKSkKCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYFN1a3NlcyBNZW5hbWJhaGthbiBWaWRlb1xuQ2VrIGRlbmdhbiBjYXJhICR7cHJlZml4fWxpc3RpbWFnZWAsIE1lc3NhZ2VUeXBlLnRleHQsIHsgcXVvdGVkOiBmdG9rbyB9KQoJCQkJYnJlYWsKCQkJY2FzZSAnZ2V0aW1hZ2UnOgoJCQkJbmFtYXN0YyA9IGFyZ3Muam9pbignICcpCgkJCQlidWZmZXIgPSBmcy5yZWFkRmlsZVN5bmMoYC4vc3JjL2ltYWdlLyR7bmFtYXN0Y30uanBlZ2ApCgkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGJ1ZmZlciwgaW1hZ2UsIHsgcXVvdGVkOiBmdG9rbywgY2FwdGlvbjogYFJlc3VsdCBGcm9tIERhdGFiYXNlIDogJHtuYW1hc3RjfS5qcGVnYCB9KQoJCQkJYnJlYWsKCQkJY2FzZSAnaW1hZ2VsaXN0JzoKCQkJY2FzZSAnbGlzdGltYWdlJzoKCQkJCXRla3MgPSAnKkxpc3QgSW1hZ2UgOipcblxuJwoJCQkJZm9yIChsZXQgYXdva3drd2sgb2YgaW1hZ2VueWUpIHsKCQkJCQl0ZWtzICs9IGAtICR7YXdva3drd2t9XG5gCgkJCQl9CgkJCQl0ZWtzICs9IGBcbipUb3RhbCA6ICR7aW1hZ2VueWUubGVuZ3RofSpgCgkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIHRla3MudHJpbSgpLCBleHRlbmRlZFRleHQsIHsgcXVvdGVkOiBmdG9rbywgY29udGV4dEluZm86IHsgIm1lbnRpb25lZEppZCI6IGltYWdlbnllIH0gfSkKCQkJCWJyZWFrCgkJCWNhc2UgJ2FkZHZpZGVvJzoKCQkJCXN2c3QgPSBhcmdzLmpvaW4oJyAnKQoJCQkJaWYgKCFzdnN0KSByZXR1cm4gcmVwbHkoJ05hbWEgdmlkZW9ueWEgYXBhIHN1PycpCgkJCQlib2lqID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzYW0pLnJlcGxhY2UoJ3F1b3RlZE0nLCAnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8KCQkJCWRlbGIgPSBhd2FpdCBzYW11MzMwLmRvd25sb2FkTWVkaWFNZXNzYWdlKGJvaWopCgkJCQl2aWRlb255ZS5wdXNoKGAke3N2c3R9YCkKCQkJCWZzLndyaXRlRmlsZVN5bmMoYC4vc3JjL3ZpZGVvLyR7c3ZzdH0ubXA0YCwgZGVsYikKCQkJCWZzLndyaXRlRmlsZVN5bmMoJy4vc3JjL3ZpZGVvLmpzb24nLCBKU09OLnN0cmluZ2lmeSh2aWRlb255ZSkpCgkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGBTdWtzZXMgTWVuYW1iYWhrYW4gVmlkZW9cbkNlayBkZW5nYW4gY2FyYSAke3ByZWZpeH1saXN0dmlkZW9gLCBNZXNzYWdlVHlwZS50ZXh0LCB7IHF1b3RlZDogZnRva28gfSkKCQkJCWJyZWFrCgkJCWNhc2UgJ2dldHZpZGVvJzoKCQkJCW5hbWFzdGMgPSBhcmdzLmpvaW4oJyAnKQoJCQkJYnVmZmVyID0gZnMucmVhZEZpbGVTeW5jKGAuL3NyYy92aWRlby8ke25hbWFzdGN9Lm1wNGApCgkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGJ1ZmZlciwgdmlkZW8sIHsgbWltZXR5cGU6ICd2aWRlby9tcDQnLCBxdW90ZWQ6IGZ0b2tvIH0pCgkJCQlicmVhawoJCQljYXNlICd2aWRlb2xpc3QnOgoJCQljYXNlICdsaXN0dmlkZW8nOgoJCQkJdGVrcyA9ICcqTGlzdCBWaWRlbyA6KlxuXG4nCgkJCQlmb3IgKGxldCBhd29rd2t3ayBvZiB2aWRlb255ZSkgewoJCQkJCXRla3MgKz0gYC0gJHthd29rd2t3a31cbmAKCQkJCX0KCQkJCXRla3MgKz0gYFxuKlRvdGFsIDogJHt2aWRlb255ZS5sZW5ndGh9KmAKCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgdGVrcy50cmltKCksIGV4dGVuZGVkVGV4dCwgeyBxdW90ZWQ6IGZ0b2tvLCBjb250ZXh0SW5mbzogeyAibWVudGlvbmVkSmlkIjogdmlkZW9ueWUgfSB9KQoJCQkJYnJlYWsKCQkJY2FzZSAnbGVhdmUnOgoJCQkgICAKCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgJ0J5ZWVlZSBrYXdhbm4nLCBNZXNzYWdlVHlwZS50ZXh0KQoJCQkJYW51ID0gYXdhaXQgc2FtdTMzMC5ncm91cExlYXZlKGZyb20sICdTZWUgeW91Li4uLi4uLi4nLCBncm91cElkKQoJCQkJYnJlYWsKCQkJY2FzZSAnY2hhdGxpc3QnOgoJCQkJc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCgkJCQl0ZWtzID0gYFRvdGFsIDogJHt0b3RhbGNoYXQubGVuZ3RofWAKCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgdGVrcywgdGV4dCwge3F1b3RlZDpmZG9jfSkKCQkJCWJyZWFrCgpjYXNlICdwaW5nJzoKCQkJCXZhciBncm91cHMgPSBzYW11MzMwLmNoYXRzLmFycmF5LmZpbHRlcih2ID0+IHYuamlkLmVuZHNXaXRoKCdnLnVzJykpCgkJCQl2YXIgcHJpdmF0ID0gc2FtdTMzMC5jaGF0cy5hcnJheS5maWx0ZXIodiA9PiB2LmppZC5lbmRzV2l0aCgncy53aGF0c2FwcC5uZXQnKSkKCQkJCXZhciByYW0yID0gYCR7KHByb2Nlc3MubWVtb3J5VXNhZ2UoKS5oZWFwVXNlZCAvIDEwMjQgLyAxMDI0KS50b0ZpeGVkKDIpfU1CIC8gJHtNYXRoLnJvdW5kKHJlcXVpcmUoJ29zJykudG90YWxtZW0gLyAxMDI0IC8gMTAyNCl9TUJgCgkJCQkJdXB0aW1lID0gcHJvY2Vzcy51cHRpbWUoKTsKCQkJCQljb25zdCB0aW1lc3RhbXAgPSBzcGVlZCgpOwoJCQkJCWNvbnN0IHRvdGFsQ2hhdCA9IGF3YWl0IHNhbXUzMzAuY2hhdHMuYWxsKCkKCQkJCQljb25zdCBsYXRlbnNpID0gc3BlZWQoKSAtIHRpbWVzdGFtcAoJCQkJCXZhciB0b3RhbCA9IG1hdGgoYCR7Z3JvdXBzLmxlbmd0aH0qJHtwcml2YXQubGVuZ3RofWApCgkJCQkJdGVrcyA9IGBfUG9uZ18geERcbipFU1RBRElTVElDQVMgREVMIEJPVDoqXG4qLSBHcm91cCBDaGF0cyA6KiAke2dyb3Vwcy5sZW5ndGh9XG4qLSBQcml2YXRlIENoYXRzIDoqICR7cHJpdmF0Lmxlbmd0aH1cbiotIFRvdGFsIENoYXRzIDoqICR7dG90YWxDaGF0Lmxlbmd0aH1cbiotIFNwZWVkIDoqICR7bGF0ZW5zaS50b0ZpeGVkKDQpfSBfU2Vjb25kX1xuKi0gQWN0aXZlIFRpbWUgOiogJHtreXVuKHVwdGltZSl9XG5cbipQSE9ORSBTVEFUSVNUSUNTOipcbiotIO2gve2zsUNhcGFjaWRhZCBkZSBSYW0gOiogJHtyYW0yfVxuKi0g7aC97bK7UGxhdGFmb3JtYSA6KiAke29zLnBsYXRmb3JtKCl9XG4qLSDtoLztvJBIb3N0bmFtZSA6KiAke29zLmhvc3RuYW1lKCl9XG4qLSDtoL3ttZBVcHRpbWUgOiogJHtreXVuKG9zLnVwdGltZSgpKX1cbiotIO2gvu26gFdhIFZlcnNpb246KiAke3NhbXUzMzAudXNlci5waG9uZS53YV92ZXJzaW9ufVxuKi0g7aC97bOhT3MgVmVyc2lvbjoqICR7c2FtdTMzMC51c2VyLnBob25lLm9zX3ZlcnNpb259XG4qLSDtoL3ttJBEZXZpY2UgTWFudWZhY3R1cmVyOiogJHtzYW11MzMwLnVzZXIucGhvbmUuZGV2aWNlX21hbnVmYWN0dXJlcn1cbiotIO2gve2zskRldmljZSBNb2RlbDoqICR7c2FtdTMzMC51c2VyLnBob25lLmRldmljZV9tb2RlbH1cbiotIO2gvu23rE9zIEJ1aWxkIE51bWJlcjoqICR7c2FtdTMzMC51c2VyLnBob25lLm9zX2J1aWxkX251bWJlcn1gCgkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCB0ZWtzLCB0ZXh0LCB7cXVvdGVkOiBmZG9jLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9fSkKYnJlYWsKCQkJY2FzZSAnJCc6CgkJCQljb25zdCBjbWQgPSBhcmdzLmpvaW4oJyAnKQoJCQkJZXhlYyhjbWQsIChlcnIsIHN0ZG91dCkgPT4gewoJCQkJCWlmIChlcnIpIHJldHVybiBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGAke2Vycn1gLCB0ZXh0LCB7IHF1b3RlZDogZnRva28gfSkKCQkJCQlpZiAoc3Rkb3V0KSB7CgkJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgc3Rkb3V0LCB0ZXh0LCB7IHF1b3RlZDpmdG9rb30pCgkJCQkJfQoJCQkJfSkKCQkJCWJyZWFrCgkJCQoJCQljYXNlICdibG9ja2xpc3QnOgoJCQkJdGVrcyA9ICftoLXtt5XtoLXtt5/toLXtt6LtoLXtt5btoLXtt54g7aC17bef7aC17bec7aC17bem7aC17benIDpcbicKCQkJCWZvciAobGV0IGJsb2NrIG9mIGJsb2NrZWQpIHsKCQkJCQl0ZWtzICs9IGAtIEAke2Jsb2NrLnNwbGl0KCdAJylbMF19XG5gCgkJCQl9CgkJCQl0ZWtzICs9IGDtoLXtt6ftoLXtt7ztoLXtuIHtoLXtt67toLXtt7kgOiAke2Jsb2NrZWQubGVuZ3RofWAKCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgdGVrcy50cmltKCksIGV4dGVuZGVkVGV4dCwgeyBxdW90ZWQ6IGZ0b2tvLCBjb250ZXh0SW5mbzogeyAibWVudGlvbmVkSmlkIjogYmxvY2tlZCB9IH0pCgkJCQlicmVhawoJCQljYXNlICdvY3InOgoJCQkJaWYgKChpc01lZGlhICYmICFzYW0ubWVzc2FnZS52aWRlb01lc3NhZ2UgfHwgaXNRdW90ZWRJbWFnZSkgJiYgYXJncy5sZW5ndGggPT0gMCkgewoJCQkJCWNvbnN0IGVuY21lZGlhID0gaXNRdW90ZWRJbWFnZSA/IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywgJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvIDogc2FtCgkJCQkJY29uc3QgbWVkaWEgPSBhd2FpdCBzYW11MzMwLmRvd25sb2FkQW5kU2F2ZU1lZGlhTWVzc2FnZShlbmNtZWRpYSkKCQkJCQlyZXBseShtZXNzLndhaXQpCgkJCQkJYXdhaXQgcmVjb2duaXplKG1lZGlhLCB7IGxhbmc6ICdlbmcraW5kJywgb2VtOiAxLCBwc206IDMgfSkKCQkJCQkJLnRoZW4odGVrcyA9PiB7CgkJCQkJCQlyZXBseSh0ZWtzLnRyaW0oKSkKCQkJCQkJCWZzLnVubGlua1N5bmMobWVkaWEpCgkJCQkJCX0pCgkJCQkJCS5jYXRjaChlcnIgPT4gewoJCQkJCQkJcmVwbHkoZXJyLm1lc3NhZ2UpCgkJCQkJCQlmcy51bmxpbmtTeW5jKG1lZGlhKQoJCQkJCQl9KQoJCQkJfSBlbHNlIHsKCQkJCQlyZXBseSgnRW52aWVuIHVuYSBpbWFnZW4gY29uIGVsIGNvbWFuZG86ICR7cHJlZml4fe2gte23vO2gte23sO2gte23vycpCgkJCQl9CgkJCQlicmVhawoKCQkJCgkJCQljYXNlICdiYXRyZWknOgoJCQkJIGNhc2UgJ2JhdHRyZXknOgogICAgICAgICBsZXQgYmF0cmVpTm93ID0gZ2xvYmFsLmJhdHJlaVtnbG9iYWwuYmF0cmVpLmxlbmd0aCAtIDFdCiAgICAgICAgIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYCR7YmF0cmVpTm93fSVgLCB0ZXh0KQogICAgICAgICBicmVhawoJCQljYXNlICd0dHMnOgoJCQkJY2FzZSAndm96JzoKCQkJCQlpZiAoYXJncy5sZW5ndGggPCAxKSByZXR1cm4gc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCAnWSBlbCBjb2RpZ28gZGUgaWRpb21hPyBlc2NyaWJlIGVsIGNvbWFuZG8gKmlkaW9tYXMqIHBhcmEgdmVyIGxhIGxpc3RhJywgdGV4dCwgeyBxdW90ZWQ6IGZha2VQcm9kdWN0IH0pCgkJCQkJY29uc3QgZ3R0cyA9IHJlcXVpcmUoJy4vbGliL2d0dHMnKShhcmdzWzBdKQoJCQkJCWlmIChhcmdzLmxlbmd0aCA8IDIpIHJldHVybiBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sICdFc2NyaWJlIGVsIHRleHRvJywgdGV4dCwge3F1b3RlZDogbWVrfSkKCQkJCQlkdHQgPSBib2R5LnNsaWNlKDgpCgkJCQkJcmFubSA9IGdldFJhbmRvbSgnLm1wMycpCgkJCQkJcmFubyA9IGdldFJhbmRvbSgnLm9nZycpCgkJCQkJZHR0Lmxlbmd0aCA+IDMwMAoJCQkJCT8gcmVwbHkoJ01pcmEsIHNpIG5vIHNhYmVzIHVzYXIgZXN0by4uLiBtZWpvciBubyBsbyBhZ2FzIO2gve24pCcpCgkJCQkJOiBndHRzLnNhdmUocmFubSwgZHR0LCBmdW5jdGlvbigpIHsKCQkJCQkJc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5yZWNvcmRpbmcpCgkJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgZnMucmVhZEZpbGVTeW5jKHJhbm0pLCBhdWRpbywge3F1b3RlZDogZmFrZVByb2R1Y3QsIG1pbWV0eXBlOiAnYXVkaW8vbXA0JywgZHVyYXRpb246IC05OTk5OTk5OTk5OTk5OTk5OTksIHB0dDp0cnVlLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9fSkKCQkJCQkJZnMudW5saW5rU3luYyhyYW5tKQoJCQkJCX0pCgkJCQkJYnJlYWsKCQkJCQoJCQljYXNlICdzZXRwcmVmaXgnOgoJCQkJCWlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybgoJCQkJCWlmICghaXNPd25lcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5vd25lckIpCgkJCQkgIHByZWZpeCA9IGFyZ3NbMF0KCQkJCQlzYW11LnByZWZpeCA9IHByZWZpeAoJCQkJCWZzLndyaXRlRmlsZVN5bmMoJy4vZGF0YS9zZXR0aW5ncy5qc29uJywgSlNPTi5zdHJpbmdpZnkodXAsIG51bGwsICdcdCcpKQoJCQkJCXJlcGx5KGBQcmVmaWpvIGNhbWJpYWRvIDogJHtwcmVmaXh9YCkKCQkJCQlicmVhawoJCQljYXNlICdzZXRvd24nOgoJCQkJCWlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybgoJCQkJCWlmICghaXNPd25lcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5vd25lckIpCgkJCQkgIG93biA9IGFyZ3NbMF0KCQkJCQlzYW11LnByZWZpeCA9IG93bgoJCQkJCWZzLndyaXRlRmlsZVN5bmMoJy4vZGF0YS9zZXR0aW5ncy5qc29uJywgSlNPTi5zdHJpbmdpZnkodXAsIG51bGwsICdcdCcpKQoJCQkJCXJlcGx5KGBFbCBvd25lciBkZWwgYm90IGFob3JhIGVzIDogJHtvd259YCkKCQkJCQlicmVhawoJCQljYXNlICdzZXR0YXJnZXQnOgoJCQkJaWYgKGFyZ3MubGVuZ3RoIDwgMSkgcmV0dXJuCgkJCQl0YXJnZXRwcml2YXRlID0gYXJnc1swXQoJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBgdGFyZ2V0IFByaXZhdGUgRmFrZSBSZXBseSA6ICR7dGFyZ2V0cHJpdmF0ZX1gLCB0ZXh0LCB7cXVvdGVkOmZkb2N9KQoJCQkJYnJlYWsKCQkJY2FzZSAnYWxsJzoKc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCmlmICghaXNHcm91cCkgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5ncm91cCkKaWYgKCFpc1JlZ2lzdGVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmRhZnRhckIpCmlmICghaXNHcm91cEFkbWlucykgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5hZG1pbikKbWVtYmVyc19pZCA9IFtdCnRla3MgPSAoYXJncy5sZW5ndGggPiAxKSA/IGJvZHkuc2xpY2UoOCkudHJpbSgpOiAnJwp0ZWtzICs9IGAgIFRvdGFsIDogJHtncm91cE1lbWJlcnMubGVuZ3RofVxuYApmb3IgKGxldCBtZW0gb2YgZ3JvdXBNZW1iZXJzKSB7CiAgdGVrcyArPSBg4pSDIEAke21lbS5qaWQuc3BsaXQoJ0AnKVswXX1cbmAKICBtZW1iZXJzX2lkLnB1c2gobWVtLmppZCkKfQptZW50aW9ucygn44CYICAqVEFHQUxMKiDjgJlcbuKUj+KUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgVxu4pSg4oq3Jyt0ZWtzKyfilIPilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIFcbuKUg+KUgOKUgOKUgOKUgOKchVNhbXUzMzDtoLztv4bilIDilIDilIDilIBcbuKUl+KUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgScsIG1lbWJlcnNfaWQsIHRydWUpCmJyZWFrCgkJCWNhc2UgJ2NsZWFyYWxsJzoKCQkJCWlmICghaXNPd25lcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5vd25lckIpCgkJCQlhbnUgPSBhd2FpdCBzYW11MzMwLmNoYXRzLmFsbCgpCgkJCQlzYW11MzMwLnNldE1heExpc3RlbmVycygyNSkKCQkJCWZvciAobGV0IF8gb2YgYW51KSB7CgkJCQkJc2FtdTMzMC5kZWxldGVDaGF0KF8uamlkKQoJCQkJfQoJCQkJcmVwbHkoJ1RPRE9TIExPUyBDSEFUUyBMSU1QSU9TJykKCQkJCWJyZWFrCgkJCQljYXNlICdibG9jayc6CiAgc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCiAgaWYgKCFpc0dyb3VwKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5Lmdyb3VwKQogIGlmICghaXNPd25lcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5vd25lckIpCiAgc2FtdTMzMC5ibG9ja1VzZXIgKGAke2JvZHkuc2xpY2UoOCl9QGMudXNgLCAiYWRkIikKICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGBVc3VhcmlvIGJsb3F1ZWFkb2AsIHRleHQsIHsKcXVvdGVkOiBzYW0KICB9KQogIGJyZWFrCgkJCQljYXNlICd1bmJsb2NrJzoKICBpZiAoIWlzR3JvdXApIHJldHVybiByZXBseShtZXNzLm9ubHkuZ3JvdXApCiAgaWYgKCFpc093bmVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5Lm93bmVyQikKICBzYW11MzMwLmJsb2NrVXNlciAoYCR7Ym9keS5zbGljZSg5KX1AYy51c2AsICJyZW1vdmUiKQogIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYFVzdWFyaW8gZGVzYmxvcXVlYWRvYCwgdGV4dCkKICBicmVhawoJCQkJCgkJCQljYXNlICdiYW4nOgoJCQkJCWlmICghaXNPd25lcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5vd25lckIpCgkJCQkJYm5uZCA9IGJvZHkuc2xpY2UoNikKCQkJCQliYW4ucHVzaChgJHtibm5kfUBzLndoYXRzYXBwLm5ldGApCgkJCQkJZnMud3JpdGVGaWxlU3luYygnLi9zcmMvYmFubmVkLmpzb24nLCBKU09OLnN0cmluZ2lmeShiYW4pKQoJCQkJCXJlcGx5KGBFbCB1c3VhcmlvIHdhLm1lLyR7Ym5uZH0gYSBzaWRvIGJhbmVhZG8gIWApCgkJCQkJYnJlYWsKCQkJCWNhc2UgJ3VuYmFuJzoKCQkJCQlpZiAoIWlzT3duZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkub3duZXJCKQoJCQkJCWJubmQgPSBib2R5LnNsaWNlKDgpCgkJCQkJYmFuLnNwbGljZShgJHtibm5kfUBzLndoYXRzYXBwLm5ldGAsIDEpCgkJCQkJZnMud3JpdGVGaWxlU3luYygnLi9zcmMvYmFubmVkLmpzb24nLCBKU09OLnN0cmluZ2lmeShiYW4pKQoJCQkJCXJlcGx5KGBFbCB1c3VhcmlvICp3YS5tZS8ke2JubmR9KiBhIHNpZG8gZGVzYmFuZWFkbyFgKQoJCQkJCWJyZWFrCgkJCQkKCQkJCWNhc2UgJ2FkZHByZW0nOgoJCQkJCWlmICghaXNPd25lcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5vd25lckIpCgkJCQkJYWRkcCA9IGJvZHkuc2xpY2UoMTApCgkJCQkJcHJlbWl1bS5wdXNoKGAke2FkZHB9QHMud2hhdHNhcHAubmV0YCkKCQkJCQlmcy53cml0ZUZpbGVTeW5jKCcuL3NyYy9wcmVtaXVtLmpzb24nLCBKU09OLnN0cmluZ2lmeShwcmVtaXVtKSkKCQkJCQlyZXBseShgRWwgdXN1YXJpbyAqd2EubWUvJHthZGRwfSogYWhvcmEgZXMgXypwcmVtaXVtKl9gKQoJCQkJCWJyZWFrCgkJCQljYXNlICdkZWxscHJlbSc6CgkJCQkJaWYgKCFpc093bmVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5Lm93bmVyQikKCQkJCQlkZWxwID0gYm9keS5zbGljZSgxMSkKCQkJCQlwcmVtaXVtLnNwbGljZShgJHtkZWxwfUBzLndoYXRzYXBwLm5ldGAsIDEpCgkJCQkJZnMud3JpdGVGaWxlU3luYygnLi9zcmMvcHJlbWl1bS5qc29uJywgSlNPTi5zdHJpbmdpZnkocHJlbWl1bSkpCgkJCQkJcmVwbHkoYEVsIHVzdWFyaW8gKndhLm1lLyR7ZGVscH0qIHlhIG5vIGVzIHByZW1pdW0gXypwcmVtaXVtKl9gKQoJCQkJCWJyZWFrCQoJCQkJCgkJCWNhc2UgJ2xlYXZlJzoKCQkJCWlmICghaXNHcm91cCkgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5ncm91cCkKCQkJCXNhbXUzMzAuc2FtdTMzMC5sZWF2ZUdyb3VwKGZyb20sICdOb3MgdmVtb3MsIGRlIGx1Z2FyZXMgbWVqb3JlcyBtZSBhbiBjb3JyaWRv7aC+7bWxJywgTWVzc2FnZVR5cGUudGV4dCkKCQkJCWF3YWl0IHNhbXUzMzAuc2FtdTMzMC5sZWF2ZUdyb3VwKGZyb20sICftoLXtt5XtoLXtuIbtoLXtt7LtoLXtt7InLCBncm91cElkKQoJCQkJYnJlYWsKCQkJY2FzZSAnYmMnOgoJCQkJCWlmICghaXNPd25lcikgcmV0dXJuIHJlcGx5KCdTb2xvICpTYW11KiBwdWVkZSB1c2FyIGVzdGUgY29tYW5kbycpCgkJCQkJaWYgKGFyZ3MubGVuZ3RoIDwgMSkgcmV0dXJuIHJlcGx5KCdZIGVsIGFudW5jaW8/JykKCQkJCQlhbnUgPSBhd2FpdCBzYW11MzMwLmNoYXRzLmFsbCgpCgkJCQkJaWYgKGlzTWVkaWEgJiYgIXNhbS5tZXNzYWdlLnZpZGVvTWVzc2FnZSB8fCBpc1F1b3RlZEltYWdlKSB7CgkJCQkJCWNvbnN0IGVuY21lZGlhID0gaXNRdW90ZWRJbWFnZSA/IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8gOiBmZG9jCgkJCQkJCWJ1ZmYgPSBhd2FpdCBzYW11MzMwLmRvd25sb2FkTWVkaWFNZXNzYWdlKGVuY21lZGlhKQoJCQkJCQlmb3IgKGxldCBfIG9mIGFudSkgewoJCQkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShfLmppZCwgYnVmZiwgaW1hZ2UsIHtjYXB0aW9uOiBgKiR7Ym9keS5zbGljZSg0KX0qXG4gzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PwrDtoLXtsantoLXtsbntoLXtsbbtoLXtsajtoLXtsavtoLXtsartoLXtsajtoLXtsbrtoLXtsbvCsGB9KQoJCQkJCQl9CgkJCQkJCXJlcGx5KCdBbnVuY2lvIGRhZG8nKQoJCQkJCX0gZWxzZSB7CgkJCQkJCWZvciAobGV0IF8gb2YgYW51KSB7CgkJCQkJCQlzZW5kTWVzcyhfLmppZCwgYCoke2JvZHkuc2xpY2UoNCl9KmApCgkJCQkJCX0KCQkJCQkJcmVwbHkoJ0FudW5jaW8gZGFkbycpCgkJCQkJfQoJCQkJCWJyZWFrCgkJCWNhc2UgJ2HDsWFkaXInOgoJCQkJaWYgKCFpc0dyb3VwKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5Lmdyb3VwKQoJCQkJaWYgKCFpc0JvdEdyb3VwQWRtaW5zKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LkJhZG1pbikKCQkJCWlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybiByZXBseSgnWSBlbCBudW1lcm8/JykKCQkJCWlmIChhcmdzWzBdLnN0YXJ0c1dpdGgoJzA4JykpIHJldHVybiByZXBseSgnVXRpbGl6YSBlbCBjb2RpZ28gZGUgcGFpcycpCgkJCQl0cnkgewoJCQkJCW51bSA9IGAke2FyZ3NbMF0ucmVwbGFjZSgvIC9nLCAnJyl9QHMud2hhdHNhcHAubmV0YAoJCQkJCXNhbXUzMzAuZ3JvdXBBZGQoZnJvbSwgW251bV0pCgkJCQl9IGNhdGNoIChlKSB7CgkJCQkJY29uc29sZS5sb2coJ0Vycm9yIDonLCBlKQoJCQkJCXJldHVybiBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sICdNb2RvIHByaXZhZG8gZGljZTp2JywgTWVzc2FnZVR5cGUudGV4dCkKCQkJCX0KCQkJCWJyZWFrCgkJCQkKCQkJCWNhc2UgJ2tpY2snOgoJCQkJY2FzZSAnZWxpbWluYXInOgoJCQkJCWlmICghaXNHcm91cCkgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5ncm91cCkKCQkJCQlpZiAoIWlzR3JvdXBBZG1pbnMpIHJldHVybiByZXBseShtZXNzLm9ubHkuYWRtaW4pCgkJCQkJaWYgKCFpc0JvdEdyb3VwQWRtaW5zKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LkJhZG1pbikKCQkJCQlpZiAoc2FtLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZSA9PT0gdW5kZWZpbmVkIHx8IHNhbS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UgPT09IG51bGwpIHJldHVybiByZXBseSgnVGFnIHRhcmdldCcpCgkJCQkJbWVudGlvbmVkID0gc2FtLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mby5tZW50aW9uZWRKaWQKCQkJCQlpZiAobWVudGlvbmVkLmxlbmd0aCA+IDEpIHsKCQkJCQkJdGVrcyA9ICdPcmRlbiByZWNpYmlkYSA6XG4nCgkJCQkJCWZvciAobGV0IF8gb2YgbWVudGlvbmVkKSB7CgkJCQkJCQl0ZWtzICs9IGBAJHtfLnNwbGl0KCdAJylbMF19XG5gCgkJCQkJCX0KCQkJCQkJbWVudGlvbnModGVrcywgbWVudGlvbmVkLCB0cnVlKQoJCQkJCQlzYW11MzMwLmdyb3VwUmVtb3ZlKGZyb20sIG1lbnRpb25lZCkKCQkJCQl9IGVsc2UgewoJCQkJCQltZW50aW9ucyhgU2UgZWxpbWlubyBhIDogQCR7bWVudGlvbmVkWzBdLnNwbGl0KCdAJylbMF19YCwgbWVudGlvbmVkLCB0cnVlKQoJCQkJCQlzYW11MzMwLmdyb3VwUmVtb3ZlKGZyb20sIG1lbnRpb25lZCkKCQkJCQl9CgkJCQkJYnJlYWsKCQkJY2FzZSAncHJvbW90ZSc6CgkJCQkJaWYgKCFpc0dyb3VwKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5Lmdyb3VwKQoJCQkJCWlmICghaXNHcm91cEFkbWlucykgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5hZG1pbikKCQkJCQlpZiAoIWlzQm90R3JvdXBBZG1pbnMpIHJldHVybiByZXBseShtZXNzLm9ubHkuQmFkbWluKQoJCQkJCWlmIChzYW0ubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlID09PSB1bmRlZmluZWQgfHwgc2FtLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZSA9PT0gbnVsbCkgcmV0dXJuCgkJCQkJbWVudGlvbmVkID0gc2FtLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mby5tZW50aW9uZWRKaWQKCQkJCQlpZiAobWVudGlvbmVkLmxlbmd0aCA+IDEpIHsKCQkJCQkJdGVrcyA9ICdDb24gZXhpdG8gXG4nCgkJCQkJCWZvciAobGV0IF8gb2YgbWVudGlvbmVkKSB7CgkJCQkJCQl0ZWtzICs9IGBAJHtfLnNwbGl0KCdAJylbMF19XG5gCgkJCQkJCX0KCQkJCQkJbWVudGlvbnMoZnJvbSwgbWVudGlvbmVkLCB0cnVlKQoJCQkJCQlzYW11MzMwLmdyb3VwUmVtb3ZlKGZyb20sIG1lbnRpb25lZCkKCQkJCQl9IGVsc2UgewoJCQkJCQltZW50aW9ucyhgQWhvcmEgQCR7bWVudGlvbmVkWzBdLnNwbGl0KCdAJylbMF19IGVzIGFkbWluIGRlbCBncnVwbyFgLCBtZW50aW9uZWQsIHRydWUpCgkJCQkJCXNhbXUzMzAuZ3JvdXBNYWtlQWRtaW4oZnJvbSwgbWVudGlvbmVkKQoJCQkJCX0KCQkJCQlicmVhawoJCQljYXNlICdkZW1vdGUnOgoJCQkJCWlmICghaXNHcm91cCkgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5ncm91cCkKCQkJCQlpZiAoIWlzR3JvdXBBZG1pbnMpIHJldHVybiByZXBseShtZXNzLm9ubHkuYWRtaW4pCgkJCQkJaWYgKCFpc0JvdEdyb3VwQWRtaW5zKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LkJhZG1pbikKCQkJCQlpZiAoc2FtLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZSA9PT0gdW5kZWZpbmVkIHx8IHNhbS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UgPT09IG51bGwpIHJldHVybgoJCQkJCW1lbnRpb25lZCA9IHNhbS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8ubWVudGlvbmVkSmlkCgkJCQkJaWYgKG1lbnRpb25lZC5sZW5ndGggPiAxKSB7CgkJCQkJCXRla3MgPSAnQWRtaW4gcXVpdGFkbyBjb24gZXhpdG9cbicKCQkJCQkJZm9yIChsZXQgXyBvZiBtZW50aW9uZWQpIHsKCQkJCQkJCXRla3MgKz0gYEAke18uc3BsaXQoJ0AnKVswXX1cbmAKCQkJCQkJfQoJCQkJCQltZW50aW9ucyh0ZWtzLCBtZW50aW9uZWQsIHRydWUpCgkJCQkJCXNhbXUzMzAuZ3JvdXBSZW1vdmUoZnJvbSwgbWVudGlvbmVkKQoJCQkJCX0gZWxzZSB7CgkJCQkJCW1lbnRpb25zKGBVbiBhZG1pIG1lbm9zIEAke21lbnRpb25lZFswXS5zcGxpdCgnQCcpWzBdfSDtoL7ttbEhYCwgbWVudGlvbmVkLCB0cnVlKQoJCQkJCQlzYW11MzMwLmdyb3VwRGVtb3RlQWRtaW4oZnJvbSwgbWVudGlvbmVkKQoJCQkJCX0KCQkJCQlicmVhawoJCQljYXNlICdsaXN0YWRtaW4nOgoJCQkJaWYgKCFpc0dyb3VwKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5Lmdyb3VwKQoJCQkJdmFyIGl0c21lID0gYCR7bnVtYmVybnllfUBzLndoYXRzYXBwLm5ldGAKCQkJCXZhciBzcGxpdCA9IGAke2Zha2V9YAoJCQkJdGVrcyA9IGDtoLXtt5/toLXtt7btoLXtuIDtoLXtuIEg7aC17beu7aC17bex7aC17be67aC17be27aC17be7IO2gte23vO2gte23syDtoLXtt7TtoLXtt7/toLXtt7ztoLXtuILtoLXtt70gKiR7Z3JvdXBNZXRhZGF0YS5zdWJqZWN0fSpcbu2gte23p+2gte23vO2gte24ge2gte23ru2gte23uSA6ICR7Z3JvdXBBZG1pbnMubGVuZ3RofVxuXG5gCgkJCQlubyA9IDAKCQkJCWZvciAobGV0IGFkbW9uIG9mIGdyb3VwQWRtaW5zKSB7CgkJCQkJbm8gKz0gMQoJCQkJCXRla3MgKz0gYFske25vLnRvU3RyaW5nKCl9XSBAJHthZG1vbi5zcGxpdCgnQCcpWzBdfVxuYAoJCQkJfQoJCQkJbWVudGlvbnModGVrcywgZ3JvdXBBZG1pbnMsIHRydWUpCgkJCQlicmVhawoJCQljYXNlICd0b2ltZyc6CgkJCQkJaWYgKCFpc1F1b3RlZFN0aWNrZXIpIHJldHVybiByZXBseSgnUG9yZmF2b3IgZXRpcXVldGEgdW4gc3RpY2tlcicpCgkJCQkJcmVwbHkobWVzcy53YWl0KQoJCQkJCWZha2VlID0gZnMucmVhZEZpbGVTeW5jKCcuL3NyYy9pbWcuanBnJykKCQkJCQllbmNtZWRpYSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywgJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvCgkJCQkJbWVkaWEgPSBhd2FpdCBzYW11MzMwLmRvd25sb2FkQW5kU2F2ZU1lZGlhTWVzc2FnZShlbmNtZWRpYSkKCQkJCQlyYW4gPSBnZXRSYW5kb20oJy5wbmcnKQoJCQkJCWV4ZWMoYGZmbXBlZyAtaSAke21lZGlhfSAke3Jhbn1gLCAoZXJyKSA9PiB7CgkJCQkJCWZzLnVubGlua1N5bmMobWVkaWEpCgkJCQkJCWlmIChlcnIpIHJldHVybiByZXBseSgn7aC97bmEJykKCQkJCQkJYnVmZmVyID0gZnMucmVhZEZpbGVTeW5jKHJhbikKCQkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBidWZmZXIsIGltYWdlLCB7IGNhcHRpb246ICdMaXN0bzpEJywgdGh1bWJuYWlsOiBmYWtlZSB9KQoJCQkJCQlmcy51bmxpbmtTeW5jKHJhbikKCQkJCQl9KTsKCQkJCWJyZWFrCgkJCWNhc2UgJ2Nsb25lJzoKCQkJCWlmICghaXNHcm91cCkgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5ncm91cCkKCQkJCWlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybiByZXBseSgnRXRpcXVldGEgYSBhbGd1aWVuIHBhcmEgdXRpbGl6YXIgc3UgZm90byEhIScpCgkJCQlpZiAoc2FtLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZSA9PT0gdW5kZWZpbmVkIHx8IHNhbS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UgPT09IG51bGwpIHJldHVybiByZXBseSgnRXRpcXVldGEgYSBhbGd1aWVuJykKCQkJCW1lbnRpb25lZCA9IHNhbS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8ubWVudGlvbmVkSmlkWzBdCgkJCQlsZXQge2ppZCwgaWQsIG5vdGlmeSB9ID0gZ3JvdXBNZW1iZXJzLmZpbmQoeCA9PiB4LmppZCA9PT0gbWVudGlvbmVkKQoJCQkJdHJ5IHsKCQkJCQlwcCA9IGF3YWl0IHNhbXUzMzAuZ2V0UHJvZmlsZVBpY3R1cmUoaWQpCgkJCQkJYnVmZmVyID0gYXdhaXQgZ2V0QnVmZmVyKHBwKQoJCQkJCXNhbXUzMzAudXBkYXRlUHJvZmlsZVBpY3R1cmUoYm90TnVtYmVyLCBidWZmZXIpCgkJCQkJbWVudGlvbnMoYExhIGZvdG8gZGUgcGVyZmlsIHNlIGFjdHVhbGl6w7MgY29ycmVjdGFtZW50ZSBjb24gbGEgZm90byBkZSBwZXJmaWwgZGU6IEAke2lkLnNwbGl0KCdAJylbMF19YCwgW2ppZF0sIHRydWUpCgkJCQl9IGNhdGNoIChlKSB7CgkJCQkJcmVwbHkobWVzcy5mZXJyKQoJCQkJfQoJCQkJYnJlYWsKCQkJY2FzZSAncXVlYW5pbWUnOgoJCQkJaWYgKChpc01lZGlhICYmICFzYW0ubWVzc2FnZS52aWRlb01lc3NhZ2UgfHwgaXNRdW90ZWRJbWFnZSkgJiYgYXJncy5sZW5ndGggPT0gMCkgewoJCQkJCXJlcGx5KG1lc3Mud2FpdCkKCQkJCQljb25zdCBlbmNtZWRpYSA9IGlzUXVvdGVkSW1hZ2UgPyBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkucmVwbGFjZSgncXVvdGVkTScsICdtJykpLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mbyA6IHNhbQoJCQkJCW1lZGlhID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZE1lZGlhTWVzc2FnZShlbmNtZWRpYSkKCQkJCQlhd2FpdCB3YWl0KG1lZGlhKS50aGVuKHJlcyA9PiB7CgkJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgcmVzLnZpZGVvLCB2aWRlbywgeyBxdW90ZWQ6IGZ0b2tvLCBjYXB0aW9uOiByZXMudGVrcy50cmltKCkgfSkKCQkJCQl9KS5jYXRjaChlcnIgPT4gewoJCQkJCQlyZXBseShlcnIpCgkJCQkJfSkKCQkJCX0gZWxzZSB7CgkJCQkJcmVwbHkoJ0VudmlhIGxhIG1hZ2VuIHBhcmEgcG9kZXIgYnVzY2FyIGVsIGFuaW1lJykKCQkJCX0KCQkJCWJyZWFrCgkJCQoJCQkJCWNhc2UgJ2l0c21lJzoKY2FzZSAnc295eW8nOgogIGlmICghaXNSZWdpc3RlcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5kYWZ0YXJCKQogIHRyeSB7CnBwaW1nID0gYXdhaXQgc2FtdTMzMC5nZXRQcm9maWxlUGljdHVyZShgJHtzZW5kZXIuc3BsaXQoJ0AnKVswXX1AYy51c2ApCiAgfSBjYXRjaCB7CnBwaW1nID0gJ2h0dHBzOi8vaTAud3AuY29tL3d3dy5nYW1iYXJ1bmlrLmlkL3dwLWNvbnRlbnQvdXBsb2Fkcy8yMDE5LzA2L1RvcC1HYW1iYXItRm90by1Qcm9maWwtS29zb25nLUx1Y3UtVGVyZ29raWwtLmpwZycKICB9CiAgdGVrcyA9IGDigKMgKk5vbWJyZSogOiAke3B1c2huYW1lfQogIOKAoyAqTsO6bWVybyogOiAke3NlbmRlci5zcGxpdCgiQCIpWzBdfQogIOKAoyAqTGluayogOiB3YS5tZS8ke3NlbmRlci5zcGxpdCgiQCIpWzBdfWAKICBpdHMgPSBhd2FpdCBnZXRCdWZmZXIgKHBwaW1nKQogIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgaXRzLCBpbWFnZSwgewpxdW90ZWQ6IGZsaXZlTG9jLCBjYXB0aW9uOiB0ZWtzLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfQogIH0pCiAgCiAgYnJlYWsKCQkgICAgIGNhc2UgJ25pbGFpJzoKCQkJCQkKY2FzZSAncmF0ZSc6CiAgaWYgKGFyZ3MubGVuZ3RoIDwgMSkgcmV0dXJuIHJlcGx5KCdFc2NyaWJlIGVsIG5vbWJyZScpCiAgc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCiAgaWYgKCFpc1JlZ2lzdGVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmRhZnRhckIpCiAgcmFuZG9tID0gYCR7TWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKX1gCiAgaGFzaWwgPSBgUmF0aW5nIDogKiR7Ym9keS5zbGljZSg2KX0qXG5cblBvcmNlbnRhamUgOiAqJHtyYW5kb219JSpgCiAgcmVwbHkoaGFzaWwpCiAgYnJlYWsKCQkJCQoJCQkJCQoJCQkKCQkJCQkKCQkJCQljYXNlICdwYXN0ZWJpbic6CmlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybiByZXBseSgnRXNjcmliZSBlbCB0ZXh0byBxdWUgc2UgbW9zdHJhcmEgZW4gcGFzdGViaW4uJykKCXBhc3RlID0gYCR7YXJncy5qb2luKCcgJyl9YApyZXBseShtZXNzLndhaXQpCglhbnUgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vYXBpLWFub25jeWJmYWtlcGxheWVyLmhlcm9rdWFwcC5jb20vcGFzdGViaW4/dGV4dD0ke3Bhc3RlfWAsIHttZXRob2Q6ICdnZXQnfSkKICAgICAgICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGAke2FudS5yZXN1bHR9YCwgdGV4dCwge3F1b3RlZDogZnRva28sIGNvbnRleHRJbmZvOiB7ImZvcndhcmRpbmdTY29yZSI6IDk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZX19KQogICAgICAgICAgICAgICAgICAgYnJlYWsKCmNhc2UgJ2FiaW5hcmlvJzoKaWYgKGFyZ3MubGVuZ3RoIDwgMSkgcmV0dXJuIHJlcGx5KCdFc2NyaWJlIGVsIHRleHRvIGEgY29udmVydGlyIGEgY29kaWdvIGJpbmFyaW8uJykKCQkJZW5jYmluYXJ5ID0gYCR7YXJncy5qb2luKCcgJyl9YAoJCQkJCWFudSA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkuYW5vbmN5YmZha2VwbGF5ZXIuY29tL2FwaS9iaW5hcnkvP2VuY29kZT0ke2VuY2JpbmFyeX1gLCB7bWV0aG9kOiAnZ2V0J30pCgkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBgJHthbnUucmVzdWx0fWAsIHRleHQsIHtxdW90ZWQ6IGZ0b2tvLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9fSkKCQkJCQlicmVhawpjYXNlICdiaW5hdGV4dCc6CmlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybiByZXBseSgnUG9yZmF2b3IsIHBlZ2EgbyBlc2NyaWJlIGVsIGNvZGlnbyBiaW5hcmlvIHBhcmEgY29udmVydGlyIGEgdGV4dG8uJykKCQkJCWRlY2JpbiA9IGAke2FyZ3Muam9pbignICcpfWAKCQkJCQlhbnUgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vYXBpLmFub25jeWJmYWtlcGxheWVyLmNvbS9hcGkvYmluYXJ5Lz9kZWNvZGU9JHtkZWNiaW59YCwge21ldGhvZDogJ2dldCd9KQoJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYCR7YW51LnJlc3VsdH1gLCB0ZXh0LCB7cXVvdGVkOiBmdG9rbywgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfX0pCgkJCQkJYnJlYWsKCmNhc2UgJ2FvY3RhbCc6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCmlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybiByZXBseSgnRXNjcmliZSBlbCB0ZXh0byBhIGNvbnZlcnRpciBhIGNvZGlnbyBvY3RhbC4nKSAgICAgICAgIAplbmNiaW5hcnkgPSBgJHthcmdzLmpvaW4oJyAnKX1gCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbnUgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vYXBpLmFub25jeWJmYWtlcGxheWVyLmNvbS9hcGkvb2N0YWwvP2VuY29kZT0ke2VuY2JpbmFyeX1gLCB7bWV0aG9kOiAnZ2V0J30pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBgJHthbnUucmVzdWx0fWAsIHRleHQsIHtxdW90ZWQ6IGZ0b2tvLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9fSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCmNhc2UgJ29jdGFsYXRleHQnOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAppZiAoYXJncy5sZW5ndGggPCAxKSByZXR1cm4gcmVwbHkoJ1BvcmZhdm9yLCBwZWdhIG8gZXNjcmliZSBlbCBjb2RpZ28gb2N0YWwgcGFyYSBjb252ZXJ0aXIgYSB0ZXh0by4nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlY2JpbiA9IGAke2FyZ3Muam9pbignICcpfWAgICAgICAgICAgICAgICAgICAgICAgICAKYW51ID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS5hbm9uY3liZmFrZXBsYXllci5jb20vYXBpL29jdGFsLz9kZWNvZGU9JHtkZWNiaW59YCwge21ldGhvZDogJ2dldCd9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBgJHthbnUucmVzdWx0fWAsIHRleHQsIHtxdW90ZWQ6IGZ0b2tvLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9fSkKCQlicmVhawoKY2FzZSAnYWhleCc6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAppZiAoYXJncy5sZW5ndGggPCAxKSByZXR1cm4gcmVwbHkoJ0VzY3JpYmUgZWwgdGV4dG8gYSBjb252ZXJ0aXIgYSBjb2RpZ28gaGV4LicpICAgICAgCmVuY2JpbmFyeSA9IGAke2FyZ3Muam9pbignICcpfWAgICAgICAgICAgICAgICAgCmFudSA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkuYW5vbmN5YmZha2VwbGF5ZXIuY29tL2FwaS9oZXgvP2VuY29kZT0ke2VuY2JpbmFyeX1gLCB7bWV0aG9kOiAnZ2V0J30pCnNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYCR7YW51LnJlc3VsdH1gLCB0ZXh0LCB7cXVvdGVkOiBmdG9rbywgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfX0pICAgICAgICAgICAgICAgICAgICAgCmJyZWFrCmNhc2UgJ2hleGF0ZXh0JzogICAgICAgICAgICAgICAgICAgICAgCmlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybiByZXBseSgnUG9yZmF2b3IsIHBlZ2EgbyBlc2NyaWJlIGVsIGNvZGlnbyBoZXggcGFyYSBjb252ZXJ0aXIgYSB0ZXh0by4nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlY2JpbiA9IGAke2FyZ3Muam9pbignICcpfWAgICAgICAgICAgICAgICAgIAphbnUgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vYXBpLmFub25jeWJmYWtlcGxheWVyLmNvbS9hcGkvaGV4Lz9kZWNvZGU9JHtkZWNiaW59YCwge21ldGhvZDogJ2dldCd9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBgJHthbnUucmVzdWx0fWAsIHRleHQsIHtxdW90ZWQ6IGZ0b2tvLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9fSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCgkJCQkvL2Nhc2UgY3JlYWRvIHBvciBzYW11CgkJCQkgICBjYXNlICdkb3JraW5nJzoKCQkJICAgCQlkb3JrID0gYCR7YXJncy5qb2luKCcgJyl9YAoJCQkJCWFudSA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGktYW5vbmN5YmZha2VwbGF5ZXIuaGVyb2t1YXBwLmNvbS9kb3JraW5nP2Rvcms9JHtkb3JrfWAsIHttZXRob2Q6ICdnZXQnfSkKCQkJCQloYXNpbCA9IGAke2FudS5yZXN1bHR9YAoJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgaGFzaWwsIHRleHQsIHtxdW90ZWQ6IGZ0b2tvLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9fSkKCQkJCQlicmVhawoJCQkJCQoJCQkJCWNhc2UgJ2l0b3JpJzoKCQkJCXJlcGx5KG1lc3Mud2FpdCkKCQkJCQlhbnUgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vYXBpLmZkY2kuc2UvcmVwLnBocD9nYW1iYXI9YW5pbWUraXRvcmlgLCB7bWV0aG9kOiAnZ2V0J30pCgkJCQkJaXQgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGFudSkpOwoJCQkJCW9yaSA9ICBpdFtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBpdC5sZW5ndGgpXTsKCQkJCQlueWUgPSBhd2FpdCBnZXRCdWZmZXIob3JpKQoJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgbnllLCBpbWFnZSwgeyBjYXB0aW9uOiAnaXRvcmkgY2hhbiEhJywgcXVvdGVkOiBmdG9rbyB9KQoJCQkJCWNhc2UgJ3Nhc3VrZSc6CgkJCQlyZXBseShtZXNzLndhaXQpCgkJCQkJYW51ID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS5mZGNpLnNlL3JlcC5waHA/Z2FtYmFyPXNhc3VrZWAsIHttZXRob2Q6ICdnZXQnfSkKCQkJCQlzYXN1ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhbnUpKTsKCQkJCQlrZSA9ICBzYXN1W01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHNhc3UubGVuZ3RoKV07CgkJCQkJbnllID0gYXdhaXQgZ2V0QnVmZmVyKGtlKQoJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgbnllLCBpbWFnZSwgeyBjYXB0aW9uOiAnc2FzdWtlISEnLCBxdW90ZWQ6IGZ0b2tvIH0pCgkJCQkJYnJlYWsgCgkJCQljYXNlICdzYWt1cmEnOgoJCQkJcmVwbHkobWVzcy53YWl0KQoJCQkJCWFudSA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkuZmRjaS5zZS9yZXAucGhwP2dhbWJhcj1zYWt1cmFgLCB7bWV0aG9kOiAnZ2V0J30pCgkJCQkJc2FrID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhbnUpKTsKCQkJCQlrdXJhID0gIHNha1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBzYWsubGVuZ3RoKV07CgkJCQkJbnllID0gYXdhaXQgZ2V0QnVmZmVyKGt1cmEpCgkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBueWUsIGltYWdlLCB7IGNhcHRpb246ICdzYWt1cmEhIScsIHF1b3RlZDogZnRva28gfSkKCQkJCQlicmVhayAKIAkJCQkKCQkJCWNhc2UgJ3JpemUnOgoJCQkJcmVwbHkobWVzcy53YWl0KQoJCQkJCWFudSA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkuZmRjaS5zZS9yZXAucGhwP2dhbWJhcj1hbmltZStyaXplYCwge21ldGhvZDogJ2dldCd9KQoJCQkJCXJpID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhbnUpKTsKCQkJCQl6ZSA9ICByaVtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiByaS5sZW5ndGgpXTsKCQkJCQlueWUgPSBhd2FpdCBnZXRCdWZmZXIoemUpCgkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBueWUsIGltYWdlLCB7IGNhcHRpb246ICdyaXplIGNoYW4hIScsIHF1b3RlZDogZnRva28gfSkKCQkJCQlicmVhayAKCQkJCWNhc2UgJ2FraXJhJzoKCQkJCXJlcGx5KG1lc3Mud2FpdCkKCQkJCQlhbnUgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vYXBpLmZkY2kuc2UvcmVwLnBocD9nYW1iYXI9YW5pbWUrYWtpcmFgLCB7bWV0aG9kOiAnZ2V0J30pCgkJCQkJYWsgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGFudSkpOwoJCQkJCWFyYSA9ICBha1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBhay5sZW5ndGgpXTsKCQkJCQlueWUgPSBhd2FpdCBnZXRCdWZmZXIoYXJhKQoJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgbnllLCBpbWFnZSwgeyBjYXB0aW9uOiAnYWtpcmEgY2hhbiEhJywgcXVvdGVkOiBmdG9rbyB9KQoJCQkJCWJyZWFrIAoJCQkJCSBjYXNlICdhbmltZSc6CmlmICghaXNSZWdpc3RlcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5kYWZ0YXJCKQoKc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCmFtID0gWyJhbmltZSB0dW1ibHIiLAogICJ3YWxscGFwZXIgYW5pbWUgaGQiLAogICJhbmltZSBhZXN0ZXRoaWMiLAogICJhbmltZSBoZCJdCm5rID0gYW1bTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogYW0ubGVuZ3RoKV0KZGF0YSA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkuZmRjaS5zZS9zb3NtZWQvcmVwLnBocD9nYW1iYXI9JHtua31gLCB7CiAgbWV0aG9kOiAnZ2V0Jwp9KQpyZXBseShtZXNzLndhaXQpCm4gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGRhdGEpKTsKbmltZWsgPSBuW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIG4ubGVuZ3RoKV07CnBvayA9IGF3YWl0IGdldEJ1ZmZlcihuaW1laykKc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBwb2ssIGltYWdlLCB7CiAgcXVvdGVkOiBmaW1nLCBjYXB0aW9uOiBg4piVYCwgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZX0KfSkKCmJyZWFrCgovLyoqKioqKioqKlBpbnRlcmVzdCB3YWxscGFwZXIKICBjYXNlICd3cCc6CmNhc2UgJ3dhbGxwYXBlcic6CiAgaWYgKCFpc1JlZ2lzdGVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmRhZnRhckIpCiAgCiAgc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCiAgcHcgPSBbIndhbGxwYXBlciBhZXN0ZXRoaWMiLAoid2FsbHBhcGVyIHR1bWJsciIsCiJ3YWxscGFwZXIgbHVjdSIsCiJ3YWxscGFwZXIgZ2F0aXRvcyIsCiJ3YWxscGFwZXIiXQogIG5rID0gcHdbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcHcubGVuZ3RoKV0KICB0cnkgewogIGRhdGEgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vYXBpLmZkY2kuc2Uvc29zbWVkL3JlcC5waHA/Z2FtYmFyPSR7bmt9YCwgewptZXRob2Q6ICdnZXQnCiAgfSkKICByZXBseShtZXNzLndhaXQpCiAgbiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZGF0YSkpOwogIG5pbWVrID0gbltNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBuLmxlbmd0aCldOwogIHBvayA9IGF3YWl0IGdldEJ1ZmZlcihuaW1laykKICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIHBvaywgaW1hZ2UsIHsKcXVvdGVkOiBmaW1nLCBjYXB0aW9uOiBg4piVYCwgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZX0KICB9KQogIAogIH0gY2F0Y2ggewogICAgcmVwbHkobWVzcy5mZXJyKQogIH0KICBicmVhayAKCQkJCWNhc2UgJ25hcnV0byc6CgkJCQlyZXBseShtZXNzLndhaXQpCgkJCQkJYW51ID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS5mZGNpLnNlL3JlcC5waHA/Z2FtYmFyPU5hcnV0b2AsIHttZXRob2Q6ICdnZXQnfSkKCQkJCQluYXJ1ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhbnUpKTsKCQkJCQl0byA9ICBuYXJ1W01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIG5hcnUubGVuZ3RoKV07CgkJCQkJbnllID0gYXdhaXQgZ2V0QnVmZmVyKHRvKQoJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgbnllLCBpbWFnZSwgeyBjYXB0aW9uOiAnbmFydXRvISEnLCBxdW90ZWQ6IGZ0b2tvIH0pCgkJCQkJYnJlYWsgCgkJCQljYXNlICdtaW5hdG8nOgoJCQkJcmVwbHkobWVzcy53YWl0KQoJCQkJCWFudSA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkuZmRjaS5zZS9yZXAucGhwP2dhbWJhcj1NaW5hdG9gLCB7bWV0aG9kOiAnZ2V0J30pCgkJCQkJbWluID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhbnUpKTsKCQkJCQlhdG8gPSAgbWluW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIG1pbi5sZW5ndGgpXTsKCQkJCQlueWUgPSBhd2FpdCBnZXRCdWZmZXIoYXRvKQoJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgbnllLCBpbWFnZSwgeyBjYXB0aW9uOiAnbWluYXRvISEnLCBxdW90ZWQ6IGZ0b2tvIH0pCgkJCQkJYnJlYWsgCgkJCQljYXNlICdib3J1dG8nOgoJCQkJcmVwbHkobWVzcy53YWl0KQoJCQkJCWFudSA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkuZmRjaS5zZS9yZXAucGhwP2dhbWJhcj1ib3J1dG9gLCB7bWV0aG9kOiAnZ2V0J30pCgkJCQkJYm9yID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhbnUpKTsKCQkJCQl1dG8gPSAgYm9yW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGJvci5sZW5ndGgpXTsKCQkJCQlueWUgPSBhd2FpdCBnZXRCdWZmZXIodXRvKQoJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgbnllLCBpbWFnZSwgeyBjYXB0aW9uOiAnYm9ydXRvISEnLCBxdW90ZWQ6IGZ0b2tvIH0pCgkJCQkJYnJlYWsgCgkJCQljYXNlICdoaW5hdGEnOgoJCQkJcmVwbHkobWVzcy53YWl0KQoJCQkJCWFudSA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkuZmRjaS5zZS9yZXAucGhwP2dhbWJhcj1IaW5hdGFgLCB7bWV0aG9kOiAnZ2V0J30pCgkJCQkJaGluYSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYW51KSk7CgkJCQkJdGEgPSAgaGluYVtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBoaW5hLmxlbmd0aCldOwoJCQkJCW55ZSA9IGF3YWl0IGdldEJ1ZmZlcih0YSkKCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIG55ZSwgaW1hZ2UsIHsgY2FwdGlvbjogJ2hpbmF0YSEhJywgcXVvdGVkOiBmdG9rbyB9KQoJCQkJCWJyZWFrCgkJCQkJY2FzZSAnbGV2aSc6CgkJCQlyZXBseShtZXNzLndhaXQpCgkJCQkJYW51ID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS5mZGNpLnNlL3JlcC5waHA/Z2FtYmFyPWxldmkrYWNrZXJtYW5gLCB7bWV0aG9kOiAnZ2V0J30pCgkJCQkJbGV2aSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYW51KSk7CgkJCQkJYWNrZXJtYW4gPSAgbGV2aVtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBsZXZpLmxlbmd0aCldOwoJCQkJCW55ZSA9IGF3YWl0IGdldEJ1ZmZlcihhY2tlcm1hbikKCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIG55ZSwgaW1hZ2UsIHsgY2FwdGlvbjogJ2xldmkhIScsIHF1b3RlZDogZnRva28gfSkKCQkJCQlicmVhawoJCQkJCWNhc2UgJ2VyZW4nOgoJCQkJcmVwbHkobWVzcy53YWl0KQoJCQkJCWFudSA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkuZmRjaS5zZS9yZXAucGhwP2dhbWJhcj1lcmVuK3llYWdlcmAsIHttZXRob2Q6ICdnZXQnfSkKCQkJCQllciA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYW51KSk7CgkJCQkJZW4gPSAgZXJbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogZXIubGVuZ3RoKV07CgkJCQkJbnllID0gYXdhaXQgZ2V0QnVmZmVyKGVuKQoJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgbnllLCBpbWFnZSwgeyBjYXB0aW9uOiAnZXJlbiEhJywgcXVvdGVkOiBmdG9rbyB9KQoJCQkJCWJyZWFrCgkJCQpjYXNlICdiaXRseSc6CgkJCQkKCQlzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykgCiAgICAgICAgICAgICAgICBkYXRhID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL3RvYnotYXBpLmhlcm9rdWFwcC5jb20vYXBpL2JpdGx5P3VybD0ke2FyZ3Muam9pbignICcpfSZhcGlrZXk9Qm90V2VBYCkKICAgICAgICAgICAgICAgIGhhc2lsID0gYGxpbmsgOiAke2FyZ3Muam9pbignICcpfVxuXG5PdXRwdXQgOiAke2RhdGEucmVzdWx0fWAKICAgICAgICAgICAgICAgIHJlcGx5KGhhc2lsKQogICAgICAgICAgICAgICAgLy8KICAgICAgICAgICAgICAgIGJyZWFrCmNhc2UgJ3RlbXBvJzoKICAgdmFyIHJlcSA9IGFyZ3Muam9pbignICcpICAgICAgICAgICAgCgkJCQkJZW5jbWVkaWEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkucmVwbGFjZSgncXVvdGVkTScsJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvCgkJCQkJbWVkaWEgPSBhd2FpdCBzYW11MzMwLmRvd25sb2FkQW5kU2F2ZU1lZGlhTWVzc2FnZShlbmNtZWRpYSkKCQkJCQlyYW4gPSBnZXRSYW5kb20oJy5tcDMnKQoJCQkJCWV4ZWMoYGZmbXBlZyAtaSAke21lZGlhfSAtZmlsdGVyOmEgImF0ZW1wbz0xLjAsYXNldHJhdGU9JHtyZXF9IiAke3Jhbn1gLCAoZXJyLCBzdGRlcnIsIHN0ZG91dCkgPT4gewoJCQkJCQlmcy51bmxpbmtTeW5jKG1lZGlhKQoJCQkJCQlpZiAoZXJyKSByZXR1cm4gcmVwbHkoJ0Vycm9yIScpCgkJCQkJCWhhaCA9IGZzLnJlYWRGaWxlU3luYyhyYW4pCgkJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgaGFoLCBhdWRpbywge21pbWV0eXBlOiAnYXVkaW8vbXA0JywgcHR0OnRydWUsIHF1b3RlZDogZnRva299KQoJCQkJCQlmcy51bmxpbmtTeW5jKHJhbikKCQkJCQl9KQoJCQkJYnJlYWsKCQkJCWNhc2UgJ3RlbXBvLXYnOgogICB2YXIgcmVxID0gYXJncy5qb2luKCcgJykgICAgICAgICAgICAKCQkJCQllbmNtZWRpYSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8KCQkJCQltZWRpYSA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRBbmRTYXZlTWVkaWFNZXNzYWdlKGVuY21lZGlhKQoJCQkJCXJhbiA9IGdldFJhbmRvbSgnLm1wNCcpCgkJCQkJZXhlYyhgZmZtcGVnIC1pICR7bWVkaWF9IC1maWx0ZXI6YSAiYXRlbXBvPTEuMCxhc2V0cmF0ZT0ke3JlcX0iICR7cmFufWAsIChlcnIsIHN0ZGVyciwgc3Rkb3V0KSA9PiB7CgkJCQkJCWZzLnVubGlua1N5bmMobWVkaWEpCgkJCQkJCWlmIChlcnIpIHJldHVybiByZXBseSgnRXJyb3IhJykKCQkJCQkJaGFoID0gZnMucmVhZEZpbGVTeW5jKHJhbikKCQkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBoYWgsIHZpZGVvLCB7IG1pbWV0eXBlOiAndmlkZW8vbXA0JywgcXVvdGVkOiBmdG9rbyB9KQp9KQoJCQkJYnJlYWsKCQkJCWNhc2UgJ21maXJlJzoKCQkJCSAgIGlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybiByZXBseSgnWSBlbCBsaW5rIGRlIG1lZGlhZmlyZT8nKQoJCQkJICAgdmFyIGxpbmsgPSBhcmdzLmpvaW4oJyAnKQoJCQkJc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpIAogICAgICAgICAgICAgICAgZGF0YSA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly92aWRlZmlrcmkuY29tL2FwaS9tZWRpYWZpcmUvP3F1ZXJ5PSR7bGlua31gKQoJCXNteXBlcnJ5ID0gYXdhaXQgZ2V0QnVmZmVyKGRhdGEucmVzdWx0LmRvd25sb2FkKQogICAgICAgICAgICAgICAgaGFzaWwgPSBgbGluayA6ICR7bGlua31cblxuKlNJIE5PIFNFIEVOVklBIEVMIEFSQ0hJVk8sIE8gU0kgU0UgRU5WSUEgQ09OIEVSUk9SRVMsIFBVRURFIFRPQ0FSIEVMIEVOTEFDRSBERSBBQkFKTyBZIFNVIERFU0NBUkdBIElOSUNJQVJBIEFMIElOU1RBTlRFKiA6ICR7ZGF0YS5yZXN1bHQuZG93bmxvYWR9YAogICAgICAgICAgICAgICAgcmVwbHkoaGFzaWwpCgkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBzbXlwZXJyeSwgZG9jdW1lbnQsIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCgkJCW1pbWV0eXBlOiAnZmlsZScsIGZpbGVuYW1lOiBgJHtkYXRhLnJlc3VsdC5maWxlbmFtZX1gLCBxdW90ZWQ6IGZkb2MKICB9KQkKICAgICAgICAgICAgICAgIC8vCiAgICAgICAgICAKY2FzZSAnPic6CnZhciBrb25zb2wgPSBhcmdzLmpvaW4oJyAnKQpmdW5jdGlvbiBzZW5kUmVzdWx0KHN1bCkgewp2YXIgc2F0ID0gSlNPTi5zdHJpbmdpZnkoc3VsLCBudWxsLCAyKQp2YXIgYmFuZyA9IHV0aWwuZm9ybWF0KHNhdCkKcmV0dXJuIHJlcGx5KGJhbmcpCn0KcmVwbHkodXRpbC5mb3JtYXQoZXZhbChgOyhhc3luYyAoKSA9PiB7ICR7a29uc29sfSB9KSgpYCkpKQpicmVhawoJCQkJY2FzZSAnZmFzdCc6CgkJCQkJZW5jbWVkaWEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkucmVwbGFjZSgncXVvdGVkTScsJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvCgkJCQkJbWVkaWEgPSBhd2FpdCBzYW11MzMwLmRvd25sb2FkQW5kU2F2ZU1lZGlhTWVzc2FnZShlbmNtZWRpYSkKCQkJCQlyYW4gPSBnZXRSYW5kb20oJy5tcDMnKQoJCQkJCWV4ZWMoYGZmbXBlZyAtaSAke21lZGlhfSAtZmlsdGVyOmEgImF0ZW1wbz0xLjMsYXNldHJhdGU9NDMwMDAiICR7cmFufWAsIChlcnIsIHN0ZGVyciwgc3Rkb3V0KSA9PiB7CgkJCQkJCWZzLnVubGlua1N5bmMobWVkaWEpCgkJCQkJCWlmIChlcnIpIHJldHVybiByZXBseSgnRXJyb3IhJykKCQkJCQkJaGFoID0gZnMucmVhZEZpbGVTeW5jKHJhbikKCQkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBoYWgsIGF1ZGlvLCB7bWltZXR5cGU6ICdhdWRpby9tcDQnLCBwdHQ6dHJ1ZSwgcXVvdGVkOiBmdG9rb30pCgkJCQkJCWZzLnVubGlua1N5bmMocmFuKQoJCQkJCX0pCgkJCQkJYnJlYWsKCgkJCSAgCgkJCQoJCQkJCQoJCQkJCWNhc2UgJ3Rpa3RvZCc6CgkJCQkJdmFyIGdoID0gYXJncy5qb2luKCcgJykKCQkJCQl2YXIgZ2xpID0gZ2guc3BsaXQoInwiKVswXTsKCQkJCQl2YXIgdGNoID0gZ2guc3BsaXQoInwiKVsxXTsKCQkJCQlpZiAoYXJncy5sZW5ndGggPCAxKSByZXR1cm4gcmVwbHkoYOOAjOKdl+OAjUNvbnRvaCA6ICR7cHJlZml4fWdsaXRjaHRleHQgdGVzdHx0ZXN0YCkKCQkJCQlidWZmZXIgPSBhd2FpdCBnZXRCdWZmZXIoYGh0dHBzOi8vYXBpLnh0ZWFtLnh5ei90ZXh0cHJvL2dsaXRjaD90ZXh0PSR7Z2xpfSZ0ZXh0Mj0ke3RjaH0mQVBJS0VZPSR7WHRlYW1LZXl9YCkKCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGJ1ZmZlciwgaW1hZ2UsIHtxdW90ZWQ6IGZ0b2tvLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9fSkKCQkJCQkvLwoJCQkJCWJyZWFrCgkJCQkJCQoJCSAgICBjYXNlICdjbWQnOgoJCQkJdmFyIHRla3MgPSBlbmNvZGVVUklDb21wb25lbnQoYXJncy5qb2luKCcgJykpCgkJCQlpZiAoIXRla3MpIHJldHVybiBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sICBtc2dUeXBlLnRleHQsIHsgcXVvdGVkOiBmYWtlUHJvZHVjdCB9KQoJCQkJdmFyIGJ1ZmZlciAgPSBhd2FpdCAgZ2V0QnVmZmVyKGBodHRwczovL2FwaS1ydWxsLmhlcm9rdWFwcC5jb20vYXBpL2NtZD9jb2RlPSR7dGVrc31gKQoJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBidWZmZXIsIGltYWdlKQoJCWJyZWFrCgoJCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKCQkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCgkJCQkKCmNhc2UgJ2F0dHAnOgoJCQkJCWlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybiByZXBseSgnWSBlbCB0ZXh0bz8nKQoJCQkJCXZhciB0ZWtzID0gZW5jb2RlVVJJQ29tcG9uZW50KGFyZ3Muam9pbignICcpKQoJCQkJCWNvbnN0IGF0dHAgPSBhd2FpdCBnZXRCdWZmZXIoYGh0dHBzOi8vYXBpLnh0ZWFtLnh5ei9hdHRwP2ZpbGUmdGV4dD0ke3Rla3N9YCkKCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGF0dHAsIHN0aWNrZXIsIHtxdW90ZWQ6IGZ0b2tvLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9fSkKCQkJCQlicmVhawpjYXNlICd0dHAnOgoJCQkJCWlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybiByZXBseSgnWSBlbCB0ZXh0bz8nKQoJCQkJCXZhciB0ZWtzID0gZW5jb2RlVVJJQ29tcG9uZW50KGFyZ3Muam9pbignICcpKQoJCQkJCWNvbnN0IHR0cCA9IGF3YWl0IGdldEJ1ZmZlcihgaHR0cHM6Ly9hcGkueHRlYW0ueHl6L3R0cD9maWxlJnRleHQ9JHt0ZWtzfWApCgkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCB0dHAsIHN0aWNrZXIsIHtxdW90ZWQ6IGZ0b2tvLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9fSkKCQkJCQlicmVhawoJCQkJCWNhc2UgJ2ZvcndhcmQnOgoJCQkJCSBjYXNlICdmdyc6CnNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYCR7YXJncy5qb2luKCcgJyl9YCwgTWVzc2FnZVR5cGUudGV4dCwge2NvbnRleHRJbmZvOiB7IGZvcndhcmRpbmdTY29yZTogMjEwLCBpc0ZvcndhcmRlZDogdHJ1ZSB9fSkKICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgCQkJCS8vY2FzZSBjcmVhZG8gcG9yIHNhbXUKCmNhc2UgJ2FudGltZWRpYSc6ICAgICAgICAgICAgICAgIAppZiAoIWlzR3JvdXApIHJldHVybiByZXBseShtZXNzLm9ubHkuZ3JvdXApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzR3JvdXBBZG1pbnMpIHJldHVybiByZXBseShtZXNzLm9ubHkuYWRtaW4pICAgICAKaWYgKCFpc0JvdEdyb3VwQWRtaW5zKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LkJhZG1pbikKaWYgKGFyZ3MubGVuZ3RoIDwgMSkgcmV0dXJuIHJlcGx5KCdFc2NyaWJlICoxKiBwYXJhIGFjdGl2YXInKSAgICAgICAgICAKaWYgKGFyZ3NbMF0gPT09ICcxJykgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAoJaWYgKGlzQW50aU1lZGlhKSByZXR1cm4gcmVwbHkoJypZYSBlc3TDoSBhY3Rpdm8qJykgICAgICAgICAgCglhbnRpbWVkaWEucHVzaChmcm9tKSAgICAgICAgICAgICAgICAgICAgICAgICAgCglmcy53cml0ZUZpbGVTeW5jKCcuL3NyYy9hbnRpbWVkaWEuanNvbicsIEpTT04uc3RyaW5naWZ5KGFudGltZWRpYSkpICAgICAgCglyZXBseShgKlsgQWN0aXZhZG8gXSpgKSAgCglyZXBseShgKkxhIHBlcnNvbmEgcXVlIGVudmllIGZvdG9zIG8gdmlkZW9zIHNlcmEgZWxpbWluYWRhKmApICAKfSBlbHNlIGlmIChhcmdzWzBdID09PSAnMCcpIHsgICAgICAgICAgICAgCgl2YXIgaW5pID0gYW50aW1lZGlhLmluZGV4T2YoZnJvbSkKCWFudGltZWRpYS5zcGxpY2UoaW5pLCAxKSAgICAgICAgICAgCglmcy53cml0ZUZpbGVTeW5jKCcuL3NyYy9hbnRpbWVkaWEuanNvbicsIEpTT04uc3RyaW5naWZ5KGFudGltZWRpYSkpICAgICAgIAoJcmVwbHkoYERlc2FjdGl2YWRvYCkgICAgICAgICAgICAgIAp9IGVsc2UgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCglyZXBseSgnMSBwYXJhIGFjdGl2YXIsIDAgcGFyYSBkZXNhY3RpdmFyJykgICAgICAgICAgIAp9ICAgICAgICAgICAKYnJlYWsKY2FzZSAnKzE4JzogICAgICAgICAgICAgICAgCmlmICghaXNHcm91cCkgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5ncm91cCkKaWYgKCFpc0dyb3VwQWRtaW5zKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmFkbWluKSAgICAgCgppZiAoYXJncy5sZW5ndGggPCAxKSByZXR1cm4gcmVwbHkoJ0VzY3JpYmUgKjEqIHBhcmEgYWN0aXZhcicpICAgICAgICAgIAppZiAoYXJnc1swXSA9PT0gJzEnKSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCglpZiAoaXNOc2Z3KSByZXR1cm4gcmVwbHkoJypZYSBlc3TDoSBhY3Rpdm8qJykgICAgICAgICAgCgluc2Z3LnB1c2goZnJvbSkgICAgICAgICAgICAgICAgICAgICAgICAgIAoJZnMud3JpdGVGaWxlU3luYygnLi9zcmMvbnNmdy5qc29uJywgSlNPTi5zdHJpbmdpZnkobnNmdykpICAgICAgCglyZXBseShgKlsgQWN0aXZhZG8gXSpgKSAgIAp9IGVsc2UgaWYgKGFyZ3NbMF0gPT09ICcwJykgeyAgICAgICAgICAgICAKCXZhciBpbmkgPSBuc2Z3LmluZGV4T2YoZnJvbSkKCW5zZncuc3BsaWNlKGluaSwgMSkgICAgICAgICAgIAoJZnMud3JpdGVGaWxlU3luYygnLi9zcmMvbnNmdy5qc29uJywgSlNPTi5zdHJpbmdpZnkobnNmdykpICAgICAgIAoJcmVwbHkoYERlc2FjdGl2YWRvYCkgICAgICAgICAgICAgIAp9IGVsc2UgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCglyZXBseSgnMSBwYXJhIGFjdGl2YXIsIDAgcGFyYSBkZXNhY3RpdmFyJykgICAgICAgICAgIAp9ICAgICAgICAgICAKYnJlYWsKLy9ieSBTbTMzMApjYXNlICdhdXRvc3RpY2snOiAgICAgICAgICAgIAppZiAoIWlzR3JvdXApIHJldHVybiByZXBseShtZXNzLm9ubHkuZ3JvdXApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzR3JvdXBBZG1pbnMpIHJldHVybiByZXBseShtZXNzLm9ubHkuYWRtaW4pICAgICAKaWYgKGFyZ3MubGVuZ3RoIDwgMSkgcmV0dXJuIHJlcGx5KCdFc2NyaWJlICoxKiBwYXJhIGFjdGl2YXInKSAgICAgICAgICAgICAgICAgICAgCmlmIChhcmdzWzBdID09PSAnMScpIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAoJaWYgKGlzQXV0b1N0KSByZXR1cm4gcmVwbHkoJypZYSBlc3TDoSBhY3Rpdm8qJykgICAgICAgICAgCglhdXRvc3RpY2sucHVzaChmcm9tKSAgICAgICAgICAgICAKCWZzLndyaXRlRmlsZVN5bmMoJy4vc3JjL2F1dG9zdGljay5qc29uJywgSlNPTi5zdHJpbmdpZnkoYXV0b3N0aWNrKSkgICAgICAKCXJlcGx5KGAqWyBBY3RpdmFkbyBdKmApICAKCXJlcGx5KGAqYWhvcmEsIHRvZGFzIGxhcyBmb3RvcyBxdWUgc2UgZW52aWVuIGVuIGVsIGdydXBvIHNlIGNvbnZlcnRpcmFuIGVuIHN0aWNrZXIgYXV0b21hdGljYW1lbnRlKmApICAKfSBlbHNlIGlmIChhcmdzWzBdID09PSAnMCcpIHsgICAgICAgICAgIAoJdmFyIGluaSA9IGF1dG9zdGljay5pbmRleE9mKGZyb20pCglhdXRvc3RpY2suc3BsaWNlKGluaSwgMSkgICAgICAgICAgICAgICAgICAKCWZzLndyaXRlRmlsZVN5bmMoJy4vc3JjL2F1dG9zdGljay5qc29uJywgSlNPTi5zdHJpbmdpZnkoYXV0b3N0aWNrKSkgICAgICAKCXJlcGx5KGBEZXNhY3RpdmFkb2ApICAgICAgICAgICAgICAKfSBlbHNlIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAoJcmVwbHkoJzEgcGFyYSBhY3RpdmFyLCAwIHBhcmEgZGVzYWN0aXZhcicpICAgICAgICAKfSAgICAgICAgICAgICAgICAgICAgICAgICAgCmJyZWFrCgkJCQkJCgkJCWNhc2UgJ2FudGliYWQnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0dyb3VwKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5Lmdyb3VwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0dyb3VwQWRtaW5zKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmFkbWluKQoJCQkJCWlmICghaXNCb3RHcm91cEFkbWlucykgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5CYWRtaW4pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPCAxKSByZXR1cm4gcmVwbHkoJ0VzY3JpYmUgKjEqIHBhcmEgYWN0aXZhcicpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXJnc1swXSA9PT0gJzEnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0JhZFdvcmQpIHJldHVybiByZXBseSgnKllhIGVzdMOhIGFjdGl2byonKQogICAgICAgICAgICAgICAgIAkgICAgICAgICAgICAgICAgICAgICAgICBiYWR3b3JkLnB1c2goZnJvbSkKICAgICAgICAgICAgICAgICAJICAgICAgICAgICAgICAgICAgICAgICAgZnMud3JpdGVGaWxlU3luYygnLi9zcmMvYmFkd29yZC5qc29uJywgSlNPTi5zdHJpbmdpZnkoYmFkd29yZCkpCiAgICAgICAgICAgICAgICAgIAkgICAgICAgICAgICAgICAgICAgICAgICByZXBseShgKlsgQWN0aXZhZG8gXSpgKQoJCQkJCQlyZXBseShgKkxhcyBwZXJzb25hcyBxdWUgZW52aWVuIHVuYSBtYWxhIHBhbGFicmEgc2VyYSBlbGltaW5hZGEqLiBfUGFyYSB2ZXIgbGEgbGlzdGEgZGUgbWFsYXMgcGFsYWJyYXMgdXNhIGVsIGNvbWFuZG86IGxpc3RiYWRfYCkgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhcmdzWzBdID09PSAnMCcpIHsKICAgICAgICAgICAgICAgICAgCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmkgPSBhbnRpYmFkLmluZGV4T2YoZnJvbSkKCQkJCQkJYmFkd29yZC5zcGxpY2UoaW5pLCAxKQogICAgICAgICAgICAgICAgIAkgICAgICAgICAgICAgICAgICAgICAgICBmcy53cml0ZUZpbGVTeW5jKCcuL3NyYy9iYWR3b3JkLmpzb24nLCBKU09OLnN0cmluZ2lmeShiYWR3b3JkKSkKICAgICAgICAgICAgICAgICAJICAgICAgICAgICAgICAgICAgICAgICAgcmVwbHkoYERlc2FjdGl2YWRvYCkKICAgICAgICAgICAgIAkgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgIAkgICAgICAgICAgICAgICAgICAgICAgICByZXBseSgnMSBwYXJhIGFjdGl2YXIsIDAgcGFyYSBkZXNhY3RpdmFyJykKICAgICAgICAgICAgICAgIAkgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdhZGRiYWQnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc093bmVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5Lm93bmVyQikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNHcm91cEFkbWlucykgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5hZG1pbikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybiByZXBseSggYEVzY3JpYmUgJHtwcmVmaXh9YWRkYmFkIFtwYWxhYnJhXS4gRWplbXBsbzogJHtwcmVmaXh9YWRkYmFkIHB0b2ApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBidyA9IGJvZHkuc2xpY2UoMTIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWQucHVzaChidykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZzLndyaXRlRmlsZVN5bmMoJy4vc3JjL2JhZC5qc29uJywgSlNPTi5zdHJpbmdpZnkoYmFkKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGx5KCdTZSBhw7FhZGlvIGNvbiBleGl0bycpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2RlbGJhZCc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzT3duZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkub3duZXJCKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0dyb3VwQWRtaW5zKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmFkbWluKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoIDwgMSkgcmV0dXJuIHJlcGx5KCBgRXNjcmliZSAke3ByZWZpeH1kZWxiYWQgW3BhbGFicmFdLiBFamVtcGxvOiAke3ByZWZpeH1kZWxiYWQgYmVnb2ApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGJ3ID0gYm9keS5zbGljZSgxMikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhZC5zcGxpY2UoZGJ3KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnMud3JpdGVGaWxlU3luYygnLi9zcmMvYmFkLmpzb24nLCBKU09OLnN0cmluZ2lmeShiYWQpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwbHkoJ1NlIHF1aXRvIGNvbiBleGl0bycpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhayAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdsaXN0YmFkJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBsYncgPSBgTGlzdGEgZGUgQkFEIFdPUkRcblRvdGFsIDogJHtiYWQubGVuZ3RofVxuYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSBvZiBiYWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGJ3ICs9IGDil6YgJHtpLnJlcGxhY2UoYmFkKX1cbmAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHJlcGx5KGxidykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCgoKCQkJCWNhc2UgJ3dlbGNvbWUnOgoJCQkJCWlmICghaXNHcm91cCkgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5ncm91cCkKCQkJCQlpZiAoIWlzR3JvdXBBZG1pbnMpIHJldHVybiByZXBseShtZXNzLm9ubHkuYWRtaW4pCgkJCQkJaWYgKGFyZ3MubGVuZ3RoIDwgMSkgcmV0dXJuIHJlcGx5KCc/JykKCQkJCQlpZiAoTnVtYmVyKGFyZ3NbMF0pID09PSAxKSB7CgkJCQkJCWlmIChpc1dlbGtvbSkgcmV0dXJuIHJlcGx5KCdZYSBlc3RhIGFjdGl2bycpCgkJCQkJCXdlbGtvbS5wdXNoKGZyb20pCgkJCQkJCWZzLndyaXRlRmlsZVN5bmMoJy4vc3JjL3dlbGtvbS5qc29uJywgSlNPTi5zdHJpbmdpZnkod2Vsa29tKSkKCQkJCQkJcmVwbHkoJ1NlIGFjdGl2byBjb24gZXhpdG8nKQoJCQkJCX0gZWxzZSBpZiAoTnVtYmVyKGFyZ3NbMF0pID09PSAwKSB7CgkJCQkJCXdlbGtvbS5zcGxpY2UoZnJvbSwgMSkKCQkJCQkJZnMud3JpdGVGaWxlU3luYygnLi9zcmMvd2Vsa29tLmpzb24nLCBKU09OLnN0cmluZ2lmeSh3ZWxrb20pKQoJCQkJCQlyZXBseSgnU2UgZGVzYWN0aXZvIGNvbiBleGl0bycpCgkJCQkJfSBlbHNlIHsKCQkJCQkJcmVwbHkoJzEgcGFyYSBhY3RpdmFyLCAwIGRlc2FjdGl2YXInKQoJCQkJCX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawoKCgkJCQljYXNlICdhbnRpbGluayc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCWlmICghaXNHcm91cCkgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5ncm91cCkKCQkJCQlpZiAoIWlzR3JvdXBBZG1pbnMpIHJldHVybiByZXBseShtZXNzLm9ubHkuYWRtaW4pCgkJCQkJaWYgKCFpc0JvdEdyb3VwQWRtaW5zKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LkJhZG1pbikKCQkJCQlpZiAoYXJncy5sZW5ndGggPCAxKSByZXR1cm4gcmVwbHkoJ2VzY3JpYmEgKjEqIHBhcmEgYWN0aXZhcicpCgkJCQkJaWYgKGFyZ3NbMF0gPT09ICcxJykgewoJCQkJCQlpZiAoaXNBbnRpTGluaykgcmV0dXJuIHJlcGx5KCdZYSBlc3RhIGFjdGl2bycpCgkJCQkJCWFudGlsaW5rLnB1c2goZnJvbSkKCQkJCQkJZnMud3JpdGVGaWxlU3luYygnLi9zcmMvYW50aWxpbmsuanNvbicsIEpTT04uc3RyaW5naWZ5KGFudGlsaW5rKSkKCQkJCQkJcmVwbHkoJypBbnRpLWxpbmsgYWN0aXZhZG8g4pyU77iPKicpCgkJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSxgTG9zIG1pZW1icm9zIHF1ZSBtYW5kZW4gdW4gbGluayBzZXLDoW4gZWxpbWluYWRvcywgKk9KTyogX0NVTEFRVUlFUiBUSVBPIERFIExJTktfYCwgdGV4dCkKCQkJCQl9IGVsc2UgaWYgKChhcmdzWzBdKSA9PT0gJzAnKSB7CgkJCQkJCXZhciBpbmkgPSBhbnRpbGluay5pbmRleE9mKGZyb20pCgkJCQkJCWFudGlsaW5rLnNwbGljZShpbmksIDEpCgkJCQkJCWZzLndyaXRlRmlsZVN5bmMoJy4vc3JjL2FudGlsaW5rLmpzb24nLCBKU09OLnN0cmluZ2lmeShhbnRpbGluaykpCgkJCQkJCXJlcGx5KCdBbnRpLWxpbmsgZGVzYWN0aXZhZG8g4pyU77iPJykKCQkJCQl9IGVsc2UgewoJCQkJCQlyZXBseSgnKjEgcGFyYSBhY3RpdmFyLCAwIHBhcmEgZGVzYWN0aXZhcionKQoJCQkJCX0KCQkJCQlicmVhawoKCgkJCQljYXNlICdzaW1zaW1pJzogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNHcm91cCkgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5ncm91cCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNHcm91cEFkbWlucykgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5hZG1pbikgICAgICAgIAoJCQkJCWlmICghaXNCb3RHcm91cEFkbWlucykgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5CYWRtaW4pICAgIAoJCQkJCWlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybiByZXBseSgnZXNjcmliYSAqMSogcGFyYSBhY3RpdmFyJykgICAgICAgIAoJCQkJCWlmIChhcmdzWzBdID09PSAnMScpIHsgICAgICAgICAgICAgICAgIAoJCQkJCQlpZiAoaXNTaW1pKSByZXR1cm4gcmVwbHkoJ1lhIGVzdGEgYWN0aXZvJykgICAgICAgICAgICAKCQkJCQkJc2ltaS5wdXNoKGZyb20pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZzLndyaXRlRmlsZVN5bmMoJy4vc3JjL3NpbWkuanNvbicsIEpTT04uc3RyaW5naWZ5KHNpbWkpKQoJCQkJCX0gZWxzZSBpZiAoKGFyZ3NbMF0pID09PSAnMCcpIHsgICAgICAgICAgICAgICAgICAgICAgCgkJCQkJCXZhciBpbmkgPSBzaW1pLmluZGV4T2YoZnJvbSkgICAgICAgICAgICAgIAoJCQkJCQlzaW1pLnNwbGljZShpbmksIDEpICAgICAgICAgICAgICAgICAgICAKCQkJCQkJZnMud3JpdGVGaWxlU3luYygnLi9zcmMvc2ltaS5qc29uJywgSlNPTi5zdHJpbmdpZnkoc2ltaSkpICAgICAgICAKCQkJCQkJcmVwbHkoJ01vZG8gc2ltc2ltaSBvZmYg4pyU77iPJykgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAoJCQkJCX0gZWxzZSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAoJCQkJCQlyZXBseSgnKjEgcGFyYSBhY3RpdmFyLCAwIHBhcmEgZGVzYWN0aXZhcionKSAgICAgICAgICAgICAKCQkJCQl9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawoJCQkJCQoJCQkJCQogICAgICAgICAgICAgICBjYXNlICdkZWxldGUnOgogIGNhc2UgJ2RlbCc6CmlmICghaXNHcm91cClyZXR1cm4gcmVwbHkobWVzcy5vbmx5Lmdyb3VwKQppZiAoIWlzUmVnaXN0ZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkuZGFmdGFyQikKaWYgKCFpc0dyb3VwQWRtaW5zKXJldHVybiByZXBseShtZXNzLm9ubHkuYWRtaW4pCnRyeSB7CnNhbXUzMzAuZGVsZXRlTWVzc2FnZShmcm9tLCB7CiAgaWQ6IHNhbS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8uc3RhbnphSWQsIHJlbW90ZUppZDogZnJvbSwgZnJvbU1lOiB0cnVlCn0pCn0gY2F0Y2ggewogIHJlcGx5KCdTb2xvIHB1ZWRvIGJvcnJhciBtZW5zYWplcyBtw61vcycpCn0KYnJlYWsKICAgICAgICAgICAgIAoJCQkJY2FzZSAnd2FzdGVkJzoKCQkJCQl2YXIgaW1nYmIgPSByZXF1aXJlKCdpbWdiYi11cGxvYWRlcicpCgkJCQkJaWYgKCgoaXNNZWRpYSAmJiAhbWVrLm1lc3NhZ2UudmlkZW9NZXNzYWdlKSB8fCBpc1F1b3RlZEltYWdlKSAmJiBhcmdzLmxlbmd0aCA9PSAwKSB7CgkJCQkJCWdlciA9IGlzUXVvdGVkSW1hZ2UgPyBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkucmVwbGFjZSgncXVvdGVkTScsICdtJykpLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mbyA6IHNhbTsKCQkJCQkJcmVwbHkobWVzcy53YWl0KTsKCQkJCQkJb3dnaSA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRBbmRTYXZlTWVkaWFNZXNzYWdlKGdlcik7CgkJCQkJCWFudSA9IGF3YWl0IGltZ2JiKCcyMGExNDg2MWU0Zjc1OTFmM2RjNTI2NDljYjA3YWUwMicsIG93Z2kpOwoJCQkJCQl0ZWtzID0gYCR7YW51LmRpc3BsYXlfdXJsfWA7CgkJCQkJCWFudTEgPSBhd2FpdCBnZXRCdWZmZXIoYGh0dHBzOi8vc29tZS1yYW5kb20tYXBpLm1sL2NhbnZhcy93YXN0ZWQ/YXZhdGFyPSR7dGVrc31gKTsKCQkJCQkJZnMud3JpdGVGaWxlU3luYygnd2FzdGVkLmpwZycsIGFudTEpCgkJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgZnMucmVhZEZpbGVTeW5jKCd3YXN0ZWQuanBnJyksIE1lc3NhZ2VUeXBlLmltYWdlKQoJCQkJCX0gZWxzZSB7CgkJCQkJCXJlcGx5KCdNYW5kYSBsYSBmb3RvIScpOwoJCQkJCX0KCQkJCQlicmVhawoJCQkJCQoJCQkJCmNhc2UgJ2dlcic6CiBpZiAoIWlzUmVnaXN0ZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkudXNlckIpCiAgICAgICAgICAgIHZhciBpbWdiYiA9IHJlcXVpcmUoJ2ltZ2JiLXVwbG9hZGVyJykKICAgICAgICAgICBpZiAoKGlzTWVkaWEgJiYgIXNhbS5tZXNzYWdlLnZpZGVvTWVzc2FnZSB8fCBpc1F1b3RlZEltYWdlKSAmJiBhcmdzLmxlbmd0aCA9PSAwKSB7CiAgICAgICAgICAgZ2VyID0gaXNRdW90ZWRJbWFnZSA/IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8gOiBzYW0KICAgICAgICAgICByZXBseShtZXNzLndhaXQpCiAgICAgICAgIG93Z2kgPSBhd2FpdCBzYW11MzMwLmRvd25sb2FkQW5kU2F2ZU1lZGlhTWVzc2FnZShnZXIpCiAgICAgICAgICAgYW51ID0gYXdhaXQgaW1nYmIoJzIwYTE0ODYxZTRmNzU5MWYzZGM1MjY0OWNiMDdhZTAyJywgb3dnaSkKICAgICAgICB0ZWtzID0gYCR7YW51LmRpc3BsYXlfdXJsfWAKICAgICAgICAgcmFucCA9IGdldFJhbmRvbSgnLmdpZicpCiAgICAgICAgcmFubyA9IGdldFJhbmRvbSgnLndlYnAnKQogICAgICAgIGFudTEgPSBgaHR0cHM6Ly9zb21lLXJhbmRvbS1hcGkubWwvY2FudmFzL3RyaWdnZXJlZD9hdmF0YXI9JHt0ZWtzfWAKICAgICAgIGV4ZWMoYHdnZXQgJHthbnUxfSAtTyAke3JhbnB9ICYmIGZmbXBlZyAtaSAke3JhbnB9IC12Y29kZWMgbGlid2VicCAtZmlsdGVyOnYgZnBzPWZwcz0yMCAtbG9zc2xlc3MgMSAtbG9vcCAwIC1wcmVzZXQgZGVmYXVsdCAtYW4gLXZzeW5jIDAgLXMgNTEyOjUxMiAke3Jhbm99YCwgKGVycikgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcy51bmxpbmtTeW5jKHJhbnApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHJldHVybiByZXBseShtZXNzLmVycm9yLnN0aWNrKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2JnID0gZnMucmVhZEZpbGVTeW5jKHJhbm8pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgbm9iZywgc3RpY2tlciwge3F1b3RlZDogZnRva299KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcy51bmxpbmtTeW5jKHJhbm8pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGx5KCdTZSBuZWNlY2l0YSB1bmEgZm90byEnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCgkJCQkKCQkJCQpjYXNlICd3YW50ZWQnOgp2YXIgaW1nYmIgPSByZXF1aXJlKCdpbWdiYi11cGxvYWRlcicpCmlmICgoaXNNZWRpYSAmJiAhc2FtLm1lc3NhZ2UudmlkZW9NZXNzYWdlIHx8IGlzUXVvdGVkSW1hZ2UpICYmIGFyZ3MubGVuZ3RoID09IDApIHsKICB0ZWQgPSBpc1F1b3RlZEltYWdlID8gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzYW0pLnJlcGxhY2UoJ3F1b3RlZE0nLCAnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm86IHNhbQogIHJlcGx5KG1lc3Mud2FpdCkKICBvd2dpID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZEFuZFNhdmVNZWRpYU1lc3NhZ2UodGVkKQogIGFudSA9IGF3YWl0IGltZ2JiKCcyMGExNDg2MWU0Zjc1OTFmM2RjNTI2NDljYjA3YWUwMicsIG93Z2kpCiAgaGVoZSA9IGF3YWl0IGdldEJ1ZmZlcihgaHR0cHM6Ly92aWRlZmlrcmkuY29tL2FwaS90ZXh0bWFrZXIvd2FudGVkLz91cmxnYnI9JHthbnUuZGlzcGxheV91cmx9JnRleHQxPURpIENhcmkgT3JhbmcgR2lsYSZ0ZXh0Mj1IdWIgOiAwODgxMjkwNDI4M2ApCiBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGhlaGUsIGltYWdlLCB7cXVvdGVkOiBmaW1nLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9fSkKfSBlbHNlIHsKCXJlcGx5KCdNYW5kYSBsYSBmb3RvIScpOwp9CmJyZWFrCmNhc2UgJ2RyYXcnOgp2YXIgaW1nYmIgPSByZXF1aXJlKCdpbWdiYi11cGxvYWRlcicpCmlmICgoaXNNZWRpYSAmJiAhc2FtLm1lc3NhZ2UudmlkZW9NZXNzYWdlIHx8IGlzUXVvdGVkSW1hZ2UpICYmIGFyZ3MubGVuZ3RoID09IDApIHsKICB0ZWQgPSBpc1F1b3RlZEltYWdlID8gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzYW0pLnJlcGxhY2UoJ3F1b3RlZE0nLCAnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm86IHNhbQogIHJlcGx5KG1lc3Mud2FpdCkKICBvd2dpID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZEFuZFNhdmVNZWRpYU1lc3NhZ2UodGVkKQogIGFudSA9IGF3YWl0IGltZ2JiKGAke2ltZ2JiX2tleX1gLCBvd2dpKQogIGhlZGhlID0gYXdhaXQgZ2V0QnVmZmVyKGBodHRwczovL3ZpZGVmaWtyaS5jb20vYXBpL3RleHRtYWtlci9wZW5jaWxkcmF3aW5nLz91cmxnYnI9JHthbnUuZGlzcGxheV91cmx9YCkKIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgaGVkaGUsIGltYWdlLCB7cXVvdGVkOiBmdG9rbywgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfX0pCn0gZWxzZSB7CiAgcmVwbHkoJ0V0aXF1ZXRhIHVuYSBpbWFnZW4hJykKfQpicmVhawoJCQkJCmNhc2UgJ25vYmcnOgogIAp2YXIgaW1nYmIgPSByZXF1aXJlKCdpbWdiYi11cGxvYWRlcicpCmlmICgoaXNNZWRpYSAmJiAhc2FtLm1lc3NhZ2UudmlkZW9NZXNzYWdlIHx8IGlzUXVvdGVkSW1hZ2UpICYmIGFyZ3MubGVuZ3RoID09IDApIHsKICB0ZWQgPSBpc1F1b3RlZEltYWdlID8gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzYW0pLnJlcGxhY2UoJ3F1b3RlZE0nLCAnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm86IHNhbQogIHJlcGx5KG1lc3Mud2FpdCkKICBvd2dpID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZEFuZFNhdmVNZWRpYU1lc3NhZ2UodGVkKQogIGFudSA9IGF3YWl0IGltZ2JiKCcyMGExNDg2MWU0Zjc1OTFmM2RjNTI2NDljYjA3YWUwMicsIG93Z2kpCiAgc2F0dSA9IGF3YWl0IGdldEJ1ZmZlcihgaHR0cDovL2FwaS5sb2xodW1hbi54eXovYXBpL3JlbW92ZWJnP2FwaWtleT1CYW5kTmFvNzEmaW1nPSR7YW51LmRpc3BsYXlfdXJsfWApCiBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIHNhdHUsIGltYWdlLCB7cXVvdGVkOiBmZ2MsIGNvbnRleHRJbmZvOiB7ImZvcndhcmRpbmdTY29yZSI6IDk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZX19KQp9IGVsc2UgewogIHJlcGx5KCdldGlxdWV0YSB1bmEgaW1hZ2VuIScpCn0KYnJlYWsKCQkJCQpjYXNlICdvY2Vhbic6Cgp2YXIgaW1nYmIgPSByZXF1aXJlKCdpbWdiYi11cGxvYWRlcicpCgppZiAoKGlzTWVkaWEgJiYgIXNhbS5tZXNzYWdlLnZpZGVvTWVzc2FnZSB8fCBpc1F1b3RlZEltYWdlKSAmJiBhcmdzLmxlbmd0aCA9PSAwKSB7CiAgdGVkID0gaXNRdW90ZWRJbWFnZSA/IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywgJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvOiBzYW0KICByZXBseShtZXNzLndhaXQpCiAgb3dnaSA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRBbmRTYXZlTWVkaWFNZXNzYWdlKHRlZCkKICBhbnUgPSBhd2FpdCBpbWdiYignMjBhMTQ4NjFlNGY3NTkxZjNkYzUyNjQ5Y2IwN2FlMDInLCBvd2dpKQogIGhlZGhlID0gYXdhaXQgZ2V0QnVmZmVyKGBodHRwczovL3ZpZGVmaWtyaS5jb20vYXBpL3RleHRtYWtlci9uaWdodGJlYWNoLz91cmxnYnI9JHthbnUuZGlzcGxheV91cmx9YCkKIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgaGVkaGUsIGltYWdlLCB7cXVvdGVkOiBmaW1nLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9fSkKfSBlbHNlIHsKICByZXBseSgnRXRpcXVldGEgdW5hIGltYWdlbicpCn0KYnJlYWsKCQkJCQpjYXNlICdndGF2JzoKaWYgKCFpc1JlZ2lzdGVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LnVzZXJCKQp2YXIgaW1nYmIgPSByZXF1aXJlKCdpbWdiYi11cGxvYWRlcicpCmlmICgoaXNNZWRpYSAmJiAhc2FtLm1lc3NhZ2UudmlkZW9NZXNzYWdlIHx8IGlzUXVvdGVkSW1hZ2UpICYmIGFyZ3MubGVuZ3RoID09IDApIHsKICB0ZWQgPSBpc1F1b3RlZEltYWdlID8gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzYW0pLnJlcGxhY2UoJ3F1b3RlZE0nLCAnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm86IHNhbQogIHJlcGx5KG1lc3Mud2FpdCkKICBvd2dpID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZEFuZFNhdmVNZWRpYU1lc3NhZ2UodGVkKQogIGFudSA9IGF3YWl0IGltZ2JiKCcyMGExNDg2MWU0Zjc1OTFmM2RjNTI2NDljYjA3YWUwMicsIG93Z2kpCiAgaGVoZSA9IGF3YWl0IGdldEJ1ZmZlcihgaHR0cHM6Ly92aWRlZmlrcmkuY29tL2FwaS90ZXh0bWFrZXIvZ3RhdnBvc3Rlci8/dXJsZ2JyPSR7YW51LmRpc3BsYXlfdXJsfWApCiBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGhlaGUsIGltYWdlLCB7cXVvdGVkOmZpbWd9KQp9IGVsc2UgewogIHJlcGx5KCdNYW5kYSBsYSBmb3RvJykKfQpicmVhawoKCQkJCWNhc2UgJ3RvZ2lmJzoKCQkJCQlnZXIgPSBpc1F1b3RlZFN0aWNrZXIgPyBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkucmVwbGFjZSgncXVvdGVkTScsJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvIDogc2FtCgkJCQkJdmFyIGltZ2JiID0gcmVxdWlyZSgnaW1nYmItdXBsb2FkZXInKQoJCQkJCXJlcGx5KG1lc3Mud2FpdCkKCQkJCQlvd2dpID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZEFuZFNhdmVNZWRpYU1lc3NhZ2UoZ2VyKQoJCQkJCWRhdGEgPSBhd2FpdCBpbWdiYigiYjBmYzEzMjQ3NGNhMDNlZTc4OThmZDVjYWM3Mjc1ZmUiLCBvd2dpKQoJCQkJCWFudSA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkubG9saHVtYW4ueHl6L2FwaS9jb252ZXJ0L3dlYnB0b21wND9hcGlrZXk9QmFuZE5hbzcxJmltZz0ke2RhdGEuZGlzcGxheV91cmx9YCkKCQkJCQlyZXN1bHQgPSBhd2FpdCBnZXRCdWZmZXIoYW51LnJlc3VsdCkKCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIHJlc3VsdCwgdmlkZW8sIHtxdW90ZWQ6IHNhbSwgY2FwdGlvbjogbWVzcy5zdWNjZXNzLCBtaW1ldHlwZTogJ3ZpZGVvL2dpZid9KQoJCQkJCWJyZWFrCgkJCQkKY2FzZSAnb2xkJzoKdmFyIGltZ2JiID0gcmVxdWlyZSgnaW1nYmItdXBsb2FkZXInKQppZiAoKGlzTWVkaWEgJiYgIXNhbS5tZXNzYWdlLnZpZGVvTWVzc2FnZSB8fCBpc1F1b3RlZEltYWdlKSAmJiBhcmdzLmxlbmd0aCA9PSAwKSB7CiAgdGVkID0gaXNRdW90ZWRJbWFnZSA/IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywgJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvOiBzYW0KICByZXBseShtZXNzLndhaXQpCiAgb3dnaSA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRBbmRTYXZlTWVkaWFNZXNzYWdlKHRlZCkKICBhbnUgPSBhd2FpdCBpbWdiYignMjBhMTQ4NjFlNGY3NTkxZjNkYzUyNjQ5Y2IwN2FlMDInLCBvd2dpKQogIGhlZGhlID0gYXdhaXQgZ2V0QnVmZmVyKGBodHRwczovL2xleXNjb2RlcnMtYXBpLmhlcm9rdWFwcC5jb20vYXBpL2ltZy9ncmV5c2NhbGU/dXJsPSR7YW51LmRpc3BsYXlfdXJsfSZhcGlrZXk9ZnJlZUtlWWApCiBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGhlZGhlLCBpbWFnZSwge3F1b3RlZDogZnRva28sIGNvbnRleHRJbmZvOiB7ImZvcndhcmRpbmdTY29yZSI6IDk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZX19KQp9IGVsc2UgewogIHJlcGx5KCdyZXBseSBpbWFnZW55YSBrYWshJykKfQpicmVhawoKY2FzZSAnY2lyY2xlJzoKICB2YXIgaW1nYmIgPSByZXF1aXJlKCdpbWdiYi11cGxvYWRlcicpCmlmICgoaXNNZWRpYSAmJiAhc2FtLm1lc3NhZ2UudmlkZW9NZXNzYWdlIHx8IGlzUXVvdGVkSW1hZ2UpICYmIGFyZ3MubGVuZ3RoID09IDApIHsKICB0ZWQgPSBpc1F1b3RlZEltYWdlID8gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzYW0pLnJlcGxhY2UoJ3F1b3RlZE0nLCAnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm86IHNhbQogIHJlcGx5KG1lc3Mud2FpdCkKICBvd2dpID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZEFuZFNhdmVNZWRpYU1lc3NhZ2UodGVkKQogIGFudSA9IGF3YWl0IGltZ2JiKCcyMGExNDg2MWU0Zjc1OTFmM2RjNTI2NDljYjA3YWUwMicsIG93Z2kpCiAgaGVkaGUgPSBhd2FpdCBnZXRCdWZmZXIoYGh0dHA6Ly9hcGkubG9saHVtYW4ueHl6L2FwaS9jb252ZXJ0L3Rvd2VicHdyb3VuZD9hcGlrZXk9QmFuZE1hbzcxJmltZz0ke2FudS5kaXNwbGF5X3VybH1gKQogc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBoZWRoZSwgc3RpY2tlciwge3F1b3RlZDogZnRva28sIGNvbnRleHRJbmZvOiB7ImZvcndhcmRpbmdTY29yZSI6IDk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZX19KQp9IGVsc2UgewogIHJlcGx5KCdyZXBseSBpbWFnZW55YSBrYWshJykKfQpicmVhawogCgkJCQljYXNlICdsbHV2aWEnOgoKaWYgKGFyZ3MubGVuZ3RoIDwgMSkgcmV0dXJuIHJlcGx5KGBlamVtcGxvOiAke3ByZWZpeH1sbHV2aWEgKGxpbmsgZGUgaW1hZ2VuKWApCnNkb3cgPSBhcmdzLmpvaW4oJyAnKQpyZXBseShtZXNzLndhaXQpCnNoYW4gPSBhd2FpdCBnZXRCdWZmZXIoYGh0dHBzOi8vdmlkZWZpa3JpLmNvbS9hcGkvdGV4dG1ha2VyL3JhaW5kcm9wLz91cmxnYnI9JHtzZG93fWApCnNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgc2hhbiwgaW1hZ2UsIHtxdW90ZWQ6IGZkb2MsIGNvbnRleHRJbmZvOiB7ImZvcndhcmRpbmdTY29yZSI6IDk5OSwgImlzRm9yd2FyZGVkIgo6IHRydWV9fSkKCQkJCWJyZWFrCgkJCQkKCQkJY2FzZSAndXBzdGF0dXMnOgogICAgICAgICAgICAgICAgICAgICBxID0gYXJncy5qb2luKCcgJykKCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoJ3N0YXR1c0Bicm9hZGNhc3QnLCBgJHtxfWAsIGV4dGVuZGVkVGV4dCkKCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYFN1a3NlcyFgLCB0ZXh0LCB7IHF1b3RlZDogeyBrZXk6IHsgZnJvbU1lOiBmYWxzZSwgcGFydGljaXBhbnQ6IGAwQHMud2hhdHNhcHAubmV0YCwgLi4uKGZyb20gPyB7IHJlbW90ZUppZDogInN0YXR1c0Bicm9hZGNhc3QiIH0gOiB7fSkgfSwgbWVzc2FnZTogeyAiaW1hZ2VNZXNzYWdlIjogeyAibWltZXR5cGUiOiAiaW1hZ2UvanBlZyIsICJjYXB0aW9uIjogIlN1Y2VzcyEiLCAnanBlZ1RodW1ibmFpbCc6IGZzLnJlYWRGaWxlU3luYygnLi9zcmMvSXZhbi5qcGcnKX19fX0pCgpicmVhawpjYXNlICdyZWFkYWxsY2hhdCc6CiAgIGNhc2UgJ3JlYWRhbGwnOgogICAgICBjYXNlICdyYWxsJzoKCQkJCWNvbnN0IHJlYWRhbGxpZCA9IGF3YWl0IHNhbXUzMzAuY2hhdHMuYWxsKCkKCQkJc2FtdTMzMC5zZXRNYXhMaXN0ZW5lcnMoMjUpCgkJCQlmb3IgKGxldCB4eXogb2YgcmVhZGFsbGlkKSB7CgkJCQkJYXdhaXQgc2FtdTMzMC5jaGF0UmVhZCh4eXouamlkKQoJCQkJfQoJCSAgICAgIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYFN1a3NlcyFgLCB0ZXh0LCB7IHF1b3RlZDogeyBrZXk6IHsgZnJvbU1lOiBmYWxzZSwgcGFydGljaXBhbnQ6IGAwQHMud2hhdHNhcHAubmV0YCwgLi4uKGZyb20gPyB7IHJlbW90ZUppZDogInN0YXR1c0Bicm9hZGNhc3QiIH0gOiB7fSkgfSwgbWVzc2FnZTogeyAiaW1hZ2VNZXNzYWdlIjogeyAibWltZXR5cGUiOiAiaW1hZ2UvanBlZyIsICJjYXB0aW9uIjogIkJlcmhhc2lsIG1lbWJhY2Egc2VtdWEgY2hhdCEiLCAnanBlZ1RodW1ibmFpbCc6IGZzLnJlYWRGaWxlU3luYygnLi9zcmMvSXZhbi5qcGcnKX19fX0pCmJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCgkJCQkgICAgICAgY2FzZSAnZ2V0cGljJzoKCQkJCQlpZiAoIWlzR3JvdXApIHJldHVybiByZXBseShtZXNzLm9ubHkuZ3JvdXApCgkJCQkJaWYgKGFyZ3MubGVuZ3RoIDwgMSkgcmV0dXJuIAoJCQkJCWlmIChzYW0ubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlID09PSB1bmRlZmluZWQgfHwgc2FtLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZSA9PT0gbnVsbCkgcmV0dXJuIHJlcGx5KCdOeWFuQm90JykKCQkJCQltZW50aW9uZWQgPSBzYW0ubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvLm1lbnRpb25lZEppZFswXQoJCQkJCQl0cnkgewoJCQkJCQlwcCA9IGF3YWl0IHNhbXUzMzAuZ2V0UHJvZmlsZVBpY3R1cmUobWVudGlvbmVkKQoJCQkJCQlidWZmZXIgPSBhd2FpdCBnZXRCdWZmZXIocHApCgkJCQkJCQoJCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGJ1ZmZlciwgaW1hZ2UsIHtxdW90ZWQ6IGZpbWcsIGNvbnRleHRJbmZvOiB7ImZvcndhcmRpbmdTY29yZSI6IDk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZX19KQoJCQkJCX0gY2F0Y2ggKGUpIHsKCQkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBidWZmZXIsIGltYWdlLCB7cXVvdGVkOiBmaW1nLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9fSkKCQkJCQl9CgkJCQlicmVhawoJCQkJCWNhc2UgJ2hhY2snOgoJCQkJdmFyIG5uID0gYXJncy5qb2luKCcgJykKCQkJCXZhciB1cmxueWUgPSBubi5zcGxpdCgifCIpWzBdOwoJCQkJdmFyIHRpdGxlbnllID0gbm4uc3BsaXQoInwiKVsxXTsKCQkJCXZhciBkZXNjbnllID0gbm4uc3BsaXQoInwiKVsyXTsKCQkJCWltZ2JiYiA9IHJlcXVpcmUoJ2ltZ2JiLXVwbG9hZGVyJykKCQkJCXJ1biA9IGdldFJhbmRvbSgnLmpwZWcnKQoJCQkJZW5jbWVkaWEgPSBpc1F1b3RlZEltYWdlID8gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzYW0pLnJlcGxhY2UoJ3F1b3RlZE0nLCAnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8gOiBzYW0KCQkJCW1lZGlhID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZEFuZFNhdmVNZWRpYU1lc3NhZ2UoZW5jbWVkaWEpCgkJCQlkZGF0YWUgPSBhd2FpdCBpbWFnZVRvQmFzZTY0KEpTT04uc3RyaW5naWZ5KG1lZGlhKS5yZXBsYWNlKC9cIi9naSwgJycpKQoKCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgewoKCQkJCQl0ZXh0OiBgJHt1cmxueWV9YCwKCgkJCQkJbWF0Y2hlZFRleHQ6IGAke3VybG55ZX1gLAoKCQkJCQljYW5vbmljYWxVcmw6IGAke3VybG55ZX1gLAoKCQkJCQlkZXNjcmlwdGlvbjogYCR7ZGVzY255ZX1gLAoKCQkJCQl0aXRsZTogYCR7dGl0bGVueWV9YCwKCgkJCQkJanBlZ1RodW1ibmFpbDogZGRhdGFlCgkJCQl9LCAnZXh0ZW5kZWRUZXh0TWVzc2FnZScsIHsgZGV0ZWN0TGlua3M6IGZhbHNlIH0pCgkJCQlicmVhawoKCQkJCWNhc2UgJ3B1YmxpYyc6CgkJCQljYXNlICdwdWJsaWsnOgoJCQkJICAgcHVibGlrID0gdHJ1ZQoJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShzYW0ua2V5LnJlbW90ZUppZCwgYOOAjCAqUFVCTElDLU1PREUqIOOAjWAsIE1lc3NhZ2VUeXBlLnRleHQsIHsgcXVvdGVkOmZ0b2tvfSkKCQkJYnJlYWsKCQkJCWNhc2UgJ3ByaXZhZG8nOgoJCQkJICAgcHVibGlrID0gZmFsc2UKCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2Uoc2FtLmtleS5yZW1vdGVKaWQsIGDjgIwgKk1PRE8gUFJJVkFETyog44CNYCwgTWVzc2FnZVR5cGUudGV4dCwgeyBxdW90ZWQ6ZnRva299KQoJCQlicmVhawoJCQkJCgkJY2FzZSAnc2V0aW1nJzoKCQkJCWlmICghaXNRdW90ZWRJbWFnZSkKCQkgICAgIAlpZgkoIWlzUXVvdGVkU3RpY2tlcilyZXR1cm4gcmVwbHkoJ0V0aXF1ZXRhIHVuYSBpbWFnZW4hJykKCQkJCWNvbnN0IHRodW1icmVwbHkgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkucmVwbGFjZSgncXVvdGVkTScsICdtJykpLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mbwoJCQkJY29uc3QgZG93bnJlcGx5ID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZE1lZGlhTWVzc2FnZSh0aHVtYnJlcGx5KQoJCQkJZnMudW5saW5rU3luYyhgLi9zcmMvTnlhbkJvdC5qcGdgKQoJCQkJZnMud3JpdGVGaWxlU3luYyhgLi9zcmMvTnlhbkJvdC5qcGdgLCBkb3ducmVwbHkpCgkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYHNlIGNhbWJpbyBjb3JyZWN0YW1lbnRlIGxhIG1pbmlhdHVyYSBkZSByZXNwdWVzdGFgLCB0ZXh0LCB7IHF1b3RlZDogeyBrZXk6IHsgZnJvbU1lOiBmYWxzZSwgcGFydGljaXBhbnQ6IGAwQHMud2hhdHNhcHAubmV0YCwgLi4uKGZyb20gPyB7IHJlbW90ZUppZDogInN0YXR1c0Bicm9hZGNhc3QiIH0gOiB7fSkgfSwgbWVzc2FnZTogeyAiaW1hZ2VNZXNzYWdlIjogeyAibWltZXR5cGUiOiAiaW1hZ2UvanBlZyIsICJjYXB0aW9uIjogIlN1Y2VzcyIsICdqcGVnVGh1bWJuYWlsJzogZnMucmVhZEZpbGVTeW5jKCcuL3NyYy9JdmFuLmpwZycpfX19fSkKYnJlYWsKY2FzZSAnc2V0aW1nbWVudSc6CgkJCQlpZiAoIWlzUXVvdGVkSW1hZ2UpCgkJICAgICAJaWYJKCFpc1F1b3RlZFN0aWNrZXIpcmV0dXJuIHJlcGx5KCdFdGlxdWV0YSB1bmEgaW1hZ2VuIScpCgkJCQljb25zdCB0aHVtYm1lbnUgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkucmVwbGFjZSgncXVvdGVkTScsICdtJykpLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mbwoJCQkJY29uc3QgZG93bm1lbnUgPSBhd2FpdCBzYW11MzMwLmRvd25sb2FkTWVkaWFNZXNzYWdlKHRodW1ibWVudSkKCQkJCWZzLnVubGlua1N5bmMoYC4vc3JjL2hlbHAuanBnYCkKCQkJCWZzLndyaXRlRmlsZVN5bmMoYC4vc3JjL2hlbHAuanBnYCwgZG93bm1lbnUpCgkJCQlhbnUgPSBmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL2hlbHAuanBnJykKCQkJCWFudXUgPSBmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL2Zha2UuanBnJykKCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYW51LCBpbWFnZSwgeyBxdW90ZWQ6ZnRva28sIGNhcHRpb246IGBTZSBjYW1iaW8gbGEgaW1hZ2VuIGRlbCBtZW51YCwgdGh1bWJuYWlsOiBhbnV1fSkKYnJlYWsKCgkJCWRlZmF1bHQ6CgkJCQkJaWYgKGJvZHkuc3RhcnRzV2l0aChgJHtwcmVmaXh9JHtjb21tYW5kfWApKSB7CiAgcmVwbHkoYCAgICAgICAgwrvCu+KAlOKAlOKAlOKAlC3jgIDimIXjgIDigJTigJTigJTigJQtwqvCq1xuSG9sYSAqJHtwdXNobmFtZX0qICEhIVxuRXNlIGNvbWFuZG8gbm8gZXN0YSBlbiBtaSBsaXN0YSA6ICoke3ByZWZpeH0ke2NvbW1hbmR9KlxuVXNhIGVzdG8gcGFyYSB2ZXIgZWwgbWVudTogKiR7cHJlZml4fU1lbnUqXG4gICAgICAgIMK7wrvigJTigJTigJTigJQt44CA4piF44CA4oCU4oCU4oCU4oCULcKrwqtgKQoJCQkJfQoJCQkJCWlmIChpc0dyb3VwICYmIGlzU2ltaSAmJiBidWR5ICE9IHVuZGVmaW5lZCkgewoJCQkJCQljb25zb2xlLmxvZyhidWR5KQoJCQkJCQltdWVoZSA9IGF3YWl0IHNpbWloKGJ1ZHkpCgkJCQkJCWNvbnNvbGUubG9nKG11ZWhlKQoJCQkJCQlyZXBseShtdWVoZSkKCQkJCQl9IGVsc2UgewoJCQkJCQlyZXR1cm4gLy9jb25zb2xlLmxvZyhjb2xvcignW1dBUk5dJywncmVkJyksICdVbnJlZ2lzdGVyZWQgQ29tbWFuZCBmcm9tJywgY29sb3Ioc2VuZGVyLnNwbGl0KCdAJylbMF0pKQoJCQkJCX0KfQoJCQoJfSBjYXRjaCAoZSkgewoJCWNvbnNvbGUubG9nKCclcycsIGNvbG9yKGUsICdyZWQnKSkKCQkvLyBjb25zb2xlLmxvZyhlKQoJfQp9KQp9CnN0YXJ0cygpCg==

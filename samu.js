Y29uc3QKCXsKICBXQUNvbm5lY3Rpb24sCiAgTWVzc2FnZVR5cGUsCiAgUHJlc2VuY2UsCiAgTWltZXR5cGUsCiAgR3JvdXBTZXR0aW5nQ2hhbmdlLAogIE1lc3NhZ2VPcHRpb25zLAogIFdBTG9jYXRpb25NZXNzYWdlLAogIFdBX01FU1NBR0VfU1RVQl9UWVBFUywKICBSZWNvbm5lY3RNb2RlLAogIFByb3h5QWdlbnQsCiAgd2FDaGF0S2V5LAogIG1lbnRpb25lZEppZCwKICBwcm9jZXNzVGltZSwKICBDaGF0TW9kaWZpY2F0aW9uLAp9ID0gcmVxdWlyZSgnQGFkaXdhanNoaW5nL2JhaWxleXMnKTsKCmNvbnN0IHFyY29kZSA9IHJlcXVpcmUoInFyY29kZS10ZXJtaW5hbCIpOwpjb25zdCBtb21lbnQgPSByZXF1aXJlKCJtb21lbnQtdGltZXpvbmUiKTsKY29uc3QgZnMgPSByZXF1aXJlKCJmcyIpOwpjb25zdCBicmFpbmx5ID0gcmVxdWlyZSgiYnJhaW5seS1zY3JhcGVyIik7CmNvbnN0IHsgY29sb3IsIGJnY29sb3IgfSA9IHJlcXVpcmUoJy4vbGliL2NvbG9yJyk7CmNvbnN0IHsgZmV0Y2hKc29uIH0gPSByZXF1aXJlKCcuL2xpYi9mZXRjaGVyJyk7CmNvbnN0IHsgcmVjb2duaXplIH0gPSByZXF1aXJlKCcuL2xpYi9vY3InKTsKY29uc3QKIHsgCiAgd2FpdCwKICBzaW1paCwKICBnZXRCdWZmZXIsCiAgaDJrLAogIGdlbmVyYXRlTWVzc2FnZUlELAogIGdldEdyb3VwQWRtaW5zLAogIGdldFJhbmRvbSwKICBiYW5uZXIsCiAgc3RhcnQsIAogIGluZm8sCiAgc3VjY2Vzcwp9ID0gcmVxdWlyZSgnLi9saWIvZnVuY3Rpb25zJyk7Cgpjb25zdCBheGlvcyA9IHJlcXVpcmUoImF4aW9zIik7CmNvbnN0IG9zID0gcmVxdWlyZSgnb3MnKTsKY29uc3QgQ3J5cHRvSlMgPSByZXF1aXJlKCJjcnlwdG8tanMiKTsKY29uc3QgcmVxdWVzdCA9IHJlcXVpcmUoJ3JlcXVlc3QnKTsKY29uc3QgdXRpbCA9IHJlcXVpcmUoJ3V0aWwnKTsKY29uc3QgZmZtcGVnID0gcmVxdWlyZSgnZmx1ZW50LWZmbXBlZycpOwpjb25zdCBpbWdiYiA9IHJlcXVpcmUoJ2ltZ2JiLXVwbG9hZGVyJyk7CmNvbnN0IGltYWdlVG9CYXNlNjQgPSByZXF1aXJlKCdpbWFnZS10by1iYXNlNjQnKTsKY29uc3QgeyBVdGlsc18xIH0gPSByZXF1aXJlKCcuL25vZGVfbW9kdWxlcy9AYWRpd2Fqc2hpbmcvYmFpbGV5cy9saWIvV0FDb25uZWN0aW9uL1V0aWxzJykKY29uc3QgeyByZW1vdmVCYWNrZ3JvdW5kRnJvbUltYWdlRmlsZSB9ID0gcmVxdWlyZSgncmVtb3ZlLmJnJyk7CmNvbnN0IHdlbGtvbSA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKCcuL3NyYy93ZWxrb20uanNvbicpKTsKY29uc3QgYW50aW1lZGlhID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL2FudGltZWRpYS5qc29uJykpOwpjb25zdCBiYWQgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYygnLi9zcmMvYmFkLmpzb24nKSk7CmNvbnN0IGJhZHdvcmQgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYygnLi9zcmMvYmFkd29yZC5qc29uJykpOwpjb25zdCBhdXRvc3RpY2sgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYygnLi9zcmMvYXV0b3N0aWNrLmpzb24nKSk7CmNvbnN0IG5zZncgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYygnLi9zcmMvbnNmdy5qc29uJykpOwpjb25zdCBhbnRpbGluayA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKCcuL3NyYy9hbnRpbGluay5qc29uJykpOwpjb25zdCBzZXRpa2VyID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL3N0aWsuanNvbicpKQpjb25zdCB2aWRlb255ZSA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKCcuL3NyYy92aWRlby5qc29uJykpCmNvbnN0IGF1ZGlvbnllID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL2F1ZGlvLmpzb24nKSkKY29uc3QgaW1hZ2VueWUgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYygnLi9zcmMvaW1hZ2UuanNvbicpKQpjb25zdCBzYW11ID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoJy4vc2V0dGluZy5qc29uJykpCmNvbnN0IHsgc3Bhd24sIGV4ZWMsIGV4ZWNTeW5jIH0gPSByZXF1aXJlKCJjaGlsZF9wcm9jZXNzIikKY29uc3Qgc3BlZWQgPSByZXF1aXJlKCdwZXJmb3JtYW5jZS1ub3cnKQpjb25zdCBjcnlwdG8gPSByZXF1aXJlKCdjcnlwdG8nKQpjb25zdCBzaW1pID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL3NpbWkuanNvbicpKQpjb25zdCBfcmVnaXN0ZXJlZCA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKCcuL3NyYy9yZWdpc3RlcmVkLmpzb24nKSkKY29uc3QgYmFuID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL2Jhbm5lZC5qc29uJykpCmNvbnN0IHByZW1pdW0gPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYygnLi9zcmMvcHJlbWl1bS5qc29uJykpCmNvbnN0IEV4aWYgPSByZXF1aXJlKCcuL2xpYi9leGlmJykKY29uc3QgZXhpZiA9IG5ldyBFeGlmKCkKCi8vU2V0dGluZ3MKcHVibGlrID0gdHJ1ZQpwcmVmaXggPSBzYW11LnByZWZpeApzYW15cGVycnkgPSBzYW11LnNhbXlwZXJyeQpib2R5TSA9IHNhbXUuc2FtdU0KdGFyZ2V0cHJpdmF0ZSA9ICcnCmJsb2NrZWQgPSBbXQoKLy9hcGlrZXkKYXBpID0gJ2VjMzUzNTNhOTkxYTI1OGIwNTg3Njg2MScKbG9sID0gc2FtdS5sb2wKemVrcyA9IHNhbXUuemVrcwppbWdiYl9rZXkgPSBzYW11LmltZ2JiX2tleQoKCmNvbnN0IGdldFJlZ2lzdGVyZWRSYW5kb21JZCA9ICgpID0+IHsKICByZXR1cm4gX3JlZ2lzdGVyZWRbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogX3JlZ2lzdGVyZWQubGVuZ3RoKV0uaWQKfQoKY29uc3QgYWRkUmVnaXN0ZXJlZFVzZXIgPSAodXNlcmlkLCBzZW5kZXIsIGFnZSwgdGltZSwgc2VyaWFscykgPT4gewogIGNvbnN0IG9iaiA9IHsKaWQ6IHVzZXJpZCwKbmFtZTogc2VuZGVyLAphZ2U6IGFnZSwKdGltZTogdGltZSwKc2VyaWFsOiBzZXJpYWxzCiAgfQogIF9yZWdpc3RlcmVkLnB1c2gob2JqKQogIGZzLndyaXRlRmlsZVN5bmMoJy4vc3JjL3JlZ2lzdGVyZWQuanNvbicsIEpTT04uc3RyaW5naWZ5KF9yZWdpc3RlcmVkKSkKfQoKY29uc3QgY3JlYXRlU2VyaWFsID0gKHNpemUpID0+IHsKICByZXR1cm4gY3J5cHRvLnJhbmRvbUJ5dGVzKHNpemUpLnRvU3RyaW5nKCdoZXgnKS5zbGljZSgwLCBzaXplKQp9Cgpjb25zdCBjaGVja1JlZ2lzdGVyZWRVc2VyID0gKHNlbmRlcikgPT4gewogIGxldCBzdGF0dXMgPSBmYWxzZQogIE9iamVjdC5rZXlzKF9yZWdpc3RlcmVkKS5mb3JFYWNoKChpKSA9PiB7CmlmIChfcmVnaXN0ZXJlZFtpXS5pZCA9PT0gc2VuZGVyKSB7CiAgc3RhdHVzID0gdHJ1ZQp9CiAgfSkKICByZXR1cm4gc3RhdHVzCn0KCgovL2Z1bmN0aW9uCmZ1bmN0aW9uIGt5dW4oc2Vjb25kcykgewoJZnVuY3Rpb24gcGFkKHMpIHsKCQlyZXR1cm4gKHMgPCAxMCA/ICcwJyA6ICcnKSArIHM7Cgl9Cgl2YXIgaG91cnMgPSBNYXRoLmZsb29yKHNlY29uZHMgLyAoNjAgKiA2MCkpOwoJdmFyIG1pbnV0ZXMgPSBNYXRoLmZsb29yKHNlY29uZHMgJSAoNjAgKiA2MCkgLyA2MCk7Cgl2YXIgc2Vjb25kcyA9IE1hdGguZmxvb3Ioc2Vjb25kcyAlIDYwKTsKCXJldHVybiBgJHtwYWQoaG91cnMpfToke3BhZChtaW51dGVzKX06JHtwYWQoc2Vjb25kcyl9YApsZXQgZCA9IG5ldyBEYXRlCgkJCQlsZXQgbG9jYWxlID0gJ2lkJwoJCQkJCWxldCBnbXQgPSBuZXcgRGF0ZSgwKS5nZXRUaW1lKCkgLSBuZXcgRGF0ZSgnMSBKYW51YXJpIDIwMjEnKS5nZXRUaW1lKCkKCQkJCQlsZXQgd2V0b24gPSBbJ1BhaGluZycsICdQb24nLCdXYWdlJywnS2xpd29uJywnTGVnaSddW01hdGguZmxvb3IoKChkICogMSkgKyBnbXQpIC8gODQ2MDAwMDApICUgNV0KCQkJCQlsZXQgd2VlayA9IGQudG9Mb2NhbGVEYXRlU3RyaW5nKGxvY2FsZSwgeyB3ZWVrZGF5OiAnbG9uZycgfSkKCQkJCQlsZXQgY2FsZW5kZXIgPSBkLnRvTG9jYWxlRGF0ZVN0cmluZyhsb2NhbGUsIHsKCQkJCWRheTogJ251bWVyaWMnLAoJCQkJbW9udGg6ICdsb25nJywKCQkJCXllYXI6ICdudW1lcmljJwoJCQkJfSkKCQkJbGV0IHYgPSBuZXcgRGF0ZQoJCQkJbGV0IGxvY2FsbGUgPSAnaWQnCgkJCQkJY29uc3QgaGFyaW55YSA9IGQudG9Mb2NhbGVEYXRlU3RyaW5nKGxvY2FsZSwgeyB3ZWVrZGF5OiAnbG9uZycgfSkKCQkJCQoJCQkJdmFyIHJhbWFkaGFuID0gTWF0aC5mbG9vcihwZW5naGl0dW5nUm1kIC0gbW9tZW50KCkuZm9ybWF0KCdERDpISDptbScpKSAKCQkJCWxldCBocmkgPSBuZXcgRGF0ZQoJCQkJbGV0IGxvY2FsZXYgPSAnaWQnCgkJCQkJdmFyIGhhcmk9IGhyaS50b0xvY2FsZURhdGVTdHJpbmcobG9jYWxldiwgeyB3ZWVrZGF5OiAnbG9uZycgfSkKfQoKYXN5bmMgZnVuY3Rpb24gc3RhcnRzKCkgewoJY29uc3Qgc2FtdTMzMCA9IG5ldyBXQUNvbm5lY3Rpb24oKQoJc2FtdTMzMC5sb2dnZXIubGV2ZWwgPSAnd2FybicKCXNhbXUzMzAub24oJ3FyJywgKCkgPT4gewoJCWNvbnNvbGUubG9nKGNvbG9yKCdbJywnd2hpdGUnKSwgY29sb3IoJyEnLCdyZWQnKSwgY29sb3IoJ10nLCd3aGl0ZScpLCBjb2xvcignIEVTQ0FORUEgRUwgQ09HSUdPIFdF7aC+7bWAJykpCgl9KQoKCWZzLmV4aXN0c1N5bmMoJy4vU2FtdS5qc29uJykgJiYgc2FtdTMzMC5sb2FkQXV0aEluZm8oJy4vU2FtdS5qc29uJykKCXNhbXUzMzAub24oJ2Nvbm5lY3RpbmcnLCAoKSA9PiB7CgkJc3RhcnQoJzInLCAnQ29ubmVjdGluZy4uLicpCgl9KQoJc2FtdTMzMC5vbignb3BlbicsICgpID0+IHsKCQlzdWNjZXNzKCcyJywgJ0NvbmVjdGFkb+2gve23vScpCgl9KQoJYXdhaXQgc2FtdTMzMC5jb25uZWN0KHt0aW1lb3V0TXM6IDMwKjEwMDB9KQogICAgICAgIGZzLndyaXRlRmlsZVN5bmMoJy4vU2FtdS5qc29uJywgSlNPTi5zdHJpbmdpZnkoc2FtdTMzMC5iYXNlNjRFbmNvZGVkQXV0aEluZm8oKSwgbnVsbCwgJ1x0JykpCgkJCQkKc2FtdTMzMC5vbignZ3JvdXAtcGFydGljaXBhbnRzLXVwZGF0ZScsIGFzeW5jIChhbnUpID0+IHsKCQlpZiAoIXdlbGtvbS5pbmNsdWRlcyhhbnUuamlkKSkgcmV0dXJuCgkJdHJ5IHsKCQkJY29uc3QgbWRhdGEgPSBhd2FpdCBzYW11MzMwLmdyb3VwTWV0YWRhdGEoYW51LmppZCkKCQkJY29uc29sZS5sb2coYW51KQoJCQlpZiAoYW51LmFjdGlvbiA9PSAnYWRkJykgewoJCQkJbnVtID0gYW51LnBhcnRpY2lwYW50c1swXQoJCQkJY29uc3QgbW9tZW50ID0gcmVxdWlyZSgnbW9tZW50LXRpbWV6b25lJykKY29uc3Qgam0gPSBtb21lbnQudHooJ0FzaWEvSmFrYXJ0YScpLmZvcm1hdCgnSEg6bW06c3MnKQoJCQlsZXQgZCA9IG5ldyBEYXRlCgkJCQlsZXQgbG9jYWxlID0gJ2lkJwoJCQkJCWxldCBnbXQgPSBuZXcgRGF0ZSgwKS5nZXRUaW1lKCkgLSBuZXcgRGF0ZSgnMSBKYW51YXJpIDIwMjEnKS5nZXRUaW1lKCkKCQkJCQlsZXQgd2V0b24gPSBbJ1BhaGluZycsICdQb24nLCdXYWdlJywnS2xpd29uJywnTGVnaSddW01hdGguZmxvb3IoKChkICogMSkgKyBnbXQpIC8gODQ2MDAwMDApICUgNV0KCQkJCQlsZXQgd2VlayA9IGQudG9Mb2NhbGVEYXRlU3RyaW5nKGxvY2FsZSwgeyB3ZWVrZGF5OiAnbG9uZycgfSkKCQkJCQlsZXQgY2FsZW5kZXIgPSBkLnRvTG9jYWxlRGF0ZVN0cmluZyhsb2NhbGUsIHsKCQkJCWRheTogJ251bWVyaWMnLAoJCQkJbW9udGg6ICdsb25nJywKCQkJCXllYXI6ICdudW1lcmljJwoJCQkJfSkKCgl0cnkgewoJCXB1c2huZW0gPSBzYW0ua2V5LmZyb21NZSA/IHNhbXUzMzAudXNlci5uYW1lIDogY29udHMubm90aWZ5IHx8IGNvbnRzLnZuYW1lIHx8IGNvbnRzLm5hbWUgfHwgJy0nCgp9IGNhdGNoIHsgCiBwdXNobmVtID0gbnVtLnNwbGl0KCdAJylbMF0KfQoJCQl0cnkgewoJCQkJcHBpbWcgPSBhd2FpdCBzYW11MzMwLmdldFByb2ZpbGVQaWN0dXJlKGAke2FudS5wYXJ0aWNpcGFudHNbMF0uc3BsaXQoJ0AnKVswXX1AYy51c2ApCgkJCX0gY2F0Y2ggewoJCQkJcHBpbWcgPSAnLi9zcmMvaW1hZ2UvcHAuanBlZycKCQkJfQoJCQkJZXhlYyhgbWFnaWNrICcuL3NyYy93ZWwuanBnJyAtZ3Jhdml0eSB3ZXN0IC1maWxsICcjMDBGRkZGJyAtZm9udCAnLi9zcmMvZm9udC1ndWUudHRmJyAtc2l6ZSAxMjgweDcxMCAtcG9pbnRzaXplIDc1IC1pbnRlcmxpbmUtc3BhY2luZyA3LjUgLWFubm90YXRlICs0NjAtNDUgJyR7cHVzaG5lbX0nIC1wb2ludHNpemUgMzUgLWFubm90YXRlICs0NjArODMgJyR7am19ICR7Y2FsZW5kZXJ9JyAtcG9pbnRzaXplIDUwIC1hbm5vdGF0ZSArNDYwKzIwMCAnQmllbnZlbmlkbyBhICR7bWRhdGEuc3ViamVjdH0nICcke3BwaW1nfScgLXJlc2l6ZSAlW2Z4OnQ/dS53KjAuMjp1LnddeCVbZng6P3UuaCowLjI6dS5oXSAtZ3Jhdml0eSBjZW50ZXIgLWdlb21ldHJ5IC00MzArNzAgLWNvbXBvc2l0ZSAnaGFtc2lsLmpwZydgKQoJCQkJLm9uKCdlcnJvcicsICgpID0+IHJlcGx5KCdlcnJvcicpKQoJCQkJLm9uKCdleGl0JywgKCkgPT4gewoJCQlzYW11MzMwLnNlbmRNZXNzYWdlKG1kYXRhLmlkLCBmcy5yZWFkRmlsZVN5bmMoJ2hhbXNpbC5qcGcnKSwgTWVzc2FnZVR5cGUuaW1hZ2UsIHtjYXB0aW9uOiBg7aC97biZSG9sYSwgQCR7bnVtLnNwbGl0KCdAJylbMF19LCBfKkJpZW52ZW5pZG8gYSAke21kYXRhLnN1YmplY3R9LCBlc3BlcmFtb3MgcXVlIHRlIGxhIHBhc2VzIGEgZ3VzdG8gZW4gZXN0ZSBncnVwb+KcqCpfXG5cbl9SZWN1ZXJkYSBzaWVtcHJlIHNlZ3VpciBsYXMgcmVnbGFzIHkgbWFudGVuZXIgdW5hIGZvcm1hbGlkYWQgcmVzcGV0dW9zYV/toL3tuIlcblxuU29uIGxhcyAqJHtqbX0qIGRlbCAqJHtjYWxlbmRlcn0qXG5cbiR7bWRhdGEuZGVzY31gLCBjb250ZXh0SW5mbzogeyBtZW50aW9uZWRKaWQ6IFtudW1dIH19KQoJCQl9KQoJCQkvL2xlYXZlCgkJfSAgZWxzZSBpZiAoYW51LmFjdGlvbiA9PSAncmVtb3ZlJykgewoJCQkJbnVtID0gYW51LnBhcnRpY2lwYW50c1swXQoJCQkJdGVrcyA9IGBfV2VubyBwcy4uLi4gYW1t7aC97biqLi4uICBAJHtudW0uc3BsaXQoJ0AnKVswXX0gc2Ugbm9zIGZ1ZSwgbmkgbGxvcmFyIGVzIGJ1ZW5vOilfCl8qT2phbGEgeSBsZSBiYXlhIGJpZW4sIHkgbWFzIGRlc3B1ZXMuLi4uLiBxdWUgbG8gYXRyb3BlbGxlIHVuIHRyZW4hIe2gve26ie2gvu20oypfCipObyBzZSBhd2l0ZW4gZ2VudGUsIGVzdGVuIHNlZ3Vyb3MgcXVlIG5hZGllIGxvIGV4dHJhw7FhcmE6RCpgCgkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKG1kYXRhLmlkLCB0ZWtzLCBNZXNzYWdlVHlwZS50ZXh0LHsgY29udGV4dEluZm86IHsibWVudGlvbmVkSmlkIjogW251bV19fSkKCQkJfQoJCX0gY2F0Y2ggKGUpIHsKCQljb25zb2xlLmxvZyhlKQoJfQoJfSkKCnNhbXUzMzAub24oJ0NCOkJsb2NrbGlzdCcsIGpzb24gPT4gewoJaWYgKGJsb2NrZWQubGVuZ3RoID4gMikgcmV0dXJuCglmb3IgKGxldCBpIG9mIGpzb25bMV0uYmxvY2tsaXN0KSB7CgkJYmxvY2tlZC5wdXNoKGkucmVwbGFjZSgnYy51cycsICdzLndoYXRzYXBwLm5ldCcpKQoJfQp9KQoKc2FtdTMzMC5vbignQ0I6YWN0aW9uLCxiYXR0ZXJ5JywganNvbiA9PiB7CgkJZ2xvYmFsLmJhdHRlcnlMZXZlbFN0ciA9IGpzb25bMl1bMF1bMV0udmFsdWUKCQlnbG9iYWwuYmF0dGVyeWxldmVsID0gcGFyc2VJbnQoYmF0dGVyeUxldmVsU3RyKQoJCWJhdGVyYWkgPSBiYXR0ZXJ5bGV2ZWwKCQlpZiAoanNvblsyXVswXVsxXS5saXZlID09ICd0cnVlJykgY2hhcmdpbmcgPSB0cnVlCgkJaWYgKGpzb25bMl1bMF1bMV0ubGl2ZSA9PSAnZmFsc2UnKSBjaGFyZ2luZyA9IGZhbHNlCgl9KQoJCgkvL0FOVElERUwKc2FtdTMzMC5vbignbWVzc2FnZS11cGRhdGUnLCBhc3luYyAoaHVydHopID0+IHsKCXRyeSB7CgkJY29uc3QgZnJvbSA9IGh1cnR6LmtleS5yZW1vdGVKaWQKCQljb25zdCBtZXNzYWdlU3R1YlR5cGUgPSBXQV9NRVNTQUdFX1NUVUJfVFlQRVNbaHVydHoubWVzc2FnZVN0dWJUeXBlXSB8fCAnTUVTU0FHRScKCQljb25zdCBkYXRhUmV2b2tlID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL2djLXJldm9rZWQuanNvbicpKQoJCWNvbnN0IGRhdGFDdFJldm9rZSA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKCcuL3NyYy9jdC1yZXZva2VkLmpzb24nKSkKCQljb25zdCBkYXRhQmFuQ3RSZXZva2UgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYygnLi9zcmMvY3QtcmV2b2tlZC1iYW5saXN0Lmpzb24nKSkKCQljb25zdCBzZW5kZXIgPSBodXJ0ei5rZXkuZnJvbU1lID8gc2FtdTMzMC51c2VyLmppZCA6IGh1cnR6LmtleS5yZW1vdGVKaWQuZW5kc1dpdGgoJ0BnLnVzJykgPyBodXJ0ei5wYXJ0aWNpcGFudCA6IGh1cnR6LmtleS5yZW1vdGVKaWQKCQljb25zdCBpc1Jldm9rZSA9IGh1cnR6LmtleS5yZW1vdGVKaWQuZW5kc1dpdGgoJ0BzLndoYXRzYXBwLm5ldCcpID8gdHJ1ZSA6IGh1cnR6LmtleS5yZW1vdGVKaWQuZW5kc1dpdGgoJ0BnLnVzJykgPyBkYXRhUmV2b2tlLmluY2x1ZGVzKGZyb20pIDogZmFsc2UKCQljb25zdCBpc0N0UmV2b2tlID0gaHVydHoua2V5LnJlbW90ZUppZC5lbmRzV2l0aCgnQGcudXMnKSA/IHRydWUgOiBkYXRhQ3RSZXZva2UuZGF0YSA/IHRydWUgOiBmYWxzZQoJCWNvbnN0IGlzQmFuQ3RSZXZva2UgPSBodXJ0ei5rZXkucmVtb3RlSmlkLmVuZHNXaXRoKCdAZy51cycpID8gdHJ1ZSA6ICFkYXRhQmFuQ3RSZXZva2UuaW5jbHVkZXMoc2VuZGVyKSA/IHRydWUgOiBmYWxzZQoJCWlmIChtZXNzYWdlU3R1YlR5cGUgPT0gJ1JFVk9LRScpIHsKCQkJY29uc29sZS5sb2coYEVzdGFkbyBkZWwgZ3J1cG8gOiAkeyFpc1Jldm9rZX1cbkVzdGFkbyBkZSB0b2RvcyBsb3MgY29udGFjdG9zIDogJHshaXNDdFJldm9rZX1cbkVsIGVzdGFkbyBkZWwgY29udGFjdG8gZXN0w6EgZXhjbHVpZG86ICR7IWlzQmFuQ3RSZXZva2V9YCkKCQkJaWYgKCFpc1Jldm9rZSkgcmV0dXJuCgkJCWlmICghaXNDdFJldm9rZSkgcmV0dXJuCgkJCWlmICghaXNCYW5DdFJldm9rZSkgcmV0dXJuCgkJCWNvbnN0IGZyb20gPSBodXJ0ei5rZXkucmVtb3RlSmlkCgkJCWNvbnN0IGlzR3JvdXAgPSBodXJ0ei5rZXkucmVtb3RlSmlkLmVuZHNXaXRoKCdAZy51cycpID8gdHJ1ZSA6IGZhbHNlCgkJCWxldCBpbnQKCQkJbGV0IGluZm9NU0cgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYygnLi9zcmMvLmRhdC9tc2cuZGF0YS5qc29uJykpCgkJCWNvbnN0IGlkX2RlbGV0ZWQgPSBodXJ0ei5rZXkuaWQKCQkJY29uc3Qgb3B0NHRhZyA9IHsKCQkJCWNvbnRleHRJbmZvOiB7IG1lbnRpb25lZEppZDogW3NlbmRlcl0gfQoJCQl9CgkJCWZvciAobGV0IGkgPSAwOyBpIDwgaW5mb01TRy5sZW5ndGg7IGkrKykgewoJCQkJaWYgKGluZm9NU0dbaV0ua2V5LmlkID09IGlkX2RlbGV0ZWQpIHsKCQkJCQljb25zdCBkYXRhSW5mbyA9IGluZm9NU0dbaV0KCQkJCQljb25zdCB0eXBlID0gT2JqZWN0LmtleXMoaW5mb01TR1tpXS5tZXNzYWdlKVswXQoJCQkJCWNvbnN0IHRpbWVzdGFtcCA9IGluZm9NU0dbaV0ubWVzc2FnZVRpbWVzdGFtcAoJCQkJCWludCA9IHsKCQkJCQkJbm86IGksCgkJCQkJCXR5cGU6IHR5cGUsCgkJCQkJCXRpbWVzdGFtcDogdGltZXN0YW1wLAoJCQkJCQlkYXRhOiBkYXRhSW5mbwoJCQkJCX0KCQkJCX0KCQkJfQoJCQljb25zdCBpbmRleCA9IE51bWJlcihpbnQubm8pCgkJCWNvbnN0IGJvZHkgPSBpbnQudHlwZSA9PSAnY29udmVyc2F0aW9uJyA/IGluZm9NU0dbaW5kZXhdLm1lc3NhZ2UuY29udmVyc2F0aW9uIDogaW50LnR5cGUgPT0gJ2V4dGVuZGVkVGV4dE1lc3NhZ2UnID8gaW5mb01TR1tpbmRleF0ubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLnRleHQgOiBpbnQudHlwZSA9PSAnaW1hZ2VNZXNzYWdlJyA/IGluZm9NU0dbaW5kZXhdLm1lc3NhZ2UuaW1hZ2VNZXNzYWdlLmNhcHRpb24gOiBpbnQudHlwZSA9PSAnc3RpY2tlck1lc3NhZ2UnID8gJ1N0aWNrZXInIDogaW50LnR5cGUgPT0gJ2F1ZGlvTWVzc2FnZScgPyAnQXVkaW8nIDogaW50LnR5cGUgPT0gJ3ZpZGVvTWVzc2FnZScgPyBpbmZvTVNHW2luZGV4XS52aWRlb01lc3NhZ2UuY2FwdGlvbiA6IGluZm9NU0dbaW5kZXhdCgkJCWJ1ZHkgPSAodHlwZSA9PT0gJ2NvbnZlcnNhdGlvbicpID8gaHVydHoubWVzc2FnZS5jb252ZXJzYXRpb24gOiAodHlwZSA9PT0gJ2V4dGVuZGVkVGV4dE1lc3NhZ2UnKSA/IGh1cnR6Lm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS50ZXh0IDogJycKCQkJY29uc3QgbWVkaWFEYXRhID0gaW50LnR5cGUgPT09ICdleHRlbmRlZFRleHRNZXNzYWdlJyA/IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoaW50LmRhdGEpLnJlcGxhY2UoJ3F1b3RlZE0nLCAnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8gOiBpbnQuZGF0YQoJCQlpZiAoaW50LnR5cGUgPT0gJ2NvbnZlcnNhdGlvbicgfHwgaW50LnR5cGUgPT0gJ2V4dGVuZGVkVGV4dE1lc3NhZ2UnKSB7CgkJCQljb25zdCBzdHJDb252ZXJzYXRpb24gPSBgCQkg44CMICpBTlRJLURFTEVURSog44CNCgoq4oiYIO2gve25je2gvO2/u+KAjeKZgu+4j05vbWJyZSA6KiAke3B1c2huYW1lfQoq4oiYIO2gve2zsk51bWVybyA6KiB3YS5tZS8ke3NlbmRlci5zcGxpdCgnQCcpWzBdfQoq4oiYIOKcj1RpcG8gOiogVGV4dAoq4oiYIO2gve21kEhvcmEgOiogJHttb21lbnQudW5peChpbnQudGltZXN0YW1wKS5mb3JtYXQoJ0hIOm1tOnNzJyl9CiriiJgg7aC97bOGRmVjaGEgOiogJHttb21lbnQudW5peChpbnQudGltZXN0YW1wKS5mb3JtYXQoJ0REL01NL1lZWVknKX0KKuKImCDtoL3ts6FNZW5zYWplIDoqICR7Ym9keSA/IGJvZHkgOiAnLSd9YAoJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBzdHJDb252ZXJzYXRpb24sIE1lc3NhZ2VUeXBlLnRleHQpCgoJCQl9CgkJfQp9IGNhdGNoIChlKSB7CgkJY29uc29sZS5sb2coJ01lc3NhZ2UgOiAlcycsIGNvbG9yKGUsICdyZWQnKSkKCQkvLyBjb25zb2xlLmxvZyhlKQp9Cn0pCgoKc2FtdTMzMC5vbignbWVzc2FnZS1uZXcnLCBhc3luYyAoc2FtKSA9PiB7Cgl0cnkgewoJCWlmICghc2FtLm1lc3NhZ2UpIHJldHVybgoJCWlmIChzYW0ua2V5ICYmIHNhbS5rZXkucmVtb3RlSmlkID09ICdzdGF0dXNAYnJvYWRjYXN0JykgcmV0dXJuCgkJbGV0IGluZm9NU0cgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYygnLi9zcmMvbXNnLmRhdGEuanNvbicpKQoJCWluZm9NU0cucHVzaChKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkpKQoJCWZzLndyaXRlRmlsZVN5bmMoJy4vc3JjLy5kYXQvbXNnLmRhdGEuanNvbicsIEpTT04uc3RyaW5naWZ5KGluZm9NU0csIG51bGwsIDIpKQoJCWNvbnN0IHVydXRhbl9wZXNhbiA9IGluZm9NU0cubGVuZ3RoCgkJaWYgKHVydXRhbl9wZXNhbiA9PT0gNTAwMCkgewoJCQlpbmZvTVNHLnNwbGljZSgwLCA0MzAwKQoJCQlmcy53cml0ZUZpbGVTeW5jKCcuL3NyYy9tc2cuZGF0YS5qc29uJywgSlNPTi5zdHJpbmdpZnkoaW5mb01TRywgbnVsbCwgMikpCgkJfQoJCSBpZiAoIXNhbS5tZXNzYWdlKSByZXR1cm4KCQlpZiAoc2FtLmtleSAmJiBzYW0ua2V5LnJlbW90ZUppZCA9PSAnc3RhdHVzQGJyb2FkY2FzdCcpIHJldHVybgoJCWNvbnN0IHR5cGVpID0gT2JqZWN0LmtleXMoc2FtLm1lc3NhZ2UpWzBdCgkJYnVkbyA9ICh0eXBlaSA9PT0gJ2NvbnZlcnNhdGlvbicpID8gc2FtLm1lc3NhZ2UuY29udmVyc2F0aW9uIDogKHR5cGVpID09PSAnZXh0ZW5kZWRUZXh0TWVzc2FnZScpID8gc2FtLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS50ZXh0IDogJycKCQkJaWYoc2FtLmtleS5mcm9tTWUpewoJCQl9CgoJCWlmICghcHVibGlrKSB7CgkJCWlmICghc2FtLmtleS5mcm9tTWUpIHJldHVybgoJCX0KCQlnbG9iYWwucHJlZml4CgkJZ2xvYmFsLmJsb2NrZWQKCQlzYW0ubWVzc2FnZSA9IChPYmplY3Qua2V5cyhzYW0ubWVzc2FnZSlbMF0gPT09ICdlcGhlbWVyYWxNZXNzYWdlJykgPyBzYW0ubWVzc2FnZS5lcGhlbWVyYWxNZXNzYWdlLm1lc3NhZ2UgOiBzYW0ubWVzc2FnZQoJCWdsb2JhbC5iYXRyZWkgPSBnbG9iYWwuYmF0cmVpID8gZ2xvYmFsLmJhdHJlaSA6IFtdCgkJc2FtdTMzMC5vbignQ0I6YWN0aW9uLCxiYXR0ZXJ5JywganNvbiA9PiB7CgkJY29uc3QgYmF0dGVyeUxldmVsU3RyID0ganNvblsyXVswXVsxXS52YWx1ZQoJCWNvbnN0IGJhdHRlcnlsZXZlbCA9IHBhcnNlSW50KGJhdHRlcnlMZXZlbFN0cikKCQlnbG9iYWwuYmF0cmVpLnB1c2goYmF0dGVyeWxldmVsKQoJfSkKCQljb25zdCBjb250ZW50ID0gSlNPTi5zdHJpbmdpZnkoc2FtLm1lc3NhZ2UpCgkJY29uc3QgZnJvbSA9IHNhbS5rZXkucmVtb3RlSmlkCgkJY29uc3QgdHlwZSA9IE9iamVjdC5rZXlzKHNhbS5tZXNzYWdlKVswXQoJCXZhciB0aXBlID0gJ1Rla3MnCgkJCWlmICh0eXBlID09ICdpbWFnZU1lc3NhZ2UnKSB7CgkJCQl0aXBlID0gJ0ltYWdlbicKCQkJfSBlbHNlIGlmICh0eXBlID09ICdzdGlja2VyTWVzc2FnZScpIHsKCQkJCXRpcGUgPSAnU3Rpa2VyJwoJCQl9IGVsc2UgaWYgKHR5cGUgPT09ICdleHRlbmRlZFRleHRNZXNzYWdlJyAmJiBjb250ZW50LmluY2x1ZGVzKCdpbWFnZU1lc3NhZ2UnKSkgewoJCQkJdGlwZSA9ICdldGlxdWV0YSBJbWFnZW4nCgkJCX0gZWxzZSBpZiAodHlwZSA9PT0gJ2V4dGVuZGVkVGV4dE1lc3NhZ2UnICYmIGNvbnRlbnQuaW5jbHVkZXMoJ3N0aWNrZXJNZXNzYWdlJykpIHsKCQkJCXRpcGUgPSAnZXRpcXVldGEgU3Rpa2VyJwoJCQl9IGVsc2UgaWYgKHR5cGUgPT09ICdleHRlbmRlZFRleHRNZXNzYWdlJyAmJiBjb250ZW50LmluY2x1ZGVzKCdhdWRpb01lc3NhZ2UnKSkgewoJCQkJdGlwZSA9ICdldGlxdWV0YSBBdWRpbycKCQkJfSBlbHNlIGlmICh0eXBlID09PSAnZXh0ZW5kZWRUZXh0TWVzc2FnZScgJiYgY29udGVudC5pbmNsdWRlcygndmlkZW9NZXNzYWdlJykpIHsKCQkJCXRpcGUgPSAnZXRpcXVldGEgVmlkZW8nCgkJCX0gZWxzZSBpZiAodHlwZSA9PT0gJ2V4dGVuZGVkVGV4dE1lc3NhZ2UnICYmIGNvbnRlbnQuaW5jbHVkZXMoJ2NvbnZlcnNhdGlvbicpKSB7CgkJCQl0aXBlID0gJ2V0aXF1ZXRhIFRleHRvJwoJCQl9IGVsc2UgaWYgKHR5cGUgPT09ICdleHRlbmRlZFRleHRNZXNzYWdlJyAmJiBjb250ZW50LmluY2x1ZGVzKCdwcm9kdWN0TWVzc2FnZScpKSB7CgkJCQl0aXBlID0gJ2V0aXF1ZXRhIFByb2R1dnRvJwoJCQl9IGVsc2UgaWYgKHR5cGUgPT09ICdleHRlbmRlZFRleHRNZXNzYWdlJyAmJiBjb250ZW50LmluY2x1ZGVzKCdkb2N1bWVudE1lc3NhZ2UnKSkgewoJCQkJdGlwZSA9ICdldGlxdWV0YSBEb2N1bWVudG8nCgkJCX0gZWxzZSBpZiAodHlwZSA9PT0gJ2V4dGVuZGVkVGV4dE1lc3NhZ2UnICYmIGNvbnRlbnQuaW5jbHVkZXMoJ29yZGVyTWVzc2FnZScpKSB7CgkJCQl0aXBlID0gJ2V0aXF1ZXRhIFBlZGlkbycKCQkJfSBlbHNlIGlmICh0eXBlID09PSAnZXh0ZW5kZWRUZXh0TWVzc2FnZScgJiYgY29udGVudC5pbmNsdWRlcygnY29udGFjdE1lc3NhZ2UnKSkgewoJCQkJdGlwZSA9ICdldGlxdWV0YSBDb250YWN0bycKCQkJfSBlbHNlIGlmICh0eXBlID09PSAnZXh0ZW5kZWRUZXh0TWVzc2FnZScgJiYgY29udGVudC5pbmNsdWRlcygnaW1hZ2VNZXNzYWdlJykpIHsKCQkJCXRpcGUgPSAnZXRpcXVldGEgTG9jYXNpb24nCgkJCX0gZWxzZSBpZiAodHlwZSA9PT0gJ2V4dGVuZGVkVGV4dE1lc3NhZ2UnICYmIGNvbnRlbnQuaW5jbHVkZXMoJ21lbnRpb25lZEppZCcpKSB7CgkJCQl0aXBlID0gJ01lbmNpb25hciBwZXJzb25hcycKCQkJfSBlbHNlIGlmICh0eXBlID09PSAnZXh0ZW5kZWRUZXh0TWVzc2FnZScgJiYgY29udGVudC5pbmNsdWRlcygnbWF0Y2hlZFRleHQnKSkgewoJCQkJdGlwZSA9ICdMaW5rJwoJCQl9IGVsc2UgaWYgKHR5cGUgPT0gJ3ZpZGVvTWVzc2FnZScpIHsKCQkJCXRpcGUgPSAnVmlkZW8nCgkJCX0gZWxzZSBpZiAodHlwZSA9PSAnY29udmVyc2F0aW9uJykgewoJCQkJdGlwZSA9ICdUZXh0bycKCQkJfSBlbHNlIHsKCQkJCXRpcGUgPSAnQcO6biBubyBjb25vY2lkbycKCQkJfQoJCWNvbnN0IHsgdGV4dCwgZXh0ZW5kZWRUZXh0LCBjb250YWN0LCBsb2NhdGlvbiwgbGl2ZUxvY2F0aW9uLCBpbWFnZSwgdmlkZW8sIHN0aWNrZXIsIGRvY3VtZW50LCBhdWRpbywgcHJvZHVjdCB9ID0gTWVzc2FnZVR5cGUKCQljb25zdCB0aW1lID0gbW9tZW50LnR6KCdBc2lhL0pha2FydGEnKS5mb3JtYXQoJ0REL01NIEhIOm1tOnNzJykKCQlib2R5ID0gKHR5cGUgPT09ICdjb252ZXJzYXRpb24nICYmIHNhbS5tZXNzYWdlLmNvbnZlcnNhdGlvbi5zdGFydHNXaXRoKHByZWZpeCkpID8gc2FtLm1lc3NhZ2UuY29udmVyc2F0aW9uIDogKHR5cGUgPT0gJ2ltYWdlTWVzc2FnZScpICYmIHNhbS5tZXNzYWdlLmltYWdlTWVzc2FnZS5jYXB0aW9uLnN0YXJ0c1dpdGgocHJlZml4KSA/IHNhbS5tZXNzYWdlLmltYWdlTWVzc2FnZS5jYXB0aW9uIDogKHR5cGUgPT0gJ3ZpZGVvTWVzc2FnZScpICYmIHNhbS5tZXNzYWdlLnZpZGVvTWVzc2FnZS5jYXB0aW9uLnN0YXJ0c1dpdGgocHJlZml4KSA/IHNhbS5tZXNzYWdlLnZpZGVvTWVzc2FnZS5jYXB0aW9uIDogKHR5cGUgPT0gJ2V4dGVuZGVkVGV4dE1lc3NhZ2UnKSAmJiBzYW0ubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLnRleHQuc3RhcnRzV2l0aChwcmVmaXgpID8gc2FtLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS50ZXh0IDogJycKCQlidWR5ID0gKHR5cGUgPT09ICdjb252ZXJzYXRpb24nKSA/IHNhbS5tZXNzYWdlLmNvbnZlcnNhdGlvbiA6ICh0eXBlID09PSAnZXh0ZW5kZWRUZXh0TWVzc2FnZScpID8gc2FtLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS50ZXh0IDogJycKCQljb25zdCBjb21tYW5kID0gYm9keS5yZXBsYWNlKHByZWZpeCwgJycpLnRyaW0oKS5zcGxpdCgvICsvKS5zaGlmdCgpLnRvTG93ZXJDYXNlKCkKCQl2YXIgcGVzID0gKHR5cGUgPT09ICdjb252ZXJzYXRpb24nICYmIHNhbS5tZXNzYWdlLmNvbnZlcnNhdGlvbikgPyBzYW0ubWVzc2FnZS5jb252ZXJzYXRpb24gOiAodHlwZSA9PSAnaW1hZ2VNZXNzYWdlJykgJiYgc2FtLm1lc3NhZ2UuaW1hZ2VNZXNzYWdlLmNhcHRpb24gPyBzYW0ubWVzc2FnZS5pbWFnZU1lc3NhZ2UuY2FwdGlvbiA6ICh0eXBlID09ICd2aWRlb01lc3NhZ2UnKSAmJiBzYW0ubWVzc2FnZS52aWRlb01lc3NhZ2UuY2FwdGlvbiA/IHNhbS5tZXNzYWdlLnZpZGVvTWVzc2FnZS5jYXB0aW9uIDogKHR5cGUgPT0gJ2V4dGVuZGVkVGV4dE1lc3NhZ2UnKSAmJiBzYW0ubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLnRleHQgPyBzYW0ubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLnRleHQgOiAnJwoJCWNvbnN0IG1lc3NhZ2VzQyA9IHBlcy5zbGljZSgwKS50cmltKCkuc3BsaXQoLyArLykuc2hpZnQoKS50b0xvd2VyQ2FzZSgpCgkJY29uc3QgaXMgPSBidWR5LnNsaWNlKDApLnRyaW0oKS5zcGxpdCgvICsvKS5zaGlmdCgpLnRvTG93ZXJDYXNlKCkKCgkJY29uc3QgYXJncyA9IGJvZHkudHJpbSgpLnNwbGl0KC8gKy8pLnNsaWNlKDEpCgkJY29uc3QgaXNDbWQgPSBib2R5LnN0YXJ0c1dpdGgocHJlZml4KQoJCQoKCQltZXNzID0gewoJCQl3YWl0OiAn4oybIO2gte2whO2gte2wjSDtoLXtsI/toLXtsJHtoLXtsI7toLXtsILtoLXtsITtoLXtsJLtoLXtsI4g4oybJywKCQkJc3VjY2VzczogJ+KclO+4jyDtoLXtuY7toLXtuZDtoLXtuY7toLXtuY7toLXtuYDtoLXtuY4g4pyU77iPJywKCQkJbnNmdzogJ+2gte23n+2gte23vCDtoLXtuIDtoLXtt7btoLXtt7LtoLXtt7vtoLXtuIHtoLXtt7wg7aC17be97aC17bey7aC17be/7aC17be8IO2gte23u+2gte23vCDtoLXtt73toLXtuILtoLXtt7LtoLXtt7HtoLXtt7wg7aC17bey7aC17be37aC17bey7aC17bew7aC17biC7aC17biB7aC17beu7aC17be/IO2gte23su2gte24gO2gte23siDtoLXtt7DtoLXtt7ztoLXtt7rtoLXtt67toLXtt7vtoLXtt7HtoLXtt7wsIO2gte23su2gte24gO2gte24ge2gte23siDtoLXtt7TtoLXtt7/toLXtuILtoLXtt73toLXtt7wg7aC17be77aC17be8IO2gte23ve2gte23su2gte23v+2gte23uu2gte23tu2gte24ge2gte23siDtoLXtt7DtoLXtt7ztoLXtt7vtoLXtuIHtoLXtt7LtoLXtt7vtoLXtt7btoLXtt7HtoLXtt7wgK+2gte2/re2gte2/tFxuKlBBUkEgQUNUSVZBUiBMT1MgQ09NQU5ET1MgKzE4LCBVU0E6KiAuKzE4IDEnLCAKCQkJZmVycjogJ0ludGVudGFsbyBkZSBudWV2byBtYXMgdGFyZGUnLAoJCQliYW46ICfimqAgKlVTVEVEIEVTIFVOIFVTVUFSSU8gQkFORUFETywgRVNPIFFVSUVSRSBERUNJUiBRVUUgTk8gUFVFREUgVVNBUiBFTCBCT1QqIOKaoCcsCgkJCXByZW06ICftoL7ttLTtoLztv7sgXypMTyBTSUVOVE8sIEVTVEUgQ09NQU5ETyBTT0xPIFBVRURFIFNFUiBVVElMSVpBRE8gUE9SIFVTVUFSSU9TKl8gYGBgUFJFTUlVTWBgYCDtoL3tsLHigI3toL3tsrsnLAoJCQllcnJvcjogewoJCQkJc3RpY2s6ICdb4p2XXSDtoLXtuYDtoLXtuY3toLXtuY3toLXtuYrtoLXtuY0gaW50ZW50YWxvIGRlIG51ZXZvLCBkYSBlcnJvciBhIGxhIHByaW1lcmE6RCAg4p2MJywKCQkJCUl2OiAn4p2MIExpbmsgaW52YWxpZG8g4p2MJwoJCQl9LAoJCQlvbmx5OiB7CiAgICBncm91cDogJ1vinZddIMKhRXN0ZSBjb21hbmRvIHNvbG8gc2UgcHVlZGUgdXNhciBlbiBncnVwb3MhIOKdjCcsCiAgICBvd25lckc6ICdb4p2XXSDCoUVzdGUgY29tYW5kbyBzb2xvIHB1ZWRlIHNlciB1dGlsaXphZG8gcG9yIGVsIGNyZWFkb3IgZGVsIGdydXBvISDinYwnLAogICAgb3duZXJCOiAnW+Kdl10gwqFFc3RlIGNvbWFuZG8gc29sbyBwdWVkZSBzZXIgdXRpbGl6YWRvIHBvciBlbCBjcmVhZG9yIGRlbCBib3QhIOKdjFxuT3NlYSwgU2FtdTogd2EubWUvKzUyOTk4NDkwNzc5NCwgSGFibGEgY29uIGVsIHBhcmEgcXVlIHB1ZWRhIGNhbWJpYXIgZWwgbnVtZXJvIGRlbCBvd25lciBlbiBlc3RlIGJvdCcsCiAgICBhZG1pbjogJ1vinZddIMKhRXN0ZSBjb21hbmRvIHNvbG8gcHVlZGUgc2VyIHV0aWxpemFkbyBwb3IgYWRtaW5pc3RyYWRvcmVzIGRlbCBncnVwbyEg4p2MJywKICAgIEJhZG1pbjogJ1vinZddIMKhRXN0ZSBjb21hbmRvIHNvbG8gc2UgcHVlZGUgdXNhciBjdWFuZG8gZWwgYm90IGVzIGFkbWluaXN0cmFkb3IhIOKdjCcsCiAgICBkYWZ0YXJCOiBgSG9sYSwgdXNhICoke3ByZWZpeH1yZWcqIHBhcmEgcG9kZXIgdXNhciBlbCBib3RgCiAgfQoJCX0KCgkJY29uc3QgYm90TnVtYmVyID0gc2FtdTMzMC51c2VyLmppZAoJCWNvbnN0IHNhbXUgPSAnYGBgJwoJCWNvbnN0IG93bmVyTnVtYmVyID0gW2Ake3NhbXlwZXJyeX1Acy53aGF0c2FwcC5uZXRgXQoJCWNvbnN0IGlzR3JvdXAgPSBmcm9tLmVuZHNXaXRoKCdAZy51cycpCgkJY29uc3Qgc2VuZGVyID0gaXNHcm91cCA/IHNhbS5wYXJ0aWNpcGFudCA6IHNhbS5rZXkucmVtb3RlSmlkCgkJY29uc3QgdG90YWxjaGF0ID0gYXdhaXQgc2FtdTMzMC5jaGF0cy5hbGwoKQoJCWNvbnN0IGdyb3VwTWV0YWRhdGEgPSBpc0dyb3VwID8gYXdhaXQgc2FtdTMzMC5ncm91cE1ldGFkYXRhKGZyb20pIDogJycKCQljb25zdCBncm91cE5hbWUgPSBpc0dyb3VwID8gZ3JvdXBNZXRhZGF0YS5zdWJqZWN0IDogJycKCQljb25zdCBncm91cElkID0gaXNHcm91cCA/IGdyb3VwTWV0YWRhdGEuamlkIDogJycKCQljb25zdCBncm91cE1lbWJlcnMgPSBpc0dyb3VwID8gZ3JvdXBNZXRhZGF0YS5wYXJ0aWNpcGFudHMgOiAnJwoJCWNvbnN0IGdyb3VwRGVzYyA9IGlzR3JvdXAgPyBncm91cE1ldGFkYXRhLmRlc2MgOiAnJwoJCWNvbnN0IGdyb3VwT3duZXIgPSBpc0dyb3VwID8gZ3JvdXBNZXRhZGF0YS5vd25lciA6ICcnCgkJY29uc3QgZ3JvdXBBZG1pbnMgPSBpc0dyb3VwID8gZ2V0R3JvdXBBZG1pbnMoZ3JvdXBNZW1iZXJzKSA6ICcnCgkJY29uc3QgaXNCb3RHcm91cEFkbWlucyA9IGdyb3VwQWRtaW5zLmluY2x1ZGVzKGJvdE51bWJlcikgfHwgZmFsc2UKCQljb25zdCBpc0JhZFdvcmQgPSBpc0dyb3VwID8gYmFkd29yZC5pbmNsdWRlcyhmcm9tKSA6IGZhbHNlCgkJY29uc3QgaXNBbnRpTWVkaWEgPSBpc0dyb3VwID8gYW50aW1lZGlhLmluY2x1ZGVzKGZyb20pIDogZmFsc2UKCQljb25zdCBpc0F1dG9TdCA9IGlzR3JvdXAgPyBhdXRvc3RpY2suaW5jbHVkZXMoZnJvbSkgOiBmYWxzZQoJCWNvbnN0IGlzU2ltaSA9IGlzR3JvdXAgPyBzaW1pLmluY2x1ZGVzKGZyb20pIDogZmFsc2UKCQljb25zdCBpc05zZncgPSBpc0dyb3VwID8gbnNmdy5pbmNsdWRlcyhmcm9tKSA6IGZhbHNlCgkJY29uc3QgaXNBbnRpTGluayA9IGlzR3JvdXAgPyBhbnRpbGluay5pbmNsdWRlcyhmcm9tKSA6IGZhbHNlCgkJY29uc3QgaXNHcm91cEFkbWlucyA9IGdyb3VwQWRtaW5zLmluY2x1ZGVzKHNlbmRlcikgfHwgZmFsc2UKCQljb25zdCBpc1dlbGtvbSA9IGlzR3JvdXAgPyB3ZWxrb20uaW5jbHVkZXMoZnJvbSkgOiBmYWxzZQoJCWNvbnN0IGlzT3duZXIgPSBvd25lck51bWJlci5pbmNsdWRlcyhzZW5kZXIpCgkJY29uc3QgaXNSZWdpc3RlciA9IGNoZWNrUmVnaXN0ZXJlZFVzZXIoc2VuZGVyKQoJCWNvbnN0IGlzQmFubmVkID0gYmFuLmluY2x1ZGVzKHNlbmRlcikKCQljb25zdCBpc1ByZW0gPSBwcmVtaXVtLmluY2x1ZGVzKHNlbmRlcikKCQljb25zdCBjb250cyA9IHNhbS5rZXkuZnJvbU1lID8gc2FtdTMzMC51c2VyLmppZCA6IHNhbXUzMzAuY29udGFjdHNbc2VuZGVyXSB8fCB7IG5vdGlmeTogamlkLnJlcGxhY2UoL0AuKy8sICcnKSB9CgkJY29uc3QgcHVzaG5hbWUgPSBzYW0ua2V5LmZyb21NZSA/IHNhbXUzMzAudXNlci5uYW1lIDogY29udHMubm90aWZ5IHx8IGNvbnRzLnZuYW1lIHx8IGNvbnRzLm5hbWUgfHwgJy0nCgkJY29uc3QgaXNVcmwgPSAodXJsKSA9PiB7CgkJCXJldHVybiAobmV3IFJlZ0V4cCgvaHR0cHM/OlwvXC8od3d3XC4pP1stYS16QS1aMC05QDolLit+Iz1dezEsMjU2fVwuW2EtekEtWjAtOSgpXXsxLDZ9XGIoWy1hLXpBLVowLTkoKUA6JSsufiM/Ji89XSopLywgJ2dpJykpCgkJfQoJCWNvbnN0IHJlcGx5ID0gKHRla3MpID0+IHsKCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCB0ZWtzLCB0ZXh0LCB7IHF1b3RlZDogc2FtLCB0aW1lc3RhbXA6IDAsIGNvbnRleHRJbmZvOiB7ImZvcndhcmRpbmdTY29yZSI6IDk5OTksICJpc0ZvcndhcmRlZCI6IHRydWUsIGNhcHRpb246ICdfXycsIHRodW1ibmFpbEpwZzogJy4vc3JjL2hlbHAuanBnJ319KQoJCX0KCQljb25zdCBtYXRoID0gKHRla3MpID0+IHsKCQkJCXJldHVybiBNYXRoLmZsb29yKHRla3MpCgkJCX0KY29uc3QgZmlsZXVybCA9IGFzeW5jKGxpbmssIHR5cGUpID0+IHsKIHdveSA9IGF3YWl0IGdldEJ1ZmZlcihsaW5rKQogc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCB3b3ksIHR5cGUsIHtxdW90ZWQ6ZnRva299KQp9CgkvL0ZBS0UgU1RBVFVTCgljb25zdCBmaW1nID0gewoJIGtleToKCSB7IGZyb21NZTogZmFsc2UsCgkgcGFydGljaXBhbnQ6IGAwQHMud2hhdHNhcHAubmV0YCwgLi4uKGZyb20gPyAKCSB7IHJlbW90ZUppZDogInN0YXR1c0Bicm9hZGNhc3QiIH0gOiB7fSkgfSwKCSBtZXNzYWdlOiB7ICJpbWFnZU1lc3NhZ2UiOiB7ICJtaW1ldHlwZSI6ICJpbWFnZS9qcGVnIiwiY2FwdGlvbiI6ICftoL3tspPtoLXtsYbtoLXtsLTtoLXtsYAg7aC17bGMIO2gte2xg+2gte2wuO2gte2xhe2gte2xhe2gte2xjO2gve20pVztoL3tsKxOeWFuQm90JywgJ2pwZWdUaHVtYm5haWwnOiBmcy5yZWFkRmlsZVN5bmMoJy4vTnlhbkJvdC5qcGcnKX19Cgl9CgkJY29udGV4dEluZm86IHsKICBtZW50aW9uZWRKaWQ6IFtzZW5kZXJdfQoJY29uc3QgZmRvYyA9IHsKCSBrZXk6CgkgeyBmcm9tTWU6IGZhbHNlLAoJIHBhcnRpY2lwYW50OiBgNTIxOTk4NDkwNzc5NEBzLndoYXRzYXBwLm5ldGAsIC4uLihmcm9tID8gCgkgeyByZW1vdGVKaWQ6ICJzdGF0dXNAYnJvYWRjYXN0IiB9IDoge30pIH0sCgkgbWVzc2FnZTogeyAiZG9jdW1lbnRNZXNzYWdlIjogeyAidGl0bGUiOiLinaPvuI/toLXts6LtoLXts6rtoLXts7Yg7aC17bSCIO2gte2zn+2gte2zru2gte2zu+2gte2zu+2gte20giztoL3ttKUiLCAiY2FwdGlvbiI6ICAiTnlhbkJvdCztoL3tsKwiICwgJ2pwZWdUaHVtYm5haWwnOiBmcy5yZWFkRmlsZVN5bmMoJy4vTnlhbkJvdC5qcGcnKX19Cgl9Cgljb25zdCBmbG9jID0gewoJIGtleToKCSB7IGZyb21NZTogZmFsc2UsCgkgcGFydGljaXBhbnQ6IGAwQHMud2hhdHNhcHAubmV0YCwgLi4uKGZyb20gPyAKCSB7IHJlbW90ZUppZDogInN0YXR1c0Bicm9hZGNhc3QiIH0gOiB7fSkgfSwKCSBtZXNzYWdlOiB7ICJsb2NhdGlvbk1lc3NhZ2UiOiB7ICJ0aXRsZSI6Iu2gve20kFNhbXUzMzDimqEiLCAiY2FwdGlvbiI6ICJBZGlvc+2gve24tCIgLCAnanBlZ1RodW1ibmFpbCc6IGZzLnJlYWRGaWxlU3luYygnLi9zcmMvc2FteXBlcnJ5LnBuZycpfX0KCX0KCQljb250ZXh0SW5mbzogewogIG1lbnRpb25lZEppZDogW3NlbmRlcl19Cgljb25zdCBmbGl2ZUxvYyA9IHsKCSBrZXk6CgkgeyBmcm9tTWU6IGZhbHNlLAoJIHBhcnRpY2lwYW50OiBgMEBzLndoYXRzYXBwLm5ldGAsIC4uLihmcm9tID8gCgkgeyByZW1vdGVKaWQ6ICJzdGF0dXNAYnJvYWRjYXN0IiB9IDoge30pIH0sCgkgbWVzc2FnZTogeyAibGl2ZUxvY2F0aW9uTWVzc2FnZSI6IHsgInRpdGxlIjoiTnlhbkJvdCIsImNhcHRpb24iOiAn7aC97bSl4p2j77iPU+Glsm0g4YOnIFDhpbFycuGDpyB8IE7hg6fhpbLhpZJCb3TtoL3tsKwnLCAnanBlZ1RodW1ibmFpbCc6IGZzLnJlYWRGaWxlU3luYygnLi9OeWFuQm90LmpwZycpfX0KCX0KCQljb250ZXh0SW5mbzogewogIG1lbnRpb25lZEppZDogW3NlbmRlcl19Cgljb25zdCBmdmlkID0gewoJIGtleToKCSB7IGZyb21NZTogZmFsc2UsCgkgcGFydGljaXBhbnQ6IGAwQHMud2hhdHNhcHAubmV0YCwgLi4uKGZyb20gPyAKCSB7IHJlbW90ZUppZDogInN0YXR1c0Bicm9hZGNhc3QiIH0gOiB7fSkgfSwKCSBtZXNzYWdlOiB7ICJ2aWRlb01lc3NhZ2UiOiB7ICJ0aXRsZSI6ICJOeWFuQm90IiwiY2FwdGlvbiI6ICfimqHtoL3ttKXtoLXtsq7toLXtsrbtoLXts4Ig7aC17bOOIO2gte2yq+2gte2xku2gte2zh+2gte2zh+2gte2zjiB8IO2gte2yqe2gte2zju2gte2ytu2gte2zg+KErO2gte2xnO2gte2zie2gve2ykycsICdqcGVnVGh1bWJuYWlsJzogZnMucmVhZEZpbGVTeW5jKCcuL3NyYy9mYWtlLmpwZycpfX0KCX0KCQljb250ZXh0SW5mbzogewogIG1lbnRpb25lZEppZDogW3NlbmRlcl19CiAgIAljb25zdCBmdG9rbyA9IHsKCQlrZXk6IHsKCQkJZnJvbU1lOiBmYWxzZSwKCQkJcGFydGljaXBhbnQ6IGAwQHMud2hhdHNhcHAubmV0YCwgLi4uKGZyb20gPyB7IHJlbW90ZUppZDogInN0YXR1c0Bicm9hZGNhc3QiIH0gOiB7fSkKCQl9LAoJCW1lc3NhZ2U6IHsKCQkJInByb2R1Y3RNZXNzYWdlIjogewoJCQkJInByb2R1Y3QiOiB7CgkJCQkJInByb2R1Y3RJbWFnZSI6ewoJCQkJCQkibWltZXR5cGUiOiAiaW1hZ2UvanBlZyIsCgkJCQkJCSJqcGVnVGh1bWJuYWlsIjogZnMucmVhZEZpbGVTeW5jKGAuL3NyYy9mYWtlLmpwZ2ApCgkJCQkJfSwKCQkJCQkidGl0bGUiOiAi4p6r7aC17bem7aC17beu7aC17be6IO2gte24hiDtoLXtt6PtoLXtt7LtoLXtt7/toLXtt7/toLXtuIbtoL3ttKXinaPvuI8iICwKCQkJCQkiZGVzY3JpcHRpb24iOiAiIiwKCQkJCQkiY3VycmVuY3lDb2RlIjogIlNZUCIsCgkJCQkJInByaWNlQW1vdW50MTAwMCI6ICItOTkiLAoJCQkJCSJyZXRhaWxlcklkIjogIk55YW5Cb3QiLAoJCQkJCSJwcm9kdWN0SW1hZ2VDb3VudCI6IDk5OQoJCQkJfSwKCQkJCSJidXNpbmVzc093bmVySmlkIjogYDBAcy53aGF0c2FwcC5uZXRgCgkJfQoJfQoJfQoJCWNvbnRleHRJbmZvOiB7CiAgbWVudGlvbmVkSmlkOiBbc2VuZGVyXX0KCWNvbnN0IGZnYyA9IHsKICAgICAgICAgICAgICAgICAgICBrZXk6IHsKICAgICAgICAgICAgICAgICAgICAgICAgZnJvbU1lOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgcGFydGljaXBhbnQ6IGAwQHMud2hhdHNhcHAubmV0YCwgLi4uKGZyb20gPyB7IHJlbW90ZUppZDogIjUyMTQ0NDcwMDAzNzctMTYyMDA0OTk2NUBnLnVzIiB9IDoge30pCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICJpbWFnZU1lc3NhZ2UiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidXJsIjogImh0dHBzOi8vbW1nLndoYXRzYXBwLm5ldC9kL2YvQXQweDdaZEl2dWljZmpsZjlvV1M2QTNBUjlYUGgwUC1oWklWUExzSTcwbk0uZW5jIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtaW1ldHlwZSI6ICJpbWFnZS9qcGVnIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjYXB0aW9uIjogYO2gve20pe2gte2yru2gte2ytu2gte2zgiDtoLXts44g7aC17bKr7aC17bGS7aC17bOH7aC17bOH7aC17bOOXG4ke2FyZ3Muam9pbignICcpfWAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZmlsZVNoYTI1NiI6ICIrSWErRHdpYjcwWTFDV1JNQVA5UUxKS2pJSnQ1NGZLeWNPZkIyT0VaYlRVPSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZmlsZUxlbmd0aCI6ICIyODc3NyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogMTA4MCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6IDEwNzksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWVkaWFLZXkiOiAidlhtUlI3WlVlRFdqWHk1aVFrMTdUcm93Qnp1d1J5YTBlcnJBRm5YeGJHYz0iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImZpbGVFbmNTaGEyNTYiOiAic1I5RDJSUzVKU2lmdzQ5SGVCQURndUkyM2ZXRHoxYVp1NGZhV0cvQ3lSWT0iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImRpcmVjdFBhdGgiOiAiL3YvdDYyLjcxMTgtMjQvMjE0Mjc2NDJfODQwOTUyNjg2NDc0NTgxXzU3Mjc4ODA3NjMzMjc2MTQzMF9uLmVuYz9vaD0zZjU3YzFiYTJmY2FiOTVmMmMwYmI0NzVkNzI3MjBiYSZvZT02MDJGM0Q2OSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWVkaWFLZXlUaW1lc3RhbXAiOiAiMTYxMDk5MzQ4NiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAianBlZ1RodW1ibmFpbCI6IGZzLnJlYWRGaWxlU3luYygnLi9zcmMvc2FteXBlcnJ5LnBuZycpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgInNjYW5zU2lkZWNhciI6ICIxVzBYaGZhQWNEd2M3eGgxUjhsY2E2UWcvMWJCNG5hRkNTbmdNMkxLTzJOb1A1Ukk3Syt6THc9PSIKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCX0KCQljb250ZXh0SW5mbzogewogIG1lbnRpb25lZEppZDogW3NlbmRlcl19CiAgICAgICAgICAgICAgICAKCgkJY29uc3Qgc2VuZE1lc3MgPSAoaGVoZSwgdGVrcykgPT4gewoJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGhlaGUsIHRla3MsIHRleHQsIHtjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfX0sIHtxdW90ZWQ6IGZ0b2tvCn0pCn0KCQljb25zdCBtZW50aW9ucyA9ICh0ZWtzLCBtZW1iZXJyLCBpZCkgPT4gewoJCQkoaWQgPT0gbnVsbCB8fCBpZCA9PSB1bmRlZmluZWQgfHwgaWQgPT0gZmFsc2UpID8gc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCB0ZWtzLnRyaW0oKSwgZXh0ZW5kZWRUZXh0LCB7IGNvbnRleHRJbmZvOiB7ICJtZW50aW9uZWRKaWQiOiBtZW1iZXJyIH0gfSkgOiBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIHRla3MudHJpbSgpLCBleHRlbmRlZFRleHQsIHsgcXVvdGVkOiBmdG9rbywgY29udGV4dEluZm86IHsgIm1lbnRpb25lZEppZCI6IG1lbWJlcnIgfSB9KQoJCX0KCgkvKgljb25zdCBzZW5kU3RpY2tlciA9IChmcm9tLCBmaWxlbmFtZSwgc2FtKSA9PiB7CglzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGZpbGVuYW1lLCBNZXNzYWdlVHlwZS5zdGlja2VyLCB7cXVvdGVkOiBzYW19KQp9Ki8KCQljb25zdCBzZW5kS29udGFrID0gKGZyb20sIG5vbW9yLCBuYW1hKSA9PiB7Cgljb25zdCB2Y2FyZCA9ICdCRUdJTjpWQ0FSRFxuJworICdWRVJTSU9OOjMuMFxuJworIGBGTjoke25hbWF9XG5gCisgJ09SRzrtoL3tsKxOeWFuQm90O1xuJworIGBURUw7dHlwZT1DRUxMO3R5cGU9Vk9JQ0U7d2FpZD0ke25vbW9yfTorJHtub21vcn1cbmAKKyAnRU5EOlZDQVJEJyAKCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwge2Rpc3BsYXluYW1lOiBuYW1hLCB2Y2FyZDogdmNhcmR9LAoJCU1lc3NhZ2VUeXBlLmNvbnRhY3QpCgkJfQoKCWNvbnN0IHNlbmRTdGlja2VyID0gKGZyb20sIGZpbGVuYW1lLCBzYW0pID0+IHsKCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgZmlsZW5hbWUsIE1lc3NhZ2VUeXBlLnN0aWNrZXIsIHtxdW90ZWQ6IHNhbX0pCn0KCQoJCWNvbG9ycyA9IFsncmVkJywgJ3doaXRlJywgJ2JsYWNrJywgJ2JsdWUnLCAneWVsbG93JywgJ2dyZWVuJ10KCQljb25zdCBpc01lZGlhID0gKHR5cGUgPT09ICdpbWFnZU1lc3NhZ2UnIHx8IHR5cGUgPT09ICd2aWRlb01lc3NhZ2UnKQoJCWNvbnN0IGlzUXVvdGVkSW1hZ2UgPSB0eXBlID09PSAnZXh0ZW5kZWRUZXh0TWVzc2FnZScgJiYgY29udGVudC5pbmNsdWRlcygnaW1hZ2VNZXNzYWdlJykKCQljb25zdCBpc1F1b3RlZFZpZGVvID0gdHlwZSA9PT0gJ2V4dGVuZGVkVGV4dE1lc3NhZ2UnICYmIGNvbnRlbnQuaW5jbHVkZXMoJ3ZpZGVvTWVzc2FnZScpCgkJY29uc3QgaXNRdW90ZWRBdWRpbyA9IHR5cGUgPT09ICdleHRlbmRlZFRleHRNZXNzYWdlJyAmJiBjb250ZW50LmluY2x1ZGVzKCdhdWRpb01lc3NhZ2UnKQoJCWNvbnN0IGlzUXVvdGVkU3RpY2tlciA9IHR5cGUgPT09ICdleHRlbmRlZFRleHRNZXNzYWdlJyAmJiBjb250ZW50LmluY2x1ZGVzKCdzdGlja2VyTWVzc2FnZScpCgkJCgkJCgkJLy9hdXRvU3Rpa2VyIEJ5IFNhbXUzMzAKaWYgKGlzR3JvdXAgJiYgaXNBdXRvU3QgJiYgIWJvdE51bWJlcikgewppZiAoaXNNZWRpYSAmJiAhc2FtLm1lc3NhZ2UudmlkZW9NZXNzYWdlIHx8IGlzUXVvdGVkSW1hZ2UpIHsgICAgICAgICAgIAoJaWYgKCFib3ROdW1iZXIpIHsKCWNvbnN0IGVuY21lZGlhID0gaXNRdW90ZWRJbWFnZSA/IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8gOiBzYW0gICAgICAgCgljb25zdCBtZWRpYSA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRBbmRTYXZlTWVkaWFNZXNzYWdlKGVuY21lZGlhKSAKCXJhbiA9IGdldFJhbmRvbSgnLndlYnAnKSAgICAgICAgICAgCglhd2FpdCBmZm1wZWcoYC4vJHttZWRpYX1gKSAgICAgIAoJCS5pbnB1dChtZWRpYSkgICAgICAgCgkJLm9uKCdzdGFydCcsIGZ1bmN0aW9uIChjbWQpIHsgICAgICAKCQkJY29uc29sZS5sb2coYFN0YXJ0ZWQgOiAke2NtZH1gKSAgICAgCgkJfSkgICAgICAgICAgICAgICAgICAgIAoJCS5vbignZXJyb3InLCBmdW5jdGlvbiAoZXJyKSB7ICAgICAgICAgICAKCQkJY29uc29sZS5sb2coYEVycm9yIDogJHtlcnJ9YCkgICAgICAgIAoJCQlmcy51bmxpbmtTeW5jKG1lZGlhKSAgICAgICAgICAgICAgICAgCgkJCXJlcGx5KG1lc3MuZXJyb3Iuc3RpY2spICAgICAgICAgICAgICAgICAKCQl9KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKCQkub24oJ2VuZCcsIGZ1bmN0aW9uICgpIHsgICAgICAgICAgICAgICAgICAKCQkJY29uc29sZS5sb2coJ0ZpbmlzaCcpICAgICAgICAgICAgICAgCgkJCWV4ZWMoYHdlYnBtdXggLXNldCBleGlmICR7YWRkTWV0YWRhdGEoJ0F1dG8tU3QtQnktU2FtdTMzMC1TYW0teS1QZXJyeScpfSAke3Jhbn0gLW8gJHtyYW59YCwgYXN5bmMgKGVycm9yKSA9PiB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKCQkJCWlmIChlcnJvcikgcmV0dXJuIHJlcGx5KG1lc3MuZXJyb3Iuc3RpY2spCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgZnMucmVhZEZpbGVTeW5jKHJhbiksIHN0aWNrZXIsIHtxdW90ZWQ6IGZkb2MsIGNvbnRleHRJbmZvOiB7ImZvcndhcmRpbmdTY29yZSI6IDk5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9fSkgICAgCgkJCQkJCQkJCXJlcGx5KG1lc3Muc3VjY2VzcykgICAgICAgCgkJCQkJCQkJCWZzLnVubGlua1N5bmMobWVkaWEpICAgICAgIAoJCQkJCQkJCQlmcy51bmxpbmtTeW5jKHJhbikgICAgICAgICAgCgkJCQkJCQkJCX0pICAgICAgICAgICAgICAgICAgICAgICAKCQkJCQkJCX0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFkZE91dHB1dE9wdGlvbnMoW2AtdmNvZGVjYCxgbGlid2VicGAsYC12ZmAsYHNjYWxlPSdtaW4oMzIwLGl3KSc6bWluJygzMjAsaWgpJzpmb3JjZV9vcmlnaW5hbF9hc3BlY3RfcmF0aW89ZGVjcmVhc2UsZnBzPTE1LCBwYWQ9MzIwOjMyMDotMTotMTpjb2xvcj13aGl0ZUAwLjAsIHNwbGl0IFthXVtiXTsgW2FdIHBhbGV0dGVnZW49cmVzZXJ2ZV90cmFuc3BhcmVudD1vbjp0cmFuc3BhcmVuY3lfY29sb3I9ZmZmZmZmIFtwXTsgW2JdW3BdIHBhbGV0dGV1c2VgXSkKCQkJCQkJCS50b0Zvcm1hdCgnd2VicCcpCgkJCQkJCSAgCS5zYXZlKHJhbikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KfQp9CgoKCgoKCgoKCgoJCQlpZiAoaXNHcm91cCAmJiBpc0JvdEdyb3VwQWRtaW5zICYmIGlzQmFkV29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmFkLmluY2x1ZGVzKG1lc3NhZ2VzQykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzR3JvdXBBZG1pbnMpIHsgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKCQkJCQl2YXIga2ljID0gYCR7c2VuZGVyLnNwbGl0KCJAIilbMF19QHMud2hhdHNhcHAubmV0YAogICAgICAgICAgICAgICAgICAgICAgICByZXBseShgTG8gc2llbnRvICR7c2VuZGVyLnNwbGl0KCJAIilbMF19LCBwZXJvIGFxdWkgbm8gc2UgcGVybWl0ZW4gbGFzIG1hbGFzIHBhbGFicmFzLCBzZXLDoXMgZXhwdWxzYWRvIGVuIDUgc2VndW5kb3NgKQogICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FtdTMzMC5ncm91cFJlbW92ZShmcm9tLCBba2ljXSkuY2F0Y2goKGUpPT57cmVwbHkoYCpFUlI6KiAke2V9YCl9KQogICAgICAgICAgICAgICAgICAgICAgICB9LCA1MDAwKQogICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwbHkoIjEgc2VndW5kbyIpCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDQwMDApCiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBseSgiMiBzZWd1bmRvcyIpCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDMwMDApCiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBseSgiMyBzZWd1bmRvcyIpCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDIwMDApCiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBseSgiNCBzZWd1bmRvcyIpCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEwMDApCiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBseSgiNSBzZWd1bmRvcyIpCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDApCgkJCQl9CgkJCX0KCQl9CgkJCWlmIChpc0dyb3VwICYmIGlzQm90R3JvdXBBZG1pbnMgJiYgaXNBbnRpTWVkaWEgJiYgIWJvdE51bWJlcikgeyAgICAgICAgIAoJCQkJaWYgKGlzTWVkaWEgJiYgIXNhbS5tZXNzYWdlLnZpZGVvTWVzc2FnZSB8fCBpc1F1b3RlZEltYWdlKSB7CgkJCQkJaWYgKCFpc0dyb3VwQWRtaW5zKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKCQkJCQkJdmFyIGtpYyA9IGAke3NlbmRlci5zcGxpdCgiQCIpWzBdfUBzLndoYXRzYXBwLm5ldGAgICAgIAoJCQlyZXBseShgTG8gc2llbnRvICR7c2VuZGVyLnNwbGl0KCJAIilbMF19LCBwZXJvIGFxdWkgbm8gc2UgcGVybWl0ZW4gbGFzIGZvdG9zIG5pIHZpZGVvcywgKnNlcsOhcyBleHB1bHNhZG8gcG9yIHNlZ3VyaWRhZDpEKmApCgkJCQlzYW11MzMwLmdyb3VwUmVtb3ZlKGZyb20sIFtraWNdKS5jYXRjaCgoZSk9PntyZXBseShgKkVSUjoqICR7ZX1gKX0pICAgICAgIAoJCQkJCX0gICAgICAgIAoJCQkJfSAgICAgIAoJCQl9CgkJCWlmIChpc0dyb3VwICYmIGlzQm90R3JvdXBBZG1pbnMgJiYgaXNBbnRpTWVkaWEgJiYgIWJvdE51bWJlcikgewoJCQkJaWYgKGlzTWVkaWEgJiYgc2FtLm1lc3NhZ2UudmlkZW9NZXNzYWdlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzR3JvdXBBZG1pbnMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIga2ljID0gYCR7c2VuZGVyLnNwbGl0KCJAIilbMF19QHMud2hhdHNhcHAubmV0YCAgICAgCgkJCQkJCXJlcGx5KGBMbyBzaWVudG8gJHtzZW5kZXIuc3BsaXQoIkAiKVswXX0sIHBlcm8gYXF1aSBubyBzZSBwZXJtaXRlbiBsYXMgZm90b3MgbmkgdmlkZW9zLCAqc2Vyw6FzIGV4cHVsc2FkbyBwb3Igc2VndXJpZGFkOkQqYCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYW11MzMwLmdyb3VwUmVtb3ZlKGZyb20sIFtraWNdKS5jYXRjaCgoZSk9PntyZXBseShgKkVSUjoqICR7ZX1gKX0pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKCQkJCQl9CgkJCQl9CgkJCX0KCQkJCQoJCQoJCQkgaWYgKG1lc3NhZ2VzQy5pbmNsdWRlcygiaHR0cHM6Ly8iKSl7CgkJICAgICAgICBpZiAoIWlzR3JvdXApIHJldHVybgoJCSAgICAgICAgaWYgKCFpc0FudGlMaW5rKSByZXR1cm4KCQkgICAgICAgIGlmIChpc0dyb3VwQWRtaW5zKSByZXR1cm4gcmVwbHkoJ1RpZW5lcyBzdWVydGUsIGVyZXMgYWRtaW4geSBubyB0ZSBzYWNhcsOpJykKCQkgICAgICAgIHNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQoJCSAgICAgICAgaWYgKG1lc3NhZ2VzQy5pbmNsdWRlcygiI2l6aW5hZG1pbiIpKSByZXR1cm4gcmVwbHkoIiNpemluYWRtaW4gcmVjZWJpZG8iKQoJCSAgICAgICAgdmFyIGtpYyA9IGAke3NlbmRlci5zcGxpdCgiQCIpWzBdfUBzLndoYXRzYXBwLm5ldGAKCQkgICAgICAgIHJlcGx5KGBMaW5rIGRldGVjdGFkbyAke3NlbmRlci5zcGxpdCgiQCIpWzBdfSBzZXLDoXMgZXhwdWxzYWRvIGVuIDUgc2VndW5kb3NgKQoJCSAgICAgICAgc2V0VGltZW91dCggKCkgPT4gewoJCQkgICAgICAgIHNhbXUzMzAuZ3JvdXBSZW1vdmUoZnJvbSwgW2tpY10pLmNhdGNoKChlKT0+e3JlcGx5KGAqRVJSOiogJHtlfWApfSkKCQkgICAgICAgIH0sIDUwMDApCgkJICAgICAgICBzZXRUaW1lb3V0KCAoKSA9PiB7CgkJCSAgICAgICAgc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCgkJCSAgICAgICAgcmVwbHkoIjEgc2VndW5kbyIpCgkJICAgICAgICB9LCA0MDAwKQoJCSAgICAgICAgc2V0VGltZW91dCggKCkgPT4gewoJCQkgICAgICAgIHNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQoJCSAgICAgICAgICAgICAgICByZXBseSgiMiBzZWd1bmRvcyIpCgkJICAgICAgICB9LCAzMDAwKQoJCSAgICAgICAgc2V0VGltZW91dCggKCkgPT4gewoJCQkgICAgICAgIHNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQoJCQkgICAgICAgIHJlcGx5KCIzIHNlZ3VuZG9zIikKCQkgICAgICAgIH0sIDIwMDApCgkJICAgICAgICBzZXRUaW1lb3V0KCAoKSA9PiB7CgkJCSAgICAgICAgc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCgkJCSAgICAgICAgcmVwbHkoIjQgc2VndW5kb3MiKQoJCSAgICAgICAgfSwgMTAwMCkKCQkgICAgICAgIHNldFRpbWVvdXQoICgpID0+IHsKCQkJICAgICAgICBzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKCQkJICAgICAgICByZXBseSgiNSBzZWd1bmRvcyIpCgkJCX0sIDEwMDApCgkJCXNldFRpbWVvdXQoICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBseSgiQWRpb3M6RCIpCgkJICAgICAgICB9LCAwKQoJICAgICAgICB9CgkKCQoJICAgICAgICAgICAgaWYgKG1lc3NhZ2VzQy5pbmNsdWRlcygid3d3LiIpKXsKCQkgICAgICAgIGlmICghaXNHcm91cCkgcmV0dXJuCgkJICAgICAgICBpZiAoIWlzQW50aUxpbmspIHJldHVybgoJCSAgICAgICAgaWYgKGlzR3JvdXBBZG1pbnMpIHJldHVybiByZXBseSgnVGllbmVzIHN1ZXJ0ZSwgZXJlcyBhZG1pbiB5IG5vIHRlIHNhY2Fyw6knKQoJCSAgICAgICAgc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCgkJICAgICAgICBpZiAobWVzc2FnZXNDLmluY2x1ZGVzKCIjaXppbmFkbWluIikpIHJldHVybiByZXBseSgiI2l6aW5hZG1pbiByZWNlYmlkbyIpCgkJICAgICAgICB2YXIga2ljID0gYCR7c2VuZGVyLnNwbGl0KCJAIilbMF19QHMud2hhdHNhcHAubmV0YAoJCSAgICAgICAgcmVwbHkoYExpbmsgZGV0ZWN0YWRvICR7c2VuZGVyLnNwbGl0KCJAIilbMF19IHNlcsOhcyBleHB1bHNhZG8gZW4gNSBzZWd1bmRvc2ApCgkJICAgICAgICBzZXRUaW1lb3V0KCAoKSA9PiB7CgkJCSAgICAgICAgc2FtdTMzMC5ncm91cFJlbW92ZShmcm9tLCBba2ljXSkuY2F0Y2goKGUpPT57cmVwbHkoYCpFUlI6KiAke2V9YCl9KQoJCSAgICAgICAgfSwgNTAwMCkKCQkgICAgICAgIHNldFRpbWVvdXQoICgpID0+IHsKCQkJICAgICAgICBzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKCQkJICAgICAgICByZXBseSgiMSBzZWd1bmRvIikKCQkgICAgICAgIH0sIDQwMDApCgkJICAgICAgICBzZXRUaW1lb3V0KCAoKSA9PiB7CgkJCSAgICAgICAgc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCgkJICAgICAgICAgICAgICAgIHJlcGx5KCIyIHNlZ3VuZG9zIikKCQkgICAgICAgIH0sIDMwMDApCgkJICAgICAgICBzZXRUaW1lb3V0KCAoKSA9PiB7CgkJCSAgICAgICAgc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCgkJCSAgICAgICAgcmVwbHkoIjMgc2VndW5kb3MiKQoJCSAgICAgICAgfSwgMjAwMCkKCQkgICAgICAgIHNldFRpbWVvdXQoICgpID0+IHsKCQkJICAgICAgICBzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKCQkJICAgICAgICByZXBseSgiNCBzZWd1bmRvcyIpCgkJICAgICAgICB9LCAxMDAwKQoJCSAgICAgICAgc2V0VGltZW91dCggKCkgPT4gewoJCQkgICAgICAgIHNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQoJCQkgICAgICAgIHJlcGx5KCI1IHNlZ3VuZG9zIikKCQkgICAgICAgIH0sIDApCgkgICAgICAgIH0KCQkKCQkKCQkKCQljb2xvcnMgPSBbJ3JlZCcsJ3doaXRlJywnYmxhY2snLCdibHVlJywneWVsbG93JywnZ3JlZW4nXQoKLy8qKioqKioqKipDb25zb2xlIGxvZyBjaGF0cwoJCQlpZiAoIWlzR3JvdXAgJiYgaXNDbWQpIGNvbnNvbGUubG9nKCdceDFiWzE7MzJtPicsIHRpbWUsIGNvbG9yKGNvbW1hbmQpLCAnZnJvbScsIGNvbG9yKHB1c2huYW1lKSwgJ2FyZ3MgOicsIChhcmdzLmxlbmd0aCkpCgkJCQovLyoqKioqKioqKkNvbnNvbGUgbG9nIGdydXBvcwoJCQlpZiAoaXNDbWQgJiYgaXNHcm91cCkgY29uc29sZS5sb2coJ1x4MWJbMTszMm0+JywgdGltZSwgY29sb3IoY29tbWFuZCksICdmcm9tJywgKGdyb3VwTmFtZSksICdhcmdzIDonLCBjb2xvcihhcmdzLmxlbmd0aCkpCgoJCQoKCQkJZnVuY3Rpb24gYWRkTWV0YWRhdGEocGFja25hbWUpIHsJCgkJCQlpZiAoIXBhY2tuYW1lKSBwYWNrbmFtZSA9ICdXQUJvdCc7CQoJCQkJbGV0IG5hbWUgPSBgJHtwYWNrbmFtZX1gCgkJCQlpZiAoZnMuZXhpc3RzU3luYyhgLi9zcmMvc3RpY2tlcnMvJHtuYW1lfS5leGlmYCkpIHJldHVybiBgLi9zcmMvc3RpY2tlcnMvJHtuYW1lfS5leGlmYAoJCQkJY29uc3QganNvbiA9IHsJCgkJCQkJInN0aWNrZXItcGFjay1uYW1lIjogcGFja25hbWUsCgkJCQl9CgkJCQljb25zdCBsaXR0bGVFbmRpYW4gPSBCdWZmZXIuZnJvbShbMHg0OSwgMHg0OSwgMHgyQSwgMHgwMCwgMHgwOCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMSwgMHgwMCwgMHg0MSwgMHg1NywgMHgwNywgMHgwMF0pCQoJCQkJY29uc3QgYnl0ZXMgPSBbMHgwMCwgMHgwMCwgMHgxNiwgMHgwMCwgMHgwMCwgMHgwMF0JCgoJCQkJbGV0IGxlbiA9IEpTT04uc3RyaW5naWZ5KGpzb24pLmxlbmd0aAkKCQkJCWxldCBsYXN0CQoKCQkJCWlmIChsZW4gPiAyNTYpIHsJCgkJCQkJbGVuID0gbGVuIC0gMjU2CQoJCQkJCWJ5dGVzLnVuc2hpZnQoMHgwMSkJCgkJCQl9IGVsc2UgewkKCQkJCQlieXRlcy51bnNoaWZ0KDB4MDApCQoJCQkJfQkKCgkJCQlpZiAobGVuIDwgMTYpIHsJCgkJCQkJbGFzdCA9IGxlbi50b1N0cmluZygxNikJCgkJCQkJbGFzdCA9ICIwIiArIGxlbgkKCQkJCX0gZWxzZSB7CQoJCQkJCWxhc3QgPSBsZW4udG9TdHJpbmcoMTYpCQoJCQkJfQkKCgkJCQljb25zdCBidWYyID0gQnVmZmVyLmZyb20obGFzdCwgImhleCIpCQoJCQkJY29uc3QgYnVmMyA9IEJ1ZmZlci5mcm9tKGJ5dGVzKQkKCQkJCWNvbnN0IGJ1ZjQgPSBCdWZmZXIuZnJvbShKU09OLnN0cmluZ2lmeShqc29uKSkJCgoJCQkJY29uc3QgYnVmZmVyID0gQnVmZmVyLmNvbmNhdChbbGl0dGxlRW5kaWFuLCBidWYyLCBidWYzLCBidWY0XSkJCgoJCQkJZnMud3JpdGVGaWxlKGAuL3NyYy9zdGlja2Vycy8ke25hbWV9LmV4aWZgLCBidWZmZXIsIChlcnIpID0+IHsJCgkJCQkJcmV0dXJuIGAuL3NyYy9zdGlja2Vycy8ke25hbWV9LmV4aWZgCQoJCQkJfSkJCgoJCQl9CgkJCQoJCQoKaWYoYnVkeS5tYXRjaCgnYm90JykgJiYgIWJvdE51bWJlcil7CnJtID0gWwpyZXN1bHQgPSBmcy5yZWFkRmlsZVN5bmMoYC4vdGVtcC9TYW11LndlYnBgKQpdCm5rID0gcm1bTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcm0ubGVuZ3RoKV0KICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIG5rLCBzdGlja2VyLCB7CnF1b3RlZDogZmltZywgImZvcndhcmRpbmdTY29yZSI6IDk5OTksICJpc0ZvcndhcmRlZCI6IHRydWUKICB9KQp9CgkJCgkJCgkJCnN3aXRjaChpcykgewogIGNhc2UgJ2J1ZW5vcyc6CmJ1ZiA9IGZzLnJlYWRGaWxlU3luYyhgLi90ZW1wL2F1ZGlvL3dlbmFzLm1wM2ApCnNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYnVmLCBhdWRpbywgewogIG1pbWV0eXBlOiAnYXVkaW8vbXA0JywgcXVvdGVkOiBmbGl2ZUxvYywgZHVyYXRpb24gOi05OTk5OTk5OTk5OTk5OTksIHB0dDogdHJ1ZQp9KQp9Cgpzd2l0Y2goaXMpIHsKICBjYXNlICd0ZXN0JzoKYnVmID0gZnMucmVhZEZpbGVTeW5jKGAuL3RlbXAvYXVkaW8vb25pLm1wM2ApCnNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQpyZXBseShgSG9sYSAqJHtwdXNobmFtZX0qLCBhcXVpIGFuZGFtb3MsIG1pIHZlbG9jaWRhZCBkZSByZXNwdWV0YSBlcyBkZTogXyR7cHJvY2Vzcy51cHRpbWUoKX1fIG1pbGlzZWd1bmRvc2ApCnNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYnVmLCBhdWRpbywgewogIG1pbWV0eXBlOiAnYXVkaW8vbXA0JywgcXVvdGVkOiBmbGl2ZUxvYywgZHVyYXRpb24gOjk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTksIHB0dDogdHJ1ZQp9KSAKYnJlYWsKfQkJCgkJCQoJCXN3aXRjaCAoY29tbWFuZCkgewoJCQkJCgkJCQkKCQkJCQpjYXNlICdoZWxwJzoKY2FzZSAnbWVudSc6Cgpjb25zdCBtb21lbnQgPSByZXF1aXJlKCdtb21lbnQtdGltZXpvbmUnKQoKY29uc3Qgam1uID0gbW9tZW50LnR6KCdBc2lhL0pha2FydGEnKS5mb3JtYXQoJ0hIOm1tOnNzJykKCmxldCBkID0gbmV3IERhdGUKCQkJCWxldCBsb2NhbGUgPSAnaWQnCgkJCQkJbGV0IGdtdCA9IG5ldyBEYXRlKDApLmdldFRpbWUoKSAtIG5ldyBEYXRlKCcxIEphbnVhcmkgMjAyMScpLmdldFRpbWUoKQoJCQkJCWxldCB3ZXRvbiA9IFsnUGFoaW5nJywgJ1BvbicsJ1dhZ2UnLCdLbGl3b24nLCdMZWdpJ11bTWF0aC5mbG9vcigoKGQgKiAxKSArIGdtdCkgLyA4NDYwMDAwMCkgJSA1XQoJCQkJCWxldCB3ZWVrID0gZC50b0xvY2FsZURhdGVTdHJpbmcobG9jYWxlLCB7IHdlZWtkYXk6ICdsb25nJyB9KQoJCQkJCWxldCBjYWxlbmRlciA9IGQudG9Mb2NhbGVEYXRlU3RyaW5nKGxvY2FsZSwgewoJCQkJZGF5OiAnbnVtZXJpYycsCgkJCQltb250aDogJ2xvbmcnLAoJCQkJeWVhcjogJ251bWVyaWMnCgkJCQl9KQoJCQkJCgkJCQl2YXIgbnVtID0gc2FtLnBhcnRpY2lwYW50CgkJCQlmb3RvID0gZnMucmVhZEZpbGVTeW5jKCcuL3NyYy9oZWxwLmpwZycpCgkJCQlmYWtlZSA9IGZzLnJlYWRGaWxlU3luYygnLi9zcmMvZmFrZS5qcGcnKQoJCQkJCiAgc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5yZWNvcmRpbmcpCiAgaWYgKCFpc1JlZ2lzdGVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmRhZnRhckIpCiAgdXB0aW1lID0gcHJvY2Vzcy51cHRpbWUoKQoJCQkKCQkJCW1lbnUgPSBg4p6r4YC87aC17bqc4bek7aC17bqKzaPtoLXtupbNq+2gte26nu2gtO25hO2gm+2+lO2gm+2+lO2gm+29me2gve24iC5saSBP4oSx4buLY865yZFsLmxpCu2gve20kEhvbGEgKiR7cHVzaG5hbWV9KiAKSG9yYTogJHtqbW59CkZlY2hhOiAke2NhbGVuZGVyfQrZjNieJHtzYW11fSBbICR7cHJlZml4fSBdICBQcmVmaWpvOiR7c2FtdX3inI/vuI8K2YzYniR7c2FtdX0gVGllbXBvIGRlIGFjdGl2aWRhZDoke3NhbXV9ICoke2t5dW4odXB0aW1lKX0q7aC97bWQCtmM2J4ke3NhbXV9IE1vZG86JHtzYW11fSAqT04q4pyFCtmM2J4ke3NhbXV9IEdydXBvOiR7c2FtdX0gKiR7Z3JvdXBOYW1lfSrtoL3tsaUK2YzYniR7c2FtdX0gTsO6bWVybyBkZSBncnVwb3M6JHtzYW11fSAqJHtfcmVnaXN0ZXJlZC5sZW5ndGh9KuKaoQrZjNieJHtzYW11fSBOw7ptZXJvIGRlIGNoYXRzOiR7c2FtdX0gKiR7dG90YWxjaGF0Lmxlbmd0aH0q7aC97bSlCtmM2J4ke3NhbXV9IE51bWVybyBkZWwgRHVlw7FvIHdhLm1lLys1Mjk5ODQ5MDc3OTQke3NhbXV97aC87b+GCgrtoLXtt6DtoLXtt6wg7aC17beW7aC17beU7aC17beh7aC17beU7aC17befIO2gte23l+2gte23mCDtoLXtt6ztoLXtt6LtoLXtt6jtoLXtt6ftoLXtt6gu7aC17beV7aC17beYOiBodHRwczovL3lvdXR1LmJlL2NoTWM1N2dqbWtJCgrijaMgKkJPVCBJTkZPKiDijaMKCiR7c2FtdX3il6Yg7aC87byQTmF2ZWdhZG9yIDoke3NhbXV9ICoke3NhbXUzMzAuYnJvd3NlckRlc2NyaXB0aW9uWzFdfSoKJHtzYW11feKXpiDtoL3ts6FzZXJ2aWRvciA6JHtzYW11fSAqJHtzYW11MzMwLmJyb3dzZXJEZXNjcmlwdGlvblswXX0qCiR7c2FtdX3il6Yg4pyFdmVyc2lvbiA6JHtzYW11fSAqJHtzYW11MzMwLmJyb3dzZXJEZXNjcmlwdGlvblsyXX0qCiR7c2FtdX3il6Yg7aC97bqEVmVsb2NpZGFkIDoke3NhbXV9ICoke3Byb2Nlc3MudXB0aW1lKCl9Kgoke3NhbXV94pemIO2gve2zslNpc3RlbWEgb3BlcmF0aXZvIDoke3NhbXV9ICoke3NhbXUzMzAudXNlci5waG9uZS5kZXZpY2VfbWFudWZhY3R1cmVyfSoKJHtzYW11feKXpiDtoL7tuoB2ZXJzaW9uIGRlJHtzYW11fSAqV2hhdHNBcHAqIDogKiR7c2FtdTMzMC51c2VyLnBob25lLndhX3ZlcnNpb259KgpfTGlzdGEgZGUgTUVOVXNfCiR7Ym9keU19ICR7cHJlZml4fW1lbnUxICooTWVudSBkZSBNZWRpYSoKJHtib2R5TX0gJHtwcmVmaXh9bWVudTIgKihNZW51IGRlIFN0aWNrZXIpKgoke2JvZHlNfSAke3ByZWZpeH1tZW51MyAqKE1lbnUgZGUgR3J1cG9zKSoKJHtib2R5TX0gJHtwcmVmaXh9bWVudTQgKihNZW51IGRlIGRlc2NhcmdhcykqCiR7Ym9keU19ICR7cHJlZml4fW1lbnU1ICooT3Ryb3MgY29tYW5kb3MpKgoke2JvZHlNfSAke3ByZWZpeH1tZW51NiAqKENvbWFuZG9zICsxOCkqIAoke2JvZHlNfSAke3ByZWZpeH1tZW51NyAqKENvbWFuZG9zIGRlIGxvZ29zKSogCuG0uOG1gyDhtZDhtYPKuOG1ksqz4bamzIHhtYMg4bWI4bWJIMuh4bWSy6Ig4bac4bWS4bWQ4bWD4oG/4bWI4bWSy6Ig4bag4bWY4oG/4bac4bam4bWS4oG/4bWD4oG/IOG1g8uhIMK54oGw4oGwCuG0scui4bacyrPhtqbhtYfhtYkgy6HhtZLLoiDhtpzhtZLhtZDhtYPigb/htYjhtZLLoiDhtYnigb8gy6LhtZgg4bag4bWSyrPhtZDhtYPhtZfhtZIg4bac4bWSyrPKs+G1ieG2nOG1l+G1kiDhtZbhtYPKs+G1gyDhkavhtZjhtYkg4oG/4bWSIOG1iOG1iSDhtYnKs8qz4bWSyrPhtYnLogrLouG2piDhtZfhtqbhtYnigb/htYnLoiDhtYPLoeG1jeG1mMyB4oG/IOG1lsqz4bWS4bWHy6HhtYnhtZDhtYMg4bWSIOG1g8uh4bWN4bWY4oG/4bWDIOG2oOG1mOKBv+G2nOG2puG1ksyB4oG/IOG1iOG1icuhIOG1h+G1kuG1lyDhtYjhtYnKsuG1kiDhtYjhtYkg4bag4bWY4oG/4bac4bam4bWS4oG/4bWDyrMgyrDhtYPMgeG2u+G1kOG1icuh4bWSIMui4bWD4bWH4bWJyrMg4bWDIOG1kOG2psyjLuG1gsqw4bWD4bWXy6LhtKzhtZbhtZYubGkKICAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCsKmOgrCpjogICAgICAgICAuIDog7aC97bCs7aC17bCN7aC17bCy7aC17bCa7aC17bCn7aC17bCB7aC17bCo7aC17bCt7aC97bCsIDogLgrCpjogICAgIO2gve20peKdo++4j+2gte23pu2gte23ru2gte23uiDtoLXtuIYg7aC17bej7aC17bey7aC17be/7aC17be/7aC17biG4p2j77iP7aC97bSlCjo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6OjoKKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMswoJCSAgICAg7aC87by4IFNhbeG7i1BlcnJ5LmxpIO2gvO28uAoJICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCmAKc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBmb3RvLCBpbWFnZSwgeyBxdW90ZWQ6IGZ0b2tvLCBjYXB0aW9uOiBtZW51LCB0aHVtYm5haWw6IGZha2VlLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9fSkKYnJlYWsKCQpjYXNlICdtZW51MSc6CglzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLnJlY29yZGluZykKICBpZiAoIWlzUmVnaXN0ZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkuZGFmdGFyQikKICB1cHRpbWUgPSBwcm9jZXNzLnVwdGltZSgpCmNvbnN0IE1lbnVtID0gewp0ZXh0OiBg4p6r4YC87aC17bqc4bek7aC17bqKzaPtoLXtupbNq+2gte26nu2gtO25hO2gm+2+lO2gm+2+lO2gm+29mS5saSBP4oSx4buLY865yZFsLmxpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIArtoL3ttJBIb2xhICoke3B1c2huYW1lfSogCuKNoyAqQk9UIElORk8qIOKNowoqVVNBOiAke3ByZWZpeH1waW5nKiBvICp0ZXN0KgpQYXJhIHNhYmVyIHkgdmVyaWZpY2FyIHNpIGVsIGJvdCBlc3RhIGFjdGl2by4KKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMswoJICAgICAg7aC87by4IFNhbeG7i1BlcnJ5LmxpIO2gvO28uAogKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKJHtib2R5TX0gJHtwcmVmaXh9aW1hZ2VuICooQnVzY2EgaW1hZ2VuZXMgZGUgcGludGVyZXN0KSoKJHtib2R5TX0gJHtwcmVmaXh9YW5pbWUKJHtib2R5TX0gJHtwcmVmaXh9Z29vZ2xlCiR7Ym9keU19ICR7cHJlZml4fWRvbmFsZHRydW1wCiR7Ym9keU19ICR7cHJlZml4fXF1ZWFuaW1lCiR7Ym9keU19ICR7cHJlZml4fXVybDJpbWcKJHtib2R5TX0gJHtwcmVmaXh9dG91cmwgKihFdGlxdWV0YSB1bmEgaW1hZ2VuKSoKJHtib2R5TX0gJHtwcmVmaXh9Z2V0cGljIEBwYXJ0aWNpcGFudGUKJHtib2R5TX0gJHtwcmVmaXh9c3MgXyhMaW5rKV8gKihDYXB0dXJhIGRlIHBhbnRhbGxhIGRlIHVuIGxpbmspKgoke2JvZHlNfSAke3ByZWZpeH13cAoke2JvZHlNfSAke3ByZWZpeH13cHNlYXJjaCBfKEJ1c2NhIGZvbmRvcyBkZSBwYW50YWxsYSlfCiR7Ym9keU19ICR7cHJlZml4fWxvbGkKJHtib2R5TX0gJHtwcmVmaXh9bmVrbwoke2JvZHlNfSAke3ByZWZpeH1kb3JraW5nCiR7Ym9keU19ICR7cHJlZml4fXR3aXQKJHtib2R5TX0gJHtwcmVmaXh9Y3liZXJwdW5rCiR7Ym9keU19ICR7cHJlZml4fWxldHJhICooTGV0cmEgZGUgdW5hIGNhbmNpb24pKgoke2JvZHlNfSAke3ByZWZpeH1hY29yZGVzICooQWNvcmRlcyBkZSB1bmEgY2FuY2lvbikqCmAsCgljb250ZXh0SW5mbzogewogIG1lbnRpb25lZEppZDogW3NlbmRlcl0sICJmb3J3YXJkaW5nU2NvcmUiOiA5OTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlCn0KICB9CiAgc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBNZW51bSwgdGV4dCwgewoJICBxdW90ZWQ6IGZ0b2tvfSkgICAgICAgICAgICAgIAogIGJyZWFrCgpjYXNlICdtZW51Mic6CiAgIHNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQogIGlmICghaXNSZWdpc3RlcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5kYWZ0YXJCKQogIHVwdGltZSA9IHByb2Nlc3MudXB0aW1lKCkKY29uc3QgTWVudXMgPSB7CnRleHQ6IGDinqvhgLztoLXtupzht6TtoLXtuorNo+2gte26ls2r7aC17bqe7aC07bmE7aCb7b6U7aCb7b6U7aCb7b2ZLmxpIE/ihLHhu4tjzrnJkWwubGkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCu2gve20kEhvbGEgKiR7cHVzaG5hbWV9KgoqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzCgkgICAgIO2gvO28uCBTYW3hu4tQZXJyeS5saSDtoLztvLgKICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiR7Ym9keU19ICR7cHJlZml4fXN0aWNrZXIgKihJbWFnZW4sIHZpZGVvIG8gZ2lmKSoKJHtib2R5TX0gJHtwcmVmaXh9c3RpY2tlciBub2JnICooRXRpcXVldGEgdW5hIGZvdG8gcGFyYSBjcmVhciB1biBzdGlja2VyIHNpbiBmb25kbykqCiR7Ym9keU19ICR7cHJlZml4fWF1dG9zdGljawoke2JvZHlNfSAke3ByZWZpeH1jaXJjbGUKJHtib2R5TX0gJHtwcmVmaXh9dG9pbWcKJHtib2R5TX0gJHtwcmVmaXh9YXR0cAoke2JvZHlNfSAke3ByZWZpeH10dHAgCiR7Ym9keU19ICR7cHJlZml4fWVtb2ppCiR7Ym9keU19ICR7cHJlZml4fXRha2VzdGljawpgLAoJY29udGV4dEluZm86IHsKICBtZW50aW9uZWRKaWQ6IFtzZW5kZXJdLCAiZm9yd2FyZGluZ1Njb3JlIjogOTk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZQp9CiAgfQogIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgTWVudXMsIHRleHQsIHsKcXVvdGVkOiBmdmlkfSkgICAgICAgICAgICAgIAogIGJyZWFrCmNhc2UgJ21lbnUzJzoKICAgc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCiAgaWYgKCFpc1JlZ2lzdGVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmRhZnRhckIpCiAgdXB0aW1lID0gcHJvY2Vzcy51cHRpbWUoKQpjb25zdCBNZW51ZyA9IHsKdGV4dDogYOKeq+GAvO2gte26nOG3pO2gte26is2j7aC17bqWzavtoLXtup7toLTtuYTtoJvtvpTtoJvtvpTtoJvtvZkubGkgT+KEseG7i2POucmRbC5saSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAK7aC97bSQSG9sYSAqJHtwdXNobmFtZX0qCuKNoyAqQk9UIElORk8qIOKNowoke3NhbXV94pemIO2gvO28kE5hdmVnYWRvciA6JHtzYW11fSAqJHtzYW11MzMwLmJyb3dzZXJEZXNjcmlwdGlvblsxXX0qCiR7c2FtdX3il6Yg7aC97bOhc2Vydmlkb3IgOiR7c2FtdX0gKiR7c2FtdTMzMC5icm93c2VyRGVzY3JpcHRpb25bMF19Kgoke3NhbXV94pemIOKchXZlcnNpb24gOiR7c2FtdX0gKiR7c2FtdTMzMC5icm93c2VyRGVzY3JpcHRpb25bMl19Kgoke3NhbXV94pemIO2gve26hFZlbG9jaWRhZCA6JHtzYW11fSAqJHtwcm9jZXNzLnVwdGltZSgpfSoKJHtzYW11feKXpiDtoL3ts7JTaXN0ZW1hIG9wZXJhdGl2byA6JHtzYW11fSAqJHtzYW11MzMwLnVzZXIucGhvbmUuZGV2aWNlX21hbnVmYWN0dXJlcn0qCiR7c2FtdX3il6Yg7aC+7bqAdmVyc2lvbiBkZSR7c2FtdX0gKldoYXRzQXBwKiA6ICoke3NhbXUzMzAudXNlci5waG9uZS53YV92ZXJzaW9ufSoKJHtib2R5TX0gJHtzYW11fSR7cHJlZml4fWFudGlsaW5rJHtzYW11fQoke2JvZHlNfSAke3NhbXV9JHtwcmVmaXh9YW50aW1lZGlhJHtzYW11fQoke2JvZHlNfSAke3NhbXV9JHtwcmVmaXh9YW50aWJhZCR7c2FtdX0KJHtib2R5TX0gJHtzYW11fSR7cHJlZml4fWF1dG9zdCR7c2FtdX0KJHtib2R5TX0gJHtzYW11fSR7cHJlZml4fWFudGlkZWxldGUke3NhbXV9CiR7Ym9keU19ICR7cHJlZml4fSsxOCAxLzAKCipQYXJhIHF1ZSBlbCBib3QgZW50cmUgYSB0dSBncnVwbywgdXNhIGVsIHNpZ3VpZW50ZSBjb21hbmRvOioKCSR7cHJlZml4fWVudHJhYm90ICooTGluayBkZWwgZ3J1cG8pKgoKJHtib2R5TX0gJHtwcmVmaXh9YWJyaXIKJHtib2R5TX0gJHtwcmVmaXh9Y2VycmFyCiR7Ym9keU19ICR7cHJlZml4fWxlYXZlCiR7Ym9keU19ICR7cHJlZml4fXRhZ3N0aWNrCiR7Ym9keU19ICR7cHJlZml4fWhpZGV0YWcKJHtib2R5TX0gJHtwcmVmaXh9YWxsCiR7Ym9keU19ICR7cHJlZml4fXNldGRlc2MKJHtib2R5TX0gJHtwcmVmaXh9c2V0bmFtZQoke2JvZHlNfSAke3ByZWZpeH1hZG1pbmxpc3QKJHtib2R5TX0gJHtwcmVmaXh9c2V0cGljCiR7Ym9keU19ICR7cHJlZml4fWVubGluZWEKJHtib2R5TX0gJHtwcmVmaXh9cHJvbW90ZQoke2JvZHlNfSAke3ByZWZpeH1kZW1vdGUKJHtib2R5TX0gJHtwcmVmaXh9ZWxpbWluYXIKJHtib2R5TX0gJHtwcmVmaXh9YcOxYWRpciAqKE51bWVybyBzaW4gZWwgKykqCiR7Ym9keU19ICR7cHJlZml4fW5vdGlmCiR7Ym9keU19ICR7cHJlZml4fXJlcGx5IEBtaWVtYnJvfGZyYXNlfGZyYXNlCiR7Ym9keU19ICR7cHJlZml4fWxpbmsKYCwKCWNvbnRleHRJbmZvOiB7CiAgbWVudGlvbmVkSmlkOiBbc2VuZGVyXSwgImZvcndhcmRpbmdTY29yZSI6IDk5OTksICJpc0ZvcndhcmRlZCI6IHRydWUKfQogIH0KICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIE1lbnVnLCB0ZXh0LCB7CnF1b3RlZDogeyBrZXk6IHsgZnJvbU1lOiBmYWxzZSwgcGFydGljaXBhbnQ6IGAwQHMud2hhdHNhcHAubmV0YCwgLi4uKGZyb20gPyB7IHJlbW90ZUppZDogInN0YXR1c0Bicm9hZGNhc3QiIH0gOiB7fSkgfSwgbWVzc2FnZTogeyAiaW1hZ2VNZXNzYWdlIjogeyAibWltZXR5cGUiOiAiaW1hZ2UvanBlZyIsICJjYXB0aW9uIjogIuKeq+2gte2xtO2gte2yhu2gte2yj+2gte2yliDtoLXtsavtoLXtsoYg7aC17bGu7aC17bKT7aC17bKW7aC17bKR7aC17bKQ7aC17bKUXG7inaPvuI/ig57toL3ttKXtoLXtuY7qr63toLXtuZbNoO2gte25ouqvrSDtoLXtuZQg6q+t7aC17bmL6q+t7aC17bma7aC17bmn7aC17bmn6q+t7aC17bmu7aC97bSl4p2j77iPIiAsImpwZWdUaHVtYm5haWwiOiBmcy5yZWFkRmlsZVN5bmMoYC4vTnlhbkJvdC5qcGdgKX19fX0pICAgICAgICAgICAgICAKICBicmVhawpjYXNlICdtZW51NCc6CiAgIHNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQogIGlmICghaXNSZWdpc3RlcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5kYWZ0YXJCKQogIHVwdGltZSA9IHByb2Nlc3MudXB0aW1lKCkKY29uc3QgTWVudWQgPSB7CnRleHQ6IGDinqvhgLztoLXtupzht6TtoLXtuorNo+2gte26ls2r7aC17bqe7aC07bmE7aCb7b6U7aCb7b6U7aCb7b2ZLmxpIE/ihLHhu4tjzrnJkWwubGkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCu2gve20kEhvbGEgKiR7cHVzaG5hbWV9KgrijaMgKkJPVCBJTkZPKiDijaMKJHtzYW11feKXpiDtoLztvJBOYXZlZ2Fkb3IgOiR7c2FtdX0gKiR7c2FtdTMzMC5icm93c2VyRGVzY3JpcHRpb25bMV19Kgoke3NhbXV94pemIO2gve2zoXNlcnZpZG9yIDoke3NhbXV9ICoke3NhbXUzMzAuYnJvd3NlckRlc2NyaXB0aW9uWzBdfSoKJHtzYW11feKXpiDinIV2ZXJzaW9uIDoke3NhbXV9ICoke3NhbXUzMzAuYnJvd3NlckRlc2NyaXB0aW9uWzJdfSoKJHtzYW11feKXpiDtoL3tuoRWZWxvY2lkYWQgOiR7c2FtdX0gKiR7cHJvY2Vzcy51cHRpbWUoKX0qCiR7c2FtdX3il6Yg7aC97bOyU2lzdGVtYSBvcGVyYXRpdm8gOiR7c2FtdX0gKiR7c2FtdTMzMC51c2VyLnBob25lLmRldmljZV9tYW51ZmFjdHVyZXJ9Kgoke3NhbXV94pemIO2gvu26gHZlcnNpb24gZGUke3NhbXV9ICpXaGF0c0FwcCogOiAqJHtzYW11MzMwLnVzZXIucGhvbmUud2FfdmVyc2lvbn0qCiR7Ym9keU19ICR7cHJlZml4fXBsYXkgKihEZXNjYXJnYSBkZSBhdWRpb3MgZW4gbm90YSBkZSB2b3opKgoke2JvZHlNfSAke3ByZWZpeH1wbGF5MiAqKERlc2NhcmdhIGRlIGF1ZGlvcyBlbiBtcDMpKgoke2JvZHlNfSAke3ByZWZpeH1wbGF5dmlkICooRGVzY2FyZ2EgZGUgdmlkZW9zIHBvciBub21icmUpKgoke2JvZHlNfSAke3ByZWZpeH1pZyAqKEZvdG9zIHkgdmlkZW9zIGRlIEluc3RhZ3JhbSkqCiR7Ym9keU19ICR7cHJlZml4fXl0bXAzCiR7Ym9keU19ICR7cHJlZml4fXl0bXA0CiR7Ym9keU19ICR7cHJlZml4fW1maXJlICooTGluayBkZSBtZWRpYWZpcmUpKgoke2JvZHlNfSAke3ByZWZpeH10b21wMyAqKFZpZGVvcyBhIGF1ZGlvKSoKYCwKCWNvbnRleHRJbmZvOiB7CiAgbWVudGlvbmVkSmlkOiBbc2VuZGVyXSwgImZvcndhcmRpbmdTY29yZSI6IDk5OTksICJpc0ZvcndhcmRlZCI6IHRydWUKfQogIH0KICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIE1lbnVkLCB0ZXh0LCB7CnF1b3RlZDogIGZ2aWR9KSAgICAgICAgICAgICAgCiAgYnJlYWsKY2FzZSAnbWVudTUnOgogICBzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKICBpZiAoIWlzUmVnaXN0ZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkuZGFmdGFyQikKICB1cHRpbWUgPSBwcm9jZXNzLnVwdGltZSgpCmNvbnN0IE1lbnVvID0gewp0ZXh0OiBg4p6r4YC87aC17bqc4bek7aC17bqKzaPtoLXtupbNq+2gte26nu2gtO25hO2gm+2+lO2gm+2+lO2gm+29mS5saSBP4oSx4buLY865yZFsLmxpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIArtoL3ttJBIb2xhICoke3B1c2huYW1lfSogCirMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMqzLPMs8yzzLPMs8yzzLPMs8yzzLMKCSAgICAgIO2gvO28uCBTYW3hu4tQZXJyeS5saSDtoLztvLgKICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiR7Ym9keU19ICR7cHJlZml4fXZveiAqKENvZGlnbyBkZSBpZGlvbWEpKiAqKFRleHRvKSogX1BhcmEgdmVyIGlkaW9tYXMgY29tcGF0aWJsZXMsIHVzYSBlbCBjb21hbmRvXyAqaWRpb21hcyoKJHtib2R5TX0gJHtwcmVmaXh9YmxvY2sKJHtib2R5TX0gJHtwcmVmaXh9dHJhbnNsYXRlICooaWRpb21hIGEgdHJhZHVjaXIgPSBlcywgZW4sIGlkLi4uKSoKJHtib2R5TX0gJHtwcmVmaXh9c2V0aW1nCiR7Ym9keU19ICR7cHJlZml4fXNldGltZ21lbnUKJHtib2R5TX0gJHtwcmVmaXh9dGlrdG9rc3RhbGsgQHVzdWFyaW8KJHtib2R5TX0gJHtwcmVmaXh9aGlkZXRhZyAqKFRleHRvKSoKJHtib2R5TX0gJHtwcmVmaXh9Y2MgKihUYXJqZXRhcyBkZSBjcsOpZGl0bykqCiR7Ym9keU19ICR7cHJlZml4fT4gKihFamVjdXRhIGNvbWFuZG9zIGVuIGxhIHRlcm1pbmFsKSoKJHtib2R5TX0gJHtwcmVmaXh9JCAqKEVqZWN1dGEgY29tYW5kb3MgZW4gbGEgdGVybWluYWwpKiAKJHtib2R5TX0gJHtwcmVmaXh9Y2FtYmlhciAqKENhbWJpYSBlbCBjdWVycG8gZGVsIG1lbsO6KSoKJHtib2R5TX0gJHtwcmVmaXh9dHJpZ2dlciAqKEV0aXF1ZXRhIHVuIGF1ZGlvKSoKJHtib2R5TX0gJHtwcmVmaXh9c2xvdyAqKEV0aXF1ZXRhIHVuIGF1ZGlvKSoKJHtib2R5TX0gJHtwcmVmaXh9aW11dCAqKEV0aXF1ZXRhIHVuIGF1ZGlvKSoKJHtib2R5TX0gJHtwcmVmaXh9aG9kZSAqKEV0aXF1ZXRhIHVuIGF1ZGlvKSoKJHtib2R5TX0gJHtwcmVmaXh9YmFzcyAqKEV0aXF1ZXRhIHVuIGF1ZGlvKSoKJHtib2R5TX0gJHtwcmVmaXh9YXJkaWxsYSAqKEV0aXF1ZXRhIHVuIGF1ZGlvKSoKJHtib2R5TX0gJHtwcmVmaXh9Z3JhdmUgKihFdGlxdWV0YSB1biBhdWRpbykqCiR7Ym9keU19ICR7cHJlZml4fWFydGkKJHtib2R5TX0gJHtwcmVmaXh9c2hvcnRsaW5rIF8oQWNvcnRhZG9yIGRlIGxpbmtzKQoke2JvZHlNfSAke3ByZWZpeH1xdW90ZQoke2JvZHlNfSAke3ByZWZpeH1wYXN0ZWJpbiAqKGdlbmVyYSBsaW5rIGhhY2lhIGVsIHRleHRvIG8gbGluayBxdWUgZXNjcmliYXMpKgoke2JvZHlNfSAke3ByZWZpeH1hYmluYXJpbyAqKHRleHRvIGEgY29kaWdvIGJpbmFyaW8pKiAwMTAwMTAKJHtib2R5TX0gJHtwcmVmaXh9YmluYXRleHQgKihjb2RpZ28gYmluYXJpbyBhIHRleHRvKSoKJHtib2R5TX0gJHtwcmVmaXh9YW9jdGFsICoodGV4dG8gYSBjb2RpZ28gb2N0YWwpKgoke2JvZHlNfSAke3ByZWZpeH1vY3RhbGF0ZXh0ICooY29kaWdvIG9jdGFsIGEgdGV4dG8pKgoke2JvZHlNfSAke3ByZWZpeH1haGV4ICoodGV4dG8gYSBjb2RpZ28gaGV4KSoKJHtib2R5TX0gJHtwcmVmaXh9aGV4YXRleHQgKihjb2RpZ28gaGV4IGEgdGV4dG8pKgoke2JvZHlNfSAke3ByZWZpeH1yYXRlIF9mcmFzZSBAbWllbWJyb18KJHtib2R5TX0gJHtwcmVmaXh9d2EubWUKJHtib2R5TX0gJHtwcmVmaXh9aWRpb2ltYXMKJHtib2R5TX0gJHtwcmVmaXh9cGFpc2VzCiR7Ym9keU19ICR7cHJlZml4fXJldmVyc2EKJHtib2R5TX0gJHtwcmVmaXh9dmVyZGFkCiR7Ym9keU19ICR7cHJlZml4fW1lbWUKJHtib2R5TX0gJHtwcmVmaXh9cmVhZG1vcmUgX2ZyYXNlL2ZyYXNlXwoke2JvZHlNfSAke3ByZWZpeH1tYXBhCiR7Ym9keU19ICR7cHJlZml4fXNveXlvCiR7Ym9keU19ICR7cHJlZml4fWJsb2NrbGlzdAoke2JvZHlNfSAke3ByZWZpeH1sZWVyaW1hZ2VuCmAsCgljb250ZXh0SW5mbzogewogIG1lbnRpb25lZEppZDogW3NlbmRlcl0sICJmb3J3YXJkaW5nU2NvcmUiOiA5OTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlCn0KICB9CiAgc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBNZW51bywgdGV4dCwgewoJICBxdW90ZWQ6IGZsb2N9KSAgICAgICAgICAgICAgCiAgYnJlYWsKIGNhc2UgJ21lbnU2JzoKICAgc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCiAgaWYgKCFpc1JlZ2lzdGVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmRhZnRhckIpCiAgaWYgKCFpc0dyb3VwKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5Lmdyb3VwKQogIGlmICghaXNOc2Z3KSByZXR1cm4gcmVwbHkobWVzcy5uc2Z3KQogIHVwdGltZSA9IHByb2Nlc3MudXB0aW1lKCkKY29uc3QgTWVudTE4ID0gewp0ZXh0OiBg4p6r4YC87aC17bqc4bek7aC17bqKzaPtoLXtupbNq+2gte26nu2gtO25hO2gm+2+lO2gm+2+lO2gm+29mS5saSBP4oSx4buLY865yZFsLmxpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIArtoL3ttJBIb2xhICoke3B1c2huYW1lfSoKKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMswoJICAgICDtoLztvLggU2Ft4buLUGVycnkubGkg7aC87by4CiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgoke2JvZHlNfSAke3ByZWZpeH1wb3Jubwoke2JvZHlNfSAke3ByZWZpeH1sZXNiaWFuIAoke2JvZHlNfSAke3ByZWZpeH10ZXRhcwoke2JvZHlNfSAke3ByZWZpeH1hc3MKJHtib2R5TX0gJHtwcmVmaXh9cHVzc3kKJHtib2R5TX0gJHtwcmVmaXh9eG54eAoke2JvZHlNfSAke3ByZWZpeH14bnh4c2VhcmNoCmAsCgljb250ZXh0SW5mbzogewogIG1lbnRpb25lZEppZDogW3NlbmRlcl0sICJmb3J3YXJkaW5nU2NvcmUiOiA5OTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlCn0KICB9CiAgc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBNZW51MTgsIHRleHQsIHsKcXVvdGVkOiBmdmlkfSkgICAgICAgICAgICAgIAogIGJyZWFrCgkJCQkKY2FzZSAnbWVudTcnOgogICBzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKICBpZiAoIWlzUmVnaXN0ZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkuZGFmdGFyQikKICB1cHRpbWUgPSBwcm9jZXNzLnVwdGltZSgpCmNvbnN0IE1lbnU3ID0gewp0ZXh0OiBg4p6r4YC87aC17bqc4bek7aC17bqKzaPtoLXtupbNq+2gte26nu2gtO25hO2gm+2+lO2gm+2+lO2gm+29mS5saSBP4oSx4buLY865yZFsLmxpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIArtoL3ttJBIb2xhICoke3B1c2huYW1lfSoKKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzKsyzzLPMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMsyrMs8yzzLPMs8yzzLPMs8yzzLPMswoJICAgICDtoLztvLggU2Ft4buLUGVycnkubGkg7aC87by4CiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKJHtib2R5TX0gJHtwcmVmaXh9YmxhY2twaW5rICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1uZW9uICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1ncmVlbm5lb24gKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWFkdmFuY2VnbG93ICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1mdXR1cmVuZW9uICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1zYW5kd3JpdGluZyAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9c2FuZHN1bW1lciAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9c2FuZGVuZ3JhdmVkICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1tZXRhbGRhcmsgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fW5lb25saWdodCAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9aG9sb2dyYXBoaWMgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fXRleHQxOTE3ICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1taW5pb24gKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWRlbHV4ZXNpbHZlciAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9bmV3eWVhcmNhcmQgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWJsb29kZnJvc3RlZCAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9aGFsbG93ZWVuICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1qb2tlcmxvZ28gKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWZpcmV3b3Jrc3BhcmtsZSAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9bmF0dXJlbGVhdmVzICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1ib2tlaCAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9dG94aWMgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fXN0cmF3YmVycnkgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWJveDNkICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1yb2Fkd2FybmluZyAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9YnJlYWt3YWxsICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1pY2Vjb2xkICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1sdXh1cnkgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWNsb3VkICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1zdW1tZXJzYW5kICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1ob3Jyb3JibG9vZCAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9dGh1bmRlciAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9cG9ybmh1YiAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9Z2xpdGNoICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1hdmVuZ2VyICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1zcGFjZSAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9bmluamFsb2dvICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1tYXJ2ZWxzdHVkaW8gKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWxpb25sb2dvICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH13b2xmbG9nbyAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9c3RlZWwzZCAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9d2FsbGdyYXZpdHkgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fXNvbWJyYSAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9Y3VwICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1jdXAxICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1yb21hbmNlICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1zbW9rZSAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9YnVybnBhcGVyICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1sb3ZlbWVzc2FnZSAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9dW5kZXJncmFzcyAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9bG92ZSAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9Y2FmZSAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9d29vZGhlYXJ0ICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH13b29kZW5ib2FyZCAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9c3VtbWVyM2QgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fXdvbGZtZXRhbCAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9bmF0dXJlM2QgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fXVuZGVyd2F0ZXIgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWdvbGRlcnJvc2UgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fXN1bW1lcm5hdHVyZSAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9bGV0dGVybGVhdmVzICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1nbG93aW5nbmVvbiAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9ZmFsbGxlYXZlcyAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9ZmxhbW1pbmcgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWhwICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1jYXJ2ZWR3b29kICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH10aWt0b2sgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWFyY2FkZThiaXQgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWJhdHRsZWZpZWxkNCAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9cHViZyAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9d2V0Z2xhc3MgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fW11bHRpY29sb3IzZCAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9d2F0ZXJjb2xvciAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9bHV4dXJ5Z29sZCAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9Z2FsYXh5d2FsbHBhcGVyICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1saWdodHRleHQgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWJlYXV0aWZ1bGZsb3dlciAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9cHVwcHljdXRlICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1yb3lhbHRleHQgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWhlYXJ0c2hhcGVkICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1iaXJ0aGRheWNha2UgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWdhbGF4eXN0eWxlICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1ob2xvZ3JhbTNkICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1ncmVlbm5lb24gKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWdsb3NzeWNocm9tZSAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9Z3JlZW5idXNoICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1tZXRhbGxvZ28gKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fW5vZWx0ZXh0ICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1nbGl0dGVyZ29sZCAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9dGV4dGNha2UgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fXN0YXJzbmlnaHQgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fXdvb2RlbjNkICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH10ZXh0YnluYW1lICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH13cml0ZWdhbGFjeSAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9Z2FsYXh5YmF0ICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1zbm93M2QgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqCiR7Ym9keU19ICR7cHJlZml4fWJpcnRoZGF5ZGF5ICooRXNjcmliZSB1biB0ZXh0byBwYXJhIGNyZWFyIGxvZ28pKgoke2JvZHlNfSAke3ByZWZpeH1nb2xkcGxheWJ1dHRvbiAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9c2lsdmVycGxheWJ1dHRvbiAqKEVzY3JpYmUgdW4gdGV4dG8gcGFyYSBjcmVhciBsb2dvKSoKJHtib2R5TX0gJHtwcmVmaXh9ZnJlZWZpcmUgKihFc2NyaWJlIHVuIHRleHRvIHBhcmEgY3JlYXIgbG9nbykqKgoke2JvZHlNfSAke3ByZWZpeH1ndGF2ICooRXRpcXVldGEgdW5hIGltYWdlbikqCiR7Ym9keU19ICR7cHJlZml4fXdhbnRlZCAqKEV0aXF1ZXRhIHVuYSBpbWFnZW4pKgoke2JvZHlNfSAke3ByZWZpeH13YXN0ZWQgKihFdGlxdWV0YSB1bmEgaW1hZ2VuKSoKJHtib2R5TX0gJHtwcmVmaXh9b2NlYW4gKihFdGlxdWV0YSB1bmEgaW1hZ2VuKSoKJHtib2R5TX0gJHtwcmVmaXh9Z2VyICooRXRpcXVldGEgdW5hIGltYWdlbikqCiR7Ym9keU19ICR7cHJlZml4fWRyYXdpbmcgKihFdGlxdWV0YSB1bmEgaW1hZ2VuKSoKJHtib2R5TX0gJHtwcmVmaXh9Y2cgKihFdGlxdWV0YSB1bmEgaW1hZ2VuKSoKCmAsCgljb250ZXh0SW5mbzogewogIG1lbnRpb25lZEppZDogW3NlbmRlcl0sICJmb3J3YXJkaW5nU2NvcmUiOiA5OTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlCn0KICB9CiAgc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBNZW51NywgdGV4dCwgewpxdW90ZWQ6IGZ2aWR9KSAgICAgICAgICAgICAgCiAgYnJlYWsKCQkJCQoJCQkJCi8vZW5jb2RlIHkgZGVjb2RlIGJ5IFNhbXUKY2FzZSAnY29kZSc6CnRleHRvID0gYXJncy5qb2luKCcgJykKdmFyIHJhd1N0ciA9IGAke3RleHRvfWAKdmFyIHdvcmRBcnJheSA9IENyeXB0b0pTLmVuYy5VdGY4LnBhcnNlKHJhd1N0cik7CnZhciBiYXNlNjQgPSBDcnlwdG9KUy5lbmMuQmFzZTY0LnN0cmluZ2lmeSh3b3JkQXJyYXkpOwpyZXBseShgJHtiYXNlNjR9YCkKYnJlYWsKCmNhc2UgJ2RlY29kZSc6CnRleHRvID0gYXJncy5qb2luKCcgJykKdmFyIHBhcnNlV29yZEFycmF5ID0gQ3J5cHRvSlMuZW5jLkJhc2U2NC5wYXJzZShgJHt0ZXh0b31gKTsKdmFyIHBhcnNlZFN0ciA9IHBhcnNlV29yZEFycmF5LnRvU3RyaW5nKENyeXB0b0pTLmVuYy5VdGY4KTsKCXJlcGx5KGAke3BhcnNlZFN0cn1gKQoJCWJyZWFrCgoKCgpjYXNlICdsb2xpJzoKaWYgKCFpc1JlZ2lzdGVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmRhZnRhckIpCgpzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKdWsgPSBbImFuaW1lIGxvbGkiXQpuayA9IHVrW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHVrLmxlbmd0aCldCnRyeSB7CmRhdGEgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vYXBpLmZkY2kuc2Uvc29zbWVkL3JlcC5waHA/Z2FtYmFyPSR7bmt9YCwgewogIG1ldGhvZDogJ2dldCcKfSkKcmVwbHkobWVzcy53YWl0KQpuID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkYXRhKSk7Cm5pbWVrID0gbltNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBuLmxlbmd0aCldOwpwb2sgPSBhd2FpdCBnZXRCdWZmZXIobmltZWspCnNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgcG9rLCBpbWFnZSwgewogIHF1b3RlZDogc2FtLCBjYXB0aW9uOiBg4piVYCwgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZX0KfSkKCn0gY2F0Y2ggewogIHJlcGx5KG1lc3MuZmVycikKfQpicmVhawkKCQpjYXNlICdtZW1lJzoKICBzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKICBpZiAoIWlzUmVnaXN0ZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkuZGFmdGFyQikKCnRyeSB7CiAgYmVoID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL21lbWUtYXBpLmhlcm9rdWFwcC5jb20vZ2ltbWUvbWVtZXNtZXhpY29gKQogIHBpbnQgPSBhd2FpdCBnZXRCdWZmZXIoYCR7YmVoLnVybH1gKQogIHJlcGx5KG1lc3Mud2FpdCkKICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIHBpbnQsIGltYWdlLCB7CgkgIHF1b3RlZDogZmRvYywgY2FwdGlvbjogYCR7YmVoLnRpdGxlfWAsIGNvbnRleHRJbmZvOiB7ImZvcndhcmRpbmdTY29yZSI6IDk5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9CiAgfSkKICAKfSBjYXRjaCB7CiAgcmVwbHkobWVzcy5mZXJyKQp9CiAgYnJlYWsKCQkJCQoJCQkJCmNhc2UgJ21hcGEnOgogIGlmICghaXNSZWdpc3RlcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5kYWZ0YXJCKQogIAogIGlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybiByZXBseSgnSW5ncmVzYSBlbCBub21icmUgZGVsIMOhcmVhJykKICBkYWVyYWggPSBib2R5LnNsaWNlKDUpCiAgdHJ5IHsKICBkYXRhID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL21uYXpyaWEuaGVyb2t1YXBwLmNvbS9hcGkvbWFwcz9zZWFyY2g9JHtkYWVyYWh9YCkKICByZXBseShtZXNzLndhaXQpCiAgaGFzaWwgPSBhd2FpdCBnZXRCdWZmZXIoZGF0YS5nYW1iYXIpCiAgc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBoYXNpbCwgaW1hZ2UsIHsKcXVvdGVkOiBzYW0sIGNhcHRpb246IGBSZXN1bHRhZG8gKiR7ZGFlcmFofWkqYCwgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZX0KICB9KQogIAogIH0gY2F0Y2ggewogICAgcmVwbHkobWVzcy5mZXJyKQogIH0KICBicmVhawoJCQkKCQkJCmNhc2UgJ3dhLm1lJzoKY2FzZSAnd2FtZSc6CiAgc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCiAgb3B0aW9ucyA9IHsKdGV4dDogYExpbmsgV2hhdHNBcHA6ICp3YS5tZS8ke3NlbmRlci5zcGxpdCgiQHMud2hhdHNhcHAubmV0IilbMF19KlxuKk9yICggLyApKlxuKmFwaS53aGF0c2FwcC5jb20vc2VuZD9waG9uZT0ke3NlbmRlci5zcGxpdCgiQCIpWzBdfSpgLApjb250ZXh0SW5mbzogewogIG1lbnRpb25lZEppZDogW3NlbmRlcl0sICJmb3J3YXJkaW5nU2NvcmUiOiA5OTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlCn0KICB9CiAgc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBvcHRpb25zLCB0ZXh0LCB7CnF1b3RlZDogc2FtCiAgfSkKICBicmVhawoJCQkJCmNhc2UgJ3ZlcmRhZCc6CmNvbnN0IHR0cnRoID0gdHJ1dFtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB0cnV0Lmxlbmd0aCldCnNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYOKAoyAqVmVyZGFkKlxuJHt0dHJ0aH1gLCB0ZXh0LCB7CiAgcXVvdGVkOiBzYW0KfSkKYnJlYWsKCgovLyoqKioqKioqKgogIGNhc2UgJ25vdGlmJzoKCmlmICghaXNHcm91cEFkbWlucykgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5hZG1pbikKc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCmlmICghaXNSZWdpc3RlcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5kYWZ0YXJCKQppZiAoIWlzR3JvdXApIHJldHVybiByZXBseShtZXNzLm9ubHkuZ3JvdXApCnRla3MgPSBgTm90aWZpY2FjacOzbiBkYWRhIHBvciBAJHtzZW5kZXIuc3BsaXQoIkAiKVswXX1cbipNZW5zYWplIDogJHtib2R5LnNsaWNlKDcpfSpgCmdyb3VwID0gYXdhaXQgc2FtdTMzMC5ncm91cE1ldGFkYXRhKGZyb20pOwptZW1iZXIgPSBncm91cFsncGFydGljaXBhbnRzJ10KamlkcyA9IFtdOwptZW1iZXIubWFwKGFzeW5jIGFkbSA9PiB7CiAgamlkcy5wdXNoKGFkbS5pZC5yZXBsYWNlKCdjLnVzJywgJ3Mud2hhdHNhcHAubmV0JykpOwp9KQpvcHRpb25zID0gewogIHRleHQ6IHRla3MsCiAgY29udGV4dEluZm86IHsKbWVudGlvbmVkSmlkOiBqaWRzLCAiZm9yd2FyZGluZ1Njb3JlIjogOTk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZQogIH0sCiAgcXVvdGVkOiBzYW0KfQphd2FpdCBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIG9wdGlvbnMsIHRleHQpCmJyZWFrCgkJCmNhc2UgJ3JlYWRtb3JlJzoKc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCmlmICghaXNSZWdpc3RlcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5kYWZ0YXJCKQoKaWYgKGFyZ3MubGVuZ3RoIDwgMSkgcmV0dXJuIHJlcGx5KGBFc2NyaWJlIGVsIHRleHRvXG5FamVtcGxvIDogJHtwcmVmaXh9cmVhZG1vcmUgdGUgYW1vL3JkaWRvIHVuIHBlcnJvP2ApCnRlbHMgPSBib2R5LnNsaWNlKDkpCnZhciB0ZWtzMSA9IHRlbHMuc3BsaXQoIi8iKVswXTsKdmFyIHRla3MyID0gdGVscy5zcGxpdCgiLyIpWzFdOwpoYXNpbCA9IGAke3Rla3Mxfc2PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/NjyR7dGVrczJ9YApzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGhhc2lsLCB0ZXh0LCB7CiAgcXVvdGVkOiBzYW0KfSkKYnJlYWsKCQkJCQpjYXNlICdzZXRwaWMnOgoKaWYgKCFpc0dyb3VwKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5Lmdyb3VwKQppZiAoIWlzUmVnaXN0ZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkuZGFmdGFyQikKaWYgKCFpc0dyb3VwQWRtaW5zKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmFkbWluKQppZiAoIWlzQm90R3JvdXBBZG1pbnMpIHJldHVybiByZXBseShtZXNzLm9ubHkuQmFkbWluKQpjb25zdCBlbmNtZWRpYSA9IGlzUXVvdGVkSW1hZ2UgPyBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkucmVwbGFjZSgncXVvdGVkTScsICdtJykpLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mbzogc2FtCnJlcGx5KG1lc3Mud2FpdCkKY29uc3QgbWVkaWEgPSBhd2FpdCBzYW11MzMwLmRvd25sb2FkQW5kU2F2ZU1lZGlhTWVzc2FnZShlbmNtZWRpYSkKYXdhaXQgc2FtdTMzMC51cGRhdGVQcm9maWxlUGljdHVyZSAoZnJvbSwgbWVkaWEpCnJlcGx5KCdTZSBjYW1iaW8gbGEgZm90byBkZWwgZ3J1cG8nKQpicmVhawoJCgkJCQkKY2FzZSAncmVnJzoKaWYgKGlzUmVnaXN0ZXIpIHJldHVybiByZXBseSgnVHUgY3VlbnRhIHlhIGVzdGFiYSB2ZXJpZmljYWRhJykKY29uc3QgbmFtYVVzZXIgPSBgJHtwdXNobmFtZX1gCmNvbnN0IHVtdXJVc2VyID0gYCR7c2VuZGVyfWAKY29uc3Qgc2VyaWFsVXNlciA9IGNyZWF0ZVNlcmlhbCgyMCkKdmVyaSA9IHNlbmRlcgppZiAoaXNHcm91cCkgewogIGFkZFJlZ2lzdGVyZWRVc2VyKHNlbmRlciwgbmFtYVVzZXIsIHVtdXJVc2VyLCB0aW1lLCBzZXJpYWxVc2VyKQogIGhhc2lsID0gYOOAmCAgKlZlcmljYWNpw7NuKiDjgJkKQ8OzZGlnbyA6ICoke3NlcmlhbFVzZXJ9Kgril6YgKk5vbWJyZSogOiAqJHtuYW1hVXNlcn0qCuKXpiAqTsO6bWVybyogOiAqJHtzZW5kZXIuc3BsaXQoIkAiKVswXX0qCmAKcmVwbHkoaGFzaWwpCiAgY29uc29sZS5sb2coY29sb3IoJ1tSRUdJU1RFUl0nKSwgY29sb3IodGltZSwgJ3llbGxvdycpLCAnTmFtZTonLCBjb2xvcihuYW1hVXNlciwgJ2N5YW4nKSwgJ0FnZTonLCBjb2xvcih1bXVyVXNlciwgJ2N5YW4nKSwgJ1NlcmlhbDonLCBjb2xvcihzZXJpYWxVc2VyLCAnY3lhbicpLCAnaW4nLCBjb2xvcihzZW5kZXIgfHwgZ3JvdXBOYW1lKSkKfSBlbHNlIHsKICBhZGRSZWdpc3RlcmVkVXNlcihzZW5kZXIsIG5hbWFVc2VyLCB1bXVyVXNlciwgdGltZSwgc2VyaWFsVXNlcikKICBoYXNpbCA9IGDjgJggICpWZXJpZmljYWNpw7NuKiDjgJkKQ8OzZGlnbyA6ICoke3NlcmlhbFVzZXJ9Kgril6YgKk5vbWJyZSogOiAqJHtuYW1hVXNlcn0qCuKXpiAqTsO6bWVybyogOiAqJHtzZW5kZXIuc3BsaXQoIkAiKVswXX0qCmAKcmVwbHkoaGFzaWwpCiAgY29uc29sZS5sb2coY29sb3IoJ1tSRUdJU1RFUl0nKSwgY29sb3IodGltZSwgJ3llbGxvdycpLCAnTmFtZTonLCBjb2xvcihuYW1hVXNlciwgJ2N5YW4nKSwgJ0FnZTonLCBjb2xvcih1bXVyVXNlciwgJ2N5YW4nKSwgJ1NlcmlhbDonLCBjb2xvcihzZXJpYWxVc2VyLCAnY3lhbicpKQp9CnRtID0gYHZlcmlmaWNhY2nDs24gY29tcGxldGEgdXNhICR7cHJlZml4fU1lbnUgcGFyYSB2ZXIgbG9zIGNvbWFuZG9zYApyZXBseSh0bSkKYnJlYWsKCQkKCQkJCQpjYXNlICd0b3VybCc6CiBpZiAoIWlzUmVnaXN0ZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkudXNlckIpCiAgICAgICAgICAgIHZhciBpbWdiYiA9IHJlcXVpcmUoJ2ltZ2JiLXVwbG9hZGVyJykKICAgICAgICAgICBpZiAoKGlzTWVkaWEgJiYgIXNhbS5tZXNzYWdlLnZpZGVvTWVzc2FnZSB8fCBpc1F1b3RlZEltYWdlKSAmJiBhcmdzLmxlbmd0aCA9PSAwKSB7CiAgICAgICAgICAgZ2VyID0gaXNRdW90ZWRJbWFnZSA/IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8gOiBzYW0KICAgICAgICAgICByZXBseShtZXNzLndhaXQpCiAgICAgICAgIG93Z2kgPSBhd2FpdCBzYW11MzMwLmRvd25sb2FkQW5kU2F2ZU1lZGlhTWVzc2FnZShnZXIpCiAgICAgICAgICAgYW51ID0gYXdhaXQgaW1nYmIoJzIwYTE0ODYxZTRmNzU5MWYzZGM1MjY0OWNiMDdhZTAyJywgb3dnaSkKICAgICAgICB0ZWtzID0gYCR7YW51LmRpc3BsYXlfdXJsfWAKcmVwbHkodGVrcykKfQpicmVhawoJCQkJCgkJCQkKCQkJCWNhc2UgJ3Bvcm5vJzoKaWYgKCFpc0dyb3VwKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5Lmdyb3VwKSAgICAgICAgICAKaWYgKCFpc05zZncpIHJldHVybiByZXBseShtZXNzLm5zZncpCnBvcm4gPSBhd2FpdCBmZXRjaEpzb24oJ2h0dHBzOi8vbWVtZS1hcGkuaGVyb2t1YXBwLmNvbS9naW1tZS9wb3JuJywgewptZXRob2Q6ICdnZXQnCgl9KSAKcmVwbHkobWVzcy53YWl0KQpidWZmZXIgPSBhd2FpdCBnZXRCdWZmZXIoYCR7cG9ybi51cmx9YCkKCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYnVmZmVyLCBpbWFnZSwgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCgkJcXVvdGVkOiBmaW1nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAoJfSkKICBicmVhawoJCmNhc2UgJ25la28nOgppZiAoIWlzUmVnaXN0ZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkuZGFmdGFyQikKCnNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQp1ayA9IFsiYW5pbWUgbmVrbyJdCm5rID0gdWtbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdWsubGVuZ3RoKV0KdHJ5IHsKZGF0YSA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkuZmRjaS5zZS9zb3NtZWQvcmVwLnBocD9nYW1iYXI9JHtua31gLCB7CiAgbWV0aG9kOiAnZ2V0Jwp9KQpyZXBseShtZXNzLndhaXQpCm4gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGRhdGEpKTsKbmltZWsgPSBuW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIG4ubGVuZ3RoKV07CnBvayA9IGF3YWl0IGdldEJ1ZmZlcihuaW1laykKc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBwb2ssIGltYWdlLCB7CiAgcXVvdGVkOiBzYW0sIGNhcHRpb246IGDimJVgLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfQp9KQoKfSBjYXRjaCB7CiAgcmVwbHkobWVzcy5mZXJyKQp9CmJyZWFrCgkJCQkKY2FzZSAnbGVzYmlhbic6CmlmICghaXNHcm91cCkgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5ncm91cCkgICAgICAgICAgICAgICAKaWYgKCFpc05zZncpIHJldHVybiByZXBseShtZXNzLm5zZncpCnBvcm4gPSBhd2FpdCBmZXRjaEpzb24oJ2h0dHBzOi8vbWVtZS1hcGkuaGVyb2t1YXBwLmNvbS9naW1tZS9sZXNiaWFucycsIHsKbWV0aG9kOiAnZ2V0JwogICAgICAgIH0pICAgICAgICAgICAgICAgICAgICAKcmVwbHkobWVzcy53YWl0KQpidWZmZXIgPSBhd2FpdCBnZXRCdWZmZXIoYCR7cG9ybi51cmx9YCkgICAgICAgIApzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGJ1ZmZlciwgaW1hZ2UsIHsKZmltZ30pCiAgYnJlYWsKCQkJCQpjYXNlICd0ZXRhcyc6ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAppZiAoIWlzR3JvdXApIHJldHVybiByZXBseShtZXNzLm9ubHkuZ3JvdXApICAgICAgICAgICAgICAKaWYgKCFpc05zZncpIHJldHVybiByZXBseShtZXNzLm5zZncpCnB3ID0gWyJodHRwczovL21lbWUtYXBpLmhlcm9rdWFwcC5jb20vZ2ltbWUvdGl0cyIsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKImh0dHBzOi8vbWVtZS1hcGkuaGVyb2t1YXBwLmNvbS9naW1tZS9CZXN0VGl0cyIsCgkiaHR0cHM6Ly9tZW1lLWFwaS5oZXJva3VhcHAuY29tL2dpbW1lL2Jvb2JzIiwKCSJodHRwczovL21lbWUtYXBpLmhlcm9rdWFwcC5jb20vZ2ltbWUvYW1hemluZ3RpdHMiLCAgICAgICAgICAgICAgICAgICAgCgkiaHR0cHM6Ly9tZW1lLWFwaS5oZXJva3VhcHAuY29tL2dpbW1lL1RpbnlUaXRzIl0gICAgICAgICAKbmsgPSBwd1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBwdy5sZW5ndGgpXQpwb3JuID0gYXdhaXQgZmV0Y2hKc29uKGAke25rfWAsIHsgICAgICAgIAoJbWV0aG9kOiAnZ2V0JyAgICAgICAgICAgICAgICAgICAKfSkKcmVwbHkobWVzcy53YWl0KQpidWZmZXIgPSBhd2FpdCBnZXRCdWZmZXIoYCR7cG9ybi51cmx9YCkgICAgICAgICAgICAgICAgCnNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYnVmZmVyLCBpbWFnZSwgeyAgICAgICAgICAgICAgICAgICAKCXF1b3RlZDogZmltZyAgICAgICAgICAgICAgIAp9KQogIGJyZWFrCgkKY2FzZSAnYXNzJzoKaWYgKCFpc0dyb3VwKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5Lmdyb3VwKSAgICAgICAgICAgICAgICAgICAgICAgICAKaWYgKCFpc05zZncpIHJldHVybiByZXBseShtZXNzLm5zZncpCnB3ID0gWyJodHRwczovL21lbWUtYXBpLmhlcm9rdWFwcC5jb20vZ2ltbWUvQ3V0ZUxpdHRsZUJ1dHRzIiwKImh0dHBzOi8vbWVtZS1hcGkuaGVyb2t1YXBwLmNvbS9naW1tZS9hc3MiLCAgICAgICAgICAgICAgICAKImh0dHBzOi8vbWVtZS1hcGkuaGVyb2t1YXBwLmNvbS9naW1tZS9ib29icyIsCiJodHRwczovL21lbWUtYXBpLmhlcm9rdWFwcC5jb20vZ2ltbWUvYXNzIl0KbmsgPSBwd1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBwdy5sZW5ndGgpXQpwb3JuID0gYXdhaXQgZmV0Y2hKc29uKGAke25rfWAsIHsKICAgICAgICBtZXRob2Q6ICdnZXQnCn0pCnJlcGx5KG1lc3Mud2FpdCkKYnVmZmVyID0gYXdhaXQgZ2V0QnVmZmVyKGAke3Bvcm4udXJsfWApCnNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYnVmZmVyLCBpbWFnZSwgewogICAgICAgIHF1b3RlZDogZmltZyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKfSkKICBicmVhawoJCQkJCmNhc2UgJ3B1c3N5JzoKaWYgKCFpc0dyb3VwKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5Lmdyb3VwKSAgICAgICAgICAgICAgICAgICAgIAppZiAoIWlzTnNmdykgcmV0dXJuIHJlcGx5KG1lc3MubnNmdykKcHcgPSBbImh0dHBzOi8vbWVtZS1hcGkuaGVyb2t1YXBwLmNvbS9naW1tZS9wdXNzeSIsCiJodHRwczovL21lbWUtYXBpLmhlcm9rdWFwcC5jb20vZ2ltbWUvTGVnYWxUZWVucyIgICAgICAgICAgIApdCm5rID0gcHdbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcHcubGVuZ3RoKV0gICAgICAgCnBvcm4gPSBhd2FpdCBmZXRjaEpzb24oYCR7bmt9YCwgewogICAgICAgIG1ldGhvZDogJ2dldCcgICAgICAgICAgICAgICAgICAgCn0pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKcmVwbHkobWVzcy53YWl0KQpidWZmZXIgPSBhd2FpdCBnZXRCdWZmZXIoYCR7cG9ybi51cmx9YCkKc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBidWZmZXIsIGltYWdlLCB7CiAgICAgICAgcXVvdGVkOiBmaW1nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAp9KQogIGJyZWFrCgkJCQkKCQkJCQoJCQkJY2FzZSAnY2MnOgoJCQkJCXRyeSB7CgkJCQkJCWFudSA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly92aWRlZmlrcmkuY29tL2FwaS9jY2dlbmVyYXRvci9gLCB7CgkJCQkJCW1ldGhvZDogJ2dldCcKIAkJCQkJCX0pCiAgCQkJCQkJcmVwbHkoYCoke2FudS5yZXN1bHQuY2FyZC5uZXR3b3JrfSpcbu2gve2ysyBfTnVtZXJvIGRlIHRhcmpldGFfIDogJHthbnUucmVzdWx0LmNhcmQubnVtYmVyfVxuIyBfQ1ZWXyA6ICR7YW51LnJlc3VsdC5jYXJkLmN2dn1cbu2gve2zkSBfcGluXyA6ICR7YW51LnJlc3VsdC5jYXJkLnBpbn1cbu2gve2ysCBfTW9udG9fIDogJHthbnUucmVzdWx0LmNhcmQuYmFsYW5jZX1cbl9NZXMgZGUgdmVuY2ltaWVudG9fIDogJHthbnUucmVzdWx0LmNhcmQuZXhwaXJhdGlvbl9tb250aH1cbl9Bw7FvIGRlIHZlbmNpbWllbnRvXyA6ICR7YW51LnJlc3VsdC5jYXJkLmV4cGlyYXRpb25feWVhcn1cblxuKkluZm9ybWFjaW9uIGRlIGxhIHRhcmpldGEq7aC+7be+XG5c7aC97bGo7aC87b+74oCN7aC+7baxIF9Qcm9waWV0YXJpb18gOiAke2FudS5yZXN1bHQuY3VzdG9tZXIubmFtZX1cbl/toLztvI1EaXJlY2Npb25fIDogJHthbnUucmVzdWx0LmN1c3RvbWVyLmFkZHJlc3N9XG5f7aC87byGQ2l1ZGFkXyA6ICR7YW51LnJlc3VsdC5jdXN0b21lci5jb3VudHJ5fWApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggewogICAgCQkJCQkJcmVwbHkobWVzcy5mZXJyKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKCQkJCQkJCQkJCQkJCSAgICB9CiAgCQkJCQkJYnJlYWsKCQkJCQoJCQkJCgkJCQljYXNlICdudWV2b2dydXBvJzoKCQkJCW5vbWJyZSA9IGFyZ3Muam9pbignICcpCgkJCQljb25zdCBncm91cCA9IGF3YWl0IHNhbXUzMzAuZ3JvdXBDcmVhdGUoYCR7bm9tYnJlfWAsIFsiNTIxOTk4NDkwNzc5NEBzLndoYXRzYXBwLm5ldCJdKQoJCQkJcmVwbHkoYCpFTCBHUlVQTyBGVUUgQ1JFQURPIENPUlJFQ1RBTUVOVEUqXG5pZCBkZWwgZ3J1cG86ICR7Z3JvdXAuZ2lkfWApCgkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGdyb3VwLmdpZCwgImhlbGxvIGV2ZXJ5b25lIiwgdGV4dCwge3F1b3RlZDogZmxpdmVMb2N9KQoJCQkJYnJlYWsKCQkJCQoJCQkJCgkJCQkKCQkJCgoKCQkJCQoJCQkJY2FzZSAnc3RpY2tlcic6CgkJCWNhc2UgJ3N0aWtlcic6CgkJCWNhc2UgJ3MnOgoJCQkJaWYgKGlzTWVkaWEgJiYgIXNhbS5tZXNzYWdlLnZpZGVvTWVzc2FnZSB8fCBpc1F1b3RlZEltYWdlKSB7CgkJCQkJY29uc3QgZW5jbWVkaWEgPSBpc1F1b3RlZEltYWdlID8gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzYW0pLnJlcGxhY2UoJ3F1b3RlZE0nLCAnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8gOiBzYW0KCQkJCQljb25zdCBtZWRpYSA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRBbmRTYXZlTWVkaWFNZXNzYWdlKGVuY21lZGlhLCBgLi9zdGlja2VyLyR7c2VuZGVyfWApCgkJCQkJYXdhaXQgZmZtcGVnKGAke21lZGlhfWApCgkJCQkJCQkuaW5wdXQobWVkaWEpCgkJCQkJCQkub24oJ3N0YXJ0JywgZnVuY3Rpb24gKGNtZCkgewoJCQkJCQkJCWNvbnNvbGUubG9nKGBTdGFydGVkIDogJHtjbWR9YCkKCQkJCQkJCX0pCgkJCQkJCQkub24oJ2Vycm9yJywgZnVuY3Rpb24gKGVycikgewoJCQkJCQkJCWNvbnNvbGUubG9nKGBFcnJvciA6ICR7ZXJyfWApCgkJCQkJCQkJZnMudW5saW5rU3luYyhtZWRpYSkKCQkJCQkJCQlyZXBseSgnZXJyb3InKQoJCQkJCQkJfSkKCQkJCQkJCS5vbignZW5kJywgZnVuY3Rpb24gKCkgewoJCQkJCQkJCWNvbnNvbGUubG9nKCdGaW5pc2gnKQoJCQkJCQkJCWV4ZWMoYHdlYnBtdXggLXNldCBleGlmIC4vc3RpY2tlci9kYXRhLmV4aWYgLi9zdGlja2VyLyR7c2VuZGVyfS53ZWJwIC1vIC4vc3RpY2tlci8ke3NlbmRlcn0ud2VicGAsIGFzeW5jIChlcnJvcikgPT4gewoJCQkJCQkJCQlpZiAoZXJyb3IpIHJldHVybiBhcXVsLnJlcGx5KGZyb20sIG1lc3MuZXJyb3IuYXBpLCBxdWwpCgkJCQkJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2Vmcm9tLCBmcy5yZWFkRmlsZVN5bmMoYC4vc3RpY2tlci8ke3NlbmRlcn0ud2VicGApLHN0aWNrZXIsIHtxdW90ZWQ6IGZkb2MsIGNvbnRleHRJbmZvOiB7ImZvcndhcmRpbmdTY29yZSI6IDk5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9fSkKCQkJCQkJCQkJZnMudW5saW5rU3luYyhtZWRpYSkJCgkJCQkJCQkJCWZzLnVubGlua1N5bmMoYC4vc3RpY2tlci8ke3NlbmRlcn0ud2VicGApCQoJCQkJCQkJCX0pCgkJCQkJCQl9KQoJCQkJCQkJLmFkZE91dHB1dE9wdGlvbnMoW2AtdmNvZGVjYCxgbGlid2VicGAsYC12ZmAsYHNjYWxlPSdtaW4oMzIwLGl3KSc6bWluJygzMjAsaWgpJzpmb3JjZV9vcmlnaW5hbF9hc3BlY3RfcmF0aW89ZGVjcmVhc2UsZnBzPTE1LCBwYWQ9MzIwOjMyMDotMTotMTpjb2xvcj13aGl0ZUAwLjAsIHNwbGl0IFthXVtiXTsgW2FdIHBhbGV0dGVnZW49cmVzZXJ2ZV90cmFuc3BhcmVudD1vbjp0cmFuc3BhcmVuY3lfY29sb3I9ZmZmZmZmIFtwXTsgW2JdW3BdIHBhbGV0dGV1c2VgXSkKCQkJCQkJCS50b0Zvcm1hdCgnd2VicCcpCgkJCQkJCQkuc2F2ZShgLi9zdGlja2VyLyR7c2VuZGVyfS53ZWJwYCkKCQkJCX0gZWxzZSBpZiAoKGlzTWVkaWEgJiYgc2FtLm1lc3NhZ2UudmlkZW9NZXNzYWdlLmZpbGVMZW5ndGggPCAxMDAwMDAwMCB8fCBpc1F1b3RlZFZpZGVvICYmIHNhbS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8ucXVvdGVkTWVzc2FnZS52aWRlb01lc3NhZ2UuZmlsZUxlbmd0aCA8IDEwMDAwMDAwKSkgewoJCQkJCWNvbnN0IGVuY21lZGlhID0gaXNRdW90ZWRWaWRlbyA/IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywgJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvIDogc2FtCgkJCQkJY29uc3QgbWVkaWEgPSBhd2FpdCBzYW11MzMwLmRvd25sb2FkQW5kU2F2ZU1lZGlhTWVzc2FnZShlbmNtZWRpYSwgYC4vc3RpY2tlci8ke3NlbmRlcn1gKQoJCQkJCXJlcGx5KG1lc3Mud2FpdCkKCQkJCQkJYXdhaXQgZmZtcGVnKGAke21lZGlhfWApCgkJCQkJCQkuaW5wdXRGb3JtYXQobWVkaWEuc3BsaXQoJy4nKVs0XSkKCQkJCQkJCS5vbignc3RhcnQnLCBmdW5jdGlvbiAoY21kKSB7CgkJCQkJCQkJY29uc29sZS5sb2coYFN0YXJ0ZWQgOiAke2NtZH1gKQoJCQkJCQkJfSkKCQkJCQkJCS5vbignZXJyb3InLCBmdW5jdGlvbiAoZXJyKSB7CgkJCQkJCQkJY29uc29sZS5sb2coYEVycm9yIDogJHtlcnJ9YCkKCQkJCQkJCQlmcy51bmxpbmtTeW5jKG1lZGlhKQoJCQkJCQkJCXRpcGUgPSBtZWRpYS5lbmRzV2l0aCgnLm1wNCcpID8gJ3ZpZGVvJyA6ICdnaWYnCgkJCQkJCQkJcmVwbHkoJ2Vycm9yJykKCQkJCQkJCX0pCgkJCQkJCQkub24oJ2VuZCcsIGZ1bmN0aW9uICgpIHsKCQkJCQkJCQljb25zb2xlLmxvZygnRmluaXNoJykKCQkJCQkJCQlleGVjKGB3ZWJwbXV4IC1zZXQgZXhpZiAuL3N0aWNrZXIvZGF0YS5leGlmIC4vc3RpY2tlci8ke3NlbmRlcn0ud2VicCAtbyAuL3N0aWNrZXIvJHtzZW5kZXJ9LndlYnBgLCBhc3luYyAoZXJyb3IpID0+IHsKCQkJCQkJCQkJaWYgKGVycm9yKSByZXR1cm4gcmVwbHkoJ2Vycm9yJykKCQkJCQkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBmcy5yZWFkRmlsZVN5bmMoYC4vc3RpY2tlci8ke3NlbmRlcn0ud2VicGApLCBzdGlja2VyLCB7cXVvdGVkOiBmZG9jLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfX0pCgkJCQkJCQkJCWZzLnVubGlua1N5bmMobWVkaWEpCgkJCQkJCQkJCWZzLnVubGlua1N5bmMoYC4vc3RpY2tlci8ke3NlbmRlcn0ud2VicGApCgkJCQkJCQkJfSkKCQkJCQkJCX0pCgkJCQkJCQkuYWRkT3V0cHV0T3B0aW9ucyhbYC12Y29kZWNgLGBsaWJ3ZWJwYCxgLXZmYCxgc2NhbGU9J21pbigzMjAsaXcpJzptaW4nKDMyMCxpaCknOmZvcmNlX29yaWdpbmFsX2FzcGVjdF9yYXRpbz1kZWNyZWFzZSxmcHM9MTUsIHBhZD0zMjA6MzIwOi0xOi0xOmNvbG9yPXdoaXRlQDAuMCwgc3BsaXQgW2FdW2JdOyBbYV0gcGFsZXR0ZWdlbj1yZXNlcnZlX3RyYW5zcGFyZW50PW9uOnRyYW5zcGFyZW5jeV9jb2xvcj1mZmZmZmYgW3BdOyBbYl1bcF0gcGFsZXR0ZXVzZWBdKQoJCQkJCQkJLnRvRm9ybWF0KCd3ZWJwJykKCQkJCQkJCS5zYXZlKGAuL3N0aWNrZXIvJHtzZW5kZXJ9LndlYnBgKQoJCQkJfSBlbHNlIHsKCQkJCQlyZXBseShgS2lyaW0gZ2FtYmFyL3ZpZGVvIGRlbmdhbiBjYXB0aW9uICR7cHJlZml4fXN0aWNrZXIgYXRhdSB0YWcgZ2FtYmFyL3ZpZGVvIHlhbmcgc3VkYWggZGlraXJpbVxuTm90ZSA6IER1cmFzaSB2aWRlbyBtYXhpbWFsIDEwIGRldGlrYCkKCQkJCX0KCQkJCWJyZWFrCgkJCQkKCQkJCQoJCQkJCgkJCQkKCQkJCQoJCQkJCgkJCQkKCQkJCQoJCQkJCgkJCQljYXNlICdzaW1pJzoKc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCnRleHRvID0gYm9keS5zbGljZSg1KSAgICAgICAgICAgICAgICAgICAgCnNpbSA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkuc2ltc2ltaS5uZXQvdjEvP3RleHQ9JHt0ZXh0b30mbGFuZz1lc2ApCnNtdXUgPSAoYCR7c2ltLnN1Y2Nlc3N9YCkgICAgICAgICAgICAgICAgICAgCnNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgc211dSwgdGV4dCwge3F1b3RlZDogeyBrZXk6IHsgICAgICAgICAgICAgCglmcm9tTWU6IGZhbHNlLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAoJcGFydGljaXBhbnQ6IGAwQHMud2hhdHNhcHAubmV0YCwgLi4uKGZyb20gPyB7IHJlbW90ZUppZDogInN0YXR1c0Bicm9hZGNhc3QiIH0gOiB7fSkgICAgICAgICAKfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiB7ICAgICAgICAgICAKCQkJCQkJCQkicHJvZHVjdE1lc3NhZ2UiOiB7ICAgICAgICAgIAoJCQkJCQkJCQkicHJvZHVjdCI6IHsgICAgICAgICAgICAKCQkJCQkJCQkJCSJwcm9kdWN0SW1hZ2UiOnsgICAgICAgCgkJCQkJCQkJCQkJIm1pbWV0eXBlIjogImltYWdlL2pwZWciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImpwZWdUaHVtYm5haWwiOiBmcy5yZWFkRmlsZVN5bmMoYC4vc3JjL3NpbWkuanBnYCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0aXRsZSI6IGDinqvtoLXtsJLtoLXtsKLtoLXtsKbtoLXtsKztoLXtsKLtoLXtsKbtoLXtsKIgfCDtoLXtsJLtoLXtsJrtoLXtsKYg7aC17bCyIO2gte2wj+2gte2wnu2gte2wq+2gte2wq+2gte2wsu2gve20peKdo++4j3wgJHtwdXNobmFtZX0gYCwgICAgICAgICAgICAgICAgCgkJCQkJCQkJCQkiZGVzY3JpcHRpb24iOiBgJHt0ZXh0b31gLCAgICAKCQkJCQkJCQkJCSJjdXJyZW5jeUNvZGUiOiAnJywKCQkJCQkJCQkJCSJwcmljZUFtb3VudDEwMDAiOiAiOTk5IiwKCQkJCQkJCQkJCSJyZXRhaWxlcklkIjogJ1RPTScsICAKCQkJCQkJCQkJCSJwcm9kdWN0SW1hZ2VDb3VudCI6IDk5OQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiYnVzaW5lc3NPd25lckppZCI6IGA1MjE5OTg0OTA3Nzk0QHMud2hhdHNhcHAubmV0YAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKCQkJCQkgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAoJCQkJICAgICAgfSkKCQkJCWJyZWFrCgkJCQkKCQkJCQoJCQkJCgkJCWNhc2UgJ2hpZGV0YWcxJzoKCQkJY2FzZSAnaGlkZXRhZyc6CgkJCQlpZiAoIWlzR3JvdXApIHJldHVybiByZXBseShtZXNzLm9ubHkuZ3JvdXApCgkJCQkJbWVtYmVyc19pZCA9IFtdCgkJCQkJdGVrcyA9IChhcmdzLmxlbmd0aCA+IDEpID8gYXJncy5qb2luKCcgJykudHJpbSgpIDogYCR7YXJncy5qb2luKCcgJyl9YAoJCQkJCWZvciAobGV0IG1lbSBvZiBncm91cE1lbWJlcnMpIHsKCQkJCQkJbWVtYmVyc19pZC5wdXNoKG1lbS5qaWQpCgkJCQkJfQoJCQkJCW1lbnRpb25zKHRla3MsIG1lbWJlcnNfaWQsIHRydWUsIE1lc3NhZ2VUeXBlLnRleHQpCgkJCQlicmVhawoJCQkKCQkJY2FzZSAnc2V0bmFtZSc6CgkJCQlhd2FpdCBzYW11MzMwLmdyb3VwVXBkYXRlU3ViamVjdChmcm9tLCBgJHthcmdzLmpvaW4oJyAnKX1gKQoJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBgKuOAjCBOT01CUkUgREVMIEdSVVBPIENBTUJJQURPIEE644CNXG4ke2FyZ3Muam9pbignICcpfSpgLCBNZXNzYWdlVHlwZS50ZXh0KQoJCQkJYnJlYWsKCQkJY2FzZSAnc2V0ZGVzYyc6CgkJCQlhd2FpdCBzYW11MzMwLmdyb3VwVXBkYXRlRGVzY3JpcHRpb24oZnJvbSwgYCR7YXJncy5qb2luKCcgJyl9YCkKCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYCrjgIwgREVTQ1JJUENJT04gREVMIEdSVVBPIENBTUJJQURBIEE644CNXG4ke2FyZ3Muam9pbignICcpfSpgLCBNZXNzYWdlVHlwZS50ZXh0KQoJCQkJYnJlYWsKCQkJY2FzZSAndXB0aW1lJzoKCQkJCXJ1bnRpbWUgPSBwcm9jZXNzLnVwdGltZSgpCgkJCQl0ZWtzID0gYCR7a3l1bihydW50aW1lKX1gCgkJCQkKCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYCR7dGVrc31gLCBNZXNzYWdlVHlwZS50ZXh0KQoJCQkJYnJlYWsKCQkJCgkJCWNhc2UgJ2ltYWdlbic6CmlmICghaXNSZWdpc3RlcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5kYWZ0YXJCKQoKaWYgKGFyZ3MubGVuZ3RoIDwgMSkgcmV0dXJuIHJlcGx5KCdJbmdyZXNhIGFsZ28gcGFyYSBidXNjYXIgZW4gaW3DoWdlbmVz7aC97bSQJykKdGVscyA9IGJvZHkuc2xpY2UoOCkKZmFrZWUgPSBmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL2ltZy5qcGcnKQpzYW11MzMwLnVwZGF0ZVByZXNlbmNlKGZyb20sIFByZXNlbmNlLmNvbXBvc2luZykKcmVwbHkobWVzcy53YWl0KQp0cnkgewpkYXRhID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS5mZGNpLnNlL3Nvc21lZC9yZXAucGhwP2dhbWJhcj0ke3RlbHN9YCwgewogIG1ldGhvZDogJ2dldCcKfSkKbiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZGF0YSkpOwpuaW1layA9IG5bTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogbi5sZW5ndGgpXTsKcG9rID0gYXdhaXQgZ2V0QnVmZmVyKG5pbWVrKQpzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIHBvaywgaW1hZ2UsIHsKICBxdW90ZWQ6IGZ0b2tvLCBjYXB0aW9uOiBgRXNwZXJvIHkgdGUgZ3VzdGUgZXN0YSBpbWFnZW4gZGUgKiR7dGVsc30qYCwgdGh1bWJuYWlsOiBmYWtlZSwgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZX0KfSkKCn0gY2F0Y2ggewogIHJlcGx5KG1lc3MuZmVycikKfQpicmVhawoJCQkKY2FzZSAnYW50aWRlbGV0ZSc6CgkJCQljb25zdCBkYXRhUmV2b2tlID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL2djLXJldm9rZWQuanNvbicpKQoJCQkJY29uc3QgZGF0YUN0UmV2b2tlID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL2N0LXJldm9rZWQuanNvbicpKQoJCQkJY29uc3QgZGF0YUJhbkN0UmV2b2tlID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL2N0LXJldm9rZWQtYmFubGlzdC5qc29uJykpCgkJCQljb25zdCBpc1Jldm9rZSA9IGRhdGFSZXZva2UuaW5jbHVkZXMoZnJvbSkKCQkJCWNvbnN0IGlzQ3RSZXZva2UgPSBkYXRhQ3RSZXZva2UuZGF0YQoJCQkJY29uc3QgaXNCYW5DdFJldm9rZSA9IGRhdGFCYW5DdFJldm9rZS5pbmNsdWRlcyhzZW5kZXIpID8gdHJ1ZSA6IGZhbHNlCgkJCQljb25zdCBhcmd6ID0gYm9keS5zcGxpdCgnICcpCgkJCQlpZiAoYXJnei5sZW5ndGggPT09IDEpIHJldHVybiBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGBVc28gZGUgbGEgZnVuY2nDs24gYW50aWRlbGV0ZSA6XG5cbioke3ByZWZpeH1hbnRpZGVsZXRlIFthY3RpdmFyL2Rlc2FjdGl2YXJdKiAoUGFyYSBncnVwb3MpXG4qJHtwcmVmaXh9YW50aWRlbGV0ZSBbMS8wXSogKFBhcmEgUFJJVilcbioke3ByZWZpeH1hbnRpZGVsZXRlIGJhbmN0IDUyMTk5ODR4eHh4eHh4KiAoUGFyYSB1biBudW1lcm8gZW4gZXNwZWNpZmljbylgLCBNZXNzYWdlVHlwZS50ZXh0KQoJCQkJaWYgKGFyZ3pbMV0gPT0gJ2FjdGl2YXInKSB7CgkJCQkJaWYgKGlzR3JvdXApIHsKCQkJCQkJaWYgKGlzUmV2b2tlKSByZXR1cm4gc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBgQW50aWRlbGV0ZSBlc3RhYmEgaGFiaWxpdGFkbyBlbiBlc3RlIGdydXBvIGFudGVzIWAsIE1lc3NhZ2VUeXBlLnRleHQpCgkJCQkJCWRhdGFSZXZva2UucHVzaChmcm9tKQoJCQkJCQlmcy53cml0ZUZpbGVTeW5jKCcuL3NyYy9nYy1yZXZva2VkLmpzb24nLCBKU09OLnN0cmluZ2lmeShkYXRhUmV2b2tlLCBudWxsLCAyKSkKCQkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBgKlN1Y2NlcyBFbmFibGUgQW50aWRlbGV0ZSBHcnVwISpgLCBNZXNzYWdlVHlwZS50ZXh0KQoJCQkJCX0gZWxzZSBpZiAoIWlzR3JvdXApIHsKCQkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBgUGFyYSB1dGlsaXphciBlbiBQUklWOiAqJHtwcmVmaXh9YW50aWRlbGV0ZSAxKmAsIE1lc3NhZ2VUeXBlLnRleHQpCgkJCQkJfQoJCQkJfSBlbHNlIGlmIChhcmd6WzFdID09ICcxJykgewoJCQkJCWlmICghaXNHcm91cCkgewoJCQkJCQlpZiAoaXNDdFJldm9rZSkgcmV0dXJuIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYEFudGlkZWxldGUgc2UgaGEgaGFiaWxpdGFkbyBlbiB0b2RvcyBsb3MgY29udGFjdG9zIWAsIE1lc3NhZ2VUeXBlLnRleHQpCgkJCQkJCWRhdGFDdFJldm9rZS5kYXRhID0gdHJ1ZQoJCQkJCQlmcy53cml0ZUZpbGVTeW5jKCcuL3NyYy9jdC1yZXZva2VkLmpzb24nLCBKU09OLnN0cmluZ2lmeShkYXRhQ3RSZXZva2UsIG51bGwsIDIpKQoJCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGBBbnRpZGVsZXRlIHlhIGVzdGEgYWN0aXZhZG8gZW4gdG9kb3MgbG9zIGNvbnRhY3RvcyFgLCBNZXNzYWdlVHlwZS50ZXh0KQoJCQkJCX0gZWxzZSBpZiAoaXNHcm91cCkgewoJCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGBQYXJhIHVzb2VuIGdydXBvczogKiR7cHJlZml4fWFudGlkZWxldGUgYWN0aXZhcipgLCBNZXNzYWdlVHlwZS50ZXh0KQoJCQkJCX0KCQkJCX0gZWxzZSBpZiAoYXJnelsxXSA9PSAnYmFuY3QnKSB7CgkJCQkJaWYgKGlzQmFuQ3RSZXZva2UpIHJldHVybiBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGBFc3RlIGNvbnRhY3RvIHlhIGVzdMOhIGVuIGxhIGJhc2UgZGUgZGF0b3MgZGUgbGEgbGlzdGEgZGUgcHJvaGliaWNpw7NuLiFgLCBNZXNzYWdlVHlwZS50ZXh0KQoJCQkJCWlmIChhcmd6Lmxlbmd0aCA9PT0gMiB8fCBhcmd6WzJdLnN0YXJ0c1dpdGgoJzAnKSkgcmV0dXJuIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYEluZ3Jlc2UgZWwgbsO6bWVybyBxdWUgY29taWVuemUgc2luIGVsICsuXG5FamVtcGxvIDUyOTk4NHh4eHh4YCwgTWVzc2FnZVR5cGUudGV4dCkKCQkJCQlkYXRhQmFuQ3RSZXZva2UucHVzaChhcmd6WzJdICsgJ0BzLndoYXRzYXBwLm5ldCcpCgkJCQkJZnMud3JpdGVGaWxlU3luYygnLi9zcmMvY3QtcmV2b2tlZC1iYW5saXN0Lmpzb24nLCBKU09OLnN0cmluZ2lmeShkYXRhQmFuQ3RSZXZva2UsIG51bGwsIDIpKQoJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYEtvbnRhayAke2FyZ3pbMl19IHRlbGFoIGRpbWFzdWthbiBrZSBiYW5saXN0IGFudGlkZWxldGUgc2VjYXJhIHBlcm1hbmVuIWAsIE1lc3NhZ2VUeXBlLnRleHQpCgkJCQl9IGVsc2UgaWYgKGFyZ3pbMV0gPT0gJ2Rlc2FjdGl2YXInKSB7CgkJCQkJaWYgKGlzR3JvdXApIHsKCQkJCQkJY29uc3QgaW5kZXggPSBkYXRhUmV2b2tlLmluZGV4T2YoZnJvbSkKCQkJCQkJZGF0YVJldm9rZS5zcGxpY2UoaW5kZXgsIDEpCgkJCQkJCWZzLndyaXRlRmlsZVN5bmMoJy4vc3JjL2djLXJldm9rZWQuanNvbicsIEpTT04uc3RyaW5naWZ5KGRhdGFSZXZva2UsIG51bGwsIDIpKQoJCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGAqU3VjY2VzIGRpc2FibGUgQW50aWRlbGV0ZSBHcnVwISpgLCBNZXNzYWdlVHlwZS50ZXh0KQoJCQkJCX0gZWxzZSBpZiAoIWlzR3JvdXApIHsKCQkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBgUGFyYSB1dGlsaXphciBlbiBQcml2OiAqJHtwcmVmaXh9YW50aWRlbGV0ZSAwKmAsIE1lc3NhZ2VUeXBlLnRleHQpCgkJCQkJfQoJCQkJfSBlbHNlIGlmIChhcmd6WzFdID09ICcwJykgewoJCQkJCWlmICghaXNHcm91cCkgewoJCQkJCQlkYXRhQ3RSZXZva2UuZGF0YSA9IGZhbHNlCgkJCQkJCWZzLndyaXRlRmlsZVN5bmMoJy4vc3JjL2N0LXJldm9rZWQuanNvbicsIEpTT04uc3RyaW5naWZ5KGRhdGFDdFJldm9rZSwgbnVsbCwgMikpCgkJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYEFudGlkZWxldGUgZXN0w6EgZGVzaGFiaWxpdGFkbyBlbiB0b2RvcyBsb3MgY29udGFjdG9zIWAsIE1lc3NhZ2VUeXBlLnRleHQpCgkJCQkJfSBlbHNlIGlmIChpc0dyb3VwKSB7CgkJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYFBhcmEgdXNvIGVuIGdydXBvczogKiR7cHJlZml4fWFudGlkZWxldGUgZGVzYWN0aXZhcipgLCBNZXNzYWdlVHlwZS50ZXh0KQoJCQkJCX0KCQkJCX0KCQkJCWJyZWFrCgkJCWNhc2UgJ2xpbmsnOgoJCQkJaWYgKCFpc0dyb3VwKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5Lmdyb3VwKQoJCQkJY29uc3QgbGlua2djID0gYXdhaXQgc2FtdTMzMC5ncm91cEludml0ZUNvZGUoZnJvbSkKCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYGh0dHBzOi8vY2hhdC53aGF0c2FwcC5jb20vJHtsaW5rZ2N9YCwgdGV4dCwge3F1b3RlZDpmZG9jfSkKCQkJCWJyZWFrCgkJCQkKCQkJCQoJCQkJCgkJY2FzZSAnc2hvcnRsaW5rJzoKCQkgICAgaWYgKCFpc1JlZ2lzdGVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmRhZnRhckIpCgkJICAgIGlmICghaXNVcmwpIHJldHVybiByZXBseSgnUG9yZmF2b3IgZW52aWEgZXNwZWNpZmljYW1lbnRlIHVuIGxpbmsnKQogICAgICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA8MCkgcmV0dXJuIHJlcGx5KGBFamVtcGxvOiAke3ByZWZpeH1zaG9ydGxpbmsgaHR0cHM6Ly9ib25nby5jYXRgKQogICAgICAgICAgICAgICAgICAgIGluaV9saW5rID0gYXJncy5qb2luKCcgJykKICAgICAgICAgICAgICAgICAgICBpbmlfYnVmZmVyID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS5sb2xodW1hbi54eXovYXBpL3Nob3J0bGluaz9hcGlrZXk9JHthcGl9JnVybD0ke2luaV9saW5rfWApCiAgICAgICAgICAgICAgICAgICAgcmVwbHkoaW5pX2J1ZmZlci5yZXN1bHQpCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKCQkJCQoJCQkKCQljYXNlICdzdGFsa2lnJzoKICAgICAgICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPT0gMCkgcmV0dXJuIHJlcGx5KGBFamVtcGxvOiAke3ByZWZpeCArIGNvbW1hbmR9IHNhbXUuMzMwYCkKICAgICAgICAgICAgICAgICAgICB1c2VybmFtZSA9IGFyZ3Muam9pbignICcpCiAgICAgICAgICAgICAgICAgICAgaW5pX3Jlc3VsdCA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkubG9saHVtYW4ueHl6L2FwaS9zdGFsa2lnLyR7dXNlcm5hbWV9P2FwaWtleT0ke2FwaX1gKQogICAgICAgICAgICAgICAgICAgIGluaV9yZXN1bHQgPSBpbmlfcmVzdWx0LnJlc3VsdAogICAgICAgICAgICAgICAgICAgIGluaV9idWZmZXIgPSBhd2FpdCBnZXRCdWZmZXIoaW5pX3Jlc3VsdC5waG90b19wcm9maWxlKQogICAgICAgICAgICAgICAgICAgIGluaV90eHQgPSBgVXNlcm5hbWUgOiAke2luaV9yZXN1bHQudXNlcm5hbWV9XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBgRnVsbCBOYW1lIDogJHtpbmlfcmVzdWx0LmZ1bGxuYW1lfVxuYAogICAgICAgICAgICAgICAgICAgIGluaV90eHQgKz0gYFBvc3RzIDogJHtpbmlfcmVzdWx0LnBvc3RzfVxuYAogICAgICAgICAgICAgICAgICAgIGluaV90eHQgKz0gYEZvbGxvd2VycyA6ICR7aW5pX3Jlc3VsdC5mb2xsb3dlcnN9XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBgRm9sbG93aW5nIDogJHtpbmlfcmVzdWx0LmZvbGxvd2luZ31cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGBCaW8gOiAke2luaV9yZXN1bHQuYmlvfWAKICAgICAgICAgICAgICAgICAgICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGluaV9idWZmZXIsIGltYWdlLCB7IGNhcHRpb246IGluaV90eHQgfSkKICAgICAgICAgICAgICAgICAgICBicmVhawoJCQkJCgkJY2FzZSAnZG9uYWxkdHJ1bXAnOgogICAgICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA9PSAwKSByZXR1cm4gcmVwbHkoYEVqZW1wbG86ICR7cHJlZml4ICsgY29tbWFuZH0gU2FtdTMzMCB5IFBlcnJ5YCkKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ID0gYXJncy5qb2luKCcgJykKICAgICAgICAgICAgICAgICAgICBpbmlfYnVmZmVyID0gYXdhaXQgZ2V0QnVmZmVyKGBodHRwczovL2FwaS5sb2xodW1hbi54eXovYXBpL3R3ZWV0dHJ1bXA/YXBpa2V5PSR7YXBpfSZ0ZXh0PSR7aW5pX3R4dH1gKQogICAgICAgICAgICAgICAgICAgIGF3YWl0IHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgaW5pX2J1ZmZlciwgaW1hZ2UsIHsgcXVvdGVkOiBmdG9rbyB9KQogICAgICAgICAgICAgICAgICAgIGJyZWFrCgkJCQkKCQljYXNlICdlbW9qaSc6CiAgICAgICAgICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID09IDApIHJldHVybiByZXBseShgRWplbXBsbzogJHtwcmVmaXggKyBjb21tYW5kfSDtoL3tuK1gKQogICAgICAgICAgICAgICAgICAgIGVtb2ppID0gYXJnc1swXQogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGVtb2ppID0gZW5jb2RlVVJJQ29tcG9uZW50KGVtb2ppWzBdKQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgICAgICAgICBlbW9qaSA9IGVuY29kZVVSSUNvbXBvbmVudChlbW9qaSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaW5pX2J1ZmZlciA9IGF3YWl0IGdldEJ1ZmZlcihgaHR0cHM6Ly9hcGkubG9saHVtYW4ueHl6L2FwaS9zbW9qaS8ke2Vtb2ppfT9hcGlrZXk9JHthcGl9YCkKICAgICAgICAgICAgICAgICAgICBhd2FpdCBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGluaV9idWZmZXIsIHN0aWNrZXIsIHsgcXVvdGVkOiBmdG9rbyB9KQogICAgICAgICAgICAgICAgICAgIGJyZWFrCgkJCQkKCQljYXNlICd0YWtlc3RpY2snOgogICAgICAgICAgICAgICAgICAgIGlmICgoaXNNZWRpYSAmJiAhc2FtLm1lc3NhZ2UudmlkZW9NZXNzYWdlIHx8IGlzUXVvdGVkU3RpY2tlcikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID09IDApIHJldHVybiByZXBseShgRXhhbXBsZTogJHtwcmVmaXggKyBjb21tYW5kfSBTYW11MzMwfFNhbSB5IFBlcnJ5YCkKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZW5jbWVkaWEgPSBpc1F1b3RlZFN0aWNrZXIgPyBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkucmVwbGFjZSgncXVvdGVkTScsICdtJykpLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mbyA6IHNhbQogICAgICAgICAgICAgICAgICAgICAgICBmaWxlUGF0aCA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRBbmRTYXZlTWVkaWFNZXNzYWdlKGVuY21lZGlhLCBmaWxlbmFtZSA9IGdldFJhbmRvbSgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgZmlsZV9uYW1lID0gZ2V0UmFuZG9tKCIud2VicCIpCiAgICAgICAgICAgICAgICAgICAgICAgIGluaV90eHQgPSBhcmdzLmpvaW4oIiAiKS5zcGxpdCgifCIpCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3QoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBgaHR0cHM6Ly9hcGkubG9saHVtYW4ueHl6L2FwaS9jb252ZXJ0L3Rvd2VicGF1dGhvcj9hcGlrZXk9JHthcGl9YCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybURhdGE6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaW1nIjogZnMuY3JlYXRlUmVhZFN0cmVhbShmaWxlUGF0aCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInBhY2thZ2UiOiBpbmlfdHh0WzBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJhdXRob3IiOiBpbmlfdHh0WzFdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5jb2Rpbmc6ICJiaW4iCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycm9yLCByZXNwb25zZSwgYm9keSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZnMudW5saW5rU3luYyhmaWxlUGF0aCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZzLndyaXRlRmlsZVN5bmMoZmlsZV9uYW1lLCBib2R5LCAiYmluIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluaV9idWZmID0gZnMucmVhZEZpbGVTeW5jKGZpbGVfbmFtZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgaW5pX2J1ZmYsIHN0aWNrZXIsIHsgcXVvdGVkOiBzYW0gfSkudGhlbigoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnMudW5saW5rU3luYyhmaWxlX25hbWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICByZXBseShgRXRpcXVldGEgdW4gc3Rpa2VyIGNvbiBlbCBjb21hbmRvYCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWsKCQkJCQoJCWNhc2UgJ2JsYWNrcGluayc6CiAgICAgICAgICAgICAgICBjYXNlICduZW9uJzoKICAgICAgICAgICAgICAgIGNhc2UgJ2dyZWVubmVvbic6CiAgICAgICAgICAgICAgICBjYXNlICdhZHZhbmNlZ2xvdyc6CiAgICAgICAgICAgICAgICBjYXNlICdmdXR1cmVuZW9uJzoKICAgICAgICAgICAgICAgIGNhc2UgJ3NhbmR3cml0aW5nJzoKICAgICAgICAgICAgICAgIGNhc2UgJ3NhbmRzdW1tZXInOgogICAgICAgICAgICAgICAgY2FzZSAnc2FuZGVuZ3JhdmVkJzoKICAgICAgICAgICAgICAgIGNhc2UgJ21ldGFsZGFyayc6CiAgICAgICAgICAgICAgICBjYXNlICduZW9ubGlnaHQnOgogICAgICAgICAgICAgICAgY2FzZSAnaG9sb2dyYXBoaWMnOgogICAgICAgICAgICAgICAgY2FzZSAndGV4dDE5MTcnOgogICAgICAgICAgICAgICAgY2FzZSAnbWluaW9uJzoKICAgICAgICAgICAgICAgIGNhc2UgJ2RlbHV4ZXNpbHZlcic6CiAgICAgICAgICAgICAgICBjYXNlICduZXd5ZWFyY2FyZCc6CiAgICAgICAgICAgICAgICBjYXNlICdibG9vZGZyb3N0ZWQnOgogICAgICAgICAgICAgICAgY2FzZSAnaGFsbG93ZWVuJzoKICAgICAgICAgICAgICAgIGNhc2UgJ2pva2VybG9nbyc6CiAgICAgICAgICAgICAgICBjYXNlICdmaXJld29ya3NwYXJrbGUnOgogICAgICAgICAgICAgICAgY2FzZSAnbmF0dXJlbGVhdmVzJzoKICAgICAgICAgICAgICAgIGNhc2UgJ2Jva2VoJzoKICAgICAgICAgICAgICAgIGNhc2UgJ3RveGljJzoKICAgICAgICAgICAgICAgIGNhc2UgJ3N0cmF3YmVycnknOgogICAgICAgICAgICAgICAgY2FzZSAnYm94M2QnOgogICAgICAgICAgICAgICAgY2FzZSAncm9hZHdhcm5pbmcnOgogICAgICAgICAgICAgICAgY2FzZSAnYnJlYWt3YWxsJzoKICAgICAgICAgICAgICAgIGNhc2UgJ2ljZWNvbGQnOgogICAgICAgICAgICAgICAgY2FzZSAnbHV4dXJ5JzoKICAgICAgICAgICAgICAgIGNhc2UgJ2Nsb3VkJzoKICAgICAgICAgICAgICAgIGNhc2UgJ3N1bW1lcnNhbmQnOgogICAgICAgICAgICAgICAgY2FzZSAnaG9ycm9yYmxvb2QnOgogICAgICAgICAgICAgICAgY2FzZSAndGh1bmRlcic6CiAgICAgICAgICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID09IDApIHJldHVybiByZXBseShgRXhhbXBsZTogJHtwcmVmaXggKyBjb21tYW5kfSBTYW11MzMwYCkKCQkgICAgcmVwbHkobWVzcy53YWl0KQogICAgICAgICAgICAgICAgICAgIGluaV90eHQgPSBhcmdzLmpvaW4oIiAiKQogICAgICAgICAgICAgICAgICAgIGdldEJ1ZmZlcihgaHR0cHM6Ly9hcGkubG9saHVtYW4ueHl6L2FwaS90ZXh0cHJvbWUvJHtjb21tYW5kfT9hcGlrZXk9JHthcGl9JnRleHQ9JHtpbmlfdHh0fWApLnRoZW4oKGdhbWJhcikgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGdhbWJhciwgaW1hZ2UsIHsgcXVvdGVkOiBmZ2MgfSkKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBjYXNlICdwb3JuaHViJzoKICAgICAgICAgICAgICAgIGNhc2UgJ2dsaXRjaCc6CiAgICAgICAgICAgICAgICBjYXNlICdhdmVuZ2VyJzoKICAgICAgICAgICAgICAgIGNhc2UgJ3NwYWNlJzoKICAgICAgICAgICAgICAgIGNhc2UgJ25pbmphbG9nbyc6CiAgICAgICAgICAgICAgICBjYXNlICdtYXJ2ZWxzdHVkaW8nOgogICAgICAgICAgICAgICAgY2FzZSAnbGlvbmxvZ28nOgogICAgICAgICAgICAgICAgY2FzZSAnd29sZmxvZ28nOgogICAgICAgICAgICAgICAgY2FzZSAnc3RlZWwzZCc6CiAgICAgICAgICAgICAgICBjYXNlICd3YWxsZ3Jhdml0eSc6CiAgICAgICAgICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID09IDApIHJldHVybiByZXBseShgRXhhbXBsZTogJHtwcmVmaXggKyBjb21tYW5kfSBTYW11MzMwfFNhbSB5IFBlcnJ5YCkKCQkJCXJlcGx5KG1lc3Mud2FpdCkKICAgICAgICAgICAgICAgICAgICBhID0gYXJncy5qb2luKCcgJykKICAgICAgICAgICAgICAgICAgICB0eHQxID0gYS5zcGxpdCgifCIpWzBdOwogICAgICAgICAgICAgICAgICAgIHR4dDIgPSBhLnNwbGl0KCJ8IilbMV07CiAgICAgICAgICAgICAgICAgICAgZ2V0QnVmZmVyKGBodHRwczovL2FwaS5sb2xodW1hbi54eXovYXBpL3RleHRwcm9tZTIvJHtjb21tYW5kfT9hcGlrZXk9JHthcGl9JnRleHQxPSR7dHh0MX0mdGV4dDI9JHt0eHQyfWApLnRoZW4oKGdhbWJhcikgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGdhbWJhciwgaW1hZ2UsIHsgcXVvdGVkOiBsb2wgfSkKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICAgICAgICAgIC8vIFBob3RvIE94eSAvLwogICAgICAgICAgICAgICAgY2FzZSAnc29tYnJhJzoKICAgICAgICAgICAgICAgIGNhc2UgJ2N1cCc6CiAgICAgICAgICAgICAgICBjYXNlICdjdXAxJzoKICAgICAgICAgICAgICAgIGNhc2UgJ3JvbWFuY2UnOgogICAgICAgICAgICAgICAgY2FzZSAnc21va2UnOgogICAgICAgICAgICAgICAgY2FzZSAnYnVybnBhcGVyJzoKICAgICAgICAgICAgICAgIGNhc2UgJ2xvdmVtZXNzYWdlJzoKICAgICAgICAgICAgICAgIGNhc2UgJ3VuZGVyZ3Jhc3MnOgogICAgICAgICAgICAgICAgY2FzZSAnbG92ZSc6CiAgICAgICAgICAgICAgICBjYXNlICdjYWZlJzoKICAgICAgICAgICAgICAgIGNhc2UgJ3dvb2RoZWFydCc6CiAgICAgICAgICAgICAgICBjYXNlICd3b29kZW5ib2FyZCc6CiAgICAgICAgICAgICAgICBjYXNlICdzdW1tZXIzZCc6CiAgICAgICAgICAgICAgICBjYXNlICd3b2xmbWV0YWwnOgogICAgICAgICAgICAgICAgY2FzZSAnbmF0dXJlM2QnOgogICAgICAgICAgICAgICAgY2FzZSAndW5kZXJ3YXRlcic6CiAgICAgICAgICAgICAgICBjYXNlICdnb2xkZXJyb3NlJzoKICAgICAgICAgICAgICAgIGNhc2UgJ3N1bW1lcm5hdHVyZSc6CiAgICAgICAgICAgICAgICBjYXNlICdsZXR0ZXJsZWF2ZXMnOgogICAgICAgICAgICAgICAgY2FzZSAnZ2xvd2luZ25lb24nOgogICAgICAgICAgICAgICAgY2FzZSAnZmFsbGxlYXZlcyc6CiAgICAgICAgICAgICAgICBjYXNlICdmbGFtbWluZyc6CiAgICAgICAgICAgICAgICBjYXNlICdocCc6CiAgICAgICAgICAgICAgICBjYXNlICdjYXJ2ZWR3b29kJzoKICAgICAgICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPT0gMCkgcmV0dXJuIHJlcGx5KGBFeGFtcGxlOiAke3ByZWZpeCArIGNvbW1hbmR9IFNhbXUzMzBgKQoJCQkJcmVwbHkobWVzcy53YWl0KQogICAgICAgICAgICAgICAgICAgIGluaV90eHQgPSBhcmdzLmpvaW4oJyAnKQogICAgICAgICAgICAgICAgICAgIGdldEJ1ZmZlcihgaHR0cHM6Ly9hcGkubG9saHVtYW4ueHl6L2FwaS9waG90b294eTEvJHtjb21tYW5kfT9hcGlrZXk9JHthcGl9JnRleHQ9JHtpbmlfdHh0fWApLnRoZW4oKGdhbWJhcikgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGdhbWJhciwgaW1hZ2UsIHsgcXVvdGVkOiBmZ2MgfSkKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBjYXNlICd0aWt0b2snOgogICAgICAgICAgICAgICAgY2FzZSAnYXJjYWRlOGJpdCc6CiAgICAgICAgICAgICAgICBjYXNlICdiYXR0bGVmaWVsZDQnOgogICAgICAgICAgICAgICAgY2FzZSAncHViZyc6CQkJCQogICAgICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA9PSAwKSByZXR1cm4gcmVwbHkoYEV4YW1wbGU6ICR7cHJlZml4ICsgY29tbWFuZH0gU2FtdTMzMHxTYW0geSBQZXJyeWApCgkJICAgIHJlcGx5KG1lc3Mud2FpKQoJCSAgICBhID0gYXJncy5qb2luKCcgJykKICAgICAgICAgICAgICAgICAgICB0eHQxID0gYS5zcGxpdCgifCIpWzBdOwogICAgICAgICAgICAgICAgICAgIHR4dDIgPSBhLnNwbGl0KCJ8IilbMV07CiAgICAgICAgICAgICAgICAgICAgZ2V0QnVmZmVyKGBodHRwczovL2FwaS5sb2xodW1hbi54eXovYXBpL3Bob3Rvb3h5Mi8ke2NvbW1hbmR9P2FwaWtleT0ke2FwaX0mdGV4dDE9JHt0eHQxfSZ0ZXh0Mj0ke3R4dDJ9YCkudGhlbigoZ2FtYmFyKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgZ2FtYmFyLCBpbWFnZSwgeyBxdW90ZWQ6IGZnYyB9KQogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKCiAgICAgICAgICAgICAgICAgICAgLy8gRXBob3RvIDM2MCAvLwogICAgICAgICAgICAgICAgY2FzZSAnd2V0Z2xhc3MnOgogICAgICAgICAgICAgICAgY2FzZSAnbXVsdGljb2xvcjNkJzoKICAgICAgICAgICAgICAgIGNhc2UgJ3dhdGVyY29sb3InOgogICAgICAgICAgICAgICAgY2FzZSAnbHV4dXJ5Z29sZCc6CiAgICAgICAgICAgICAgICBjYXNlICdnYWxheHl3YWxscGFwZXInOgogICAgICAgICAgICAgICAgY2FzZSAnbGlnaHR0ZXh0JzoKICAgICAgICAgICAgICAgIGNhc2UgJ2JlYXV0aWZ1bGZsb3dlcic6CiAgICAgICAgICAgICAgICBjYXNlICdwdXBweWN1dGUnOgogICAgICAgICAgICAgICAgY2FzZSAncm95YWx0ZXh0JzoKICAgICAgICAgICAgICAgIGNhc2UgJ2hlYXJ0c2hhcGVkJzoKICAgICAgICAgICAgICAgIGNhc2UgJ2JpcnRoZGF5Y2FrZSc6CiAgICAgICAgICAgICAgICBjYXNlICdnYWxheHlzdHlsZSc6CiAgICAgICAgICAgICAgICBjYXNlICdob2xvZ3JhbTNkJzoKICAgICAgICAgICAgICAgIGNhc2UgJ2dyZWVubmVvbic6CiAgICAgICAgICAgICAgICBjYXNlICdnbG9zc3ljaHJvbWUnOgogICAgICAgICAgICAgICAgY2FzZSAnZ3JlZW5idXNoJzoKICAgICAgICAgICAgICAgIGNhc2UgJ21ldGFsbG9nbyc6CiAgICAgICAgICAgICAgICBjYXNlICdub2VsdGV4dCc6CiAgICAgICAgICAgICAgICBjYXNlICdnbGl0dGVyZ29sZCc6CiAgICAgICAgICAgICAgICBjYXNlICd0ZXh0Y2FrZSc6CiAgICAgICAgICAgICAgICBjYXNlICdzdGFyc25pZ2h0JzoKICAgICAgICAgICAgICAgIGNhc2UgJ3dvb2RlbjNkJzoKICAgICAgICAgICAgICAgIGNhc2UgJ3RleHRieW5hbWUnOgogICAgICAgICAgICAgICAgY2FzZSAnd3JpdGVnYWxhY3knOgogICAgICAgICAgICAgICAgY2FzZSAnZ2FsYXh5YmF0JzoKICAgICAgICAgICAgICAgIGNhc2UgJ3Nub3czZCc6CiAgICAgICAgICAgICAgICBjYXNlICdiaXJ0aGRheWRheSc6CiAgICAgICAgICAgICAgICBjYXNlICdnb2xkcGxheWJ1dHRvbic6CiAgICAgICAgICAgICAgICBjYXNlICdzaWx2ZXJwbGF5YnV0dG9uJzoKICAgICAgICAgICAgICAgIGNhc2UgJ2ZyZWVmaXJlJzoKICAgICAgICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPT0gMCkgcmV0dXJuIHJlcGx5KGBFeGFtcGxlOiAke3ByZWZpeCArIGNvbW1hbmR9IFNhbSB5IFBlcnJ5YCkKCQkJCXJlcGx5KG1lc3Mud2FpdCkKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ID0gYXJncy5qb2luKCcgJykKICAgICAgICAgICAgICAgICAgICBnZXRCdWZmZXIoYGh0dHBzOi8vYXBpLmxvbGh1bWFuLnh5ei9hcGkvZXBob3RvMS8ke2NvbW1hbmR9P2FwaWtleT0ke2FwaX0mdGV4dD0ke2luaV90eHR9YCkudGhlbigoZ2FtYmFyKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgZ2FtYmFyLCBpbWFnZSwgeyBxdW90ZWQ6IGZnYyB9KQogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKCQkJCQoJCWNhc2UgJ2dvb2dsZSc6CiAgICAgICAgICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID09IDApIHJldHVybiByZXBseShgRXhhbXBsZTogJHtwcmVmaXggKyBjb21tYW5kfSBHYXRpdG9zYCkKICAgICAgICAgICAgICAgICAgICBxdWVyeSA9IGFyZ3Muam9pbignICcpCiAgICAgICAgICAgICAgICAgICAgZ2V0X3Jlc3VsdCA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkubG9saHVtYW4ueHl6L2FwaS9nc2VhcmNoP2FwaWtleT0ke2FwaX0mcXVlcnk9JHtxdWVyeX1gKQogICAgICAgICAgICAgICAgICAgIGdldF9yZXN1bHQgPSBnZXRfcmVzdWx0LnJlc3VsdAogICAgICAgICAgICAgICAgICAgIGluaV90eHQgPSAnR29vZ2xlIFNlYXJjaCA6IFxuJwogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHggb2YgZ2V0X3Jlc3VsdCkgewogICAgICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDtoL7ttYBUaXRsZSA6ICR7eC50aXRsZX1cbmAKICAgICAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBg7aC97bGB77iP4oCN7aC97beo77iPTGluayA6ICR7eC5saW5rfVxuYAogICAgICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDtoL3tsqxEZXNjIDogJHt4LmRlc2N9XG5cbmAKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmVwbHkoaW5pX3R4dCkKICAgICAgICAgICAgICAgICAgICBicmVhawoJCQkJCgkJY2FzZSAnd3BzZWFyY2gnOgogICAgICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA9PSAwKSByZXR1cm4gcmVwbHkoYEV4YW1wbGU6ICR7cHJlZml4ICsgY29tbWFuZH0gZ2F0b3NgKQogICAgICAgICAgICAgICAgICAgIHF1ZXJ5ID0gYXJncy5qb2luKCcgJykKICAgICAgICAgICAgICAgICAgICBnZXRfcmVzdWx0ID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS5sb2xodW1hbi54eXovYXBpL3dhbGxwYXBlcj9hcGlrZXk9JHthcGl9JnF1ZXJ5PSR7cXVlcnl9YCkKICAgICAgICAgICAgICAgICAgICBpbmlfYnVmZmVyID0gYXdhaXQgZ2V0QnVmZmVyKGdldF9yZXN1bHQucmVzdWx0KQogICAgICAgICAgICAgICAgICAgIGF3YWl0IHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgaW5pX2J1ZmZlciwgaW1hZ2UsIHsgcXVvdGVkOiBmdG9rbyB9KQogICAgICAgICAgICAgICAgICAgIGJyZWFrCgkJCQkKCQljYXNlICd0cmFuc2xhdGUnOgogICAgICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA9PSAwKSByZXR1cm4gcmVwbHkoYEV4YW1wbGU6ICR7cHJlZml4ICsgY29tbWFuZH0gZXMgSGkgYnJvYCkKICAgICAgICAgICAgICAgICAgICBpZGlvbWEgPSBhcmdzWzBdCiAgICAgICAgICAgICAgICAgICAgYXJncy5zaGlmdCgpCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCA9IGFyZ3Muam9pbignICcpCiAgICAgICAgICAgICAgICAgICAgZ2V0X3Jlc3VsdCA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkubG9saHVtYW4ueHl6L2FwaS90cmFuc2xhdGUvYXV0by8ke2lkaW9tYX0/YXBpa2V5PSR7YXBpfSZ0ZXh0PSR7aW5pX3R4dH1gKQogICAgICAgICAgICAgICAgICAgIGdldF9yZXN1bHQgPSBnZXRfcmVzdWx0LnJlc3VsdAogICAgICAgICAgICAgICAgICAgIGluaXRfdHh0ID0gYFRyYWR1Y2Npb24gZGUgOiAke2dldF9yZXN1bHQuZnJvbX1cbmAKICAgICAgICAgICAgICAgICAgICBpbml0X3R4dCArPSBgYSA6ICR7Z2V0X3Jlc3VsdC50b31cbmAKICAgICAgICAgICAgICAgICAgICBpbml0X3R4dCArPSBgT3JpZ2luYWwgOiAke2dldF9yZXN1bHQub3JpZ2luYWx9XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pdF90eHQgKz0gYFRyYWR1Y2lkbyA6ICR7Z2V0X3Jlc3VsdC50cmFuc2xhdGVkfVxuYAogICAgICAgICAgICAgICAgICAgIGluaXRfdHh0ICs9IGBQcm9udW5jaWFjaW9uIDogJHtnZXRfcmVzdWx0LnByb251bmNpYXRpb259XG5gCiAgICAgICAgICAgICAgICAgICAgcmVwbHkoaW5pdF90eHQpCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKCQkJCgkJY2FzZSAnYWNvcmRlcyc6CiAgICAgICAgICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID09IDApIHJldHVybiByZXBseShgRXhhbXBsZTogJHtwcmVmaXggKyBjb21tYW5kfSBDaXJjdWxvIGRlIGFtb3JgKQogICAgICAgICAgICAgICAgICAgIHF1ZXJ5ID0gYXJncy5qb2luKCcgJykKICAgICAgICAgICAgICAgICAgICBnZXRfcmVzdWx0ID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS5sb2xodW1hbi54eXovYXBpL2Nob3JkP2FwaWtleT0ke2FwaX0mcXVlcnk9JHtxdWVyeX1gKQogICAgICAgICAgICAgICAgICAgIGdldF9yZXN1bHQgPSBnZXRfcmVzdWx0LnJlc3VsdAogICAgICAgICAgICAgICAgICAgIGluaV90eHQgPSBgVGl0bGUgOiAke2dldF9yZXN1bHQudGl0bGV9XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBgQ2hvcmQgOiBcbiR7Z2V0X3Jlc3VsdC5jaG9yZH1gCiAgICAgICAgICAgICAgICAgICAgcmVwbHkoaW5pX3R4dCkKICAgICAgICAgICAgICAgICAgICBicmVhawoJCQkJCgkJY2FzZSAneG54eCc6CgkJCQkgIGlmICghaXNOc2Z3KSByZXR1cm4gcmVwbHkobWVzcy5uc2Z3KQogICAgICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA9PSAwKSByZXR1cm4gcmVwbHkoYEV4YW1wbGU6ICR7cHJlZml4ICsgY29tbWFuZH0gaHR0cHM6Ly93d3cueG54eC5jb20vdmlkZW8tdXk1YTczYi9tb21faXNfaG9ybnlfLV9icm9va2x5bmApCiAgICAgICAgICAgICAgICAgICAgcXVlcnkgPSBhcmdzLmpvaW4oJyAnKQogICAgICAgICAgICAgICAgICAgIGdldF9yZXN1bHQgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vYXBpLmxvbGh1bWFuLnh5ei9hcGkveG54eD9hcGlrZXk9JHthcGl9JnVybD0ke3F1ZXJ5fWApCiAgICAgICAgICAgICAgICAgICAgZ2V0X3Jlc3VsdCA9IGdldF9yZXN1bHQucmVzdWx0CiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCA9IGBUaXRsZSA6ICR7Z2V0X3Jlc3VsdC50aXRsZX1cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGBEdXJhdGlvbiA6ICR7Z2V0X3Jlc3VsdC5kdXJhdGlvbn1cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGBWaWV3IDogJHtnZXRfcmVzdWx0LnZpZXd9XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBgUmF0aW5nIDogJHtnZXRfcmVzdWx0LnJhdGluZ31cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGBMaWtlIDogJHtnZXRfcmVzdWx0Lmxpa2V9XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBgRGlzbGlrZSA6ICR7Z2V0X3Jlc3VsdC5kaXNsaWtlfVxuYAogICAgICAgICAgICAgICAgICAgIGluaV90eHQgKz0gYENvbW1lbnQgOiAke2dldF9yZXN1bHQuY29tbWVudH1cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGBUYWcgOiAke2dldF9yZXN1bHQudGFnLmpvaW4oIiwgIil9XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBgRGVzY3JpcHRpb24gOiAke2dldF9yZXN1bHQuZGVzY3JpcHRpb259XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSAiTGluayA6IFxuIgogICAgICAgICAgICAgICAgICAgIGluaV9saW5rID0gZ2V0X3Jlc3VsdC5saW5rCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgeCBvZiBpbmlfbGluaykgewogICAgICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGAke3gudHlwZX0gLSAke3gubGlua31cblxuYAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWwgPSBhd2FpdCBnZXRCdWZmZXIoZ2V0X3Jlc3VsdC50aHVtYm5haWwpCiAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCB0aHVtYm5haWwsIGltYWdlLCB7IHF1b3RlZDogZnRva28sIGNhcHRpb246IGluaV90eHQgfSkKICAgICAgICAgICAgICAgICAgICBicmVhawkKCQkJCgkJIGNhc2UgJ3hueHhzZWFyY2gnOgogICAgICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA9PSAwKSByZXR1cm4gcmVwbHkoYEV4YW1wbGU6ICR7cHJlZml4ICsgY29tbWFuZH0gSmFwYW5lc2VgKQogICAgICAgICAgICAgICAgICAgIHF1ZXJ5ID0gYXJncy5qb2luKCcgJykKICAgICAgICAgICAgICAgICAgICBnZXRfcmVzdWx0ID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS5sb2xodW1hbi54eXovYXBpL3hueHhzZWFyY2g/YXBpa2V5PSR7YXBpfSZxdWVyeT0ke3F1ZXJ5fWApCiAgICAgICAgICAgICAgICAgICAgZ2V0X3Jlc3VsdCA9IGdldF9yZXN1bHQucmVzdWx0CiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCA9ICIiCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgeCBvZiBnZXRfcmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGluaV90eHQgKz0gYFRpdGxlIDogJHt4LnRpdGxlfVxuYAogICAgICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGBWaWV3cyA6ICR7eC52aWV3c31cbmAKICAgICAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBgRHVyYXRpb24gOiAke3guZHVyYXRpb259XG5gCiAgICAgICAgICAgICAgICAgICAgICAgIGluaV90eHQgKz0gYFVwbG9hZGVyIDogJHt4LnVwbG9hZGVyfVxuYAogICAgICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGBMaW5rIDogJHt4Lmxpbmt9XG5gCiAgICAgICAgICAgICAgICAgICAgICAgIGluaV90eHQgKz0gYFRodW1ibmFpbCA6ICR7eC50aHVtYm5haWx9XG5cbmAKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmVwbHkoaW5pX3R4dCkKICAgICAgICAgICAgICAgICAgICBicmVhawoJCQkJCgkJY2FzZSAndGFnc3RpY2snOgogICAgICAgICAgICAgICAgICAgIGlmICgoaXNNZWRpYSAmJiAhc2FtLm1lc3NhZ2UudmlkZW9NZXNzYWdlIHx8IGlzUXVvdGVkU3RpY2tlcikgJiYgYXJncy5sZW5ndGggPT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmNtZWRpYSA9IGlzUXVvdGVkU3RpY2tlciA/IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywgJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvIDogc2FtCiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVQYXRoID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZEFuZFNhdmVNZWRpYU1lc3NhZ2UoZW5jbWVkaWEsIGZpbGVuYW1lID0gZ2V0UmFuZG9tKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGFyZ3Muam9pbignICcpCiAgICAgICAgICAgICAgICAJZ3JvdXAgPSBhd2FpdCBzYW11MzMwLmdyb3VwTWV0YWRhdGEoZnJvbSkKICAgICAgICAgICAgICAgICAgICAgICAgbWVtYmVyID0gZ3JvdXBbJ3BhcnRpY2lwYW50cyddCiAgICAgICAgICAgICAgICAgICAgICAgIG1lbSA9IFtdCiAgICAgICAgICAgICAgICAgICAgICAgIG1lbWJlci5tYXAoYXN5bmMgYWRtID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lbS5wdXNoKGFkbS5pZC5yZXBsYWNlKCdjLnVzJywgJ3Mud2hhdHNhcHAubmV0JykpCiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dEluZm86IHsgbWVudGlvbmVkSmlkOiBtZW0gfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RlZDogc2FtCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaW5pX2J1ZmZlciA9IGZzLnJlYWRGaWxlU3luYyhmaWxlUGF0aCkKICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBpbmlfYnVmZmVyLCBzdGlja2VyLCBvcHRpb25zKQogICAgICAgICAgICAgICAgICAgICAgICBmcy51bmxpbmtTeW5jKGZpbGVQYXRoKQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlcGx5KGBFdGlxdWV0YSB1biBzdGlja2VyIGNvbiBlbCBjb21hbmRvYCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWsKCQkJCQoJCQkJCgkJCQkKCQkJCQoJY2FzZSAnZW50cmFib3QnOgpzYW11MzMwLnF1ZXJ5KHsKanNvbjpbImFjdGlvbiIsICJpbnZpdGUiLCBgJHthcmdzWzBdLnJlcGxhY2UoJ2h0dHBzOi8vY2hhdC53aGF0c2FwcC5jb20vJywnJyl9YF0KfSkKcmVwbHkoJ1lhIGVudHJlIGFsIGdydXBv7aC97biJJykKYnJlYWsKCQkJCQpjYXNlICdwbGF5JzoKICBpZiAoIWlzUmVnaXN0ZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkuZGFmdGFyQikKICBpZiAoYXJncy5sZW5ndGggPT0gMCkgcmV0dXJuIHJlcGx5KGBFamVtcGxvOiAke3ByZWZpeCArIGNvbW1hbmR9IE1lIG9sdmlkZSBkZSB2aXZpcmApCiAgICAgICAgICAgICAgICAgICAgcXVlcnkgPSBhcmdzLmpvaW4oJyAnKQoJCSAgICBmYWtlZSA9IGZzLnJlYWRGaWxlU3luYygnLi9zcmMvaW1nLmpwZycpCiAgICAgICAgICAgICAgICAgICAgZ2V0X3Jlc3VsdCA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkubG9saHVtYW4ueHl6L2FwaS95dHBsYXk/YXBpa2V5PSR7YXBpfSZxdWVyeT0ke3F1ZXJ5fWApCiAgICAgICAgICAgICAgICAgICAgZ2V0X3Jlc3VsdCA9IGdldF9yZXN1bHQucmVzdWx0CiAgICAgICAgICAgICAgICAgICAgZ2V0X2luZm8gPSBnZXRfcmVzdWx0LmluZm8KICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ID0gYCpUaXR1bG8qIDogJHtnZXRfaW5mby50aXRsZX1cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDtoL3ttbXtoLztv7vigI3imYDvuI/vuI9QdWJsaWNhZG9yIDogJHtnZXRfaW5mby51cGxvYWRlcn1cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDtoL3ttZBEdXJhY2lvbiA6ICR7Z2V0X2luZm8uZHVyYXRpb259XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBg7aC97bGAVmlzdGFzIDogJHtnZXRfaW5mby52aWV3fVxuYAogICAgICAgICAgICAgICAgICAgIGluaV90eHQgKz0gYO2gve2xje2gvO2/u0xpa2UgOiAke2dldF9pbmZvLmxpa2V9XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBg7aC97bGO7aC87b+7RGlzbGlrZSA6ICR7Z2V0X2luZm8uZGlzbGlrZX1cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDtoL3ts4tEZXNjcmlwY2lvbiA6XG4gJHtnZXRfaW5mby5kZXNjcmlwdGlvbn1cblxuYAoJCSAgICBpbmlfdHh0ICs9IGBTaSBlbCBhdWRpbyBubyBsbGVnYSwgcHVlZGUgZGVzY2FyZ2FyIHBvciBhcXVpOiA6XG4gJHtnZXRfcmVzdWx0LmF1ZGlvWzNdLmxpbmt9XG5cbmAKCQkgICAgaW5pX3R4dCArPSBgUHVlZGUgZGVzY2FyZ2FyIHRhbWJpZW4gZWwgdmlkZW8gYXF1aTogOlxuICR7Z2V0X3Jlc3VsdC52aWRlb1swXS5saW5rfVxuYAogICAgICAgICAgICAgICAgICAgIGluaV9idWZmZXIgPSBhd2FpdCBnZXRCdWZmZXIoZ2V0X2luZm8udGh1bWJuYWlsKQogICAgICAgICAgICAgICAgICAgIGF3YWl0IHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgaW5pX2J1ZmZlciwgaW1hZ2UsIHsgcXVvdGVkOiBmdmlkLCBjYXB0aW9uOiBpbmlfdHh0LCB0aHVtYm5haWw6IGZha2VlLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfSB9KQogICAgICAgICAgICAgICAgICAgIGdldF9hdWRpbyA9IGF3YWl0IGdldEJ1ZmZlcihnZXRfcmVzdWx0LmF1ZGlvWzRdLmxpbmspCiAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBnZXRfYXVkaW8sIGF1ZGlvLCB7IG1pbWV0eXBlOiAnYXVkaW8vbXA0JywgZHVyYXRpb24gOi05OTk5OTk5OTk5OTk5OTksIGZpbGVuYW1lOiBgJHtnZXRfaW5mby50aXRsZX0ubXAzYCwgcXVvdGVkOiBmdmlkIH0pCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKCQoJCQkJCmNhc2UgJ3BsYXkyJzoKICAgIGlmICghaXNSZWdpc3RlcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5kYWZ0YXJCKQogIGlmIChhcmdzLmxlbmd0aCA9PSAwKSByZXR1cm4gcmVwbHkoYEVqZW1wbG86ICR7cHJlZml4ICsgY29tbWFuZH0gTWUgb2x2aWRlIGRlIHZpdmlyYCkKICAgICAgICAgICAgICAgICAgICBxdWVyeSA9IGFyZ3Muam9pbignICcpCgkJICAgIGZha2VlID0gZnMucmVhZEZpbGVTeW5jKCcuL3NyYy9pbWcuanBnJykKICAgICAgICAgICAgICAgICAgICBnZXRfcmVzdWx0ID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS5sb2xodW1hbi54eXovYXBpL3l0cGxheT9hcGlrZXk9JHthcGl9JnF1ZXJ5PSR7cXVlcnl9YCkKICAgICAgICAgICAgICAgICAgICBnZXRfcmVzdWx0ID0gZ2V0X3Jlc3VsdC5yZXN1bHQKICAgICAgICAgICAgICAgICAgICBnZXRfaW5mbyA9IGdldF9yZXN1bHQuaW5mbwogICAgICAgICAgICAgICAgICAgIGluaV90eHQgPSBg7aC+7beKVGl0dWxvIDogJHtnZXRfaW5mby50aXRsZX1cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDtoL3ttbXtoLztv7vigI3imYDvuI/vuI9QdWJsaWNhZG9yIDogJHtnZXRfaW5mby51cGxvYWRlcn1cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDtoL3ttZBEdXJhY2lvbiA6ICR7Z2V0X2luZm8uZHVyYXRpb259XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBg7aC97bGAVmlzdGFzIDogJHtnZXRfaW5mby52aWV3fVxuYAogICAgICAgICAgICAgICAgICAgIGluaV90eHQgKz0gYO2gve2xje2gvO2/u0xpa2UgOiAke2dldF9pbmZvLmxpa2V9XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBg7aC97bGO7aC87b+7RGlzbGlrZSA6ICR7Z2V0X2luZm8uZGlzbGlrZX1cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDtoL3ts4tEZXNjcmlwY2lvbiA6XG4gJHtnZXRfaW5mby5kZXNjcmlwdGlvbn1cblxuYAoJCSAgICBpbmlfdHh0ICs9IGBTaSBlbCBhdWRpbyBubyBsbGVnYSwgcHVlZGUgZGVzY2FyZ2FyIHBvciBhcXVpOiA6XG4gJHtnZXRfcmVzdWx0LmF1ZGlvWzNdLmxpbmt9XG5cbmAKCQkgICAgaW5pX3R4dCArPSBgUHVlZGUgZGVzY2FyZ2FyIHRhbWJpZW4gZWwgdmlkZW8gYXF1aTogOlxuICR7Z2V0X3Jlc3VsdC52aWRlb1swXS5saW5rfVxuYAogICAgICAgICAgICAgICAgICAgIGluaV9idWZmZXIgPSBhd2FpdCBnZXRCdWZmZXIoZ2V0X2luZm8udGh1bWJuYWlsKQogICAgICAgICAgICAgICAgICAgIGF3YWl0IHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgaW5pX2J1ZmZlciwgaW1hZ2UsIHsgcXVvdGVkOiBmdmlkLCBjYXB0aW9uOiBpbmlfdHh0LCB0aHVtYm5haWw6IGZha2VlLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfSB9KQogICAgICAgICAgICAgICAgICAgIGdldF9hdWRpbyA9IGF3YWl0IGdldEJ1ZmZlcihnZXRfcmVzdWx0LmF1ZGlvWzRdLmxpbmspCiAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBnZXRfYXVkaW8sIGF1ZGlvLCB7IG1pbWV0eXBlOiAnYXVkaW8vbXA0JywgcHR0IDogdHJ1ZSwgZHVyYXRpb24gOi05OTk5OTk5OTk5OTk5OTksIGZpbGVuYW1lOiBgJHtnZXRfaW5mby50aXRsZX0ubXAzYCwgcXVvdGVkOiBmdmlkIH0pCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKCQkJCQoJCQkJCmNhc2UgJ3BsYXl2aWQnOgogIGlmICghaXNSZWdpc3RlcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5kYWZ0YXJCKQogIGlmIChhcmdzLmxlbmd0aCA9PSAwKSByZXR1cm4gcmVwbHkoYEVqZW1wbG86ICR7cHJlZml4ICsgY29tbWFuZH0gTWUgb2x2aWRlIGRlIHZpdmlyYCkKICAgICAgICAgICAgICAgICAgICBxdWVyeSA9IGFyZ3Muam9pbignICcpCgkJICAgIGZha2VlID0gZnMucmVhZEZpbGVTeW5jKCcuL3NyYy9pbWcuanBnJykKICAgICAgICAgICAgICAgICAgICBnZXRfcmVzdWx0ID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS5sb2xodW1hbi54eXovYXBpL3l0cGxheT9hcGlrZXk9JHthcGl9JnF1ZXJ5PSR7cXVlcnl9YCkKICAgICAgICAgICAgICAgICAgICBnZXRfcmVzdWx0ID0gZ2V0X3Jlc3VsdC5yZXN1bHQKICAgICAgICAgICAgICAgICAgICBnZXRfaW5mbyA9IGdldF9yZXN1bHQuaW5mbwogICAgICAgICAgICAgICAgICAgIGluaV90eHQgPSBg7aC+7beKVGl0dWxvIDogJHtnZXRfaW5mby50aXRsZX1cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDtoL3ttbXtoLztv7vigI3imYDvuI/vuI9QdWJsaWNhZG9yIDogJHtnZXRfaW5mby51cGxvYWRlcn1cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDtoL3ttZBEdXJhY2lvbiA6ICR7Z2V0X2luZm8uZHVyYXRpb259XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBg7aC97bGAVmlzdGFzIDogJHtnZXRfaW5mby52aWV3fVxuYAogICAgICAgICAgICAgICAgICAgIGluaV90eHQgKz0gYO2gve2xje2gvO2/u0xpa2UgOiAke2dldF9pbmZvLmxpa2V9XG5gCiAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBg7aC97bGO7aC87b+7RGlzbGlrZSA6ICR7Z2V0X2luZm8uZGlzbGlrZX1cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDtoL3ts4tEZXNjcmlwY2lvbiA6XG4gJHtnZXRfaW5mby5kZXNjcmlwdGlvbn1cblxuYAoJCSAgICBpbmlfdHh0ICs9IGBfU2kgZWwgdmlkZW8gbm8gbGxlZ2EsIHB1ZWRlIGRlc2NhcmdhciBwb3IgYXF1aV8gOlxuICR7Z2V0X3Jlc3VsdC52aWRlb1swXS5saW5rfVxuXG5gCgkJICAgIGluaV90eHQgKz0gYFB1ZWRlIGRlc2NhcmdhciB0YW1iaWVuIGVsIGF1ZGlvIGFxdWk6IDpcbiAke2dldF9yZXN1bHQuYXVkaW9bM10ubGlua31cbmAKICAgICAgICAgICAgICAgICAgICBpbmlfYnVmZmVyID0gYXdhaXQgZ2V0QnVmZmVyKGdldF9pbmZvLnRodW1ibmFpbCkKICAgICAgICAgICAgICAgICAgICBhd2FpdCBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGluaV9idWZmZXIsIGltYWdlLCB7IHF1b3RlZDogZnZpZCwgY2FwdGlvbjogaW5pX3R4dCwgdGh1bWJuYWlsOiBmYWtlZSwgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZX0gfSkKICAgICAgICAgICAgICAgICAgICBnZXRfdmlkZW8gPSBhd2FpdCBnZXRCdWZmZXIoZ2V0X3Jlc3VsdC52aWRlb1swXS5saW5rKQogICAgICAgICAgICAgICAgICAgIGF3YWl0IHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgZ2V0X3ZpZGVvLCB2aWRlbywgeyBtaW1ldHlwZTogJ3ZpZGVvL21wNCcsIGZpbGVuYW1lOiBgJHtnZXRfaW5mby50aXRsZX0ubXA0YCwgcXVvdGVkOiBmdmlkIH0pCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKCQkJCQoJCQkJCgkJY2FzZSAneXRzZWFyY2gnOgogICAgICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA9PSAwKSByZXR1cm4gcmVwbHkoYEVqZW1wbG86ICR7cHJlZml4ICsgY29tbWFuZH0gTWUgb2x2aWRlIGRlIHZpdmlyYCkKICAgICAgICAgICAgICAgICAgICBxdWVyeSA9IGFyZ3Muam9pbignICcpCiAgICAgICAgICAgICAgICAgICAgZ2V0X3Jlc3VsdCA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkubG9saHVtYW4ueHl6L2FwaS95dHNlYXJjaD9hcGlrZXk9JHthcGl9JnF1ZXJ5PSR7cXVlcnl9YCkKICAgICAgICAgICAgICAgICAgICBnZXRfcmVzdWx0ID0gZ2V0X3Jlc3VsdC5yZXN1bHQKICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ID0gIiIKICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4IG9mIGdldF9yZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW5pX3R4dCArPSBg7aC+7beKVGl0dWxvIDogJHt4LnRpdGxlfVxuYAogICAgICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDtoL3tsYBWaXN0YXMgOiAke3gudmlld3N9XG5gCiAgICAgICAgICAgICAgICAgICAgICAgIGluaV90eHQgKz0gYO2gve21te2gvO2/u+KAjeKZgO+4j++4j1B1YmxpY2Fkb3IgOiAke3gucHVibGlzaGVkfVxuYAogICAgICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDtoL3ts7hUaHVtYm5haWwgOiAke3gudGh1bWJuYWlsfVxuYAogICAgICAgICAgICAgICAgICAgICAgICBpbmlfdHh0ICs9IGDtoL3ts7JMaW5rIDogaHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj0ke3gudmlkZW9JZH1cblxuYAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByZXBseShpbmlfdHh0KQogICAgICAgICAgICAgICAgICAgIGJyZWFrCgkJCQkKCQkJCQoJCQljYXNlICdhcGknOgoJCQkJCWlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybgoJCQkJCWlmICghaXNPd25lcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5vd25lckIpCgkJCQkgIAluZXdhcGkgPSBhcmdzWzBdCgkJCQkJYCR7YXBpfWAgPSBuZXdhcGkKCQkJCQlmcy53cml0ZUZpbGVTeW5jKGAke2FwaX1gKQoJCQkJCXJlcGx5KGBBcGkgY2FtYmlhZGEgOiAke25ld2FwaX1gKQoJCQkJCWJyZWFrCgpjYXNlICd0aWt0b2syJzoKIHJlcGx5KCd3YWl0JykKIHBlID0gYXJncy5qb2luKCcgJykKICBhbnUgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHA6Ly9kb2NzLWpvam8uaGVyb2t1YXBwLmNvbS9hcGkvdGlrdG9rX25vd20/dXJsPSR7cGV9YCkKdGVrcyA9IGBOaWggQm9zcyBWaWRlb255YS4uLmAKCQkJCQlidWZmZXIgPSBhd2FpdCBnZXRCdWZmZXIoYCR7YW51LnJlc3VsdH1gKQoJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYnVmZmVyLCB2aWRlbywge21pbWV0eXBlOiAndmlkZW8vbXA0JywgcXVvdGVkOiBmdG9rbywgY2FwdGlvbjogdGVrc30pCgkJCQkJYnJlYWsKY2FzZSAnaWcnOgogcGUgPSBhcmdzLmpvaW4oJyAnKQogYW51ID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL3ZpZGVmaWtyaS5jb20vYXBpL2lnZGwvP3VybD0ke3BlfWApCiBidWYgPSBhd2FpdCBnZXRCdWZmZXIoYCR7YW51LnJlc3VsdC52aWRlb31gKQogc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBidWYsIHZpZGVvLCB7cXVvdGVkOmZ0b2tvLCBjYXB0aW9uOiBgTmloIEJvc3NgIH0pCiBicmVhawoJCQkJCiBjYXNlICdpZ3R2JzoKIHBlID0gYXJncy5qb2luKCcgJykKIGFudSA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly92aWRlZmlrcmkuY29tL2FwaS9pZ3R2Lz91cmw9JHtwZX1gKQogYnVmID0gYXdhaXQgZ2V0QnVmZmVyKGAke2FudS5yZXN1bHQudmlkZW9fdXJsfWApCiBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGJ1ZiwgdmlkZW8sIHtxdW90ZWQ6ZnRva28sIGNhcHRpb246IGBOaWggQm9zc2AgfSkKIGJyZWFrCgkJCQkKIGNhc2UgJ2xpcmlrJzoKY2FzZSAnbGV0cmEnOgpjYXNlICdsZXRyYXMnOgogIGlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybiByZXBseSgnRXNjcmliZSBlbCBub21icmUgZGUgbGEgY2FuY2lvbicpCiAgaWYgKCFpc1JlZ2lzdGVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmRhZnRhckIpCiAgCiAgc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpCiAgdGVscyA9IGFyZ3Muam9pbignICcpCiAgdHJ5IHsKICBhbnUgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHA6Ly9zY3JhcC50ZXJoYW1iYXIuY29tL2xpcmlrP3dvcmQ9JHt0ZWxzfWAsIHsKbWV0aG9kOiAnZ2V0JwogIH0pCiAgcmVwbHkoYO2gvu21sFJlc3VsdGFkbyBkZSAke3RlbHN9OlxuXG5fX19fX19fX19fX19fX19fX19fX1xuJHthbnUucmVzdWx0LmxpcmlrfWApCiAgCiAgfSBjYXRjaCB7CiAgICByZXBseShtZXNzLmZlcnIpCiAgfQogIGJyZWFrCgkJCQkKIC8vQXJyZWdsYWRvIHBvciBTYW11MzMwCmNhc2UgJ3l0bXAzJzoKICBpZiAoIWlzUmVnaXN0ZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkuZGFmdGFyQikKICAKICByZXBseShtZXNzLndhaXQpCiAgcGxheSA9IGJvZHkuc2xpY2UoNykKICBpZighaXNVcmwoYXJnc1swXSkgJiYgIWFyZ3NbMF0uaW5jbHVkZXMoJ3lvdXR1JykpIHJldHVybiByZXBseSgnRm9ybWF0byBkZSBsaW5rIGluY29ycmVjdG8nKQogIHRyeSB7CiAgc2FtID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS56ZWtzLnh5ei9hcGkveXRtcDMvMj91cmw9JHtwbGF5fSZhcGlrZXk9YXBpdmluemApCiAgaW5mb21wMyA9IGAqQXVkaW8hISEqXG7igKMgTm9tYnJlIDogJHtzYW0ucmVzdWx0LnRpdGxlfVxu4oCjIEZ1ZW50ZTogJHtzYW0ucmVzdWx0LnNvdXJjZX1cbuKAoyBUYW1hw7FvOiAke3NhbS5yZXN1bHQuc2l6ZX1cbuKAoyAqQ2FsaWRhZCogOiAke2FudS5yZXN1bHQucXVhbGl0eX1cblxuX0VsIGF1ZGlvIHNlIGVzdGEgbWFuZGFuZG8gZXNwZXJlLCBzaSBubyBsbGVnYSBkZXNjYXJndWUgcG9yIGVsIGxpbmtfXG7igKMgKmxpbmsqIDogJHtzYW0ucmVzdWx0Lmxpbmt9YAogIGZha2VlID0gZnMucmVhZEZpbGVTeW5jKCcuL3NyYy9pbWcuanBnJykKICBidWZmZXIgPSBhd2FpdCBnZXRCdWZmZXIoc2FtLnJlc3VsdC50aHVtYikKICBsYWd1ID0gYXdhaXQgZ2V0QnVmZmVyKHNhbS5yZXN1bHQubGluaykKICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGJ1ZmZlciwgaW1hZ2UsIHsKcXVvdGVkOiBmdmlkLCBjYXB0aW9uOiBpbmZvbXAzLCB0aHVtYm5haWw6IGZha2VlLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfQogIH0pCiAgc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBsYWd1LCBhdWRpbywgewptaW1ldHlwZTogJ2F1ZGlvL21wNCcsIGR1cmF0aW9uIDotOTk5OTk5OTk5OTk5OTk5LCBmaWxlbmFtZTogYCR7c2FtLnJlc3VsdC50aXRsZX0ubXAzYCwgcXVvdGVkOiBmbGl2ZUxvYywgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZX0KICB9KQogIAogIH0gY2F0Y2ggewogICAgcmVwbHkobWVzcy5mZXJyKQogIH0KICBicmVhawoKY2FzZSAneXRtcDQnOgogIGlmICghaXNSZWdpc3RlcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5kYWZ0YXJCKQogIAogIHJlcGx5KG1lc3Mud2FpdCkKICBwbGF5ID0gYm9keS5zbGljZSg3KQogIHRyeSB7CiAgYW51ID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS56ZWtzLnh5ei9hcGkveXRtcDQ/dXJsPSR7cGxheX0mYXBpa2V5PWFwaXZpbnpgKQogIGlmKCFpc1VybChhcmdzWzBdKSAmJiAhYXJnc1swXS5pbmNsdWRlcygneW91dHUnKSkgcmV0dXJuIHJlcGx5KCdFbCBmb3JtYXRvIGRlbCBsaW5rIGVzIGluY29ycmVjdG8nKQogIGlmIChhbnUuZXJyb3IpIHJldHVybiByZXBseShhbnUuZXJyb3IpCiAgaW5mb21wMyA9IGAqVmlkZW8qXG7igKMgKk5vbWJyZSogOiAke2FudS5yZXN1bHQudGl0bGV9XG7igKMgKkZ1ZW50ZSogOiAke2FudS5yZXN1bHQuc291cmNlfVxu4oCjICpUYW1hw7FvKiA6ICR7YW51LnJlc3VsdC5zaXplfVxuXG5fU2UgZXN0YSBtYW5kYW5kbyBlbCB2aWRlbywgc2kgbm8gbGxlZ2EgZGVzY2FyZ3VlIHBvciBlbCBsaW5rX1xu4oCjICpsaW5rKiA6ICR7YW51LnJlc3VsdC51cmxfdmlkZW99YAogIGZha2VlID0gZnMucmVhZEZpbGVTeW5jKCcuL3NyYy9pbWcuanBnJykKICBidWZmZXIgPSBhd2FpdCBnZXRCdWZmZXIoYW51LnJlc3VsdC50aHVtYm5haWwpCiAgbGFndSA9IGF3YWl0IGdldEJ1ZmZlcihhbnUucmVzdWx0LnVybF92aWRlbykKICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGJ1ZmZlciwgaW1hZ2UsIHsKcXVvdGVkOiBmdmlkLCBjYXB0aW9uOiBpbmZvbXAzLCB0aHVtYm5haWw6IGZha2VlCiAgfSkKICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGxhZ3UsIHZpZGVvLCB7Cm1pbWV0eXBlOiAndmlkZW8vbXA0JywgZHVyYXRpb24gOi05OTk5OTk5OTk5OTk5OTksIGZpbGVuYW1lOiBgJHthbnUucmVzdWx0LnRpdGxlfS5tcDRgLCBxdW90ZWQ6IGZ2aWQKICB9KQogIAogIH0gY2F0Y2ggewogICAgcmVwbHkobWVzcy5mZXJyKQogIH0KICBicmVhawogY2FzZSAndGlrdG9rYXVkaW8nOgogcGUgPSBhcmdzLmpvaW4oJyAnKQogYW51ID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwOi8vZG9jcy1qb2pvLmhlcm9rdWFwcC5jb20vYXBpL3Rpa3Rva19hdWRpbz91cmw9JHtwZX1gKQogYnVmID0gYXdhaXQgZ2V0QnVmZmVyKGAke2FudS5yZXN1bHR9YCkKIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYnVmLCBhdWRpbywge21pbWV0eXBlOiAnYXVkaW8vbXA0JywgcXVvdGVkOiBmdG9rbywgcHR0OnRydWV9KQogYnJlYWsKY2FzZSAnc3MnOgogcGUgPSBhcmdzLmpvaW4oJyAnKQogYW51ID0gYXdhaXQgZ2V0QnVmZmVyKGBodHRwczovL2FwaS1ydWxsLmhlcm9rdWFwcC5jb20vYXBpL3Nzd2ViP3VybD0ke3BlfWApCiBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGFudSwgaW1hZ2UsIHtxdW90ZWQ6IGZpbWd9KQogYnJlYWsKIAoJCQkJY2FzZSAnaW11dCc6CgkJCQkJZW5jbWVkaWEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkucmVwbGFjZSgncXVvdGVkTScsJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvCgkJCQkJbWVkaWEgPSBhd2FpdCBzYW11MzMwLmRvd25sb2FkQW5kU2F2ZU1lZGlhTWVzc2FnZShlbmNtZWRpYSkKCQkJCQlyYW4gPSBnZXRSYW5kb20oJy5tcDMnKQoJCQkJCWV4ZWMoYGZmbXBlZyAtaSAke21lZGlhfSAtYWYgYXRlbXBvPTMvNCxhc2V0cmF0ZT00NDUwMCo0LzMgJHtyYW59YCwgKGVyciwgc3RkZXJyLCBzdGRvdXQpID0+IHsKCQkJCQkJZnMudW5saW5rU3luYyhtZWRpYSkKCQkJCQkJaWYgKGVycikgcmV0dXJuIHJlcGx5KCdFcnJvciEnKQoJCQkJCQloYWggPSBmcy5yZWFkRmlsZVN5bmMocmFuKQoJCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGhhaCwgYXVkaW8sIHttaW1ldHlwZTogJ2F1ZGlvL21wNCcsIHB0dDogdHJ1ZSwgcXVvdGVkOiBmZG9jfSkKCQkJCQkJZnMudW5saW5rU3luYyhyYW4pCgkJCQkJfSkKCQkJCWJyZWFrCgkJCQljYXNlICdob2RlJzoKCQkJCQllbmNtZWRpYSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8KCQkJCQltZWRpYSA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRBbmRTYXZlTWVkaWFNZXNzYWdlKGVuY21lZGlhKQoJCQkJCXJhbiA9IGdldFJhbmRvbSgnLm1wMycpCgkJCQkJZXhlYyhgZmZtcGVnIC1pICR7bWVkaWF9IC1hZiBhdGVtcG89NC8zLGFzZXRyYXRlPTQ0NTAwKjMvNCAke3Jhbn1gLCAoZXJyLCBzdGRlcnIsIHN0ZG91dCkgPT4gewoJCQkJCQlmcy51bmxpbmtTeW5jKG1lZGlhKQoJCQkJCQlpZiAoZXJyKSByZXR1cm4gcmVwbHkoJ0Vycm9yIScpCgkJCQkJCWhhaCA9IGZzLnJlYWRGaWxlU3luYyhyYW4pCgkJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgaGFoLCBhdWRpbywge21pbWV0eXBlOiAnYXVkaW8vbXA0JywgcHR0OiB0cnVlLCBxdW90ZWQ6IGZkb2N9KQoJCQkJCQlmcy51bmxpbmtTeW5jKHJhbikKCQkJCQl9KQoJCQkJYnJlYWsKCQkJCQoJCQkJY2FzZSAndHJpZ2dlcic6CgkJCQkJICAgcmVwbHkobWVzcy53YWl0KQoJCQkJCSAgIHRyaSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8KCQkJCQkgICBnZXIgPSBhd2FpdCBzYW11MzMwLmRvd25sb2FkQW5kU2F2ZU1lZGlhTWVzc2FnZSh0cmkpCgkJCQkJICAgcmFuID0gZ2V0UmFuZG9tKCcubXAzJykKCQkJCQkgICBleGVjKGBmZm1wZWcgLWkgJHtnZXJ9IC1maWx0ZXJfY29tcGxleCAiYWNydXNoZXI9bGV2ZWxfaW49ODpsZXZlbF9vdXQ9MTg6Yml0cz04Om1vZGU9bG9nOmFhPTEiICR7cmFufWAsIChlcnIsIHN0ZGVyciwgc3Rkb3V0KSA9PiB7CgkJCQkJCWZzLnVubGlua1N5bmMoZ2VyKQoJCQkJCQlpZiAoZXJyKSByZXR1cm4gcmVwbHkoJ0Vycm9yIScpCgkJCQkJCWhhaCA9IGZzLnJlYWRGaWxlU3luYyhyYW4pCgkJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgaGFoLCBhdWRpbywge21pbWV0eXBlOiAnYXVkaW8vbXA0JywgcHR0OnRydWUsIHF1b3RlZDogZmRvY30pCgkJCQkJCWZzLnVubGlua1N5bmMocmFuKQoJCQkJCX0pCgkJCQlicmVhawoJCgkJCQkJY2FzZSAnc2xvdyc6CgkJCQkJcmVwbHkobWVzcy53YWl0KQoJCQkJCWxvdyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8KCQkJCQlzbG8gPSBhd2FpdCBzYW11MzMwLmRvd25sb2FkQW5kU2F2ZU1lZGlhTWVzc2FnZShsb3cpCgkJCQkJcmFuID0gZ2V0UmFuZG9tKCcubXAzJykKCQkJCQlleGVjKGBmZm1wZWcgLWkgJHtzbG99IC1maWx0ZXI6YSAiYXRlbXBvPTAuNyxhc2V0cmF0ZT00NDEwMCIgJHtyYW59YCwgKGVyciwgc3RkZXJyLCBzdGRvdXQpID0+IHsKCQkJCQkJZnMudW5saW5rU3luYyhzbG8pCgkJCQkJCWlmIChlcnIpIHJldHVybiByZXBseSgnRXJyb3IhJykKCQkJCQkJaGFoID0gZnMucmVhZEZpbGVTeW5jKHJhbikKCQkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBoYWgsIGF1ZGlvLCB7bWltZXR5cGU6ICdhdWRpby9tcDQnLCBkdXJhdGlvbiA6LTk5OTk5OTk5OTk5OTk5OSwgcHR0OnRydWUsIHF1b3RlZDogZmRvY30pCgkJCQkJCWZzLnVubGlua1N5bmMocmFuKQoJCQkJCX0pCgkJCQlicmVhawoJCQkJY2FzZSAnYXJkaWxsYSc6CgkJCQkJcmVwbHkobWVzcy53YWl0KQoJCQkJCXBhaSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8KCgkJCQkJdHVwID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZEFuZFNhdmVNZWRpYU1lc3NhZ2UocGFpKQoJCQkJCXJhbiA9IGdldFJhbmRvbSgnLm1wMycpCgkJCQkJZXhlYyhgZmZtcGVnIC1pICR7dHVwfSAtZmlsdGVyOmEgImF0ZW1wbz0wLjUsYXNldHJhdGU9NjUxMDAiICR7cmFufWAsIChlcnIsIHN0ZGVyciwgc3Rkb3V0KSA9PiB7CgkJCQkJCWZzLnVubGlua1N5bmModHVwKQoJCQkJCQlpZiAoZXJyKSByZXR1cm4gcmVwbHkoJ0Vycm9yIScpCgkJCQkJCWhhaCA9IGZzLnJlYWRGaWxlU3luYyhyYW4pCgkJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgaGFoLCBhdWRpbywge21pbWV0eXBlOiAnYXVkaW8vbXA0JywgZHVyYXRpb24gOi05OTk5OTk5OTk5OTk5OTksIHB0dDp0cnVlLCBxdW90ZWQ6IGZkb2N9KQoJCQkJCQlmcy51bmxpbmtTeW5jKHJhbikKCQkJCQl9KQoJCQkJYnJlYWsKCQkJCWNhc2UgJ2dyYXZlJzoKCQkJCQlyZXBseShtZXNzLndhaXQpCgkJCQkJbXVrID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzYW0pLnJlcGxhY2UoJ3F1b3RlZE0nLCdtJykpLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mbwoKCQkJCQlnZW0gPSBhd2FpdCBzYW11MzMwLmRvd25sb2FkQW5kU2F2ZU1lZGlhTWVzc2FnZShtdWspCgkJCQkJcmFuID0gZ2V0UmFuZG9tKCcubXAzJykKCQkJCQlleGVjKGBmZm1wZWcgLWkgJHtnZW19IC1maWx0ZXI6YSAiYXRlbXBvPTEuNixhc2V0cmF0ZT0yMjEwMCIgJHtyYW59YCwgKGVyciwgc3RkZXJyLCBzdGRvdXQpID0+IHsKCQkJCQkJZnMudW5saW5rU3luYyhnZW0pCgkJCQkJCWlmIChlcnIpIHJldHVybiByZXBseSgnRXJyb3IhJykKCQkJCQkJaGFoID0gZnMucmVhZEZpbGVTeW5jKHJhbikKCQkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBoYWgsIGF1ZGlvLCB7bWltZXR5cGU6ICdhdWRpby9tcDQnLCBkdXJhdGlvbiA6LTk5OTk5OTk5OTk5OTk5OSwgcHR0OnRydWUsIHF1b3RlZDogZmRvY30pCgkJCQkJCWZzLnVubGlua1N5bmMocmFuKQoJCQkJCX0pCgkJCQlicmVhawoJCQkJY2FzZSAnYmFzcyc6ICAgICAgICAgICAgICAgICAKCQkJCQlhc3MgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkucmVwbGFjZSgncXVvdGVkTScsJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvCgoJCQkJCWJhcyA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRBbmRTYXZlTWVkaWFNZXNzYWdlKGFzcykKCQkJCQlyYW4gPSBnZXRSYW5kb20oJy5tcDMnKQoJCQkJCWV4ZWMoYGZmbXBlZyAtaSAke2Jhc30gLWFmIGVxdWFsaXplcj1mPTk0OndpZHRoX3R5cGU9bzp3aWR0aD0yOmc9MzAgJHtyYW59YCwgKGVyciwgc3RkZXJyLCBzdGRvdXQpID0+IHsKCQkJCQkJZnMudW5saW5rU3luYyhiYXMpCgkJCQkJCWlmIChlcnIpIHJldHVybiByZXBseSgnRXJyb3IhJykKCQkJCQkJaGFoID0gZnMucmVhZEZpbGVTeW5jKHJhbikKCQkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBoYWgsIGF1ZGlvLCB7bWltZXR5cGU6ICdhdWRpby9tcDQnLCBkdXJhdGlvbiA6LTk5OTk5OTk5OTk5OTk5OSwgcHR0OnRydWUsIHRlc2N1aywgcXVvdGVkOiBmZG9jfSkKCQkJCQkJZnMudW5saW5rU3luYyhyYW4pCgkJCQkJfSkKCQkJCQlicmVhawoJCQkJCgkJCWNhc2UgJ3RvbXAzJzoKCQkJCXNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQoJCQkJaWYgKCFpc1F1b3RlZFZpZGVvKSByZXR1cm4gcmVwbHkoJ1kgZWwgdmlkZW8/JykKCQkJCXJlcGx5KG1lc3Mud2FpdCkKCQkJCWVuY21lZGlhID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzYW0pLnJlcGxhY2UoJ3F1b3RlZE0nLCAnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8KCQkJCW1lZGlhID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZEFuZFNhdmVNZWRpYU1lc3NhZ2UoZW5jbWVkaWEpCgkJCQlyYW4gPSBnZXRSYW5kb20oJy5tcDMnKQoJCQkJZXhlYyhgZmZtcGVnIC1pICR7bWVkaWF9ICR7cmFufWAsIChlcnIpID0+IHsKCQkJCQlmcy51bmxpbmtTeW5jKG1lZGlhKQoJCQkJCWlmIChlcnIpIHJldHVybiByZXBseShtZXNzLmZlcnIpCgkJCQkJYnVmZmVyID0gZnMucmVhZEZpbGVTeW5jKHJhbikKCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGJ1ZmZlciwgYXVkaW8sIHsgbWltZXR5cGU6ICdhdWRpby9tcDQnLCBxdW90ZWQ6IGZ0b2tvfSkKCQkJCQkJZnMudW5saW5rU3luYyhyYW4pCgkJCQkJICAgfSkKCQkJCWJyZWFrCgkJCWNhc2UgJ2dldHN0aWNrZXInOgoJCQljYXNlICdnZXRzJzoKCQkJCXZhciBpdHNtZSA9IGAke251bWJlcm55ZX1Acy53aGF0c2FwcC5uZXRgCgkJCQluYW1hc3RjID0gYXJncy5qb2luKCcgJykKCQkJCXJlc3VsdCA9IGZzLnJlYWRGaWxlU3luYyhgLi9tZWRpYS9zdGlja2VyLyR7bmFtYXN0Y30ud2VicGApCgkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIHJlc3VsdCwgc3RpY2tlciwgeyBxdW90ZWQ6IHsga2V5OiB7IGZyb21NZTogZmFsc2UsIHBhcnRpY2lwYW50OiBgMEBzLndoYXRzYXBwLm5ldGAsIC4uLihmcm9tID8geyByZW1vdGVKaWQ6ICJzdGF0dXNAYnJvYWRjYXN0IiB9IDoge30pIH0sIG1lc3NhZ2U6IHsgImltYWdlTWVzc2FnZSI6IHsgIm1pbWV0eXBlIjogImltYWdlL2pwZWciLCAiY2FwdGlvbiI6ICIke3NldHRpbmcubmFtZX0iLCAnanBlZ1RodW1ibmFpbCc6IGZzLnJlYWRGaWxlU3luYygnLi9zcmMvSXZhbi5qcGcnKX19fX0pCgkJCQlicmVhawoJCQljYXNlICdzdGlja2VybGlzdCc6CgkJCWNhc2UgJ2xpc3RzdGlja2VyJzoKCQkJCXRla3MgPSAnKlN0aWNrZXIgTGlzdCA6KlxuXG4nCgkJCQlmb3IgKGxldCBhd29rd2t3ayBvZiBzZXRpa2VyKSB7CgkJCQkJdGVrcyArPSBgLSAke2F3b2t3a3drfVxuYAoJCQkJfQoJCQkJdGVrcyArPSBgXG4qVG90YWwgOiAke3NldGlrZXIubGVuZ3RofSpgCgkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIHRla3MudHJpbSgpLCBleHRlbmRlZFRleHQsIHsgcXVvdGVkOiBmdG9rbywgY29udGV4dEluZm86IHsgIm1lbnRpb25lZEppZCI6IHNldGlrZXIgfSB9KQoJCQkJYnJlYWsKCQkJY2FzZSAnYWRkc3RpY2tlcic6CgkJCQlpZiAoIWlzUXVvdGVkU3RpY2tlcikgcmV0dXJuIHJlcGx5KCdSZXBseSBzdGlrZXIgbnlhJykKCQkJCXN2c3QgPSBhcmdzLmpvaW4oJyAnKQoJCQkJaWYgKCFzdnN0KSByZXR1cm4gcmVwbHkoJ05hbWEgc3RpY2tlciBueWEgYXBhPycpCgkJCQlib2lqID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzYW0pLnJlcGxhY2UoJ3F1b3RlZE0nLCAnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8KCQkJCWRlbGIgPSBhd2FpdCBzYW11MzMwLmRvd25sb2FkTWVkaWFNZXNzYWdlKGJvaWopCgkJCQlzZXRpa2VyLnB1c2goYCR7c3ZzdH1gKQoJCQkJZnMud3JpdGVGaWxlU3luYyhgLi9tZWRpYS9zdGlja2VyLyR7c3ZzdH0ud2VicGAsIGRlbGIpCgkJCQlmcy53cml0ZUZpbGVTeW5jKCcuL21lZGlhL3N0aWNrLmpzb24nLCBKU09OLnN0cmluZ2lmeShzZXRpa2VyKSkKCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYFN1a3NlcyBNZW5hbWJhaGthbiBTdGlja2VyXG5DZWsgZGVuZ2FuIGNhcmEgJHtwcmVmaXh9bGlzdHN0aWNrZXJgLCBNZXNzYWdlVHlwZS50ZXh0LCB7IHF1b3RlZDogZnRva28gfSkKCQkJCWJyZWFrCgkJCWNhc2UgJ2FkZHZuJzoKCQkJCWlmICghaXNRdW90ZWRBdWRpbykgcmV0dXJuIHJlcGx5KCdSZXBseSB2bm55YSBibG9rayEnKQoJCQkJc3ZzdCA9IGFyZ3Muam9pbignICcpCgkJCQlpZiAoIXN2c3QpIHJldHVybiByZXBseSgnTmFtYSBhdWRpb255YSBhcGEgc3U/JykKCQkJCWJvaWogPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkucmVwbGFjZSgncXVvdGVkTScsICdtJykpLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mbwoJCQkJZGVsYiA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRNZWRpYU1lc3NhZ2UoYm9paikKCQkJCWF1ZGlvbnllLnB1c2goYCR7c3ZzdH1gKQoJCQkJZnMud3JpdGVGaWxlU3luYyhgLi9zcmMvYXVkaW8vJHtzdnN0fS5tcDNgLCBkZWxiKQoJCQkJZnMud3JpdGVGaWxlU3luYygnLi9zcmMvYXVkaW8uanNvbicsIEpTT04uc3RyaW5naWZ5KGF1ZGlvbnllKSkKCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYFN1a3NlcyBNZW5hbWJhaGthbiAgVm5cbkNlayBkZW5nYW4gY2FyYSAke3ByZWZpeH1saXN0dm5gLCBNZXNzYWdlVHlwZS50ZXh0LCB7IHF1b3RlZDogZnRva28gfSkKCQkJCWJyZWFrCgkJCWNhc2UgJ2xpc3R2bic6CgkJCWNhc2UgJ3ZubGlzdCc6CgkJCQl0ZWtzID0gJypMaXN0IFZuOipcblxuJwoJCQkJZm9yIChsZXQgYXdva3drd2sgb2YgYXVkaW9ueWUpIHsKCQkJCQl0ZWtzICs9IGAtICR7YXdva3drd2t9XG5gCgkJCQl9CgkJCQl0ZWtzICs9IGBcbipUb3RhbCA6ICR7YXVkaW9ueWUubGVuZ3RofSpgCgkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIHRla3MudHJpbSgpLCBleHRlbmRlZFRleHQsIHsgcXVvdGVkOiBmdG9rbywgY29udGV4dEluZm86IHsgIm1lbnRpb25lZEppZCI6IGF1ZGlvbnllIH0gfSkKCQkJCWJyZWFrCgkJCWNhc2UgJ2FkZGltYWdlJzoKCQkJCWlmICghaXNRdW90ZWRJbWFnZSkgcmV0dXJuIHJlcGx5KCdSZXBseSBpbWFnZW55YSBibG9rayEnKQoJCQkJc3ZzdCA9IGFyZ3Muam9pbignICcpCgkJCQlpZiAoIXN2c3QpIHJldHVybiByZXBseSgnTmFtYSBpbWFnZW55YSBhcGEgc3U/JykKCQkJCWJvaWogPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkucmVwbGFjZSgncXVvdGVkTScsICdtJykpLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mbwoJCQkJZGVsYiA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRNZWRpYU1lc3NhZ2UoYm9paikKCQkJCWltYWdlbnllLnB1c2goYCR7c3ZzdH1gKQoJCQkJZnMud3JpdGVGaWxlU3luYyhgLi9zcmMvaW1hZ2UvJHtzdnN0fS5qcGVnYCwgZGVsYikKCQkJCWZzLndyaXRlRmlsZVN5bmMoJy4vc3JjL2ltYWdlLmpzb24nLCBKU09OLnN0cmluZ2lmeShpbWFnZW55ZSkpCgkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGBTdWtzZXMgTWVuYW1iYWhrYW4gVmlkZW9cbkNlayBkZW5nYW4gY2FyYSAke3ByZWZpeH1saXN0aW1hZ2VgLCBNZXNzYWdlVHlwZS50ZXh0LCB7IHF1b3RlZDogZnRva28gfSkKCQkJCWJyZWFrCgkJCWNhc2UgJ2dldGltYWdlJzoKCQkJCW5hbWFzdGMgPSBhcmdzLmpvaW4oJyAnKQoJCQkJYnVmZmVyID0gZnMucmVhZEZpbGVTeW5jKGAuL3NyYy9pbWFnZS8ke25hbWFzdGN9LmpwZWdgKQoJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBidWZmZXIsIGltYWdlLCB7IHF1b3RlZDogZnRva28sIGNhcHRpb246IGBSZXN1bHQgRnJvbSBEYXRhYmFzZSA6ICR7bmFtYXN0Y30uanBlZ2AgfSkKCQkJCWJyZWFrCgkJCWNhc2UgJ2ltYWdlbGlzdCc6CgkJCWNhc2UgJ2xpc3RpbWFnZSc6CgkJCQl0ZWtzID0gJypMaXN0IEltYWdlIDoqXG5cbicKCQkJCWZvciAobGV0IGF3b2t3a3drIG9mIGltYWdlbnllKSB7CgkJCQkJdGVrcyArPSBgLSAke2F3b2t3a3drfVxuYAoJCQkJfQoJCQkJdGVrcyArPSBgXG4qVG90YWwgOiAke2ltYWdlbnllLmxlbmd0aH0qYAoJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCB0ZWtzLnRyaW0oKSwgZXh0ZW5kZWRUZXh0LCB7IHF1b3RlZDogZnRva28sIGNvbnRleHRJbmZvOiB7ICJtZW50aW9uZWRKaWQiOiBpbWFnZW55ZSB9IH0pCgkJCQlicmVhawoJCQljYXNlICdhZGR2aWRlbyc6CgkJCQlzdnN0ID0gYXJncy5qb2luKCcgJykKCQkJCWlmICghc3ZzdCkgcmV0dXJuIHJlcGx5KCdOYW1hIHZpZGVvbnlhIGFwYSBzdT8nKQoJCQkJYm9paiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywgJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvCgkJCQlkZWxiID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZE1lZGlhTWVzc2FnZShib2lqKQoJCQkJdmlkZW9ueWUucHVzaChgJHtzdnN0fWApCgkJCQlmcy53cml0ZUZpbGVTeW5jKGAuL3NyYy92aWRlby8ke3N2c3R9Lm1wNGAsIGRlbGIpCgkJCQlmcy53cml0ZUZpbGVTeW5jKCcuL3NyYy92aWRlby5qc29uJywgSlNPTi5zdHJpbmdpZnkodmlkZW9ueWUpKQoJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBgU3Vrc2VzIE1lbmFtYmFoa2FuIFZpZGVvXG5DZWsgZGVuZ2FuIGNhcmEgJHtwcmVmaXh9bGlzdHZpZGVvYCwgTWVzc2FnZVR5cGUudGV4dCwgeyBxdW90ZWQ6IGZ0b2tvIH0pCgkJCQlicmVhawoJCQljYXNlICdnZXR2aWRlbyc6CgkJCQluYW1hc3RjID0gYXJncy5qb2luKCcgJykKCQkJCWJ1ZmZlciA9IGZzLnJlYWRGaWxlU3luYyhgLi9zcmMvdmlkZW8vJHtuYW1hc3RjfS5tcDRgKQoJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBidWZmZXIsIHZpZGVvLCB7IG1pbWV0eXBlOiAndmlkZW8vbXA0JywgcXVvdGVkOiBmdG9rbyB9KQoJCQkJYnJlYWsKCQkJY2FzZSAndmlkZW9saXN0JzoKCQkJY2FzZSAnbGlzdHZpZGVvJzoKCQkJCXRla3MgPSAnKkxpc3QgVmlkZW8gOipcblxuJwoJCQkJZm9yIChsZXQgYXdva3drd2sgb2YgdmlkZW9ueWUpIHsKCQkJCQl0ZWtzICs9IGAtICR7YXdva3drd2t9XG5gCgkJCQl9CgkJCQl0ZWtzICs9IGBcbipUb3RhbCA6ICR7dmlkZW9ueWUubGVuZ3RofSpgCgkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIHRla3MudHJpbSgpLCBleHRlbmRlZFRleHQsIHsgcXVvdGVkOiBmdG9rbywgY29udGV4dEluZm86IHsgIm1lbnRpb25lZEppZCI6IHZpZGVvbnllIH0gfSkKCQkJCWJyZWFrCgkJCWNhc2UgJ2xlYXZlJzoKCQkJICAgCgkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sICdCeWVlZWUga2F3YW5uJywgTWVzc2FnZVR5cGUudGV4dCkKCQkJCWFudSA9IGF3YWl0IHNhbXUzMzAuZ3JvdXBMZWF2ZShmcm9tLCAnU2VlIHlvdS4uLi4uLi4uJywgZ3JvdXBJZCkKCQkJCWJyZWFrCgkJCWNhc2UgJ2NoYXRsaXN0JzoKCQkJCXNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQoJCQkJdGVrcyA9IGBUb3RhbCA6ICR7dG90YWxjaGF0Lmxlbmd0aH1gCgkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIHRla3MsIHRleHQsIHtxdW90ZWQ6ZmRvY30pCgkJCQlicmVhawoKY2FzZSAncGluZyc6CgkJCQl2YXIgZ3JvdXBzID0gc2FtdTMzMC5jaGF0cy5hcnJheS5maWx0ZXIodiA9PiB2LmppZC5lbmRzV2l0aCgnZy51cycpKQoJCQkJdmFyIHByaXZhdCA9IHNhbXUzMzAuY2hhdHMuYXJyYXkuZmlsdGVyKHYgPT4gdi5qaWQuZW5kc1dpdGgoJ3Mud2hhdHNhcHAubmV0JykpCgkJCQl2YXIgcmFtMiA9IGAkeyhwcm9jZXNzLm1lbW9yeVVzYWdlKCkuaGVhcFVzZWQgLyAxMDI0IC8gMTAyNCkudG9GaXhlZCgyKX1NQiAvICR7TWF0aC5yb3VuZChyZXF1aXJlKCdvcycpLnRvdGFsbWVtIC8gMTAyNCAvIDEwMjQpfU1CYAoJCQkJCXVwdGltZSA9IHByb2Nlc3MudXB0aW1lKCk7CgkJCQkJY29uc3QgdGltZXN0YW1wID0gc3BlZWQoKTsKCQkJCQljb25zdCB0b3RhbENoYXQgPSBhd2FpdCBzYW11MzMwLmNoYXRzLmFsbCgpCgkJCQkJY29uc3QgbGF0ZW5zaSA9IHNwZWVkKCkgLSB0aW1lc3RhbXAKCQkJCQl2YXIgdG90YWwgPSBtYXRoKGAke2dyb3Vwcy5sZW5ndGh9KiR7cHJpdmF0Lmxlbmd0aH1gKQoJCQkJCXRla3MgPSBgX1BvbmdfIHhEXG4qRVNUQURJU1RJQ0FTIERFTCBCT1Q6KlxuKi0gR3JvdXAgQ2hhdHMgOiogJHtncm91cHMubGVuZ3RofVxuKi0gUHJpdmF0ZSBDaGF0cyA6KiAke3ByaXZhdC5sZW5ndGh9XG4qLSBUb3RhbCBDaGF0cyA6KiAke3RvdGFsQ2hhdC5sZW5ndGh9XG4qLSBTcGVlZCA6KiAke2xhdGVuc2kudG9GaXhlZCg0KX0gX1NlY29uZF9cbiotIEFjdGl2ZSBUaW1lIDoqICR7a3l1bih1cHRpbWUpfVxuXG4qUEhPTkUgU1RBVElTVElDUzoqXG4qLSDtoL3ts7FDYXBhY2lkYWQgZGUgUmFtIDoqICR7cmFtMn1cbiotIO2gve2yu1BsYXRhZm9ybWEgOiogJHtvcy5wbGF0Zm9ybSgpfVxuKi0g7aC87byQSG9zdG5hbWUgOiogJHtvcy5ob3N0bmFtZSgpfVxuKi0g7aC97bWQVXB0aW1lIDoqICR7a3l1bihvcy51cHRpbWUoKSl9XG4qLSDtoL7tuoBXYSBWZXJzaW9uOiogJHtzYW11MzMwLnVzZXIucGhvbmUud2FfdmVyc2lvbn1cbiotIO2gve2zoU9zIFZlcnNpb246KiAke3NhbXUzMzAudXNlci5waG9uZS5vc192ZXJzaW9ufVxuKi0g7aC97bSQRGV2aWNlIE1hbnVmYWN0dXJlcjoqICR7c2FtdTMzMC51c2VyLnBob25lLmRldmljZV9tYW51ZmFjdHVyZXJ9XG4qLSDtoL3ts7JEZXZpY2UgTW9kZWw6KiAke3NhbXUzMzAudXNlci5waG9uZS5kZXZpY2VfbW9kZWx9XG4qLSDtoL7tt6xPcyBCdWlsZCBOdW1iZXI6KiAke3NhbXUzMzAudXNlci5waG9uZS5vc19idWlsZF9udW1iZXJ9YAoJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgdGVrcywgdGV4dCwge3F1b3RlZDogZmRvYywgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfX0pCmJyZWFrCgkJCWNhc2UgJyQnOgoJCQkJY29uc3QgY21kID0gYXJncy5qb2luKCcgJykKCQkJCWV4ZWMoY21kLCAoZXJyLCBzdGRvdXQpID0+IHsKCQkJCQlpZiAoZXJyKSByZXR1cm4gc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBgJHtlcnJ9YCwgdGV4dCwgeyBxdW90ZWQ6IGZ0b2tvIH0pCgkJCQkJaWYgKHN0ZG91dCkgewoJCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIHN0ZG91dCwgdGV4dCwgeyBxdW90ZWQ6ZnRva299KQoJCQkJCX0KCQkJCX0pCgkJCQlicmVhawoJCQkKCQkJY2FzZSAnYmxvY2tsaXN0JzoKCQkJCXRla3MgPSAn7aC17beV7aC17bef7aC17bei7aC17beW7aC17beeIO2gte23n+2gte23nO2gte23pu2gte23pyA6XG4nCgkJCQlmb3IgKGxldCBibG9jayBvZiBibG9ja2VkKSB7CgkJCQkJdGVrcyArPSBgLSBAJHtibG9jay5zcGxpdCgnQCcpWzBdfVxuYAoJCQkJfQoJCQkJdGVrcyArPSBg7aC17ben7aC17be87aC17biB7aC17beu7aC17be5IDogJHtibG9ja2VkLmxlbmd0aH1gCgkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIHRla3MudHJpbSgpLCBleHRlbmRlZFRleHQsIHsgcXVvdGVkOiBmdG9rbywgY29udGV4dEluZm86IHsgIm1lbnRpb25lZEppZCI6IGJsb2NrZWQgfSB9KQoJCQkJYnJlYWsKCQkJY2FzZSAnb2NyJzoKCQkJCWlmICgoaXNNZWRpYSAmJiAhc2FtLm1lc3NhZ2UudmlkZW9NZXNzYWdlIHx8IGlzUXVvdGVkSW1hZ2UpICYmIGFyZ3MubGVuZ3RoID09IDApIHsKCQkJCQljb25zdCBlbmNtZWRpYSA9IGlzUXVvdGVkSW1hZ2UgPyBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkucmVwbGFjZSgncXVvdGVkTScsICdtJykpLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mbyA6IHNhbQoJCQkJCWNvbnN0IG1lZGlhID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZEFuZFNhdmVNZWRpYU1lc3NhZ2UoZW5jbWVkaWEpCgkJCQkJcmVwbHkobWVzcy53YWl0KQoJCQkJCWF3YWl0IHJlY29nbml6ZShtZWRpYSwgeyBsYW5nOiAnZW5nK2luZCcsIG9lbTogMSwgcHNtOiAzIH0pCgkJCQkJCS50aGVuKHRla3MgPT4gewoJCQkJCQkJcmVwbHkodGVrcy50cmltKCkpCgkJCQkJCQlmcy51bmxpbmtTeW5jKG1lZGlhKQoJCQkJCQl9KQoJCQkJCQkuY2F0Y2goZXJyID0+IHsKCQkJCQkJCXJlcGx5KGVyci5tZXNzYWdlKQoJCQkJCQkJZnMudW5saW5rU3luYyhtZWRpYSkKCQkJCQkJfSkKCQkJCX0gZWxzZSB7CgkJCQkJcmVwbHkoJ0VudmllbiB1bmEgaW1hZ2VuIGNvbiBlbCBjb21hbmRvOiAke3ByZWZpeH3toLXtt7ztoLXtt7DtoLXtt78nKQoJCQkJfQoJCQkJYnJlYWsKCgkJCQoJCQkJY2FzZSAnYmF0cmVpJzoKCQkJCSBjYXNlICdiYXR0cmV5JzoKICAgICAgICAgbGV0IGJhdHJlaU5vdyA9IGdsb2JhbC5iYXRyZWlbZ2xvYmFsLmJhdHJlaS5sZW5ndGggLSAxXQogICAgICAgICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGAke2JhdHJlaU5vd30lYCwgdGV4dCkKICAgICAgICAgYnJlYWsKCQkJY2FzZSAndHRzJzoKCQkJCWNhc2UgJ3Zveic6CgkJCQkJaWYgKGFyZ3MubGVuZ3RoIDwgMSkgcmV0dXJuIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgJ1kgZWwgY29kaWdvIGRlIGlkaW9tYT8gZXNjcmliZSBlbCBjb21hbmRvICppZGlvbWFzKiBwYXJhIHZlciBsYSBsaXN0YScsIHRleHQsIHsgcXVvdGVkOiBmYWtlUHJvZHVjdCB9KQoJCQkJCWNvbnN0IGd0dHMgPSByZXF1aXJlKCcuL2xpYi9ndHRzJykoYXJnc1swXSkKCQkJCQlpZiAoYXJncy5sZW5ndGggPCAyKSByZXR1cm4gc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCAnRXNjcmliZSBlbCB0ZXh0bycsIHRleHQsIHtxdW90ZWQ6IG1la30pCgkJCQkJZHR0ID0gYm9keS5zbGljZSg4KQoJCQkJCXJhbm0gPSBnZXRSYW5kb20oJy5tcDMnKQoJCQkJCXJhbm8gPSBnZXRSYW5kb20oJy5vZ2cnKQoJCQkJCWR0dC5sZW5ndGggPiAzMDAKCQkJCQk/IHJlcGx5KCdNaXJhLCBzaSBubyBzYWJlcyB1c2FyIGVzdG8uLi4gbWVqb3Igbm8gbG8gYWdhcyDtoL3tuKQnKQoJCQkJCTogZ3R0cy5zYXZlKHJhbm0sIGR0dCwgZnVuY3Rpb24oKSB7CgkJCQkJCXNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UucmVjb3JkaW5nKQoJCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGZzLnJlYWRGaWxlU3luYyhyYW5tKSwgYXVkaW8sIHtxdW90ZWQ6IGZha2VQcm9kdWN0LCBtaW1ldHlwZTogJ2F1ZGlvL21wNCcsIGR1cmF0aW9uOiAtOTk5OTk5OTk5OTk5OTk5OTk5LCBwdHQ6dHJ1ZSwgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfX0pCgkJCQkJCWZzLnVubGlua1N5bmMocmFubSkKCQkJCQl9KQoJCQkJCWJyZWFrCgkJCQkKCQkJY2FzZSAnc2V0cHJlZml4JzoKCQkJCQlpZiAoYXJncy5sZW5ndGggPCAxKSByZXR1cm4KCQkJCQlpZiAoIWlzT3duZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkub3duZXJCKQoJCQkJICBwcmVmaXggPSBhcmdzWzBdCgkJCQkJc2FtdS5wcmVmaXggPSBwcmVmaXgKCQkJCQlmcy53cml0ZUZpbGVTeW5jKCcuL2RhdGEvc2V0dGluZ3MuanNvbicsIEpTT04uc3RyaW5naWZ5KHVwLCBudWxsLCAnXHQnKSkKCQkJCQlyZXBseShgUHJlZmlqbyBjYW1iaWFkbyA6ICR7cHJlZml4fWApCgkJCQkJYnJlYWsKCQkJY2FzZSAnc2V0b3duJzoKCQkJCQlpZiAoYXJncy5sZW5ndGggPCAxKSByZXR1cm4KCQkJCQlpZiAoIWlzT3duZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkub3duZXJCKQoJCQkJICBvd24gPSBhcmdzWzBdCgkJCQkJc2FtdS5wcmVmaXggPSBvd24KCQkJCQlmcy53cml0ZUZpbGVTeW5jKCcuL2RhdGEvc2V0dGluZ3MuanNvbicsIEpTT04uc3RyaW5naWZ5KHVwLCBudWxsLCAnXHQnKSkKCQkJCQlyZXBseShgRWwgb3duZXIgZGVsIGJvdCBhaG9yYSBlcyA6ICR7b3dufWApCgkJCQkJYnJlYWsKCQkJY2FzZSAnc2V0dGFyZ2V0JzoKCQkJCWlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybgoJCQkJdGFyZ2V0cHJpdmF0ZSA9IGFyZ3NbMF0KCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYHRhcmdldCBQcml2YXRlIEZha2UgUmVwbHkgOiAke3RhcmdldHByaXZhdGV9YCwgdGV4dCwge3F1b3RlZDpmZG9jfSkKCQkJCWJyZWFrCgkJCWNhc2UgJ2FsbCc6CnNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQppZiAoIWlzR3JvdXApIHJldHVybiByZXBseShtZXNzLm9ubHkuZ3JvdXApCmlmICghaXNSZWdpc3RlcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5kYWZ0YXJCKQppZiAoIWlzR3JvdXBBZG1pbnMpIHJldHVybiByZXBseShtZXNzLm9ubHkuYWRtaW4pCm1lbWJlcnNfaWQgPSBbXQp0ZWtzID0gKGFyZ3MubGVuZ3RoID4gMSkgPyBib2R5LnNsaWNlKDgpLnRyaW0oKTogJycKdGVrcyArPSBgICBUb3RhbCA6ICR7Z3JvdXBNZW1iZXJzLmxlbmd0aH1cbmAKZm9yIChsZXQgbWVtIG9mIGdyb3VwTWVtYmVycykgewogIHRla3MgKz0gYOKUgyBAJHttZW0uamlkLnNwbGl0KCdAJylbMF19XG5gCiAgbWVtYmVyc19pZC5wdXNoKG1lbS5qaWQpCn0KbWVudGlvbnMoJ+OAmCAgKlRBR0FMTCog44CZXG7ilI/ilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIFcbuKUoOKKtycrdGVrcysn4pSD4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSBXG7ilIPilIDilIDilIDilIDinIVTYW11MzMw7aC87b+G4pSA4pSA4pSA4pSAXG7ilJfilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIEnLCBtZW1iZXJzX2lkLCB0cnVlKQpicmVhawoJCQljYXNlICdjbGVhcmFsbCc6CgkJCQlpZiAoIWlzT3duZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkub3duZXJCKQoJCQkJYW51ID0gYXdhaXQgc2FtdTMzMC5jaGF0cy5hbGwoKQoJCQkJc2FtdTMzMC5zZXRNYXhMaXN0ZW5lcnMoMjUpCgkJCQlmb3IgKGxldCBfIG9mIGFudSkgewoJCQkJCXNhbXUzMzAuZGVsZXRlQ2hhdChfLmppZCkKCQkJCX0KCQkJCXJlcGx5KCdUT0RPUyBMT1MgQ0hBVFMgTElNUElPUycpCgkJCQlicmVhawoJCQkJY2FzZSAnYmxvY2snOgogIHNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQogIGlmICghaXNHcm91cCkgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5ncm91cCkKICBpZiAoIWlzT3duZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkub3duZXJCKQogIHNhbXUzMzAuYmxvY2tVc2VyIChgJHtib2R5LnNsaWNlKDgpfUBjLnVzYCwgImFkZCIpCiAgc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBgVXN1YXJpbyBibG9xdWVhZG9gLCB0ZXh0LCB7CnF1b3RlZDogc2FtCiAgfSkKICBicmVhawoJCQkJY2FzZSAndW5ibG9jayc6CiAgaWYgKCFpc0dyb3VwKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5Lmdyb3VwKQogIGlmICghaXNPd25lcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5vd25lckIpCiAgc2FtdTMzMC5ibG9ja1VzZXIgKGAke2JvZHkuc2xpY2UoOSl9QGMudXNgLCAicmVtb3ZlIikKICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGBVc3VhcmlvIGRlc2Jsb3F1ZWFkb2AsIHRleHQpCiAgYnJlYWsKCQkJCQoJCQkJY2FzZSAnYmFuJzoKCQkJCQlpZiAoIWlzT3duZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkub3duZXJCKQoJCQkJCWJubmQgPSBib2R5LnNsaWNlKDYpCgkJCQkJYmFuLnB1c2goYCR7Ym5uZH1Acy53aGF0c2FwcC5uZXRgKQoJCQkJCWZzLndyaXRlRmlsZVN5bmMoJy4vc3JjL2Jhbm5lZC5qc29uJywgSlNPTi5zdHJpbmdpZnkoYmFuKSkKCQkJCQlyZXBseShgRWwgdXN1YXJpbyB3YS5tZS8ke2JubmR9IGEgc2lkbyBiYW5lYWRvICFgKQoJCQkJCWJyZWFrCgkJCQljYXNlICd1bmJhbic6CgkJCQkJaWYgKCFpc093bmVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5Lm93bmVyQikKCQkJCQlibm5kID0gYm9keS5zbGljZSg4KQoJCQkJCWJhbi5zcGxpY2UoYCR7Ym5uZH1Acy53aGF0c2FwcC5uZXRgLCAxKQoJCQkJCWZzLndyaXRlRmlsZVN5bmMoJy4vc3JjL2Jhbm5lZC5qc29uJywgSlNPTi5zdHJpbmdpZnkoYmFuKSkKCQkJCQlyZXBseShgRWwgdXN1YXJpbyAqd2EubWUvJHtibm5kfSogYSBzaWRvIGRlc2JhbmVhZG8hYCkKCQkJCQlicmVhawoJCQkJCgkJCQljYXNlICdhZGRwcmVtJzoKCQkJCQlpZiAoIWlzT3duZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkub3duZXJCKQoJCQkJCWFkZHAgPSBib2R5LnNsaWNlKDEwKQoJCQkJCXByZW1pdW0ucHVzaChgJHthZGRwfUBzLndoYXRzYXBwLm5ldGApCgkJCQkJZnMud3JpdGVGaWxlU3luYygnLi9zcmMvcHJlbWl1bS5qc29uJywgSlNPTi5zdHJpbmdpZnkocHJlbWl1bSkpCgkJCQkJcmVwbHkoYEVsIHVzdWFyaW8gKndhLm1lLyR7YWRkcH0qIGFob3JhIGVzIF8qcHJlbWl1bSpfYCkKCQkJCQlicmVhawoJCQkJY2FzZSAnZGVsbHByZW0nOgoJCQkJCWlmICghaXNPd25lcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5vd25lckIpCgkJCQkJZGVscCA9IGJvZHkuc2xpY2UoMTEpCgkJCQkJcHJlbWl1bS5zcGxpY2UoYCR7ZGVscH1Acy53aGF0c2FwcC5uZXRgLCAxKQoJCQkJCWZzLndyaXRlRmlsZVN5bmMoJy4vc3JjL3ByZW1pdW0uanNvbicsIEpTT04uc3RyaW5naWZ5KHByZW1pdW0pKQoJCQkJCXJlcGx5KGBFbCB1c3VhcmlvICp3YS5tZS8ke2RlbHB9KiB5YSBubyBlcyBwcmVtaXVtIF8qcHJlbWl1bSpfYCkKCQkJCQlicmVhawkKCQkJCQoJCQljYXNlICdsZWF2ZSc6CgkJCQlpZiAoIWlzR3JvdXApIHJldHVybiByZXBseShtZXNzLm9ubHkuZ3JvdXApCgkJCQlzYW11MzMwLnNhbXUzMzAubGVhdmVHcm91cChmcm9tLCAnTm9zIHZlbW9zLCBkZSBsdWdhcmVzIG1lam9yZXMgbWUgYW4gY29ycmlkb+2gvu21sScsIE1lc3NhZ2VUeXBlLnRleHQpCgkJCQlhd2FpdCBzYW11MzMwLnNhbXUzMzAubGVhdmVHcm91cChmcm9tLCAn7aC17beV7aC17biG7aC17bey7aC17beyJywgZ3JvdXBJZCkKCQkJCWJyZWFrCgkJCWNhc2UgJ2JjJzoKCQkJCQlpZiAoIWlzT3duZXIpIHJldHVybiByZXBseSgnU29sbyAqU2FtdSogcHVlZGUgdXNhciBlc3RlIGNvbWFuZG8nKQoJCQkJCWlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybiByZXBseSgnWSBlbCBhbnVuY2lvPycpCgkJCQkJYW51ID0gYXdhaXQgc2FtdTMzMC5jaGF0cy5hbGwoKQoJCQkJCWlmIChpc01lZGlhICYmICFzYW0ubWVzc2FnZS52aWRlb01lc3NhZ2UgfHwgaXNRdW90ZWRJbWFnZSkgewoJCQkJCQljb25zdCBlbmNtZWRpYSA9IGlzUXVvdGVkSW1hZ2UgPyBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkucmVwbGFjZSgncXVvdGVkTScsJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvIDogZmRvYwoJCQkJCQlidWZmID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZE1lZGlhTWVzc2FnZShlbmNtZWRpYSkKCQkJCQkJZm9yIChsZXQgXyBvZiBhbnUpIHsKCQkJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoXy5qaWQsIGJ1ZmYsIGltYWdlLCB7Y2FwdGlvbjogYCoke2JvZHkuc2xpY2UoNCl9KlxuIM2PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj82PzY/Nj8Kw7aC17bGp7aC17bG57aC17bG27aC17bGo7aC17bGr7aC17bGq7aC17bGo7aC17bG67aC17bG7wrBgfSkKCQkJCQkJfQoJCQkJCQlyZXBseSgnQW51bmNpbyBkYWRvJykKCQkJCQl9IGVsc2UgewoJCQkJCQlmb3IgKGxldCBfIG9mIGFudSkgewoJCQkJCQkJc2VuZE1lc3MoXy5qaWQsIGAqJHtib2R5LnNsaWNlKDQpfSpgKQoJCQkJCQl9CgkJCQkJCXJlcGx5KCdBbnVuY2lvIGRhZG8nKQoJCQkJCX0KCQkJCQlicmVhawoJCQljYXNlICdhw7FhZGlyJzoKCQkJCWlmICghaXNHcm91cCkgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5ncm91cCkKCQkJCWlmICghaXNCb3RHcm91cEFkbWlucykgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5CYWRtaW4pCgkJCQlpZiAoYXJncy5sZW5ndGggPCAxKSByZXR1cm4gcmVwbHkoJ1kgZWwgbnVtZXJvPycpCgkJCQlpZiAoYXJnc1swXS5zdGFydHNXaXRoKCcwOCcpKSByZXR1cm4gcmVwbHkoJ1V0aWxpemEgZWwgY29kaWdvIGRlIHBhaXMnKQoJCQkJdHJ5IHsKCQkJCQludW0gPSBgJHthcmdzWzBdLnJlcGxhY2UoLyAvZywgJycpfUBzLndoYXRzYXBwLm5ldGAKCQkJCQlzYW11MzMwLmdyb3VwQWRkKGZyb20sIFtudW1dKQoJCQkJfSBjYXRjaCAoZSkgewoJCQkJCWNvbnNvbGUubG9nKCdFcnJvciA6JywgZSkKCQkJCQlyZXR1cm4gc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCAnTW9kbyBwcml2YWRvIGRpY2U6dicsIE1lc3NhZ2VUeXBlLnRleHQpCgkJCQl9CgkJCQlicmVhawoJCQkJCgkJCQljYXNlICdraWNrJzoKCQkJCWNhc2UgJ2VsaW1pbmFyJzoKCQkJCQlpZiAoIWlzR3JvdXApIHJldHVybiByZXBseShtZXNzLm9ubHkuZ3JvdXApCgkJCQkJaWYgKCFpc0dyb3VwQWRtaW5zKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmFkbWluKQoJCQkJCWlmICghaXNCb3RHcm91cEFkbWlucykgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5CYWRtaW4pCgkJCQkJaWYgKHNhbS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UgPT09IHVuZGVmaW5lZCB8fCBzYW0ubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlID09PSBudWxsKSByZXR1cm4gcmVwbHkoJ1RhZyB0YXJnZXQnKQoJCQkJCW1lbnRpb25lZCA9IHNhbS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8ubWVudGlvbmVkSmlkCgkJCQkJaWYgKG1lbnRpb25lZC5sZW5ndGggPiAxKSB7CgkJCQkJCXRla3MgPSAnT3JkZW4gcmVjaWJpZGEgOlxuJwoJCQkJCQlmb3IgKGxldCBfIG9mIG1lbnRpb25lZCkgewoJCQkJCQkJdGVrcyArPSBgQCR7Xy5zcGxpdCgnQCcpWzBdfVxuYAoJCQkJCQl9CgkJCQkJCW1lbnRpb25zKHRla3MsIG1lbnRpb25lZCwgdHJ1ZSkKCQkJCQkJc2FtdTMzMC5ncm91cFJlbW92ZShmcm9tLCBtZW50aW9uZWQpCgkJCQkJfSBlbHNlIHsKCQkJCQkJbWVudGlvbnMoYFNlIGVsaW1pbm8gYSA6IEAke21lbnRpb25lZFswXS5zcGxpdCgnQCcpWzBdfWAsIG1lbnRpb25lZCwgdHJ1ZSkKCQkJCQkJc2FtdTMzMC5ncm91cFJlbW92ZShmcm9tLCBtZW50aW9uZWQpCgkJCQkJfQoJCQkJCWJyZWFrCgkJCWNhc2UgJ3Byb21vdGUnOgoJCQkJCWlmICghaXNHcm91cCkgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5ncm91cCkKCQkJCQlpZiAoIWlzR3JvdXBBZG1pbnMpIHJldHVybiByZXBseShtZXNzLm9ubHkuYWRtaW4pCgkJCQkJaWYgKCFpc0JvdEdyb3VwQWRtaW5zKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LkJhZG1pbikKCQkJCQlpZiAoc2FtLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZSA9PT0gdW5kZWZpbmVkIHx8IHNhbS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UgPT09IG51bGwpIHJldHVybgoJCQkJCW1lbnRpb25lZCA9IHNhbS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8ubWVudGlvbmVkSmlkCgkJCQkJaWYgKG1lbnRpb25lZC5sZW5ndGggPiAxKSB7CgkJCQkJCXRla3MgPSAnQ29uIGV4aXRvIFxuJwoJCQkJCQlmb3IgKGxldCBfIG9mIG1lbnRpb25lZCkgewoJCQkJCQkJdGVrcyArPSBgQCR7Xy5zcGxpdCgnQCcpWzBdfVxuYAoJCQkJCQl9CgkJCQkJCW1lbnRpb25zKGZyb20sIG1lbnRpb25lZCwgdHJ1ZSkKCQkJCQkJc2FtdTMzMC5ncm91cFJlbW92ZShmcm9tLCBtZW50aW9uZWQpCgkJCQkJfSBlbHNlIHsKCQkJCQkJbWVudGlvbnMoYEFob3JhIEAke21lbnRpb25lZFswXS5zcGxpdCgnQCcpWzBdfSBlcyBhZG1pbiBkZWwgZ3J1cG8hYCwgbWVudGlvbmVkLCB0cnVlKQoJCQkJCQlzYW11MzMwLmdyb3VwTWFrZUFkbWluKGZyb20sIG1lbnRpb25lZCkKCQkJCQl9CgkJCQkJYnJlYWsKCQkJY2FzZSAnZGVtb3RlJzoKCQkJCQlpZiAoIWlzR3JvdXApIHJldHVybiByZXBseShtZXNzLm9ubHkuZ3JvdXApCgkJCQkJaWYgKCFpc0dyb3VwQWRtaW5zKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmFkbWluKQoJCQkJCWlmICghaXNCb3RHcm91cEFkbWlucykgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5CYWRtaW4pCgkJCQkJaWYgKHNhbS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UgPT09IHVuZGVmaW5lZCB8fCBzYW0ubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlID09PSBudWxsKSByZXR1cm4KCQkJCQltZW50aW9uZWQgPSBzYW0ubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvLm1lbnRpb25lZEppZAoJCQkJCWlmIChtZW50aW9uZWQubGVuZ3RoID4gMSkgewoJCQkJCQl0ZWtzID0gJ0FkbWluIHF1aXRhZG8gY29uIGV4aXRvXG4nCgkJCQkJCWZvciAobGV0IF8gb2YgbWVudGlvbmVkKSB7CgkJCQkJCQl0ZWtzICs9IGBAJHtfLnNwbGl0KCdAJylbMF19XG5gCgkJCQkJCX0KCQkJCQkJbWVudGlvbnModGVrcywgbWVudGlvbmVkLCB0cnVlKQoJCQkJCQlzYW11MzMwLmdyb3VwUmVtb3ZlKGZyb20sIG1lbnRpb25lZCkKCQkJCQl9IGVsc2UgewoJCQkJCQltZW50aW9ucyhgVW4gYWRtaSBtZW5vcyBAJHttZW50aW9uZWRbMF0uc3BsaXQoJ0AnKVswXX0g7aC+7bWxIWAsIG1lbnRpb25lZCwgdHJ1ZSkKCQkJCQkJc2FtdTMzMC5ncm91cERlbW90ZUFkbWluKGZyb20sIG1lbnRpb25lZCkKCQkJCQl9CgkJCQkJYnJlYWsKCQkJY2FzZSAnbGlzdGFkbWluJzoKCQkJCWlmICghaXNHcm91cCkgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5ncm91cCkKCQkJCXZhciBpdHNtZSA9IGAke251bWJlcm55ZX1Acy53aGF0c2FwcC5uZXRgCgkJCQl2YXIgc3BsaXQgPSBgJHtmYWtlfWAKCQkJCXRla3MgPSBg7aC17bef7aC17be27aC17biA7aC17biBIO2gte23ru2gte23se2gte23uu2gte23tu2gte23uyDtoLXtt7ztoLXtt7Mg7aC17be07aC17be/7aC17be87aC17biC7aC17be9ICoke2dyb3VwTWV0YWRhdGEuc3ViamVjdH0qXG7toLXtt6ftoLXtt7ztoLXtuIHtoLXtt67toLXtt7kgOiAke2dyb3VwQWRtaW5zLmxlbmd0aH1cblxuYAoJCQkJbm8gPSAwCgkJCQlmb3IgKGxldCBhZG1vbiBvZiBncm91cEFkbWlucykgewoJCQkJCW5vICs9IDEKCQkJCQl0ZWtzICs9IGBbJHtuby50b1N0cmluZygpfV0gQCR7YWRtb24uc3BsaXQoJ0AnKVswXX1cbmAKCQkJCX0KCQkJCW1lbnRpb25zKHRla3MsIGdyb3VwQWRtaW5zLCB0cnVlKQoJCQkJYnJlYWsKCQkJY2FzZSAndG9pbWcnOgoJCQkJCWlmICghaXNRdW90ZWRTdGlja2VyKSByZXR1cm4gcmVwbHkoJ1BvcmZhdm9yIGV0aXF1ZXRhIHVuIHN0aWNrZXInKQoJCQkJCXJlcGx5KG1lc3Mud2FpdCkKCQkJCQlmYWtlZSA9IGZzLnJlYWRGaWxlU3luYygnLi9zcmMvaW1nLmpwZycpCgkJCQkJZW5jbWVkaWEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkucmVwbGFjZSgncXVvdGVkTScsICdtJykpLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mbwoJCQkJCW1lZGlhID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZEFuZFNhdmVNZWRpYU1lc3NhZ2UoZW5jbWVkaWEpCgkJCQkJcmFuID0gZ2V0UmFuZG9tKCcucG5nJykKCQkJCQlleGVjKGBmZm1wZWcgLWkgJHttZWRpYX0gJHtyYW59YCwgKGVycikgPT4gewoJCQkJCQlmcy51bmxpbmtTeW5jKG1lZGlhKQoJCQkJCQlpZiAoZXJyKSByZXR1cm4gcmVwbHkoJ+2gve25hCcpCgkJCQkJCWJ1ZmZlciA9IGZzLnJlYWRGaWxlU3luYyhyYW4pCgkJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYnVmZmVyLCBpbWFnZSwgeyBjYXB0aW9uOiAnTGlzdG86RCcsIHRodW1ibmFpbDogZmFrZWUgfSkKCQkJCQkJZnMudW5saW5rU3luYyhyYW4pCgkJCQkJfSk7CgkJCQlicmVhawoJCQljYXNlICdjbG9uZSc6CgkJCQlpZiAoIWlzR3JvdXApIHJldHVybiByZXBseShtZXNzLm9ubHkuZ3JvdXApCgkJCQlpZiAoYXJncy5sZW5ndGggPCAxKSByZXR1cm4gcmVwbHkoJ0V0aXF1ZXRhIGEgYWxndWllbiBwYXJhIHV0aWxpemFyIHN1IGZvdG8hISEnKQoJCQkJaWYgKHNhbS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UgPT09IHVuZGVmaW5lZCB8fCBzYW0ubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlID09PSBudWxsKSByZXR1cm4gcmVwbHkoJ0V0aXF1ZXRhIGEgYWxndWllbicpCgkJCQltZW50aW9uZWQgPSBzYW0ubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvLm1lbnRpb25lZEppZFswXQoJCQkJbGV0IHtqaWQsIGlkLCBub3RpZnkgfSA9IGdyb3VwTWVtYmVycy5maW5kKHggPT4geC5qaWQgPT09IG1lbnRpb25lZCkKCQkJCXRyeSB7CgkJCQkJcHAgPSBhd2FpdCBzYW11MzMwLmdldFByb2ZpbGVQaWN0dXJlKGlkKQoJCQkJCWJ1ZmZlciA9IGF3YWl0IGdldEJ1ZmZlcihwcCkKCQkJCQlzYW11MzMwLnVwZGF0ZVByb2ZpbGVQaWN0dXJlKGJvdE51bWJlciwgYnVmZmVyKQoJCQkJCW1lbnRpb25zKGBMYSBmb3RvIGRlIHBlcmZpbCBzZSBhY3R1YWxpesOzIGNvcnJlY3RhbWVudGUgY29uIGxhIGZvdG8gZGUgcGVyZmlsIGRlOiBAJHtpZC5zcGxpdCgnQCcpWzBdfWAsIFtqaWRdLCB0cnVlKQoJCQkJfSBjYXRjaCAoZSkgewoJCQkJCXJlcGx5KG1lc3MuZmVycikKCQkJCX0KCQkJCWJyZWFrCgkJCWNhc2UgJ3F1ZWFuaW1lJzoKCQkJCWlmICgoaXNNZWRpYSAmJiAhc2FtLm1lc3NhZ2UudmlkZW9NZXNzYWdlIHx8IGlzUXVvdGVkSW1hZ2UpICYmIGFyZ3MubGVuZ3RoID09IDApIHsKCQkJCQlyZXBseShtZXNzLndhaXQpCgkJCQkJY29uc3QgZW5jbWVkaWEgPSBpc1F1b3RlZEltYWdlID8gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzYW0pLnJlcGxhY2UoJ3F1b3RlZE0nLCAnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8gOiBzYW0KCQkJCQltZWRpYSA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRNZWRpYU1lc3NhZ2UoZW5jbWVkaWEpCgkJCQkJYXdhaXQgd2FpdChtZWRpYSkudGhlbihyZXMgPT4gewoJCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIHJlcy52aWRlbywgdmlkZW8sIHsgcXVvdGVkOiBmdG9rbywgY2FwdGlvbjogcmVzLnRla3MudHJpbSgpIH0pCgkJCQkJfSkuY2F0Y2goZXJyID0+IHsKCQkJCQkJcmVwbHkoZXJyKQoJCQkJCX0pCgkJCQl9IGVsc2UgewoJCQkJCXJlcGx5KCdFbnZpYSBsYSBtYWdlbiBwYXJhIHBvZGVyIGJ1c2NhciBlbCBhbmltZScpCgkJCQl9CgkJCQlicmVhawoJCQkKCQkJCQljYXNlICdpdHNtZSc6CmNhc2UgJ3NveXlvJzoKICBpZiAoIWlzUmVnaXN0ZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkuZGFmdGFyQikKICB0cnkgewpwcGltZyA9IGF3YWl0IHNhbXUzMzAuZ2V0UHJvZmlsZVBpY3R1cmUoYCR7c2VuZGVyLnNwbGl0KCdAJylbMF19QGMudXNgKQogIH0gY2F0Y2ggewpwcGltZyA9ICdodHRwczovL2kwLndwLmNvbS93d3cuZ2FtYmFydW5pay5pZC93cC1jb250ZW50L3VwbG9hZHMvMjAxOS8wNi9Ub3AtR2FtYmFyLUZvdG8tUHJvZmlsLUtvc29uZy1MdWN1LVRlcmdva2lsLS5qcGcnCiAgfQogIHRla3MgPSBg4oCjICpOb21icmUqIDogJHtwdXNobmFtZX0KICDigKMgKk7Dum1lcm8qIDogJHtzZW5kZXIuc3BsaXQoIkAiKVswXX0KICDigKMgKkxpbmsqIDogd2EubWUvJHtzZW5kZXIuc3BsaXQoIkAiKVswXX1gCiAgaXRzID0gYXdhaXQgZ2V0QnVmZmVyIChwcGltZykKICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGl0cywgaW1hZ2UsIHsKcXVvdGVkOiBmbGl2ZUxvYywgY2FwdGlvbjogdGVrcywgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZX0KICB9KQogIAogIGJyZWFrCgkJICAgICBjYXNlICduaWxhaSc6CgkJCQkJCmNhc2UgJ3JhdGUnOgogIGlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybiByZXBseSgnRXNjcmliZSBlbCBub21icmUnKQogIHNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQogIGlmICghaXNSZWdpc3RlcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5kYWZ0YXJCKQogIHJhbmRvbSA9IGAke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCl9YAogIGhhc2lsID0gYFJhdGluZyA6ICoke2JvZHkuc2xpY2UoNil9KlxuXG5Qb3JjZW50YWplIDogKiR7cmFuZG9tfSUqYAogIHJlcGx5KGhhc2lsKQogIGJyZWFrCgkJCQkKCQkJCQkKCQkJCgkJCQkJCgkJCQkJY2FzZSAncGFzdGViaW4nOgppZiAoYXJncy5sZW5ndGggPCAxKSByZXR1cm4gcmVwbHkoJ0VzY3JpYmUgZWwgdGV4dG8gcXVlIHNlIG1vc3RyYXJhIGVuIHBhc3RlYmluLicpCglwYXN0ZSA9IGAke2FyZ3Muam9pbignICcpfWAKcmVwbHkobWVzcy53YWl0KQoJYW51ID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS1hbm9uY3liZmFrZXBsYXllci5oZXJva3VhcHAuY29tL3Bhc3RlYmluP3RleHQ9JHtwYXN0ZX1gLCB7bWV0aG9kOiAnZ2V0J30pCiAgICAgICAgc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBgJHthbnUucmVzdWx0fWAsIHRleHQsIHtxdW90ZWQ6IGZ0b2tvLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9fSkKICAgICAgICAgICAgICAgICAgIGJyZWFrCgpjYXNlICdhYmluYXJpbyc6CmlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybiByZXBseSgnRXNjcmliZSBlbCB0ZXh0byBhIGNvbnZlcnRpciBhIGNvZGlnbyBiaW5hcmlvLicpCgkJCWVuY2JpbmFyeSA9IGAke2FyZ3Muam9pbignICcpfWAKCQkJCQlhbnUgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vYXBpLmFub25jeWJmYWtlcGxheWVyLmNvbS9hcGkvYmluYXJ5Lz9lbmNvZGU9JHtlbmNiaW5hcnl9YCwge21ldGhvZDogJ2dldCd9KQoJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYCR7YW51LnJlc3VsdH1gLCB0ZXh0LCB7cXVvdGVkOiBmdG9rbywgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfX0pCgkJCQkJYnJlYWsKY2FzZSAnYmluYXRleHQnOgppZiAoYXJncy5sZW5ndGggPCAxKSByZXR1cm4gcmVwbHkoJ1BvcmZhdm9yLCBwZWdhIG8gZXNjcmliZSBlbCBjb2RpZ28gYmluYXJpbyBwYXJhIGNvbnZlcnRpciBhIHRleHRvLicpCgkJCQlkZWNiaW4gPSBgJHthcmdzLmpvaW4oJyAnKX1gCgkJCQkJYW51ID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS5hbm9uY3liZmFrZXBsYXllci5jb20vYXBpL2JpbmFyeS8/ZGVjb2RlPSR7ZGVjYmlufWAsIHttZXRob2Q6ICdnZXQnfSkKCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGAke2FudS5yZXN1bHR9YCwgdGV4dCwge3F1b3RlZDogZnRva28sIGNvbnRleHRJbmZvOiB7ImZvcndhcmRpbmdTY29yZSI6IDk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZX19KQoJCQkJCWJyZWFrCgpjYXNlICdhb2N0YWwnOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAppZiAoYXJncy5sZW5ndGggPCAxKSByZXR1cm4gcmVwbHkoJ0VzY3JpYmUgZWwgdGV4dG8gYSBjb252ZXJ0aXIgYSBjb2RpZ28gb2N0YWwuJykgICAgICAgICAKZW5jYmluYXJ5ID0gYCR7YXJncy5qb2luKCcgJyl9YAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW51ID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS5hbm9uY3liZmFrZXBsYXllci5jb20vYXBpL29jdGFsLz9lbmNvZGU9JHtlbmNiaW5hcnl9YCwge21ldGhvZDogJ2dldCd9KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCnNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYCR7YW51LnJlc3VsdH1gLCB0ZXh0LCB7cXVvdGVkOiBmdG9rbywgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfX0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawpjYXNlICdvY3RhbGF0ZXh0JzogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKaWYgKGFyZ3MubGVuZ3RoIDwgMSkgcmV0dXJuIHJlcGx5KCdQb3JmYXZvciwgcGVnYSBvIGVzY3JpYmUgZWwgY29kaWdvIG9jdGFsIHBhcmEgY29udmVydGlyIGEgdGV4dG8uJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWNiaW4gPSBgJHthcmdzLmpvaW4oJyAnKX1gICAgICAgICAgICAgICAgICAgICAgICAgCmFudSA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkuYW5vbmN5YmZha2VwbGF5ZXIuY29tL2FwaS9vY3RhbC8/ZGVjb2RlPSR7ZGVjYmlufWAsIHttZXRob2Q6ICdnZXQnfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYCR7YW51LnJlc3VsdH1gLCB0ZXh0LCB7cXVvdGVkOiBmdG9rbywgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfX0pCgkJYnJlYWsKCmNhc2UgJ2FoZXgnOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKaWYgKGFyZ3MubGVuZ3RoIDwgMSkgcmV0dXJuIHJlcGx5KCdFc2NyaWJlIGVsIHRleHRvIGEgY29udmVydGlyIGEgY29kaWdvIGhleC4nKSAgICAgIAplbmNiaW5hcnkgPSBgJHthcmdzLmpvaW4oJyAnKX1gICAgICAgICAgICAgICAgIAphbnUgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vYXBpLmFub25jeWJmYWtlcGxheWVyLmNvbS9hcGkvaGV4Lz9lbmNvZGU9JHtlbmNiaW5hcnl9YCwge21ldGhvZDogJ2dldCd9KQpzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGAke2FudS5yZXN1bHR9YCwgdGV4dCwge3F1b3RlZDogZnRva28sIGNvbnRleHRJbmZvOiB7ImZvcndhcmRpbmdTY29yZSI6IDk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZX19KSAgICAgICAgICAgICAgICAgICAgIApicmVhawpjYXNlICdoZXhhdGV4dCc6ICAgICAgICAgICAgICAgICAgICAgIAppZiAoYXJncy5sZW5ndGggPCAxKSByZXR1cm4gcmVwbHkoJ1BvcmZhdm9yLCBwZWdhIG8gZXNjcmliZSBlbCBjb2RpZ28gaGV4IHBhcmEgY29udmVydGlyIGEgdGV4dG8uJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWNiaW4gPSBgJHthcmdzLmpvaW4oJyAnKX1gICAgICAgICAgICAgICAgICAKYW51ID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS5hbm9uY3liZmFrZXBsYXllci5jb20vYXBpL2hleC8/ZGVjb2RlPSR7ZGVjYmlufWAsIHttZXRob2Q6ICdnZXQnfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYCR7YW51LnJlc3VsdH1gLCB0ZXh0LCB7cXVvdGVkOiBmdG9rbywgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfX0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawoJCQkJLy9jYXNlIGNyZWFkbyBwb3Igc2FtdQoJCQkJICAgY2FzZSAnZG9ya2luZyc6CgkJCSAgIAkJZG9yayA9IGAke2FyZ3Muam9pbignICcpfWAKCQkJCQlhbnUgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vYXBpLWFub25jeWJmYWtlcGxheWVyLmhlcm9rdWFwcC5jb20vZG9ya2luZz9kb3JrPSR7ZG9ya31gLCB7bWV0aG9kOiAnZ2V0J30pCgkJCQkJaGFzaWwgPSBgJHthbnUucmVzdWx0fWAKCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGhhc2lsLCB0ZXh0LCB7cXVvdGVkOiBmdG9rbywgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfX0pCgkJCQkJYnJlYWsKCQkJCQkKCQkJCQljYXNlICdpdG9yaSc6CgkJCQlyZXBseShtZXNzLndhaXQpCgkJCQkJYW51ID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS5mZGNpLnNlL3JlcC5waHA/Z2FtYmFyPWFuaW1lK2l0b3JpYCwge21ldGhvZDogJ2dldCd9KQoJCQkJCWl0ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhbnUpKTsKCQkJCQlvcmkgPSAgaXRbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogaXQubGVuZ3RoKV07CgkJCQkJbnllID0gYXdhaXQgZ2V0QnVmZmVyKG9yaSkKCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIG55ZSwgaW1hZ2UsIHsgY2FwdGlvbjogJ2l0b3JpIGNoYW4hIScsIHF1b3RlZDogZnRva28gfSkKCQkJCQljYXNlICdzYXN1a2UnOgoJCQkJcmVwbHkobWVzcy53YWl0KQoJCQkJCWFudSA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkuZmRjaS5zZS9yZXAucGhwP2dhbWJhcj1zYXN1a2VgLCB7bWV0aG9kOiAnZ2V0J30pCgkJCQkJc2FzdSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYW51KSk7CgkJCQkJa2UgPSAgc2FzdVtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBzYXN1Lmxlbmd0aCldOwoJCQkJCW55ZSA9IGF3YWl0IGdldEJ1ZmZlcihrZSkKCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIG55ZSwgaW1hZ2UsIHsgY2FwdGlvbjogJ3Nhc3VrZSEhJywgcXVvdGVkOiBmdG9rbyB9KQoJCQkJCWJyZWFrIAoJCQkJY2FzZSAnc2FrdXJhJzoKCQkJCXJlcGx5KG1lc3Mud2FpdCkKCQkJCQlhbnUgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vYXBpLmZkY2kuc2UvcmVwLnBocD9nYW1iYXI9c2FrdXJhYCwge21ldGhvZDogJ2dldCd9KQoJCQkJCXNhayA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYW51KSk7CgkJCQkJa3VyYSA9ICBzYWtbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogc2FrLmxlbmd0aCldOwoJCQkJCW55ZSA9IGF3YWl0IGdldEJ1ZmZlcihrdXJhKQoJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgbnllLCBpbWFnZSwgeyBjYXB0aW9uOiAnc2FrdXJhISEnLCBxdW90ZWQ6IGZ0b2tvIH0pCgkJCQkJYnJlYWsgCiAJCQkJCgkJCQljYXNlICdyaXplJzoKCQkJCXJlcGx5KG1lc3Mud2FpdCkKCQkJCQlhbnUgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vYXBpLmZkY2kuc2UvcmVwLnBocD9nYW1iYXI9YW5pbWUrcml6ZWAsIHttZXRob2Q6ICdnZXQnfSkKCQkJCQlyaSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYW51KSk7CgkJCQkJemUgPSAgcmlbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcmkubGVuZ3RoKV07CgkJCQkJbnllID0gYXdhaXQgZ2V0QnVmZmVyKHplKQoJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgbnllLCBpbWFnZSwgeyBjYXB0aW9uOiAncml6ZSBjaGFuISEnLCBxdW90ZWQ6IGZ0b2tvIH0pCgkJCQkJYnJlYWsgCgkJCQljYXNlICdha2lyYSc6CgkJCQlyZXBseShtZXNzLndhaXQpCgkJCQkJYW51ID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS5mZGNpLnNlL3JlcC5waHA/Z2FtYmFyPWFuaW1lK2FraXJhYCwge21ldGhvZDogJ2dldCd9KQoJCQkJCWFrID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhbnUpKTsKCQkJCQlhcmEgPSAgYWtbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogYWsubGVuZ3RoKV07CgkJCQkJbnllID0gYXdhaXQgZ2V0QnVmZmVyKGFyYSkKCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIG55ZSwgaW1hZ2UsIHsgY2FwdGlvbjogJ2FraXJhIGNoYW4hIScsIHF1b3RlZDogZnRva28gfSkKCQkJCQlicmVhayAKCQkJCQkgY2FzZSAnYW5pbWUnOgppZiAoIWlzUmVnaXN0ZXIpIHJldHVybiByZXBseShtZXNzLm9ubHkuZGFmdGFyQikKCnNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQphbSA9IFsiYW5pbWUgdHVtYmxyIiwKICAid2FsbHBhcGVyIGFuaW1lIGhkIiwKICAiYW5pbWUgYWVzdGV0aGljIiwKICAiYW5pbWUgaGQiXQpuayA9IGFtW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGFtLmxlbmd0aCldCmRhdGEgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vYXBpLmZkY2kuc2Uvc29zbWVkL3JlcC5waHA/Z2FtYmFyPSR7bmt9YCwgewogIG1ldGhvZDogJ2dldCcKfSkKcmVwbHkobWVzcy53YWl0KQpuID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkYXRhKSk7Cm5pbWVrID0gbltNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBuLmxlbmd0aCldOwpwb2sgPSBhd2FpdCBnZXRCdWZmZXIobmltZWspCnNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgcG9rLCBpbWFnZSwgewogIHF1b3RlZDogZmltZywgY2FwdGlvbjogYOKYlWAsIGNvbnRleHRJbmZvOiB7ImZvcndhcmRpbmdTY29yZSI6IDk5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9Cn0pCgpicmVhawoKLy8qKioqKioqKipQaW50ZXJlc3Qgd2FsbHBhcGVyCiAgY2FzZSAnd3AnOgpjYXNlICd3YWxscGFwZXInOgogIGlmICghaXNSZWdpc3RlcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5kYWZ0YXJCKQogIAogIHNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKQogIHB3ID0gWyJ3YWxscGFwZXIgYWVzdGV0aGljIiwKIndhbGxwYXBlciB0dW1ibHIiLAoid2FsbHBhcGVyIGx1Y3UiLAoid2FsbHBhcGVyIGdhdGl0b3MiLAoid2FsbHBhcGVyIl0KICBuayA9IHB3W01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHB3Lmxlbmd0aCldCiAgdHJ5IHsKICBkYXRhID0gYXdhaXQgZmV0Y2hKc29uKGBodHRwczovL2FwaS5mZGNpLnNlL3Nvc21lZC9yZXAucGhwP2dhbWJhcj0ke25rfWAsIHsKbWV0aG9kOiAnZ2V0JwogIH0pCiAgcmVwbHkobWVzcy53YWl0KQogIG4gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGRhdGEpKTsKICBuaW1layA9IG5bTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogbi5sZW5ndGgpXTsKICBwb2sgPSBhd2FpdCBnZXRCdWZmZXIobmltZWspCiAgc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBwb2ssIGltYWdlLCB7CnF1b3RlZDogZmltZywgY2FwdGlvbjogYOKYlWAsIGNvbnRleHRJbmZvOiB7ImZvcndhcmRpbmdTY29yZSI6IDk5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9CiAgfSkKICAKICB9IGNhdGNoIHsKICAgIHJlcGx5KG1lc3MuZmVycikKICB9CiAgYnJlYWsgCgkJCQljYXNlICduYXJ1dG8nOgoJCQkJcmVwbHkobWVzcy53YWl0KQoJCQkJCWFudSA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkuZmRjaS5zZS9yZXAucGhwP2dhbWJhcj1OYXJ1dG9gLCB7bWV0aG9kOiAnZ2V0J30pCgkJCQkJbmFydSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYW51KSk7CgkJCQkJdG8gPSAgbmFydVtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBuYXJ1Lmxlbmd0aCldOwoJCQkJCW55ZSA9IGF3YWl0IGdldEJ1ZmZlcih0bykKCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIG55ZSwgaW1hZ2UsIHsgY2FwdGlvbjogJ25hcnV0byEhJywgcXVvdGVkOiBmdG9rbyB9KQoJCQkJCWJyZWFrIAoJCQkJY2FzZSAnbWluYXRvJzoKCQkJCXJlcGx5KG1lc3Mud2FpdCkKCQkJCQlhbnUgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vYXBpLmZkY2kuc2UvcmVwLnBocD9nYW1iYXI9TWluYXRvYCwge21ldGhvZDogJ2dldCd9KQoJCQkJCW1pbiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYW51KSk7CgkJCQkJYXRvID0gIG1pbltNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBtaW4ubGVuZ3RoKV07CgkJCQkJbnllID0gYXdhaXQgZ2V0QnVmZmVyKGF0bykKCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIG55ZSwgaW1hZ2UsIHsgY2FwdGlvbjogJ21pbmF0byEhJywgcXVvdGVkOiBmdG9rbyB9KQoJCQkJCWJyZWFrIAoJCQkJY2FzZSAnYm9ydXRvJzoKCQkJCXJlcGx5KG1lc3Mud2FpdCkKCQkJCQlhbnUgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vYXBpLmZkY2kuc2UvcmVwLnBocD9nYW1iYXI9Ym9ydXRvYCwge21ldGhvZDogJ2dldCd9KQoJCQkJCWJvciA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYW51KSk7CgkJCQkJdXRvID0gIGJvcltNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBib3IubGVuZ3RoKV07CgkJCQkJbnllID0gYXdhaXQgZ2V0QnVmZmVyKHV0bykKCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIG55ZSwgaW1hZ2UsIHsgY2FwdGlvbjogJ2JvcnV0byEhJywgcXVvdGVkOiBmdG9rbyB9KQoJCQkJCWJyZWFrIAoJCQkJY2FzZSAnaGluYXRhJzoKCQkJCXJlcGx5KG1lc3Mud2FpdCkKCQkJCQlhbnUgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vYXBpLmZkY2kuc2UvcmVwLnBocD9nYW1iYXI9SGluYXRhYCwge21ldGhvZDogJ2dldCd9KQoJCQkJCWhpbmEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGFudSkpOwoJCQkJCXRhID0gIGhpbmFbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogaGluYS5sZW5ndGgpXTsKCQkJCQlueWUgPSBhd2FpdCBnZXRCdWZmZXIodGEpCgkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBueWUsIGltYWdlLCB7IGNhcHRpb246ICdoaW5hdGEhIScsIHF1b3RlZDogZnRva28gfSkKCQkJCQlicmVhawoJCQkJCWNhc2UgJ2xldmknOgoJCQkJcmVwbHkobWVzcy53YWl0KQoJCQkJCWFudSA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly9hcGkuZmRjaS5zZS9yZXAucGhwP2dhbWJhcj1sZXZpK2Fja2VybWFuYCwge21ldGhvZDogJ2dldCd9KQoJCQkJCWxldmkgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGFudSkpOwoJCQkJCWFja2VybWFuID0gIGxldmlbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogbGV2aS5sZW5ndGgpXTsKCQkJCQlueWUgPSBhd2FpdCBnZXRCdWZmZXIoYWNrZXJtYW4pCgkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBueWUsIGltYWdlLCB7IGNhcHRpb246ICdsZXZpISEnLCBxdW90ZWQ6IGZ0b2tvIH0pCgkJCQkJYnJlYWsKCQkJCQljYXNlICdlcmVuJzoKCQkJCXJlcGx5KG1lc3Mud2FpdCkKCQkJCQlhbnUgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vYXBpLmZkY2kuc2UvcmVwLnBocD9nYW1iYXI9ZXJlbit5ZWFnZXJgLCB7bWV0aG9kOiAnZ2V0J30pCgkJCQkJZXIgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGFudSkpOwoJCQkJCWVuID0gIGVyW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGVyLmxlbmd0aCldOwoJCQkJCW55ZSA9IGF3YWl0IGdldEJ1ZmZlcihlbikKCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIG55ZSwgaW1hZ2UsIHsgY2FwdGlvbjogJ2VyZW4hIScsIHF1b3RlZDogZnRva28gfSkKCQkJCQlicmVhawoJCQkKY2FzZSAnYml0bHknOgoJCQkJCgkJc2FtdTMzMC51cGRhdGVQcmVzZW5jZShmcm9tLCBQcmVzZW5jZS5jb21wb3NpbmcpIAogICAgICAgICAgICAgICAgZGF0YSA9IGF3YWl0IGZldGNoSnNvbihgaHR0cHM6Ly90b2J6LWFwaS5oZXJva3VhcHAuY29tL2FwaS9iaXRseT91cmw9JHthcmdzLmpvaW4oJyAnKX0mYXBpa2V5PUJvdFdlQWApCiAgICAgICAgICAgICAgICBoYXNpbCA9IGBsaW5rIDogJHthcmdzLmpvaW4oJyAnKX1cblxuT3V0cHV0IDogJHtkYXRhLnJlc3VsdH1gCiAgICAgICAgICAgICAgICByZXBseShoYXNpbCkKICAgICAgICAgICAgICAgIC8vCiAgICAgICAgICAgICAgICBicmVhawpjYXNlICd0ZW1wbyc6CiAgIHZhciByZXEgPSBhcmdzLmpvaW4oJyAnKSAgICAgICAgICAgIAoJCQkJCWVuY21lZGlhID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzYW0pLnJlcGxhY2UoJ3F1b3RlZE0nLCdtJykpLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mbwoJCQkJCW1lZGlhID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZEFuZFNhdmVNZWRpYU1lc3NhZ2UoZW5jbWVkaWEpCgkJCQkJcmFuID0gZ2V0UmFuZG9tKCcubXAzJykKCQkJCQlleGVjKGBmZm1wZWcgLWkgJHttZWRpYX0gLWZpbHRlcjphICJhdGVtcG89MS4wLGFzZXRyYXRlPSR7cmVxfSIgJHtyYW59YCwgKGVyciwgc3RkZXJyLCBzdGRvdXQpID0+IHsKCQkJCQkJZnMudW5saW5rU3luYyhtZWRpYSkKCQkJCQkJaWYgKGVycikgcmV0dXJuIHJlcGx5KCdFcnJvciEnKQoJCQkJCQloYWggPSBmcy5yZWFkRmlsZVN5bmMocmFuKQoJCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGhhaCwgYXVkaW8sIHttaW1ldHlwZTogJ2F1ZGlvL21wNCcsIHB0dDp0cnVlLCBxdW90ZWQ6IGZ0b2tvfSkKCQkJCQkJZnMudW5saW5rU3luYyhyYW4pCgkJCQkJfSkKCQkJCWJyZWFrCgkJCQljYXNlICd0ZW1wby12JzoKICAgdmFyIHJlcSA9IGFyZ3Muam9pbignICcpICAgICAgICAgICAgCgkJCQkJZW5jbWVkaWEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkucmVwbGFjZSgncXVvdGVkTScsJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvCgkJCQkJbWVkaWEgPSBhd2FpdCBzYW11MzMwLmRvd25sb2FkQW5kU2F2ZU1lZGlhTWVzc2FnZShlbmNtZWRpYSkKCQkJCQlyYW4gPSBnZXRSYW5kb20oJy5tcDQnKQoJCQkJCWV4ZWMoYGZmbXBlZyAtaSAke21lZGlhfSAtZmlsdGVyOmEgImF0ZW1wbz0xLjAsYXNldHJhdGU9JHtyZXF9IiAke3Jhbn1gLCAoZXJyLCBzdGRlcnIsIHN0ZG91dCkgPT4gewoJCQkJCQlmcy51bmxpbmtTeW5jKG1lZGlhKQoJCQkJCQlpZiAoZXJyKSByZXR1cm4gcmVwbHkoJ0Vycm9yIScpCgkJCQkJCWhhaCA9IGZzLnJlYWRGaWxlU3luYyhyYW4pCgkJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgaGFoLCB2aWRlbywgeyBtaW1ldHlwZTogJ3ZpZGVvL21wNCcsIHF1b3RlZDogZnRva28gfSkKfSkKCQkJCWJyZWFrCgkJCQljYXNlICdtZmlyZSc6CgkJCQkgICBpZiAoYXJncy5sZW5ndGggPCAxKSByZXR1cm4gcmVwbHkoJ1kgZWwgbGluayBkZSBtZWRpYWZpcmU/JykKCQkJCSAgIHZhciBsaW5rID0gYXJncy5qb2luKCcgJykKCQkJCXNhbXUzMzAudXBkYXRlUHJlc2VuY2UoZnJvbSwgUHJlc2VuY2UuY29tcG9zaW5nKSAKICAgICAgICAgICAgICAgIGRhdGEgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vdmlkZWZpa3JpLmNvbS9hcGkvbWVkaWFmaXJlLz9xdWVyeT0ke2xpbmt9YCkKCQlzbXlwZXJyeSA9IGF3YWl0IGdldEJ1ZmZlcihkYXRhLnJlc3VsdC5kb3dubG9hZCkKICAgICAgICAgICAgICAgIGhhc2lsID0gYGxpbmsgOiAke2xpbmt9XG5cbipTSSBOTyBTRSBFTlZJQSBFTCBBUkNISVZPLCBPIFNJIFNFIEVOVklBIENPTiBFUlJPUkVTLCBQVUVERSBUT0NBUiBFTCBFTkxBQ0UgREUgQUJBSk8gWSBTVSBERVNDQVJHQSBJTklDSUFSQSBBTCBJTlNUQU5URSogOiAke2RhdGEucmVzdWx0LmRvd25sb2FkfWAKICAgICAgICAgICAgICAgIHJlcGx5KGhhc2lsKQoJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgc215cGVycnksIGRvY3VtZW50LCB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAoJCQltaW1ldHlwZTogJ2ZpbGUnLCBmaWxlbmFtZTogYCR7ZGF0YS5yZXN1bHQuZmlsZW5hbWV9YCwgcXVvdGVkOiBmZG9jCiAgfSkJCiAgICAgICAgICAgICAgICAvLwogICAgICAgICAgCmNhc2UgJz4nOgp2YXIga29uc29sID0gYXJncy5qb2luKCcgJykKZnVuY3Rpb24gc2VuZFJlc3VsdChzdWwpIHsKdmFyIHNhdCA9IEpTT04uc3RyaW5naWZ5KHN1bCwgbnVsbCwgMikKdmFyIGJhbmcgPSB1dGlsLmZvcm1hdChzYXQpCnJldHVybiByZXBseShiYW5nKQp9CnJlcGx5KHV0aWwuZm9ybWF0KGV2YWwoYDsoYXN5bmMgKCkgPT4geyAke2tvbnNvbH0gfSkoKWApKSkKYnJlYWsKCQkJCWNhc2UgJ2Zhc3QnOgoJCQkJCWVuY21lZGlhID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzYW0pLnJlcGxhY2UoJ3F1b3RlZE0nLCdtJykpLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mbwoJCQkJCW1lZGlhID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZEFuZFNhdmVNZWRpYU1lc3NhZ2UoZW5jbWVkaWEpCgkJCQkJcmFuID0gZ2V0UmFuZG9tKCcubXAzJykKCQkJCQlleGVjKGBmZm1wZWcgLWkgJHttZWRpYX0gLWZpbHRlcjphICJhdGVtcG89MS4zLGFzZXRyYXRlPTQzMDAwIiAke3Jhbn1gLCAoZXJyLCBzdGRlcnIsIHN0ZG91dCkgPT4gewoJCQkJCQlmcy51bmxpbmtTeW5jKG1lZGlhKQoJCQkJCQlpZiAoZXJyKSByZXR1cm4gcmVwbHkoJ0Vycm9yIScpCgkJCQkJCWhhaCA9IGZzLnJlYWRGaWxlU3luYyhyYW4pCgkJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgaGFoLCBhdWRpbywge21pbWV0eXBlOiAnYXVkaW8vbXA0JywgcHR0OnRydWUsIHF1b3RlZDogZnRva299KQoJCQkJCQlmcy51bmxpbmtTeW5jKHJhbikKCQkJCQl9KQoJCQkJCWJyZWFrCgoJCQkgIAoJCQkKCQkJCQkKCQkJCQljYXNlICd0aWt0b2QnOgoJCQkJCXZhciBnaCA9IGFyZ3Muam9pbignICcpCgkJCQkJdmFyIGdsaSA9IGdoLnNwbGl0KCJ8IilbMF07CgkJCQkJdmFyIHRjaCA9IGdoLnNwbGl0KCJ8IilbMV07CgkJCQkJaWYgKGFyZ3MubGVuZ3RoIDwgMSkgcmV0dXJuIHJlcGx5KGDjgIzinZfjgI1Db250b2ggOiAke3ByZWZpeH1nbGl0Y2h0ZXh0IHRlc3R8dGVzdGApCgkJCQkJYnVmZmVyID0gYXdhaXQgZ2V0QnVmZmVyKGBodHRwczovL2FwaS54dGVhbS54eXovdGV4dHByby9nbGl0Y2g/dGV4dD0ke2dsaX0mdGV4dDI9JHt0Y2h9JkFQSUtFWT0ke1h0ZWFtS2V5fWApCgkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBidWZmZXIsIGltYWdlLCB7cXVvdGVkOiBmdG9rbywgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfX0pCgkJCQkJLy8KCQkJCQlicmVhawoJCQkJCQkKCQkgICAgY2FzZSAnY21kJzoKCQkJCXZhciB0ZWtzID0gZW5jb2RlVVJJQ29tcG9uZW50KGFyZ3Muam9pbignICcpKQoJCQkJaWYgKCF0ZWtzKSByZXR1cm4gc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCAgbXNnVHlwZS50ZXh0LCB7IHF1b3RlZDogZmFrZVByb2R1Y3QgfSkKCQkJCXZhciBidWZmZXIgID0gYXdhaXQgIGdldEJ1ZmZlcihgaHR0cHM6Ly9hcGktcnVsbC5oZXJva3VhcHAuY29tL2FwaS9jbWQ/Y29kZT0ke3Rla3N9YCkKCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYnVmZmVyLCBpbWFnZSkKCQlicmVhawoKCQkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCgkJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAoJCQkJCgpjYXNlICdhdHRwJzoKCQkJCQlpZiAoYXJncy5sZW5ndGggPCAxKSByZXR1cm4gcmVwbHkoJ1kgZWwgdGV4dG8/JykKCQkJCQl2YXIgdGVrcyA9IGVuY29kZVVSSUNvbXBvbmVudChhcmdzLmpvaW4oJyAnKSkKCQkJCQljb25zdCBhdHRwID0gYXdhaXQgZ2V0QnVmZmVyKGBodHRwczovL2FwaS54dGVhbS54eXovYXR0cD9maWxlJnRleHQ9JHt0ZWtzfWApCgkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBhdHRwLCBzdGlja2VyLCB7cXVvdGVkOiBmdG9rbywgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfX0pCgkJCQkJYnJlYWsKY2FzZSAndHRwJzoKCQkJCQlpZiAoYXJncy5sZW5ndGggPCAxKSByZXR1cm4gcmVwbHkoJ1kgZWwgdGV4dG8/JykKCQkJCQl2YXIgdGVrcyA9IGVuY29kZVVSSUNvbXBvbmVudChhcmdzLmpvaW4oJyAnKSkKCQkJCQljb25zdCB0dHAgPSBhd2FpdCBnZXRCdWZmZXIoYGh0dHBzOi8vYXBpLnh0ZWFtLnh5ei90dHA/ZmlsZSZ0ZXh0PSR7dGVrc31gKQoJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgdHRwLCBzdGlja2VyLCB7cXVvdGVkOiBmdG9rbywgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfX0pCgkJCQkJYnJlYWsKCQkJCQljYXNlICdmb3J3YXJkJzoKCQkJCQkgY2FzZSAnZncnOgpzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGAke2FyZ3Muam9pbignICcpfWAsIE1lc3NhZ2VUeXBlLnRleHQsIHtjb250ZXh0SW5mbzogeyBmb3J3YXJkaW5nU2NvcmU6IDIxMCwgaXNGb3J3YXJkZWQ6IHRydWUgfX0pCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIAkJCQkvL2Nhc2UgY3JlYWRvIHBvciBzYW11CgpjYXNlICdhbnRpbWVkaWEnOiAgICAgICAgICAgICAgICAKaWYgKCFpc0dyb3VwKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5Lmdyb3VwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0dyb3VwQWRtaW5zKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmFkbWluKSAgICAgCmlmICghaXNCb3RHcm91cEFkbWlucykgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5CYWRtaW4pCmlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybiByZXBseSgnRXNjcmliZSAqMSogcGFyYSBhY3RpdmFyJykgICAgICAgICAgCmlmIChhcmdzWzBdID09PSAnMScpIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKCWlmIChpc0FudGlNZWRpYSkgcmV0dXJuIHJlcGx5KCcqWWEgZXN0w6EgYWN0aXZvKicpICAgICAgICAgIAoJYW50aW1lZGlhLnB1c2goZnJvbSkgICAgICAgICAgICAgICAgICAgICAgICAgIAoJZnMud3JpdGVGaWxlU3luYygnLi9zcmMvYW50aW1lZGlhLmpzb24nLCBKU09OLnN0cmluZ2lmeShhbnRpbWVkaWEpKSAgICAgIAoJcmVwbHkoYCpbIEFjdGl2YWRvIF0qYCkgIAoJcmVwbHkoYCpMYSBwZXJzb25hIHF1ZSBlbnZpZSBmb3RvcyBvIHZpZGVvcyBzZXJhIGVsaW1pbmFkYSpgKSAgCn0gZWxzZSBpZiAoYXJnc1swXSA9PT0gJzAnKSB7ICAgICAgICAgICAgIAoJdmFyIGluaSA9IGFudGltZWRpYS5pbmRleE9mKGZyb20pCglhbnRpbWVkaWEuc3BsaWNlKGluaSwgMSkgICAgICAgICAgIAoJZnMud3JpdGVGaWxlU3luYygnLi9zcmMvYW50aW1lZGlhLmpzb24nLCBKU09OLnN0cmluZ2lmeShhbnRpbWVkaWEpKSAgICAgICAKCXJlcGx5KGBEZXNhY3RpdmFkb2ApICAgICAgICAgICAgICAKfSBlbHNlIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAoJcmVwbHkoJzEgcGFyYSBhY3RpdmFyLCAwIHBhcmEgZGVzYWN0aXZhcicpICAgICAgICAgICAKfSAgICAgICAgICAgCmJyZWFrCmNhc2UgJysxOCc6ICAgICAgICAgICAgICAgIAppZiAoIWlzR3JvdXApIHJldHVybiByZXBseShtZXNzLm9ubHkuZ3JvdXApCmlmICghaXNHcm91cEFkbWlucykgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5hZG1pbikgICAgIAoKaWYgKGFyZ3MubGVuZ3RoIDwgMSkgcmV0dXJuIHJlcGx5KCdFc2NyaWJlICoxKiBwYXJhIGFjdGl2YXInKSAgICAgICAgICAKaWYgKGFyZ3NbMF0gPT09ICcxJykgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAoJaWYgKGlzTnNmdykgcmV0dXJuIHJlcGx5KCcqWWEgZXN0w6EgYWN0aXZvKicpICAgICAgICAgIAoJbnNmdy5wdXNoKGZyb20pICAgICAgICAgICAgICAgICAgICAgICAgICAKCWZzLndyaXRlRmlsZVN5bmMoJy4vc3JjL25zZncuanNvbicsIEpTT04uc3RyaW5naWZ5KG5zZncpKSAgICAgIAoJcmVwbHkoYCpbIEFjdGl2YWRvIF0qYCkgICAKfSBlbHNlIGlmIChhcmdzWzBdID09PSAnMCcpIHsgICAgICAgICAgICAgCgl2YXIgaW5pID0gbnNmdy5pbmRleE9mKGZyb20pCgluc2Z3LnNwbGljZShpbmksIDEpICAgICAgICAgICAKCWZzLndyaXRlRmlsZVN5bmMoJy4vc3JjL25zZncuanNvbicsIEpTT04uc3RyaW5naWZ5KG5zZncpKSAgICAgICAKCXJlcGx5KGBEZXNhY3RpdmFkb2ApICAgICAgICAgICAgICAKfSBlbHNlIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAoJcmVwbHkoJzEgcGFyYSBhY3RpdmFyLCAwIHBhcmEgZGVzYWN0aXZhcicpICAgICAgICAgICAKfSAgICAgICAgICAgCmJyZWFrCi8vYnkgU20zMzAKY2FzZSAnYXV0b3N0aWNrJzogICAgICAgICAgICAKaWYgKCFpc0dyb3VwKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5Lmdyb3VwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0dyb3VwQWRtaW5zKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmFkbWluKSAgICAgCmlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybiByZXBseSgnRXNjcmliZSAqMSogcGFyYSBhY3RpdmFyJykgICAgICAgICAgICAgICAgICAgIAppZiAoYXJnc1swXSA9PT0gJzEnKSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKCWlmIChpc0F1dG9TdCkgcmV0dXJuIHJlcGx5KCcqWWEgZXN0w6EgYWN0aXZvKicpICAgICAgICAgIAoJYXV0b3N0aWNrLnB1c2goZnJvbSkgICAgICAgICAgICAgCglmcy53cml0ZUZpbGVTeW5jKCcuL3NyYy9hdXRvc3RpY2suanNvbicsIEpTT04uc3RyaW5naWZ5KGF1dG9zdGljaykpICAgICAgCglyZXBseShgKlsgQWN0aXZhZG8gXSpgKSAgCglyZXBseShgKmFob3JhLCB0b2RhcyBsYXMgZm90b3MgcXVlIHNlIGVudmllbiBlbiBlbCBncnVwbyBzZSBjb252ZXJ0aXJhbiBlbiBzdGlja2VyIGF1dG9tYXRpY2FtZW50ZSpgKSAgCn0gZWxzZSBpZiAoYXJnc1swXSA9PT0gJzAnKSB7ICAgICAgICAgICAKCXZhciBpbmkgPSBhdXRvc3RpY2suaW5kZXhPZihmcm9tKQoJYXV0b3N0aWNrLnNwbGljZShpbmksIDEpICAgICAgICAgICAgICAgICAgCglmcy53cml0ZUZpbGVTeW5jKCcuL3NyYy9hdXRvc3RpY2suanNvbicsIEpTT04uc3RyaW5naWZ5KGF1dG9zdGljaykpICAgICAgCglyZXBseShgRGVzYWN0aXZhZG9gKSAgICAgICAgICAgICAgCn0gZWxzZSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKCXJlcGx5KCcxIHBhcmEgYWN0aXZhciwgMCBwYXJhIGRlc2FjdGl2YXInKSAgICAgICAgCn0gICAgICAgICAgICAgICAgICAgICAgICAgIApicmVhawoJCQkJCQoJCQljYXNlICdhbnRpYmFkJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNHcm91cCkgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5ncm91cCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNHcm91cEFkbWlucykgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5hZG1pbikKCQkJCQlpZiAoIWlzQm90R3JvdXBBZG1pbnMpIHJldHVybiByZXBseShtZXNzLm9ubHkuQmFkbWluKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoIDwgMSkgcmV0dXJuIHJlcGx5KCdFc2NyaWJlICoxKiBwYXJhIGFjdGl2YXInKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFyZ3NbMF0gPT09ICcxJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNCYWRXb3JkKSByZXR1cm4gcmVwbHkoJypZYSBlc3TDoSBhY3Rpdm8qJykKICAgICAgICAgICAgICAgICAJICAgICAgICAgICAgICAgICAgICAgICAgYmFkd29yZC5wdXNoKGZyb20pCiAgICAgICAgICAgICAgICAgCSAgICAgICAgICAgICAgICAgICAgICAgIGZzLndyaXRlRmlsZVN5bmMoJy4vc3JjL2JhZHdvcmQuanNvbicsIEpTT04uc3RyaW5naWZ5KGJhZHdvcmQpKQogICAgICAgICAgICAgICAgICAJICAgICAgICAgICAgICAgICAgICAgICAgcmVwbHkoYCpbIEFjdGl2YWRvIF0qYCkKCQkJCQkJcmVwbHkoYCpMYXMgcGVyc29uYXMgcXVlIGVudmllbiB1bmEgbWFsYSBwYWxhYnJhIHNlcmEgZWxpbWluYWRhKi4gX1BhcmEgdmVyIGxhIGxpc3RhIGRlIG1hbGFzIHBhbGFicmFzIHVzYSBlbCBjb21hbmRvOiBsaXN0YmFkX2ApICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYXJnc1swXSA9PT0gJzAnKSB7CiAgICAgICAgICAgICAgICAgIAkgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5pID0gYW50aWJhZC5pbmRleE9mKGZyb20pCgkJCQkJCWJhZHdvcmQuc3BsaWNlKGluaSwgMSkKICAgICAgICAgICAgICAgICAJICAgICAgICAgICAgICAgICAgICAgICAgZnMud3JpdGVGaWxlU3luYygnLi9zcmMvYmFkd29yZC5qc29uJywgSlNPTi5zdHJpbmdpZnkoYmFkd29yZCkpCiAgICAgICAgICAgICAgICAgCSAgICAgICAgICAgICAgICAgICAgICAgIHJlcGx5KGBEZXNhY3RpdmFkb2ApCiAgICAgICAgICAgICAJICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAJICAgICAgICAgICAgICAgICAgICAgICAgcmVwbHkoJzEgcGFyYSBhY3RpdmFyLCAwIHBhcmEgZGVzYWN0aXZhcicpCiAgICAgICAgICAgICAgICAJICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYWRkYmFkJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNPd25lcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5vd25lckIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzR3JvdXBBZG1pbnMpIHJldHVybiByZXBseShtZXNzLm9ubHkuYWRtaW4pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPCAxKSByZXR1cm4gcmVwbHkoIGBFc2NyaWJlICR7cHJlZml4fWFkZGJhZCBbcGFsYWJyYV0uIEVqZW1wbG86ICR7cHJlZml4fWFkZGJhZCBwdG9gKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYncgPSBib2R5LnNsaWNlKDEyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFkLnB1c2goYncpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcy53cml0ZUZpbGVTeW5jKCcuL3NyYy9iYWQuanNvbicsIEpTT04uc3RyaW5naWZ5KGJhZCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBseSgnU2UgYcOxYWRpbyBjb24gZXhpdG8nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdkZWxiYWQnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc093bmVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5Lm93bmVyQikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNHcm91cEFkbWlucykgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5hZG1pbikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybiByZXBseSggYEVzY3JpYmUgJHtwcmVmaXh9ZGVsYmFkIFtwYWxhYnJhXS4gRWplbXBsbzogJHtwcmVmaXh9ZGVsYmFkIGJlZ29gKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRidyA9IGJvZHkuc2xpY2UoMTIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWQuc3BsaWNlKGRidykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZzLndyaXRlRmlsZVN5bmMoJy4vc3JjL2JhZC5qc29uJywgSlNPTi5zdHJpbmdpZnkoYmFkKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGx5KCdTZSBxdWl0byBjb24gZXhpdG8nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbGlzdGJhZCc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbGJ3ID0gYExpc3RhIGRlIEJBRCBXT1JEXG5Ub3RhbCA6ICR7YmFkLmxlbmd0aH1cbmAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgb2YgYmFkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxidyArPSBg4pemICR7aS5yZXBsYWNlKGJhZCl9XG5gCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCByZXBseShsYncpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawoKCgkJCQljYXNlICd3ZWxjb21lJzoKCQkJCQlpZiAoIWlzR3JvdXApIHJldHVybiByZXBseShtZXNzLm9ubHkuZ3JvdXApCgkJCQkJaWYgKCFpc0dyb3VwQWRtaW5zKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmFkbWluKQoJCQkJCWlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybiByZXBseSgnPycpCgkJCQkJaWYgKE51bWJlcihhcmdzWzBdKSA9PT0gMSkgewoJCQkJCQlpZiAoaXNXZWxrb20pIHJldHVybiByZXBseSgnWWEgZXN0YSBhY3Rpdm8nKQoJCQkJCQl3ZWxrb20ucHVzaChmcm9tKQoJCQkJCQlmcy53cml0ZUZpbGVTeW5jKCcuL3NyYy93ZWxrb20uanNvbicsIEpTT04uc3RyaW5naWZ5KHdlbGtvbSkpCgkJCQkJCXJlcGx5KCdTZSBhY3Rpdm8gY29uIGV4aXRvJykKCQkJCQl9IGVsc2UgaWYgKE51bWJlcihhcmdzWzBdKSA9PT0gMCkgewoJCQkJCQl3ZWxrb20uc3BsaWNlKGZyb20sIDEpCgkJCQkJCWZzLndyaXRlRmlsZVN5bmMoJy4vc3JjL3dlbGtvbS5qc29uJywgSlNPTi5zdHJpbmdpZnkod2Vsa29tKSkKCQkJCQkJcmVwbHkoJ1NlIGRlc2FjdGl2byBjb24gZXhpdG8nKQoJCQkJCX0gZWxzZSB7CgkJCQkJCXJlcGx5KCcxIHBhcmEgYWN0aXZhciwgMCBkZXNhY3RpdmFyJykKCQkJCQl9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKCgoJCQkJY2FzZSAnYW50aWxpbmsnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAlpZiAoIWlzR3JvdXApIHJldHVybiByZXBseShtZXNzLm9ubHkuZ3JvdXApCgkJCQkJaWYgKCFpc0dyb3VwQWRtaW5zKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmFkbWluKQoJCQkJCWlmICghaXNCb3RHcm91cEFkbWlucykgcmV0dXJuIHJlcGx5KG1lc3Mub25seS5CYWRtaW4pCgkJCQkJaWYgKGFyZ3MubGVuZ3RoIDwgMSkgcmV0dXJuIHJlcGx5KCdlc2NyaWJhICoxKiBwYXJhIGFjdGl2YXInKQoJCQkJCWlmIChhcmdzWzBdID09PSAnMScpIHsKCQkJCQkJaWYgKGlzQW50aUxpbmspIHJldHVybiByZXBseSgnWWEgZXN0YSBhY3Rpdm8nKQoJCQkJCQlhbnRpbGluay5wdXNoKGZyb20pCgkJCQkJCWZzLndyaXRlRmlsZVN5bmMoJy4vc3JjL2FudGlsaW5rLmpzb24nLCBKU09OLnN0cmluZ2lmeShhbnRpbGluaykpCgkJCQkJCXJlcGx5KCcqQW50aS1saW5rIGFjdGl2YWRvIOKclO+4jyonKQoJCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sYExvcyBtaWVtYnJvcyBxdWUgbWFuZGVuIHVuIGxpbmsgc2Vyw6FuIGVsaW1pbmFkb3MsICpPSk8qIF9DVUxBUVVJRVIgVElQTyBERSBMSU5LX2AsIHRleHQpCgkJCQkJfSBlbHNlIGlmICgoYXJnc1swXSkgPT09ICcwJykgewoJCQkJCQl2YXIgaW5pID0gYW50aWxpbmsuaW5kZXhPZihmcm9tKQoJCQkJCQlhbnRpbGluay5zcGxpY2UoaW5pLCAxKQoJCQkJCQlmcy53cml0ZUZpbGVTeW5jKCcuL3NyYy9hbnRpbGluay5qc29uJywgSlNPTi5zdHJpbmdpZnkoYW50aWxpbmspKQoJCQkJCQlyZXBseSgnQW50aS1saW5rIGRlc2FjdGl2YWRvIOKclO+4jycpCgkJCQkJfSBlbHNlIHsKCQkJCQkJcmVwbHkoJyoxIHBhcmEgYWN0aXZhciwgMCBwYXJhIGRlc2FjdGl2YXIqJykKCQkJCQl9CgkJCQkJYnJlYWsKCgoJCQkJY2FzZSAnc2ltc2ltaSc6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzR3JvdXApIHJldHVybiByZXBseShtZXNzLm9ubHkuZ3JvdXApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzR3JvdXBBZG1pbnMpIHJldHVybiByZXBseShtZXNzLm9ubHkuYWRtaW4pICAgICAgICAKCQkJCQlpZiAoIWlzQm90R3JvdXBBZG1pbnMpIHJldHVybiByZXBseShtZXNzLm9ubHkuQmFkbWluKSAgICAKCQkJCQlpZiAoYXJncy5sZW5ndGggPCAxKSByZXR1cm4gcmVwbHkoJ2VzY3JpYmEgKjEqIHBhcmEgYWN0aXZhcicpICAgICAgICAKCQkJCQlpZiAoYXJnc1swXSA9PT0gJzEnKSB7ICAgICAgICAgICAgICAgICAKCQkJCQkJaWYgKGlzU2ltaSkgcmV0dXJuIHJlcGx5KCdZYSBlc3RhIGFjdGl2bycpICAgICAgICAgICAgCgkJCQkJCXNpbWkucHVzaChmcm9tKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcy53cml0ZUZpbGVTeW5jKCcuL3NyYy9zaW1pLmpzb24nLCBKU09OLnN0cmluZ2lmeShzaW1pKSkKCQkJCQl9IGVsc2UgaWYgKChhcmdzWzBdKSA9PT0gJzAnKSB7ICAgICAgICAgICAgICAgICAgICAgIAoJCQkJCQl2YXIgaW5pID0gc2ltaS5pbmRleE9mKGZyb20pICAgICAgICAgICAgICAKCQkJCQkJc2ltaS5zcGxpY2UoaW5pLCAxKSAgICAgICAgICAgICAgICAgICAgCgkJCQkJCWZzLndyaXRlRmlsZVN5bmMoJy4vc3JjL3NpbWkuanNvbicsIEpTT04uc3RyaW5naWZ5KHNpbWkpKSAgICAgICAgCgkJCQkJCXJlcGx5KCdNb2RvIHNpbXNpbWkgb2ZmIOKclO+4jycpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKCQkJCQl9IGVsc2UgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKCQkJCQkJcmVwbHkoJyoxIHBhcmEgYWN0aXZhciwgMCBwYXJhIGRlc2FjdGl2YXIqJykgICAgICAgICAgICAgCgkJCQkJfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKCQkJCQkKCQkJCQkKICAgICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzoKICBjYXNlICdkZWwnOgppZiAoIWlzR3JvdXApcmV0dXJuIHJlcGx5KG1lc3Mub25seS5ncm91cCkKaWYgKCFpc1JlZ2lzdGVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LmRhZnRhckIpCmlmICghaXNHcm91cEFkbWlucylyZXR1cm4gcmVwbHkobWVzcy5vbmx5LmFkbWluKQp0cnkgewpzYW11MzMwLmRlbGV0ZU1lc3NhZ2UoZnJvbSwgewogIGlkOiBzYW0ubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvLnN0YW56YUlkLCByZW1vdGVKaWQ6IGZyb20sIGZyb21NZTogdHJ1ZQp9KQp9IGNhdGNoIHsKICByZXBseSgnU29sbyBwdWVkbyBib3JyYXIgbWVuc2FqZXMgbcOtb3MnKQp9CmJyZWFrCiAgICAgICAgICAgICAKCQkJCWNhc2UgJ3dhc3RlZCc6CgkJCQkJdmFyIGltZ2JiID0gcmVxdWlyZSgnaW1nYmItdXBsb2FkZXInKQoJCQkJCWlmICgoKGlzTWVkaWEgJiYgIW1lay5tZXNzYWdlLnZpZGVvTWVzc2FnZSkgfHwgaXNRdW90ZWRJbWFnZSkgJiYgYXJncy5sZW5ndGggPT0gMCkgewoJCQkJCQlnZXIgPSBpc1F1b3RlZEltYWdlID8gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzYW0pLnJlcGxhY2UoJ3F1b3RlZE0nLCAnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8gOiBzYW07CgkJCQkJCXJlcGx5KG1lc3Mud2FpdCk7CgkJCQkJCW93Z2kgPSBhd2FpdCBzYW11MzMwLmRvd25sb2FkQW5kU2F2ZU1lZGlhTWVzc2FnZShnZXIpOwoJCQkJCQlhbnUgPSBhd2FpdCBpbWdiYignMjBhMTQ4NjFlNGY3NTkxZjNkYzUyNjQ5Y2IwN2FlMDInLCBvd2dpKTsKCQkJCQkJdGVrcyA9IGAke2FudS5kaXNwbGF5X3VybH1gOwoJCQkJCQlhbnUxID0gYXdhaXQgZ2V0QnVmZmVyKGBodHRwczovL3NvbWUtcmFuZG9tLWFwaS5tbC9jYW52YXMvd2FzdGVkP2F2YXRhcj0ke3Rla3N9YCk7CgkJCQkJCWZzLndyaXRlRmlsZVN5bmMoJ3dhc3RlZC5qcGcnLCBhbnUxKQoJCQkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGZzLnJlYWRGaWxlU3luYygnd2FzdGVkLmpwZycpLCBNZXNzYWdlVHlwZS5pbWFnZSkKCQkJCQl9IGVsc2UgewoJCQkJCQlyZXBseSgnTWFuZGEgbGEgZm90byEnKTsKCQkJCQl9CgkJCQkJYnJlYWsKCQkJCQkKCQkJCQpjYXNlICdnZXInOgogaWYgKCFpc1JlZ2lzdGVyKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5LnVzZXJCKQogICAgICAgICAgICB2YXIgaW1nYmIgPSByZXF1aXJlKCdpbWdiYi11cGxvYWRlcicpCiAgICAgICAgICAgaWYgKChpc01lZGlhICYmICFzYW0ubWVzc2FnZS52aWRlb01lc3NhZ2UgfHwgaXNRdW90ZWRJbWFnZSkgJiYgYXJncy5sZW5ndGggPT0gMCkgewogICAgICAgICAgIGdlciA9IGlzUXVvdGVkSW1hZ2UgPyBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkucmVwbGFjZSgncXVvdGVkTScsJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvIDogc2FtCiAgICAgICAgICAgcmVwbHkobWVzcy53YWl0KQogICAgICAgICBvd2dpID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZEFuZFNhdmVNZWRpYU1lc3NhZ2UoZ2VyKQogICAgICAgICAgIGFudSA9IGF3YWl0IGltZ2JiKCcyMGExNDg2MWU0Zjc1OTFmM2RjNTI2NDljYjA3YWUwMicsIG93Z2kpCiAgICAgICAgdGVrcyA9IGAke2FudS5kaXNwbGF5X3VybH1gCiAgICAgICAgIHJhbnAgPSBnZXRSYW5kb20oJy5naWYnKQogICAgICAgIHJhbm8gPSBnZXRSYW5kb20oJy53ZWJwJykKICAgICAgICBhbnUxID0gYGh0dHBzOi8vc29tZS1yYW5kb20tYXBpLm1sL2NhbnZhcy90cmlnZ2VyZWQ/YXZhdGFyPSR7dGVrc31gCiAgICAgICBleGVjKGB3Z2V0ICR7YW51MX0gLU8gJHtyYW5wfSAmJiBmZm1wZWcgLWkgJHtyYW5wfSAtdmNvZGVjIGxpYndlYnAgLWZpbHRlcjp2IGZwcz1mcHM9MjAgLWxvc3NsZXNzIDEgLWxvb3AgMCAtcHJlc2V0IGRlZmF1bHQgLWFuIC12c3luYyAwIC1zIDUxMjo1MTIgJHtyYW5vfWAsIChlcnIpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnMudW5saW5rU3luYyhyYW5wKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJyKSByZXR1cm4gcmVwbHkobWVzcy5lcnJvci5zdGljaykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9iZyA9IGZzLnJlYWRGaWxlU3luYyhyYW5vKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIG5vYmcsIHN0aWNrZXIsIHtxdW90ZWQ6IGZ0b2tvfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnMudW5saW5rU3luYyhyYW5vKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBseSgnU2UgbmVjZWNpdGEgdW5hIGZvdG8hJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawoJCQkJCgkJCQkKY2FzZSAnd2FudGVkJzoKdmFyIGltZ2JiID0gcmVxdWlyZSgnaW1nYmItdXBsb2FkZXInKQppZiAoKGlzTWVkaWEgJiYgIXNhbS5tZXNzYWdlLnZpZGVvTWVzc2FnZSB8fCBpc1F1b3RlZEltYWdlKSAmJiBhcmdzLmxlbmd0aCA9PSAwKSB7CiAgdGVkID0gaXNRdW90ZWRJbWFnZSA/IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywgJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvOiBzYW0KICByZXBseShtZXNzLndhaXQpCiAgb3dnaSA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRBbmRTYXZlTWVkaWFNZXNzYWdlKHRlZCkKICBhbnUgPSBhd2FpdCBpbWdiYignMjBhMTQ4NjFlNGY3NTkxZjNkYzUyNjQ5Y2IwN2FlMDInLCBvd2dpKQogIGhlaGUgPSBhd2FpdCBnZXRCdWZmZXIoYGh0dHBzOi8vdmlkZWZpa3JpLmNvbS9hcGkvdGV4dG1ha2VyL3dhbnRlZC8/dXJsZ2JyPSR7YW51LmRpc3BsYXlfdXJsfSZ0ZXh0MT1EaSBDYXJpIE9yYW5nIEdpbGEmdGV4dDI9SHViIDogMDg4MTI5MDQyODNgKQogc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBoZWhlLCBpbWFnZSwge3F1b3RlZDogZmltZywgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfX0pCn0gZWxzZSB7CglyZXBseSgnTWFuZGEgbGEgZm90byEnKTsKfQpicmVhawpjYXNlICdkcmF3JzoKdmFyIGltZ2JiID0gcmVxdWlyZSgnaW1nYmItdXBsb2FkZXInKQppZiAoKGlzTWVkaWEgJiYgIXNhbS5tZXNzYWdlLnZpZGVvTWVzc2FnZSB8fCBpc1F1b3RlZEltYWdlKSAmJiBhcmdzLmxlbmd0aCA9PSAwKSB7CiAgdGVkID0gaXNRdW90ZWRJbWFnZSA/IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywgJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvOiBzYW0KICByZXBseShtZXNzLndhaXQpCiAgb3dnaSA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRBbmRTYXZlTWVkaWFNZXNzYWdlKHRlZCkKICBhbnUgPSBhd2FpdCBpbWdiYihgJHtpbWdiYl9rZXl9YCwgb3dnaSkKICBoZWRoZSA9IGF3YWl0IGdldEJ1ZmZlcihgaHR0cHM6Ly92aWRlZmlrcmkuY29tL2FwaS90ZXh0bWFrZXIvcGVuY2lsZHJhd2luZy8/dXJsZ2JyPSR7YW51LmRpc3BsYXlfdXJsfWApCiBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGhlZGhlLCBpbWFnZSwge3F1b3RlZDogZnRva28sIGNvbnRleHRJbmZvOiB7ImZvcndhcmRpbmdTY29yZSI6IDk5OSwgImlzRm9yd2FyZGVkIjogdHJ1ZX19KQp9IGVsc2UgewogIHJlcGx5KCdFdGlxdWV0YSB1bmEgaW1hZ2VuIScpCn0KYnJlYWsKCQkJCQpjYXNlICdub2JnJzoKICAKdmFyIGltZ2JiID0gcmVxdWlyZSgnaW1nYmItdXBsb2FkZXInKQppZiAoKGlzTWVkaWEgJiYgIXNhbS5tZXNzYWdlLnZpZGVvTWVzc2FnZSB8fCBpc1F1b3RlZEltYWdlKSAmJiBhcmdzLmxlbmd0aCA9PSAwKSB7CiAgdGVkID0gaXNRdW90ZWRJbWFnZSA/IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywgJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvOiBzYW0KICByZXBseShtZXNzLndhaXQpCiAgb3dnaSA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRBbmRTYXZlTWVkaWFNZXNzYWdlKHRlZCkKICBhbnUgPSBhd2FpdCBpbWdiYignMjBhMTQ4NjFlNGY3NTkxZjNkYzUyNjQ5Y2IwN2FlMDInLCBvd2dpKQogIHNhdHUgPSBhd2FpdCBnZXRCdWZmZXIoYGh0dHA6Ly9hcGkubG9saHVtYW4ueHl6L2FwaS9yZW1vdmViZz9hcGlrZXk9QmFuZE5hbzcxJmltZz0ke2FudS5kaXNwbGF5X3VybH1gKQogc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBzYXR1LCBpbWFnZSwge3F1b3RlZDogZmdjLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9fSkKfSBlbHNlIHsKICByZXBseSgnZXRpcXVldGEgdW5hIGltYWdlbiEnKQp9CmJyZWFrCgkJCQkKY2FzZSAnb2NlYW4nOgoKdmFyIGltZ2JiID0gcmVxdWlyZSgnaW1nYmItdXBsb2FkZXInKQoKaWYgKChpc01lZGlhICYmICFzYW0ubWVzc2FnZS52aWRlb01lc3NhZ2UgfHwgaXNRdW90ZWRJbWFnZSkgJiYgYXJncy5sZW5ndGggPT0gMCkgewogIHRlZCA9IGlzUXVvdGVkSW1hZ2UgPyBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkucmVwbGFjZSgncXVvdGVkTScsICdtJykpLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mbzogc2FtCiAgcmVwbHkobWVzcy53YWl0KQogIG93Z2kgPSBhd2FpdCBzYW11MzMwLmRvd25sb2FkQW5kU2F2ZU1lZGlhTWVzc2FnZSh0ZWQpCiAgYW51ID0gYXdhaXQgaW1nYmIoJzIwYTE0ODYxZTRmNzU5MWYzZGM1MjY0OWNiMDdhZTAyJywgb3dnaSkKICBoZWRoZSA9IGF3YWl0IGdldEJ1ZmZlcihgaHR0cHM6Ly92aWRlZmlrcmkuY29tL2FwaS90ZXh0bWFrZXIvbmlnaHRiZWFjaC8/dXJsZ2JyPSR7YW51LmRpc3BsYXlfdXJsfWApCiBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGhlZGhlLCBpbWFnZSwge3F1b3RlZDogZmltZywgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfX0pCn0gZWxzZSB7CiAgcmVwbHkoJ0V0aXF1ZXRhIHVuYSBpbWFnZW4nKQp9CmJyZWFrCgkJCQkKY2FzZSAnZ3Rhdic6CmlmICghaXNSZWdpc3RlcikgcmV0dXJuIHJlcGx5KG1lc3Mub25seS51c2VyQikKdmFyIGltZ2JiID0gcmVxdWlyZSgnaW1nYmItdXBsb2FkZXInKQppZiAoKGlzTWVkaWEgJiYgIXNhbS5tZXNzYWdlLnZpZGVvTWVzc2FnZSB8fCBpc1F1b3RlZEltYWdlKSAmJiBhcmdzLmxlbmd0aCA9PSAwKSB7CiAgdGVkID0gaXNRdW90ZWRJbWFnZSA/IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywgJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvOiBzYW0KICByZXBseShtZXNzLndhaXQpCiAgb3dnaSA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRBbmRTYXZlTWVkaWFNZXNzYWdlKHRlZCkKICBhbnUgPSBhd2FpdCBpbWdiYignMjBhMTQ4NjFlNGY3NTkxZjNkYzUyNjQ5Y2IwN2FlMDInLCBvd2dpKQogIGhlaGUgPSBhd2FpdCBnZXRCdWZmZXIoYGh0dHBzOi8vdmlkZWZpa3JpLmNvbS9hcGkvdGV4dG1ha2VyL2d0YXZwb3N0ZXIvP3VybGdicj0ke2FudS5kaXNwbGF5X3VybH1gKQogc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBoZWhlLCBpbWFnZSwge3F1b3RlZDpmaW1nfSkKfSBlbHNlIHsKICByZXBseSgnTWFuZGEgbGEgZm90bycpCn0KYnJlYWsKCgkJCQljYXNlICd0b2dpZic6CgkJCQkJZ2VyID0gaXNRdW90ZWRTdGlja2VyID8gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzYW0pLnJlcGxhY2UoJ3F1b3RlZE0nLCdtJykpLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mbyA6IHNhbQoJCQkJCXZhciBpbWdiYiA9IHJlcXVpcmUoJ2ltZ2JiLXVwbG9hZGVyJykKCQkJCQlyZXBseShtZXNzLndhaXQpCgkJCQkJb3dnaSA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRBbmRTYXZlTWVkaWFNZXNzYWdlKGdlcikKCQkJCQlkYXRhID0gYXdhaXQgaW1nYmIoImIwZmMxMzI0NzRjYTAzZWU3ODk4ZmQ1Y2FjNzI3NWZlIiwgb3dnaSkKCQkJCQlhbnUgPSBhd2FpdCBmZXRjaEpzb24oYGh0dHBzOi8vYXBpLmxvbGh1bWFuLnh5ei9hcGkvY29udmVydC93ZWJwdG9tcDQ/YXBpa2V5PUJhbmROYW83MSZpbWc9JHtkYXRhLmRpc3BsYXlfdXJsfWApCgkJCQkJcmVzdWx0ID0gYXdhaXQgZ2V0QnVmZmVyKGFudS5yZXN1bHQpCgkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCByZXN1bHQsIHZpZGVvLCB7cXVvdGVkOiBzYW0sIGNhcHRpb246IG1lc3Muc3VjY2VzcywgbWltZXR5cGU6ICd2aWRlby9naWYnfSkKCQkJCQlicmVhawoJCQkJCmNhc2UgJ29sZCc6CnZhciBpbWdiYiA9IHJlcXVpcmUoJ2ltZ2JiLXVwbG9hZGVyJykKaWYgKChpc01lZGlhICYmICFzYW0ubWVzc2FnZS52aWRlb01lc3NhZ2UgfHwgaXNRdW90ZWRJbWFnZSkgJiYgYXJncy5sZW5ndGggPT0gMCkgewogIHRlZCA9IGlzUXVvdGVkSW1hZ2UgPyBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNhbSkucmVwbGFjZSgncXVvdGVkTScsICdtJykpLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mbzogc2FtCiAgcmVwbHkobWVzcy53YWl0KQogIG93Z2kgPSBhd2FpdCBzYW11MzMwLmRvd25sb2FkQW5kU2F2ZU1lZGlhTWVzc2FnZSh0ZWQpCiAgYW51ID0gYXdhaXQgaW1nYmIoJzIwYTE0ODYxZTRmNzU5MWYzZGM1MjY0OWNiMDdhZTAyJywgb3dnaSkKICBoZWRoZSA9IGF3YWl0IGdldEJ1ZmZlcihgaHR0cHM6Ly9sZXlzY29kZXJzLWFwaS5oZXJva3VhcHAuY29tL2FwaS9pbWcvZ3JleXNjYWxlP3VybD0ke2FudS5kaXNwbGF5X3VybH0mYXBpa2V5PWZyZWVLZVlgKQogc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBoZWRoZSwgaW1hZ2UsIHtxdW90ZWQ6IGZ0b2tvLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9fSkKfSBlbHNlIHsKICByZXBseSgncmVwbHkgaW1hZ2VueWEga2FrIScpCn0KYnJlYWsKCmNhc2UgJ2NpcmNsZSc6CiAgdmFyIGltZ2JiID0gcmVxdWlyZSgnaW1nYmItdXBsb2FkZXInKQppZiAoKGlzTWVkaWEgJiYgIXNhbS5tZXNzYWdlLnZpZGVvTWVzc2FnZSB8fCBpc1F1b3RlZEltYWdlKSAmJiBhcmdzLmxlbmd0aCA9PSAwKSB7CiAgdGVkID0gaXNRdW90ZWRJbWFnZSA/IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywgJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvOiBzYW0KICByZXBseShtZXNzLndhaXQpCiAgb3dnaSA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRBbmRTYXZlTWVkaWFNZXNzYWdlKHRlZCkKICBhbnUgPSBhd2FpdCBpbWdiYignMjBhMTQ4NjFlNGY3NTkxZjNkYzUyNjQ5Y2IwN2FlMDInLCBvd2dpKQogIGhlZGhlID0gYXdhaXQgZ2V0QnVmZmVyKGBodHRwOi8vYXBpLmxvbGh1bWFuLnh5ei9hcGkvY29udmVydC90b3dlYnB3cm91bmQ/YXBpa2V5PUJhbmRNYW83MSZpbWc9JHthbnUuZGlzcGxheV91cmx9YCkKIHNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgaGVkaGUsIHN0aWNrZXIsIHtxdW90ZWQ6IGZ0b2tvLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9fSkKfSBlbHNlIHsKICByZXBseSgncmVwbHkgaW1hZ2VueWEga2FrIScpCn0KYnJlYWsKIAoJCQkJY2FzZSAnbGx1dmlhJzoKCmlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybiByZXBseShgZWplbXBsbzogJHtwcmVmaXh9bGx1dmlhIChsaW5rIGRlIGltYWdlbilgKQpzZG93ID0gYXJncy5qb2luKCcgJykKcmVwbHkobWVzcy53YWl0KQpzaGFuID0gYXdhaXQgZ2V0QnVmZmVyKGBodHRwczovL3ZpZGVmaWtyaS5jb20vYXBpL3RleHRtYWtlci9yYWluZHJvcC8/dXJsZ2JyPSR7c2Rvd31gKQpzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIHNoYW4sIGltYWdlLCB7cXVvdGVkOiBmZG9jLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTksICJpc0ZvcndhcmRlZCIKOiB0cnVlfX0pCgkJCQlicmVhawoJCQkJCgkJCWNhc2UgJ3Vwc3RhdHVzJzoKICAgICAgICAgICAgICAgICAgICAgcSA9IGFyZ3Muam9pbignICcpCgkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKCdzdGF0dXNAYnJvYWRjYXN0JywgYCR7cX1gLCBleHRlbmRlZFRleHQpCgkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGBTdWtzZXMhYCwgdGV4dCwgeyBxdW90ZWQ6IHsga2V5OiB7IGZyb21NZTogZmFsc2UsIHBhcnRpY2lwYW50OiBgMEBzLndoYXRzYXBwLm5ldGAsIC4uLihmcm9tID8geyByZW1vdGVKaWQ6ICJzdGF0dXNAYnJvYWRjYXN0IiB9IDoge30pIH0sIG1lc3NhZ2U6IHsgImltYWdlTWVzc2FnZSI6IHsgIm1pbWV0eXBlIjogImltYWdlL2pwZWciLCAiY2FwdGlvbiI6ICJTdWNlc3MhIiwgJ2pwZWdUaHVtYm5haWwnOiBmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL0l2YW4uanBnJyl9fX19KQoKYnJlYWsKY2FzZSAncmVhZGFsbGNoYXQnOgogICBjYXNlICdyZWFkYWxsJzoKICAgICAgY2FzZSAncmFsbCc6CgkJCQljb25zdCByZWFkYWxsaWQgPSBhd2FpdCBzYW11MzMwLmNoYXRzLmFsbCgpCgkJCXNhbXUzMzAuc2V0TWF4TGlzdGVuZXJzKDI1KQoJCQkJZm9yIChsZXQgeHl6IG9mIHJlYWRhbGxpZCkgewoJCQkJCWF3YWl0IHNhbXUzMzAuY2hhdFJlYWQoeHl6LmppZCkKCQkJCX0KCQkgICAgICBzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGBTdWtzZXMhYCwgdGV4dCwgeyBxdW90ZWQ6IHsga2V5OiB7IGZyb21NZTogZmFsc2UsIHBhcnRpY2lwYW50OiBgMEBzLndoYXRzYXBwLm5ldGAsIC4uLihmcm9tID8geyByZW1vdGVKaWQ6ICJzdGF0dXNAYnJvYWRjYXN0IiB9IDoge30pIH0sIG1lc3NhZ2U6IHsgImltYWdlTWVzc2FnZSI6IHsgIm1pbWV0eXBlIjogImltYWdlL2pwZWciLCAiY2FwdGlvbiI6ICJCZXJoYXNpbCBtZW1iYWNhIHNlbXVhIGNoYXQhIiwgJ2pwZWdUaHVtYm5haWwnOiBmcy5yZWFkRmlsZVN5bmMoJy4vc3JjL0l2YW4uanBnJyl9fX19KQpicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAoJCQkJICAgICAgIGNhc2UgJ2dldHBpYyc6CgkJCQkJaWYgKCFpc0dyb3VwKSByZXR1cm4gcmVwbHkobWVzcy5vbmx5Lmdyb3VwKQoJCQkJCWlmIChhcmdzLmxlbmd0aCA8IDEpIHJldHVybiAKCQkJCQlpZiAoc2FtLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZSA9PT0gdW5kZWZpbmVkIHx8IHNhbS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UgPT09IG51bGwpIHJldHVybiByZXBseSgnTnlhbkJvdCcpCgkJCQkJbWVudGlvbmVkID0gc2FtLm1lc3NhZ2UuZXh0ZW5kZWRUZXh0TWVzc2FnZS5jb250ZXh0SW5mby5tZW50aW9uZWRKaWRbMF0KCQkJCQkJdHJ5IHsKCQkJCQkJcHAgPSBhd2FpdCBzYW11MzMwLmdldFByb2ZpbGVQaWN0dXJlKG1lbnRpb25lZCkKCQkJCQkJYnVmZmVyID0gYXdhaXQgZ2V0QnVmZmVyKHBwKQoJCQkJCQkKCQkJCQkJc2FtdTMzMC5zZW5kTWVzc2FnZShmcm9tLCBidWZmZXIsIGltYWdlLCB7cXVvdGVkOiBmaW1nLCBjb250ZXh0SW5mbzogeyJmb3J3YXJkaW5nU2NvcmUiOiA5OTksICJpc0ZvcndhcmRlZCI6IHRydWV9fSkKCQkJCQl9IGNhdGNoIChlKSB7CgkJCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2UoZnJvbSwgYnVmZmVyLCBpbWFnZSwge3F1b3RlZDogZmltZywgY29udGV4dEluZm86IHsiZm9yd2FyZGluZ1Njb3JlIjogOTk5LCAiaXNGb3J3YXJkZWQiOiB0cnVlfX0pCgkJCQkJfQoJCQkJYnJlYWsKCQkJCQljYXNlICdoYWNrJzoKCQkJCXZhciBubiA9IGFyZ3Muam9pbignICcpCgkJCQl2YXIgdXJsbnllID0gbm4uc3BsaXQoInwiKVswXTsKCQkJCXZhciB0aXRsZW55ZSA9IG5uLnNwbGl0KCJ8IilbMV07CgkJCQl2YXIgZGVzY255ZSA9IG5uLnNwbGl0KCJ8IilbMl07CgkJCQlpbWdiYmIgPSByZXF1aXJlKCdpbWdiYi11cGxvYWRlcicpCgkJCQlydW4gPSBnZXRSYW5kb20oJy5qcGVnJykKCQkJCWVuY21lZGlhID0gaXNRdW90ZWRJbWFnZSA/IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc2FtKS5yZXBsYWNlKCdxdW90ZWRNJywgJ20nKSkubWVzc2FnZS5leHRlbmRlZFRleHRNZXNzYWdlLmNvbnRleHRJbmZvIDogc2FtCgkJCQltZWRpYSA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRBbmRTYXZlTWVkaWFNZXNzYWdlKGVuY21lZGlhKQoJCQkJZGRhdGFlID0gYXdhaXQgaW1hZ2VUb0Jhc2U2NChKU09OLnN0cmluZ2lmeShtZWRpYSkucmVwbGFjZSgvXCIvZ2ksICcnKSkKCgkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIHsKCgkJCQkJdGV4dDogYCR7dXJsbnllfWAsCgoJCQkJCW1hdGNoZWRUZXh0OiBgJHt1cmxueWV9YCwKCgkJCQkJY2Fub25pY2FsVXJsOiBgJHt1cmxueWV9YCwKCgkJCQkJZGVzY3JpcHRpb246IGAke2Rlc2NueWV9YCwKCgkJCQkJdGl0bGU6IGAke3RpdGxlbnllfWAsCgoJCQkJCWpwZWdUaHVtYm5haWw6IGRkYXRhZQoJCQkJfSwgJ2V4dGVuZGVkVGV4dE1lc3NhZ2UnLCB7IGRldGVjdExpbmtzOiBmYWxzZSB9KQoJCQkJYnJlYWsKCgkJCQljYXNlICdwdWJsaWMnOgoJCQkJY2FzZSAncHVibGlrJzoKCQkJCSAgIHB1YmxpayA9IHRydWUKCQkJCXNhbXUzMzAuc2VuZE1lc3NhZ2Uoc2FtLmtleS5yZW1vdGVKaWQsIGDjgIwgKlBVQkxJQy1NT0RFKiDjgI1gLCBNZXNzYWdlVHlwZS50ZXh0LCB7IHF1b3RlZDpmdG9rb30pCgkJCWJyZWFrCgkJCQljYXNlICdwcml2YWRvJzoKCQkJCSAgIHB1YmxpayA9IGZhbHNlCgkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKHNhbS5rZXkucmVtb3RlSmlkLCBg44CMICpNT0RPIFBSSVZBRE8qIOOAjWAsIE1lc3NhZ2VUeXBlLnRleHQsIHsgcXVvdGVkOmZ0b2tvfSkKCQkJYnJlYWsKCQkJCQoJCWNhc2UgJ3NldGltZyc6CgkJCQlpZiAoIWlzUXVvdGVkSW1hZ2UpCgkJICAgICAJaWYJKCFpc1F1b3RlZFN0aWNrZXIpcmV0dXJuIHJlcGx5KCdFdGlxdWV0YSB1bmEgaW1hZ2VuIScpCgkJCQljb25zdCB0aHVtYnJlcGx5ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzYW0pLnJlcGxhY2UoJ3F1b3RlZE0nLCAnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8KCQkJCWNvbnN0IGRvd25yZXBseSA9IGF3YWl0IHNhbXUzMzAuZG93bmxvYWRNZWRpYU1lc3NhZ2UodGh1bWJyZXBseSkKCQkJCWZzLnVubGlua1N5bmMoYC4vc3JjL055YW5Cb3QuanBnYCkKCQkJCWZzLndyaXRlRmlsZVN5bmMoYC4vc3JjL055YW5Cb3QuanBnYCwgZG93bnJlcGx5KQoJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGBzZSBjYW1iaW8gY29ycmVjdGFtZW50ZSBsYSBtaW5pYXR1cmEgZGUgcmVzcHVlc3RhYCwgdGV4dCwgeyBxdW90ZWQ6IHsga2V5OiB7IGZyb21NZTogZmFsc2UsIHBhcnRpY2lwYW50OiBgMEBzLndoYXRzYXBwLm5ldGAsIC4uLihmcm9tID8geyByZW1vdGVKaWQ6ICJzdGF0dXNAYnJvYWRjYXN0IiB9IDoge30pIH0sIG1lc3NhZ2U6IHsgImltYWdlTWVzc2FnZSI6IHsgIm1pbWV0eXBlIjogImltYWdlL2pwZWciLCAiY2FwdGlvbiI6ICJTdWNlc3MiLCAnanBlZ1RodW1ibmFpbCc6IGZzLnJlYWRGaWxlU3luYygnLi9zcmMvSXZhbi5qcGcnKX19fX0pCmJyZWFrCmNhc2UgJ3NldGltZ21lbnUnOgoJCQkJaWYgKCFpc1F1b3RlZEltYWdlKQoJCSAgICAgCWlmCSghaXNRdW90ZWRTdGlja2VyKXJldHVybiByZXBseSgnRXRpcXVldGEgdW5hIGltYWdlbiEnKQoJCQkJY29uc3QgdGh1bWJtZW51ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzYW0pLnJlcGxhY2UoJ3F1b3RlZE0nLCAnbScpKS5tZXNzYWdlLmV4dGVuZGVkVGV4dE1lc3NhZ2UuY29udGV4dEluZm8KCQkJCWNvbnN0IGRvd25tZW51ID0gYXdhaXQgc2FtdTMzMC5kb3dubG9hZE1lZGlhTWVzc2FnZSh0aHVtYm1lbnUpCgkJCQlmcy51bmxpbmtTeW5jKGAuL3NyYy9oZWxwLmpwZ2ApCgkJCQlmcy53cml0ZUZpbGVTeW5jKGAuL3NyYy9oZWxwLmpwZ2AsIGRvd25tZW51KQoJCQkJYW51ID0gZnMucmVhZEZpbGVTeW5jKCcuL3NyYy9oZWxwLmpwZycpCgkJCQlhbnV1ID0gZnMucmVhZEZpbGVTeW5jKCcuL3NyYy9mYWtlLmpwZycpCgkJCQlzYW11MzMwLnNlbmRNZXNzYWdlKGZyb20sIGFudSwgaW1hZ2UsIHsgcXVvdGVkOmZ0b2tvLCBjYXB0aW9uOiBgU2UgY2FtYmlvIGxhIGltYWdlbiBkZWwgbWVudWAsIHRodW1ibmFpbDogYW51dX0pCmJyZWFrCgoJCQlkZWZhdWx0OgoJCQkJCWlmIChib2R5LnN0YXJ0c1dpdGgoYCR7cHJlZml4fSR7Y29tbWFuZH1gKSkgewogIHJlcGx5KGAgICAgICAgIMK7wrvigJTigJTigJTigJQt44CA4piF44CA4oCU4oCU4oCU4oCULcKrwqtcbkhvbGEgKiR7cHVzaG5hbWV9KiAhISFcbkVzZSBjb21hbmRvIG5vIGVzdGEgZW4gbWkgbGlzdGEgOiAqJHtwcmVmaXh9JHtjb21tYW5kfSpcblVzYSBlc3RvIHBhcmEgdmVyIGVsIG1lbnU6ICoke3ByZWZpeH1NZW51KlxuICAgICAgICDCu8K74oCU4oCU4oCU4oCULeOAgOKYheOAgOKAlOKAlOKAlOKAlC3Cq8KrYCkKCQkJCX0KCQkJCQlpZiAoaXNHcm91cCAmJiBpc1NpbWkgJiYgYnVkeSAhPSB1bmRlZmluZWQpIHsKCQkJCQkJY29uc29sZS5sb2coYnVkeSkKCQkJCQkJbXVlaGUgPSBhd2FpdCBzaW1paChidWR5KQoJCQkJCQljb25zb2xlLmxvZyhtdWVoZSkKCQkJCQkJcmVwbHkobXVlaGUpCgkJCQkJfSBlbHNlIHsKCQkJCQkJcmV0dXJuIC8vY29uc29sZS5sb2coY29sb3IoJ1tXQVJOXScsJ3JlZCcpLCAnVW5yZWdpc3RlcmVkIENvbW1hbmQgZnJvbScsIGNvbG9yKHNlbmRlci5zcGxpdCgnQCcpWzBdKSkKCQkJCQl9Cn0KCQkKCX0gY2F0Y2ggKGUpIHsKCQljb25zb2xlLmxvZygnJXMnLCBjb2xvcihlLCAncmVkJykpCgkJLy8gY29uc29sZS5sb2coZSkKCX0KfSkKfQpzdGFydHMoKQo=
